<!doctype html>

<!--[if lt IE 7 ]> <html class="ie ie6 no-js" lang="ca"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie ie7 no-js" lang="ca"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie ie8 no-js" lang="ca"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie ie9 no-js" lang="ca"> <![endif]-->
<!--[if gt IE 9]><!--><html class="no-js" lang="ca"><!--<![endif]-->
<!-- the "no-js" class is for Modernizr. -->

<head id="www-sitename-com" data-template-set="html5-reset">

	<meta charset="utf-8">
	
	<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title>Implantació de sistemes operatius (ASIX)\ Sistemes informàtics (DAM i DAW)</title>
	
<!-- <meta name="title" content=""> --> 
	<meta name="description" content="">
	<!-- Google will often use this as its description of your page/site. Make it good. -->
	
	<meta name="google-site-verification" content="">
	<!-- Speaking of Google, don't forget to set your site up: http://google.com/webmasters -->
	
	<meta name="author" content="Institut Obert de Catalunya">
	<meta name="Copyright" content="Copyright Institut Obert de Catalunya 2011. All Rights Reserved.">

	<!-- Dublin Core Metadata : http://dublincore.org/ -->
	<meta name="DC.title" content="Implantació de sistemes operatius (ASIX)\ Sistemes informàtics (DAM i DAW)">
	<meta name="DC.subject" content="Informàtica i comunicacions">
	<meta name="DC.creator" content="Institut Obert de Catalunya">
	
	<!--  Mobile Viewport Fix
	j.mp/mobileviewport & davidbcalhoun.com/2010/viewport-metatag 
	device-width : Occupy full width of the screen in its current orientation
	initial-scale = 1.0 retains dimensions instead of zooming out if page height > device height
	maximum-scale = 1.0 retains dimensions instead of zooming in if page width < device width
	-->
	<!-- Uncomment to use � use thoughtfully!
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
	-->

	<link rel="shortcut icon" href="../../../img/favicon.ico">
	<!-- This is the traditional favicon.
		 - size: 16x16 or 32x32
		 - transparency is OK
		 - see wikipedia for info on browser support: http://mky.be/favicon/ -->
		 
	<link rel="apple-touch-icon" href="../../../img/apple-touch-icon.png">
	<!-- The is the icon for iOS's Web Clip.
		 - size: 57x57 for older iPhones, 72x72 for iPads, 114x114 for iPhone4's retina display (IMHO, just go ahead and use the biggest one)
		 - To prevent iOS from applying its styles to the icon name it thusly: apple-touch-icon-precomposed.png
		 - Transparency is not recommended (iOS will put a black BG behind the icon) -->
	
	<!-- CSS: screen, mobile & print are all in the same file -->
	<link rel="stylesheet" href="../../../_/css/style.css">

	<!-- CSS: jQuery UI -->
	<link rel="stylesheet" href="../../../_/css/jquery-ui.css">
	
	<!-- all our JS is at the bottom of the page, except for Modernizr. -->
	<script src="../../../_/js/modernizr-1.7.min.js"></script>
	<script src="../../../_/js/Hyphenator.js" type="text/javascript"></script>
	<script type="text/javascript">
	   Hyphenator.config({
		minwordlength : 4
	   });
	   Hyphenator.run();
	</script>
    <script src="../../../_/js/build.js" type="text/javascript"></script>
</head>

<body class="style-newspaper">

<div class="wrapper"><!-- not needed? up to you: http://camendesign.com/code/developpeurs_sans_frontieres -->

	<header id="header">
		<div class="head"><a href="http://ioc.gencat.cat"><img src="../../../img/logo.png" alt="Institut Obert de Catalunya"/></a><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/es/deed.ca"><img src="../../../img/license.png" alt="Llic&egrave;ncia" class="license"/></a></div>
		<div class="headdocument"><a href="../../../index.html">Implantació de sistemes operatius (ASIX)\ Sistemes informàtics (DAM i DAW)</a></div>
        <div id="search" class="search" name="search">
         <form id="frmsearch" action="../../../search.html" method="get">
          <input type="text" name="q"/>
        </form>
        </div>
	</header>
   <div id="upbutton" class="upbutton" style="display:none;"><img src="../../../img/uparrow.png" alt="Pujar a l'inici de p&agrave;gina"/></div>
   <aside id="aside">
    <div id="menu">
      <ul>
       <li name="toc"><div><img src="../../../img/toc.png" alt="&Iacute;ndex"/></div></li>
       <li name="settings"><div><img src="../../../img/settings.png" alt="Configuraci&oacute;"/></div></li>
       <li name="printer"><div><img src="../../../img/printer.png" alt="Imprimir"/></div></li>
       <li name="favorites"><div><img src="../../../img/favorites.png" alt="Favorits"/></div></li>
       <li name="help_icon" class="help_icon"><div><img src="../../../img/help_icon.png" alt="Ajuda"/></div></li>
      </ul>
     </div>
   </aside>
   <div id="sidebar-hide" name="sidebar-hide"><img src="../../../img/arrows.png"/></div>
   <section>
     <div id="toc" class="hidden">
      <div class="menucontent">
        <ul>
        <li id="u9" class="parentnode"><p><a class="unit" href="../../../WebContent/u9/introduccio.html">9. Seguretat, rendiment i recursos</a></p><ul class="expander"><li id="u9introduccio"><a href="../../../WebContent/u9/introduccio.html">Introducció</a></li><li id="u9resum"><a href="../../../WebContent/u9/resum.html">Resum</a></li><li id="u9objectius"><a href="../../../WebContent/u9/objectius.html">Resultats d'aprenentatge</a></li><li id="u9mapa"><a href="../../../WebContent/u9/mapa.html">Mapa conceptual</a></li><li id="u9referencies"><a href="../../../WebContent/u9/referencies.html">Referències</a></li><li id="u9a1" class="tocsection"><p id='u9a1continguts'><a class="section" href="../../../WebContent/u9/a1/continguts.html">Assegurament de la informació</a><span class="buttonexp"></span></p><ul><li id="u9a1activitats"><a href="../../../WebContent/u9/a1/activitats.html">Activitats</a></li><li id="u9a1exercicis"><a href="../../../WebContent/u9/a1/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><div data-parent-id='u9a1' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u9/a1/continguts.html#associacio_de_discos">Associació de discos</a></li><li><a href="../../../WebContent/u9/a1/continguts.html#tolerancia_a_fallades_del_maquinari">Tolerància a fallades del maquinari</a></li><li><a href="../../../WebContent/u9/a1/continguts.html#sistemes_redundants_raid">Sistemes redundants RAID</a></li><li><a href="../../../WebContent/u9/a1/continguts.html#associacio_d_ordinadorsclusteritzacio">Associació d'ordinadors: clusterització</a></li><li><a href="../../../WebContent/u9/a1/continguts.html#copies_de_seguretat">Còpies de seguretat</a></li><li><a href="../../../WebContent/u9/a1/continguts.html#recuperacio_en_cas_de_fallada_del_sistema">Recuperació en cas de fallada del sistema</a></li></ul></div></div><li id="u9a2" class="tocsection"><p id='u9a2continguts'><a class="section" href="../../../WebContent/u9/a2/continguts.html">Supervisió del rendiment del sistema</a><span class="buttonexp"></span></p><ul><li id="u9a2activitats"><a href="../../../WebContent/u9/a2/activitats.html">Activitats</a></li><li id="u9a2exercicis"><a href="../../../WebContent/u9/a2/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><div data-parent-id='u9a2' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u9/a2/continguts.html#monitoratge_del_rendiment_dels_components_d_un_sistema_informatic">Monitoratge del rendiment dels components d'un sistema informàtic</a></li><li><a href="../../../WebContent/u9/a2/continguts.html#enregistrament_i_monitoratge_d_esdeveniments">Enregistrament i monitoratge d'esdeveniments</a></li><li><a href="../../../WebContent/u9/a2/continguts.html#gestio_d_aplicacions_i_processos">Gestió d'aplicacions i processos</a></li></ul></div></div><li id="u9a3" class="tocsection"><p id='u9a3continguts'><a class="section" href="../../../WebContent/u9/a3/continguts.html">Directives de seguretat i auditories</a><span class="buttonexp"></span></p><ul><li id="u9a3activitats"><a href="../../../WebContent/u9/a3/activitats.html">Activitats</a></li><li id="u9a3exercicis"><a href="../../../WebContent/u9/a3/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><div data-parent-id='u9a3' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u9/a3/continguts.html#auditoria_de_sistemes_informatics">Auditoria de sistemes informàtics</a></li><li><a href="../../../WebContent/u9/a3/continguts.html#auditoria_en_sistemes_operatius_propietaris">Auditoria en sistemes operatius propietaris</a></li><li><a href="../../../WebContent/u9/a3/continguts.html#auditoria_en_sistemes_operatius_lliures">Auditoria en sistemes operatius lliures</a></li></ul></div></div></ul></li><li id="" class="indexnode"><p><a href="../../../index.html">Anar a l&#39;&iacute;ndex general</a></p></li>
        </ul>
      </div>
    </div>
   </section>
   <section>
   <div id="settings" class="hidden">
    <div class="menucontent">
     <div class="allsettings">
     <div class="settings">
      <label>Font i Color</label>
		<div class="setting-option">
	        <ul class="fontBackground">
				<li id="style-newspaper" title="Newspaper" class="appearance-style-newspaper"><span>Newspaper</span></li>
                <li id="style-novel" title="Novel" class="appearance-style-novel"><span>Novel</span></li>
                <li id="style-ebook" title="eBook" class="appearance-style-ebook"><span>eBook</span></li>
				<li id="style-inverse" title="Inverse" class="appearance-style-inverse active"><span>Inverse</span></li>
				<li id="style-athelas" title="Athelas" class="appearance-style-athelas"><span>Athelas</span></li>
			</ul>
		</div>
     </div>
	<div class="settings">
      <label>Amplada</label>
		<div class="setting-option">
	        <div id="slider-width"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
		<div class="setting-option">
	        <div id="slider-font"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
	  <div class="setting-option">
       <form action="" class="sett-options">
		<ul>
		    <li><input type="checkbox" id="secondary-content" /><label for="secondary-content">Mostra recursos complementaris</label></li>
		    <li><input type="checkbox" id="main-images" /><label for="main-images">Mostra imatges</label></li>
		    <li><input type="checkbox" id="text-alignment" /><label for="text-alignment">Text justificat</label></li>
			<li><input type="checkbox" id="text-hyphen" /><label for="text-hyphen">Partici&oacute; sil·l&agrave;bica</label></li>
		</ul>
       </form>
	  </div>
     </div>
     </div>
    </div>
   </div>
   </section>
 <section>
 <div id="favorites" class="hidden"></div>
 </section>   
 <div id="bridge" class="hidden"></div>
 <div id="help" class="hidden">
  <div class="helptitle">Dreceres del teclat<hr></div>
  <div class="helpsection"><span>General</span>
   <ul>
    <li><span class="shortcut">g</span>: Anar al men&uacute; de navegaci&oacute;</li>
    <li><span class="shortcut">o</span>: Anar a opcions</li>
    <li><span class="shortcut">s</span>: Guardar la p&agrave;gina actual a favorits</li>
    <li><span class="shortcut">p</span>: Imprimir la p&agrave;gina actual</li>
    <li><span class="shortcut">?</span>: Mostrar/Ocultar l&#39;ajuda</li>
   </ul>
  </div>
  <div class="helpsection"><span>Navegaci&oacute;</span>
   <ul>
    <li><span class="shortcut">i</span>: Anar a l&#39;&iacute;ndex general</li>
    <li><span class="shortcut">t</span>: Anar a l&#39;inici de p&agrave;gina</li>
    <li><span class="shortcut">b</span>: Anar al final de p&agrave;gina</li>
    <li><span class="shortcut">j</span>: Anar cap endavant dintre la p&agrave;gina</li>
    <li><span class="shortcut">k</span>: Anar cap enrere dintre la p&agrave;gina</li>
    <li><span class="shortcut">h</span>: Anar a la p&agrave;gina anterior:</li>
    <li><span class="shortcut">l</span>: Anar a la p&agrave;gina seg&uuml;ent:</li>
   </ul>
   </div>
 </div>
 <div id="favcounter" name="favcounter" class="hidden"><span></span></div>
 <div id="navmenu" class="navmenu"><ul class="webnav"><li><a href="../../../index.html" title="Anar a l&#39;&iacute;ndex general">Inici</a></li><li><a href="../introduccio.html">Administració de l'accés al domini</a></li><li>Recursos del domini</li></ul></div>
	<div id="content" lang="ca" class="hyphenate text">
     <article lang="ca" class="sheet">
        <h1><a id="recursos_del_domini"> Recursos del domini </a></h1>
    	
<p>
Des del punt de vista de l’administració de sistemes, s’acostuma a denominar <em>domini</em> un conjunt d’equips connectats entre ells que comparteixen informació administrativa (usuaris, grups, contrasenyes…) centralitzada. Això requereix fonamentalment la disponibilitat de, com a mínim, un ordinador perquè emmagatzemi aquesta informació i que, alhora, la comuniqui a la resta quan calgui, principalment, mitjançant un esquema client-servidor.
</p>

<h2><a id="equips_del_domini" >Equips del domini</a></h2>
<div class="level2">

<p>
Quan un usuari vol iniciar una connexió interactiva en qualsevol dels ordinadors clients del domini, aquest ha de validar les credencials de l’usuari en el servidor i obtenir-ne totes les dades necessàries per poder crear el context inicial de treball per a l’usuari.
</p>

<p>
Des del punt de vista de l’entorn del sistema operatiu Windows, la implementació del concepte de domini es realitza mitjançant l’anomenat <strong>directori actiu</strong> (AD, <em>active directory</em>); és a dir, un servei de directori basat en diferents estàndards com, per exemple, el protocol d’accés al directori (LDAP, <em>lightweight directory access protocol</em>) i el sistema de noms de domini (<acronym title="Domain Name System">DNS</acronym>, <em>domain name system</em>).
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
El directori actiu és la implementació de Microsoft del servei de directoris LDAP per ser utilitzat en entorns Windows.
</p>
</div></div>
<p>
Cal destacar, a més, que cada domini té unes directives de seguretat i relacions de seguretat amb altres dominis i, alhora, representa el límit de seguretat en una xarxa Windows en què el directori actiu està integrat per un o diversos dominis on cadascun pot abastar més d’una ubicació. Els dominis acostumen a representar l’estructura lògica de l’organització.
</p>

<p>
Des del punt de vista de l’entorn d’Unix, els dominis se solien implementar mitjançant el sistema d’informació de xarxa (NIS, <em>network information system</em>), del qual n’hi ha moltes variants. En conseqüència, la integració de serveis de directoris a Unix va possibilitar la incorporació del directori actiu que va resultar, des del punt de vista de la implementació de dominis, molt més potent i escalable que el NIS.
</p>

<p>
Quan parlem de dominis, no ens referim a una sola ubicació o a un tipus específic de configuració de xarxa sinó que els equips d’un domini tant poden compartir la proximitat física en una xarxa d’àrea local (<acronym title="Local Area Network">LAN</acronym>, <em>local area network</em>) com poden estar ubicats en diferents parts del món. En tots dos casos, mentre hi hagi comunicació entre ells, l’emplaçament físic és irrellevant.
</p>

<p>
Paral·lelament, els equips presents dins d’un domini del directori actiu (AD, <em>active directory</em>) es poden assignar dintre d’una unitat organitzativa (OU, <em>organizations units</em>) d’acord amb la ubicació, l’estructura organitzativa o altres factors. De fet, el directori actiu facilita als administradors la manipulació i implementació de canvis en la xarxa i les polítiques a tots els equips connectats al domini.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Unitat organitzativa</p>
<p>
Una unitat organitzativa (OU) és un contenidor d’objectes dins del qual trobem els usuaris, grups, equips i la resta de recursos d’aquesta OU. Una OU també pot contenir altres OU.
</p>
</div></div><div class="iocimportant"><div class="ioccontent">
<p>
Les unitats organitzatives que són unitats jeràrquicament inferiors al domini i que, alhora, poden estar formades per una sèrie d’objectes o altres unitats organitzatives (OU). Si bé els objectes tant poden ser recursos de xarxa com usuaris, impressores, ordinadors o unitats d’emmagatzematge, es poden agrupar en conjunts del mateix tipus que s’utilitzen per assignar drets d’accés als recursos.
</p>
</div></div>
<p>
Cal destacar que si un domini queda identificat per un nom de servidor de noms de domini (<acronym title="Domain Name System">DNS</acronym>), els equips basats en un servidor Windows que formin part d’aquest domini tindran el mateix sufix. Per tant, si un domini té per nom <acronym title="Domain Name System">DNS</acronym>, per exemple, <strong>ciclesfp.cat</strong> o <strong>asx.ciclesfp.cat</strong>, els equips basats en un servidor Windows tindran categoria de subdominis i s’anomenaran <strong>profes.ciclesfp.cat</strong> o <strong>profes.asx.ciclesfp.cat</strong>, respectivament. 
</p>

<p>
El directori actiu utilitza el servei de noms de domini (<acronym title="Domain Name System">DNS</acronym>) per resoldre els nom de la màquina per la seva adreça IP. Mitjançant el servei de noms de domini es defineix l’espai de noms i la màquina que es connecta en xarxa pot trobar el controlador de domini (DC, <em>domain controller</em>).
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Controlador de domini</p>
<p>
Centre neuràlgic d’un domini Windows; té assignades una sèrie de responsabilitats com, per exemple, l’autenticació per accedir a recursos compartits o a altres màquines mitjançant una contrasenya.
</p>
</div></div>
<p>
Finalment, cal destacar que el conjunt d’un o més dominis –si n’hi ha més d’un, s’estructuren jeràrquicament- que comparteixen un espai de noms contigus s’anomena <strong>arbre</strong>. Ara bé, Si aquest conjunt de dominis no comparteix un espai de noms contigu i estan connectats mitjançant relacions de confiança bidireccionals, s’anomena <strong>bosc</strong> (<span class="figref"><a href="#Figure1"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figure1"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Esquema lògic del directori actiu

</figcaption><img src="../media/ic10mu8_02.png" alt="" /></figure>
</div>
</div>

<h3><a id="instal_lacio_del_directori_actiu" >Instal·lació del directori actiu</a></h3>
<div class="level3">

<p>
El directori actiu es tracta d’un servei de xarxa que emmagatzema informació dels recursos de la xarxa i, alhora, permet l’accés dels usuaris i les aplicacions a aquests mateixos recursos.
</p>

<p>
Des d’un punt de vista pràctic, és un model d’organització, control i administració centralitzada de l’accés als recursos de la xarxa.
</p>

<p>
Tal com mostra la <span class="figref"><a href="#Figure2"><span>figura</span></a></span>, per arrencar la instal·lació del directori actiu, hem d’executar en primer lloc la utilitat <strong>dcpromo</strong> (<strong>Inici/ Executar / dcpromo</strong>).
</p>
<div class="iocfigure"><a name="Figure2"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Execució de la utilitat dcpromo

</figcaption><img src="../media/ic10mu8_03.png" alt="" /></figure>
</div>
<p>
L’execució d’aquesta utilitat activarà una instal·lació per defecte del <strong>Windows Server 2008</strong> que ens permetrà afegir el rol dels serveis de domini del directori actiu (AD DS, <em>active directory domain services</em>) i, alhora, afegir la característica (AD DS tools, <em>active directory domain services tools</em>) (<span class="figref"><a href="#Figure3"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figure3"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Assistent per a la instal·lació dels serveis del directori actiu

</figcaption><img src="../media/ic10mu8_04.png" alt="" /></figure>
</div>
<p>
A continuació, arrencarà l’assistent per a la instal·lació dels serveis del domini del directori actiu, tal com es mostra en la <span class="figref"><a href="#Figure4"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figure4"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Assistent per a la instal·lació dels serveis del directori actiu

</figcaption><img src="../media/ic10mu8_05.png" alt="" /></figure>
</div>
<p>
Posteriorment, tal com mostra la <span class="figref"><a href="#Figure5"><span>figura</span></a></span>, el programari ens demanarà si volem afegir-nos a un bosc existent, o bé, crear-ne un de nou –és a dir, crear un nou domini en un nou bosc.
</p>
<div class="iocfigure"><a name="Figure5"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Creació d’un nou domini en un nou bosc

</figcaption><img src="../media/ic10mu8_06.png" alt="" /></figure>
</div>
<p>
En el diàleg per definir el nom del domini complet del nou domini arrel del bosc se’ns sol·licita el nom <acronym title="Domain Name System">DNS</acronym> per al nou domini que, en el nostre cas, definirem <strong>asx.ciclesfp.cat</strong> (<span class="figref"><a href="#Figure6"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figure6"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Definició de l’FQDN

</figcaption><img src="../media/ic10mu8_07.png" alt="" /></figure>
</div>
<p>
Tal com mostra la <span class="figref"><a href="#Figure7"><span>figura</span></a></span>, en el diàleg de l’establiment funcional del bosc és on escollirem el mode funcional del Windows 2008, que, si bé no presenta el nivell d’actualització del Windows 2003 respecte del 2000, sí que serà el més actualitzat.
</p>
<div class="iocfigure"><a name="Figure7"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Definició del nivell funcional del bosc

</figcaption><img src="../media/ic10mu8_08.png" alt="" /></figure>
</div>
<p>
En el diàleg d’addició d’opcions per al controlador de domini podrem especificar algunes opcions força interessants. En el nostre cas, com que es tracta del primer domini del bosc, ha d’actuar com un servidor de catàleg global (<em>global catalog</em>); és a dir, no pot ser un controlador de domini de lectura solament (RODC, <em>read only domain controller</em>).
</p>

<p>
En aquest cas, la selecció del l’opció del <acronym title="Domain Name System">DNS</acronym> facilitarà que la instal·lació gestioni el muntatge del <acronym title="Domain Name System">DNS</acronym> (afegirà el rol de servidor <acronym title="Domain Name System">DNS</acronym> i la característica de les eines del servei <acronym title="Domain Name System">DNS</acronym>. Aquesta automatització del procés permetrà que no haguem d’instal·lar manualment el <acronym title="Domain Name System">DNS</acronym>, crear les zones, configurar el servidor com a client <acronym title="Domain Name System">DNS</acronym>, etc. (<span class="figref"><a href="#Figure8"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figure8"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Definició de la modalitat de servidor <acronym title="Domain Name System">DNS</acronym>

</figcaption><img src="../media/ic10mu8_09.png" alt="" /></figure>
</div>
<p>
Tal com mostra la <span class="figref"><a href="#Figure9"><span>figura</span></a></span>, a partir d’aquest punt poden sorgir avisos en relació amb la modalitat d’adreça IP amb la qual es pot treballar (<strong>estàtica</strong> o <strong>dinàmica</strong>) i els intents de creació de la delegació de la zona; en tots dos casos hem d’acceptar i continuar endavant. Per exemple, quan sorgeixi l’avís relacionat amb la creació d’una delegació pel servei <acronym title="Domain Name System">DNS</acronym>, haurem de sol·licitar continuar amb el procés de configuració.
</p>
<div class="iocfigure"><a name="Figure9"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Assignació de l’adreça IP

</figcaption><img src="../media/ic10mu8_10.png" alt="" /></figure>
</div>
<p>
En el diàleg de la ubicació de la base de dades, els arxius de registre i SYSVOL, se’ns sol·licitarà la ubicació física on es vol emmagatzemar aquesta informació. Aquest pas és important, atès que en un directori actiu amb milers o milions d’usuaris, la base de dades augmentarà constantment. A manera de proves, podem optar per deixar-ho en la unitat <strong>C:</strong>; si hi ha una previsió de creixement, és un punt que caldrà estudiar amb deteniment (<span class="figref"><a href="#Figure10"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figure10"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Definició de la ubicació de la base de dades

</figcaption><img src="../media/ic10mu8_12.png" alt="" /></figure>
</div>
<p>
En el diàleg per definir la contrasenya d’administrador del mode de restauració dels serveis de directori hem d’introduir la contrasenya que volem utilitzar per arrencar Windows en el mode de recuperació del directori actiu (<span class="figref"><a href="#Figure11"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figure11"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Introducció de la contrasenya

</figcaption><img src="../media/ic10mu8_13.png" alt="" /></figure>
</div>
<p>
Tal com mostra la <span class="figref"><a href="#Figure12"><span>figura</span></a></span>, en el diàleg Resum se’ns mostrarà un resum de la configuració que hem anat especificant en els diàlegs anteriors.
</p>
<div class="iocfigure"><a name="Figure12"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Resum de configuració

</figcaption><img src="../media/ic10mu8_14.png" alt="" /></figure>
</div>
<p>
Finalment, el programari acabarà de configurar la instal·lació perquè, definitivament, ja disposem d’un nou bosc en el nostre nou domini del directori actiu (<span class="figref"><a href="#Figure13"><span>figura</span></a></span> i <span class="figref"><a href="#Figure114"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figure13"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Procés de configuració dels serveis de domini de l’AD

</figcaption><img src="../media/ic10mu8_15.png" alt="" /></figure>
</div><div class="iocfigure"><a name="Figure114"></a><figure>
<figcaption><span class="figuretitle">Figura</span></figcaption><img src="../media/ic10mu8_16.png" alt="" /></figure>
</div>
</div>

<h3><a id="definicio_de_rols_dins_del_directori_actiu" >Definició de rols dins del directori actiu</a></h3>
<div class="level3">

<p>
Una de les funcions més importants que presenta el directori actiu és la possibilitat de configurar els equips del nostre domini i establir permisos i restriccions als nostres usuaris. Tot això ho farem mitjançant l’accés a <strong>Inici / Eines administratives / Usuaris i equips de directori actiu</strong> (<span class="figref"><a href="#Figure14"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figure14"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Usuaris i equips del directori actiu

</figcaption><img src="../media/ic10mu8_17.png" alt="" /></figure>
</div>
<p>
A banda dels usuaris que hàgim creat nosaltres, apareixen alguns grups definits per defecte com, per exemple, els usuaris de domini que és un grup al qual pertanyen tots els usuaris donats d’alta en el domini, els convidats del domini que conté tots els comptes amb permís de convidat en el domini, etc.
</p>
<div class="iocfigure"><a name="Figure15"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Contenidor 

</figcaption><img src="../media/ic10mu8_18.png" alt="" /></figure>
<div class="footfigure">built-in</div></div>
<p>
Paral·lelament al contenidor d’usuaris present dins del domini que hem creat (<strong>asx.ciclesfp.cat</strong>), també podem destacar el contenidor <strong>built-in</strong>, que conté els grups predefinits en el directori actiu més habituals i comuns. Cal destacar que els objectes grup permeten l’assignació de permisos i altres atributs a múltiples usuaris en una única operació, atès que quan un usuari pertany a un grup disposa de tots els privilegis, permisos i restriccions d’aquest grup (<span class="figref"><a href="#Figure15"><span>figura</span></a></span>).
</p>

<p>
A l’hora de donar d’alta un usuari del domini hem de tenir molt clar que no es tracta d’un usuari d’una màquina local, que, en aquest cas, es defineix en el procés d’instal·lació del sistema operatiu. L’usuari local podrà accedir a la màquina mitjançant el nom d’usuari i la contrasenya, però no podrà accedir als recursos del domini. En canvi, un usuari del domini, sí.
</p>

<p>
Per donar d’alta un usuari, hem de situar-nos sobre la carpeta <strong>usuaris</strong> present dins del domini que hem creat (<strong>asx.ciclesfp.cat</strong>) i polsar el botó dret del ratolí per accedir a un menú secundari que, mitjançant l’opció <strong>nou</strong>, ens permetrà crear un nou usuari del domini (<span class="figref"><a href="#Figure16"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figure16"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Creació d’un nou usuari de domini

</figcaption><img src="../media/ic10mu8_19.png" alt="" /></figure>
</div>
<p>
A mesura que el nombre d’usuaris del nostre domini va creixent, hem de considerar l’aplicació de permisos i restriccions a usuaris a títol individual, atès que, segons el volum d’usuaris, pot ser una feina molt enrevessada -com si fos una empresa, poden canviar els rols que tenien dins del domini, per exemple, passar d’un departament a un altre, o bé, requerir permisos que abans no tenien.
</p>

<p>
És més fàcil moure els usuaris a la categoria o el grup que els correspon que no pas anar-los configurant d’un en un per a cada ocasió que calgui. Val a dir que, tot i que relacionem grups amb usuaris, el concepte va més enllà, atès que podem constituir grups d’equips i, fins i tot, grups de grups.
</p>

<p>
Hi ha dos tipus de grups:
</p>
<ul>
<li class="level1"><div class="li"> <strong>Distribució</strong>: són grups pensats, exclusivament, per a l’enviament de correus electrònics.</div>
</li>
<li class="level1"><div class="li"> <strong>Seguretat</strong>: són grups que permeten assignar permisos i recursos a un conjunt d’usuaris. Els podem utilitzar en les llistes de control d’accés (<acronym title="Access Control List">ACL</acronym>) pròpies dels sistemes Windows (<span class="figref"><a href="#Figure17"><span>figura</span></a></span>).</div>
</li>
</ul>
<div class="iocfigure"><a name="Figure17"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Llistes de control d’accés

</figcaption><img src="../media/ic10mu8_20.png" alt="" /></figure>
</div>
<p>
Respecte a la creació d’un nou grup és important conèixer-ne l’àmbit. Aquest paràmetre és definit per tres conceptes:
</p>
<ol>
<li class="level1"><div class="li"> <strong>La pertinença</strong>: qui pot pertànyer al grup? Poden ser usuaris d’altres dominis, però, únicament, del mateix bosc o d’altres?</div>
</li>
<li class="level1"><div class="li"> <strong>Disponibilitat</strong>: un cop s’ha creat el grup, on es pot utilitzar?</div>
</li>
<li class="level1"><div class="li"> <strong>Replicació</strong>: a on es replica? A tots els controladors de domini del domini? També al catàleg global? (<span class="figref"><a href="#Figure18"><span>figura</span></a></span>).</div>
</li>
</ol>
<div class="iocfigure"><a name="Figure18"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Paràmetres de creació d’un nou grup

</figcaption><img src="../media/ic10mu8_21.png" alt="" /></figure>
</div>
<p>
A partir d’aquests tres conceptes (pertinença, disponibilitat i replicació) sorgeixen tres grups segons l’àmbit.
</p>

<p>
<strong>1. Grups locals de domini</strong>. Dins d’aquest grup trobem:
</p>
<ul>
<li class="level1"><div class="li"> Usuaris i equips de qualsevol domini del bosc, fins i tot, externs de confiança.</div>
</li>
<li class="level2"><div class="li"> Grups globals (G) i universals (U) de qualsevol domini del bosc o extern de confiança.</div>
</li>
<li class="level2"><div class="li"> Grups locals de domini (DL) del seu mateix domini.</div>
</li>
</ul>

<p>
Només podem utilitzar aquest grup en recursos del nostre domini, atès que en la resta no apareixerà com a disponible. Es replica en tots els controladors de domini (DC) del domini.
</p>

<p>
<strong>2. Grup global</strong>. Podem incloure en aquest tipus de grup:
</p>
<ul>
<li class="level1"><div class="li"> Usuaris i equips, únicament, del nostre domini.</div>
</li>
<li class="level2"><div class="li"> Altres grups globals (G), però únicament del nostre domini.</div>
</li>
</ul>

<p>
Podem utilitzar aquest grup en el nostre domini, en altres dominis del bosc i en dominis externs però de confiança. Es replica en tots els controladors de domini (DC) del domini.
</p>
<div class="iocfigure"><a name="Figure19"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Paràmetres de creació d’un nou grup

</figcaption><img src="../media/ic10mu8_22.png" alt="" /></figure>
</div>
<p>
<strong>3. Grup universal</strong>. Podem incloure en aquest tipus de grup:
</p>
<ul>
<li class="level1"><div class="li"> Usuaris i equips de qualsevol domini del bosc.</div>
</li>
<li class="level2"><div class="li"> Grups globals (G) i universals (U) de qualsevol domini del bosc.</div>
</li>
</ul>

<p>
Podem utilitzar aquest grup en el nostre domini i en altres dominis del bosc. Es replica en el catàleg global.
</p>

<p>
Un cop haurem creat el grup, podem afegir-hi usuaris si estan marcats i premem el botó dret del ratolí per accedir a l’opció <strong>Afegir a un grup</strong>; posteriorment, ja podrem triar el grup al qual volem afegir l’usuari (<span class="figref"><a href="#Figure19"><span>figura</span></a></span>).
</p>

</div>

<h3><a id="incorporacio_d_equips_al_domini" >Incorporació d&#039;equips al domini</a></h3>
<div class="level3">

<p>
Un cop hem definit un domini mitjançant el directori actiu, ja podem afegir o incorporar equips. Per fer-ho, hem d’adreçar-nos a l’equip client i, situats sobre la icona de xarxa de la barra de tasques, premem el botó dret del ratolí per accedir al <strong>Centre de xarxes i recursos compartits</strong>. Un cop dins, tal com mostra la <span class="figref"><a href="#Figure20"><span>figura</span></a></span>, premem a <strong>Connexió d’àrea local</strong> per accedir a les propietats de la connexió.
</p>
<div class="iocfigure"><a name="Figure20"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Accés a les propietats de la connexió

</figcaption><img src="../media/ic10mu8_23.png" alt="" /></figure>
</div><div class="iocfigure"><a name="Figure21"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Definició dels paràmetres de connexió

</figcaption><img src="../media/ic10mu8_24.png" alt="" /></figure>
</div>
<p>
Un cop dins de les propietats de la connexió, hem d’adreçar-nos a les propietats del protocol de la versió d’Internet –versió 4 o 6- amb què treballi la nostra màquina. Definim una adreça IP estàtica que es trobi dins de la mateixa subxarxa que la màquina en què estigui instal·lat el domini. Per exemple, si la màquina que té configurat el domini té l’adreça 192.168.1.1, la màquina que en aquest cas volem incorporar al domini, haurà de tenir, per exemple, l’adreça 192.168.1.2.
</p>

<p>
Paral·lelament, com que el controlador de domini (DC) també actua com a servidor de noms de domini (<acronym title="Domain Name System">DNS</acronym>), haurem d’introduir l’adreça IP del controlador de domini (DC) com a adreça de servidor <acronym title="Domain Name System">DNS</acronym> predilecte (<span class="figref"><a href="#Figure21"><span>figura</span></a></span>).
</p>

<p>
Un cop definits els paràmetres, tal com mostra <span class="figref"><a href="#Figure22"><span>figura</span></a></span>, podem confirmar des de la màquina client –la que volem afegir al domini– que hi ha connectivitat amb la màquina que té definit el control de domini.
</p>
<div class="iocfigure"><a name="Figure22"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Comprovació de connectivitat

</figcaption><img src="../media/ic10mu8_25.png" alt="" /></figure>
</div>
<p>
Un cop comprovada la connectivitat amb la màquina que té instal·lat el controlador de domini (DC), ja podem definir el nom de domini al qual ha de pertànyer la nostra màquina. De fet, tal com mostra la <span class="figref"><a href="#Figure23"><span>figura</span></a></span>, hem d’adreçar-nos a <strong>Inici / Ordinador</strong> i, situats al damunt, hem de prémer el botó dret del ratolí i accedir a les <strong>Propietats</strong>.
</p>
<div class="iocfigure"><a name="Figure23"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Accés a les propietats de l’ordinador

</figcaption><img src="../media/ic10mu8_26.png" alt="" /></figure>
</div>
<p>
Després d’accedir a les propietats de l’ordinador, hem de modificar els paràmetres propis de la configuració. Per tant, un cop dins de les propietats del sistema, haurem d’accedir a canviar el domini al qual pertanyerà la màquina que volem incorporar al domini (<span class="figref"><a href="#Figure24"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figure24"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Canvis en la configuració de l’ordinador

</figcaption><img src="../media/ic10mu8_27.png" alt="" /></figure>
</div>
<p>
Tal com mostra la <span class="figref"><a href="#Figure25"><span>figura</span></a></span>, un cop haurem introduït el nom del domini al qual pertanyerà la nostra màquina –en el nostre cas, <strong>asx.ciclesfp.cat</strong>–, se’ns sol·licitarà un nom d’usuari i una contrasenya perquè aquest canvi es faci efectiu. En aquest cas, el nom d’usuari i la contrasenya que hem d’introduir és l’administrador de la màquina on hi ha el controlador de domini. Posteriorment, la màquina sol·licitarà tornar a arrencar el sistema perquè els canvis siguin aplicats.
</p>

<p>

</p>
<div class="iocfigure"><a name="Figure25"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Definició del domini

</figcaption><img src="../media/ic10mu8_28.png" alt="" /></figure>
</div>
<p>
Si ens adrecem a la màquina que té definit el controlador de domini (DC), i accedim a <strong>Inici / Eines administratives / Usuaris i grups del directori actiu</strong> i, després d’accedir al domini, premem sobre l’opció <strong>Ordinadors</strong> i veurem que la màquina ha estat afegida al domini (<span class="figref"><a href="#Figure26"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figure26"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Comprovació de la inclusió de la màquina en el domini

</figcaption><img src="../media/ic10mu8_29.png" alt="" /></figure>
</div>
<p>
Paral·lelament, des de la màquina que acabem d’incorporar al domini, podrem accedir mitjançant l’usuari local de la màquina, o bé, mitjançant un usuari definit des del controlador de domini que, tal com mostra la <span class="figref"><a href="#Figure27"><span>figura</span></a></span>, accedirà al domini <strong>asx.ciclesfp.cat</strong>.
</p>
<div class="iocfigure"><a name="Figure27"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Accés al domini des d’una màquina client

</figcaption><img src="../media/ic10mu8_30.png" alt="" /></figure>
</div>
<p>
Arribats a aquest punt, és important destacar que els sistemes operatius Windows Server 2008 R2 i Windows 7 ofereixen la possibilitat d’afegir o unir la màquina a un domini sense estar connectats amb la màquina que fa de controlador de domini. Aquesta funcionalitat ens permet reduir temps d’implementació i, alhora, agilitzar les tasques per a les màquines que no disposen d’una connexió permanent amb el controlador de domini permanent, com, per exemple, en el cas d’una sucursal amb la seu de l’empresa.
</p>

<p>
En aquest cas, haurem d’accedir al terminal d’ordres de la màquina que treballa com a servidor per executar-hi l’ordre <strong>djoin</strong> (<span class="figref"><a href="#Figure28"><span>figura</span></a></span>). L’ordre <strong>djoin.exe</strong> ens permetrà crear un arxiu (<strong>blob</strong>) que, posteriorment, haurem de traslladar a l’equip que volem unir al domini que està desconnectat (<strong>offline</strong>).
</p>
<div class="iocfigure"><a name="Figure28"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Terminal d’ordres del controlador de domini

</figcaption><img src="../media/ic10mu8_31.png" alt="" /></figure>
</div>
<p>
En el nostre cas afegirem al domini un equip que es troba en funcionament i, alhora, definirem els paràmetres per a les imatges de disc per a posteriors definicions de màquines que s’han d’afegir al domini. Haurem d’executar la línia d’ordres <strong>djoin /PROVISION /DOMAIN asx.ciclesfp.cat /MACHINE ciclesfp /SAVEFILE c:\disk-win7</strong> on <strong>PROVISION</strong> crearà l’objecte d’equip en el directori actiu i <strong>DOMAIN</strong> permetrà especificar el domini al qual volem afegir el nostre equip.
</p>

<p>
Amb l’ordre <strong>MACHINE</strong> podrem especificar el nom de l’equip que volem afegir –en aquest cas, <strong>ciclesfp-PC</strong>– i, amb <strong>SAVEFILE</strong>, especificarem el lloc on emmagatzemarem l’arxiu de resposta. Finalment, guardarem l’arxiu resultant que hem definit que s’emmagatzemi en el directori <strong>c:\disk-win7</strong>, per exemple, en una memòria USB.
</p>

<p>
Des de la màquina client, hem d’adreçar-nos al terminal de instruccionsmitjançant l’execució de l’ordre <strong>cmd</strong> i escrivim la línia d’ordres <strong>djoin /REQUESTODJ /LOADFILE e:\dsk-win7 /WINDOWSPATH %SystemRoot% /LOCALOS</strong> en què <strong>e:\dsk-win7</strong> serà l’enllaç a la memòria USB en què podem haver guardat l’arxiu de configuració obtingut des del controlador de domini.
</p>

<p>
Tal com mostra la <span class="figref"><a href="#Figure29"><span>figura</span></a></span>, un cop haurem executat l’ordre, tornarem a arrencar el nostre equip per certificar que la màquina client s’ha afegit al domini sense tenir contacte amb el controlador de domini.
</p>
<div class="iocfigure"><a name="Figure29"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Domini al qual pertany la màquina

</figcaption><img src="../media/ic10mu8_32.png" alt="" /></figure>
</div>
<p>
Quan la màquina client ja tingui contacte amb el controlador de domini, s’haurà d’arrencar la sessió amb un compte de domini.
</p>

</div>

<h2><a id="recursos_locals" >Recursos locals</a></h2>
<div class="level2">

<p>
Podem accedir als recursos locals sense estar connectats a cap xarxa.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
Els recursos locals són els recursos que estan connectats directament al nostre ordinador.
</p>
</div></div>
<p>
A grans trets, un recurs local pot ser la impressora a la qual està connectat el nostre ordinador, les unitats de disc (<strong>C:</strong>, per exemple), les memòries USB o un disc dur extern. Més endavant, si ho volem, aquests recursos seran accessibles de manera remota, és a dir, estaran en xarxa i, per tant, seran recursos de xarxa.
</p>

</div>

<h2><a id="recursos_de_xarxa" >Recursos de xarxa</a></h2>
<div class="level2">

<p>
La compartició de recursos en xarxa és una de les utilitats o raons principals perquè els sistemes operatius es connectin en xarxa. En l’àmbit dels sistemes operatius, podem entendre el concepte de compartició de recursos des de diversos punts de vista.
</p>

<p>
Des del punt de vista del maquinari, compartir recursos fa referència a l’ús del maquinari per dos o més processos dins del sistema operatiu. Des del punt de vista de les xarxes, la compartició de recursos en xarxa implica configurar la xarxa perquè els ordinadors que hi estan connectats puguin utilitzar els recursos de la resta, fent servir la xarxa com a mitjà de comunicació.
</p>

<p>
Coincidint amb la instal·lació del directori actiu, disposem d’una nova consola d’administració (<strong>Inici / Eines administratives / Administrador d’emmagatzematge i recursos compartits</strong>) que presenta una pestanya anomenada <strong>Volums</strong> on apareixen totes les unitats de disc del sistema i una altra designada <strong>Recursos compartits</strong> on podem veure tots els recursos que es comparteixen en el servidor (<span class="figref"><a href="#Figure30"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figure30"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Consola d’administració d’emmagatzematge i recursos compartits

</figcaption><img src="../media/ic10mu8_33.png" alt="" /></figure>
</div>
<p>
Podem veure que ja tenim recursos creats. Aquests recursos es creen automàticament i els utilitzen els processos del servidor per a l’administració (per tant, no s’han d’eliminar ni canviar de nom). Són:
</p>
<ul>
<li class="level1"><div class="li"> <strong>ADMIN$</strong>: s’utilitza per a l’administració del servidor. És la carpeta del sistema.</div>
</li>
<li class="level1"><div class="li"> <strong>PRINT$</strong>: conté els controladors (<em>drivers</em>) de la impressora per als equips clients (només apareix si el servidor fa funcions de servidor d’impressió).</div>
</li>
<li class="level1"><div class="li"> <strong>IPC$</strong>: s’utilitza per a l’administració remota i per a la visualització dels recursos compartits de l’equip.</div>
</li>
<li class="level1"><div class="li"> <strong>NETLOGON</strong>: s’instal·la en els controladors de domini (DC) i s’utilitza en els inicis de sessió dels usuaris.</div>
</li>
<li class="level1"><div class="li"> <strong>SYSVOL</strong>: emmagatzema la seqüència d’ordre d’inici de sessió.</div>
</li>
</ul>

<p>
A més, tenim compartida la carpeta arrel de cada volum del sistema (<strong>C$</strong>, <strong>E$</strong>, etc.) per a l’administració remota de l’equip. El símbol <strong>$</strong> fa que els recursos que el porten no siguin visibles pels usuaris (només els hauria d’utilitzar el sistema).
</p>

<p>
En la pestanya de recursos, a banda del nom apareix el protocol per accedir al recurs (per defecte, <strong>SMB</strong>) i la carpeta real és la que es comparteix. Des d’aquesta pantalla, podem configurar tot el que està relacionat amb l’emmagatzematge compartit:
</p>
<ul>
<li class="level1"><div class="li"> Crear carpetes o volums compartits.</div>
</li>
<li class="level1"><div class="li"> Deixar de compartir carpetes o volums.</div>
</li>
<li class="level1"><div class="li"> Determinar el protocol que cal utilitzar per accedir a un recurs compartit.</div>
</li>
<li class="level1"><div class="li"> Modificar els permisos NTFS locals del recurs.</div>
</li>
</ul>

<p>
Per crear un nou recurs compartit des del tauler d’accions seleccionem l’opció <strong>Aprovisionar recurs compartit</strong> de la barra dreta de la interfície del programari. Un cop dins, hem de triar la carpeta per compartir (si no existeix, la podem crear), prement el botó <strong>Examinar</strong>. Des del botó d’<strong>Aprovisionar emmagatzematge</strong> podem crear nous volums en l’equip (<span class="figref"><a href="#Figure31"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figure31"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Tria del recurs per compartir

</figcaption><img src="../media/ic10mu8_34.png" alt="" /></figure>
</div>
<p>
A continuació, tenim l’opció de canviar els permisos <strong>NTFS</strong> i, posteriorment, haurem d’indicar com es pot accedir a la carpeta des de la xarxa, això és, o bé, amb el protocol <strong>SMB</strong> (l’estàndard de Windows) o <strong>NFS</strong> (l’estàndard d’Unix). En qualsevol cas, hem d’especificar el nom que tindrà el nou recurs en la xarxa (<span class="figref"><a href="#Figure32"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figure32"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Definició del nom del recurs compartit

</figcaption><img src="../media/ic10mu8_35.png" alt="" /></figure>
</div>
<p>

</p>
<div class="ioctextl"><div class="ioccontent"><p class="ioctitle">El símbol $</p>
<p>
Si el nom de xarxa acaba en $, aquest recurs estarà ocult i no apareixerà en les pantalles d’entorn de xarxa dels clients (és el que passa en algunes carpetes compartides automàticament). Així i tot, un usuari pot accedir a aquesta carpeta escrivint el seu nom (<strong><a href="file://///Nom_del_servidor/Nom_de_la_carpeta" class="windows" title="\Nom_del_servidor\Nom_de_la_carpeta">\Nom_del_servidor\Nom_de_la_carpeta</a></strong>).
</p>
</div></div>
<p>
Arribats a aquest punt, haurem de configurar el protocol <strong>SMB</strong>; en la primera pantalla, introduïm una descripció i establim el límit en el nombre d’usuaris que es puguin connectar simultàniament (<span class="figref"><a href="#Figure33"><span>figura</span></a></span>). Posteriorment, haurem de definir els permisos.
</p>
<div class="iocfigure"><a name="Figure33"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Definició del mode d’accés al recurs compartit

</figcaption><img src="../media/ic10mu8_36.png" alt="" /></figure>
</div>
<p>
A continuació, el programari ens permetrà definir aplicar filtres d’arxiu i ens oferirà publicar el nou recurs en un espai de noms DFS (és recomanable que no). Finalment, apareixerà un resum del nou recurs per crear (<span class="figref"><a href="#Figure34"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figure34"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Resum del nou recurs

</figcaption><img src="../media/ic10mu8_37.png" alt="" /></figure>
</div>
<p>
Un cop definit el recurs per compartir, ja podem, per exemple, publicar una carpeta compartida en el directori actiu perquè aparegui conjuntament amb la resta d’objectes del domini. Per fer-ho, tal com mostra la <span class="figref"><a href="#Figure35"><span>figura</span></a></span>, tenint marcada la unitat organitzativa en la qual volem crear la carpeta compartida, premem el botó dret del ratolí i accedirem a <strong>Nou / Carpeta compartida</strong>.
</p>
<div class="iocfigure"><a name="Figure35"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Publicar un recurs compartit

</figcaption><img src="../media/ic10mu8_38.png" alt="" /></figure>
</div>
<p>
L’avantatge d’això és que els clients no necessiten conèixer en quin servidor es troba la carpeta, ja que poden buscar-la en l’AD.
</p>

<p>
Una altra modalitat per compartir un recurs -per exemple, una carpeta- és des del menú contextual (amb la carpeta marcada, per exemple, prémer el botó dret del ratolí) i seleccionant <strong>Propietats</strong> i anant a la pestanya <strong>Compartir</strong> (<span class="figref"><a href="#Figure36"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figure36"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Compartir una carpeta

</figcaption><img src="../media/ic10mu8_39.png" alt="" /></figure>
</div>
<p>
Un cop hem creat el recurs, els clients amb els permisos adients es podran connectar a la carpeta compartida. En aquest cas, haurem d’adreçar-nos a <strong>Inici / Equip</strong> i, un cop dins, ens adrecem a l’opció <strong>Xarxa</strong> situada en la zona esquerra de la interfície. A partir d’aquí, podrem començar a definir la cerca i l’accés als recursos compartits (<span class="figref"><a href="#Figure37"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figure37"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Accés a la compartició de directoris

</figcaption><img src="../media/ic10mu8_40.png" alt="" /></figure>
</div>
<p>
Una altra opció és escriure el nom del recurs (<strong>\nom del servidor\nom del recurs</strong>) o l’adreça IP de l’ordinador que comparteix el directori en la casella <strong>Executar</strong> del botó <strong>Inici</strong>.
</p>

</div>

<h2><a id="samba" >Samba</a></h2>
<div class="level2">

<p>
Es tracta d’un paquet de programari que implementa en sistemes basats en Unix, com GNU/Linux, una dotzena de serveis i una dotzena de protocols, entre els quals hi ha el NetBIOS sobre TCP/IP i l’SMB. Aquests serveis i protocols permeten que els equips d’una xarxa local comparteixin fitxers i impressores.
</p>
<div class="ioctextl"><div class="ioccontent"><p class="ioctitle">Samba</p>
<p>
Inicialment el Samba s’anomenava <strong>smbserver</strong>, però li van haver de canviar el nom a causa de problemes amb una altra empresa que tenia aquesta marca registrada. Per obtenir el nom nou van buscar una paraula al diccionari de GNU/Linux que contingués les lletres SMB. El resultat escollit fou la paraula samba.
</p>
</div></div>
<p>
El NetBIOS (<em>Network Basic Input/Output System</em>) és un protocol del nivell de sessió del model de referència d’Interconnexió de Sistemes Oberts (OSI, <em>Open Systems Interconnection</em>) que s’utilitza en xarxes locals i que s’encarrega de garantir l’accés a serveis de xarxa entre màquines, independentment del maquinari de xarxa que facin servir.
</p>

<p>
Principalment, el NetBIOS s’utilitza per identificar amb un nom els equips connectats per mitjà de xarxes locals, amb la finalitat d’establir una sessió i mantenir la connexió entre equips de la xarxa. El NetBIOS no pot transportar per si mateix les dades entre els nodes de la XAL. És per aquest motiu que  ha de funcionar amb altres protocols com, per exemple, el TCP/IP, l’IPC/IPX i el NetBEUI.
</p>

<p>
El NetBIOS ha de ser transportat per altres protocols perquè, en operar en la capa 5 del model OSI, no proveeix un format de dades per a la transmissió. Aquest format, doncs, el proveeixen aquests altres protocols. El NetBIOS permet comunicació orientada a connexió (TCP, <em>Transmission Control Protocol</em>) i no orientada a connexió (UDP, <em>User Datagram Protocol</em>). A més, Suporta tant la difusió (<em>broadcast</em>) com la transmissió a grups (multicast), a més de quatre tipus de serveis diferents:
</p>
<ul>
<li class="level1"><div class="li"> Serveis generals</div>
</li>
<li class="level1"><div class="li"> Servei de noms</div>
</li>
<li class="level1"><div class="li"> Servei de sessió</div>
</li>
<li class="level1"><div class="li"> Servei de datagrames</div>
</li>
</ul>

<p>
Quan un programa d’aplicació necessita els serveis NetBIOS executa una interrupció de programari específica. Aquesta interrupció adreça el control del microprocessador al programari de l’adaptador de xarxa, el qual processa l’ordre. Quan un programa d’aplicació emet una interrupció NetBIOS, el servei NetBIOS requereix un servei de xarxa. La interfície NetBIOS defineix exactament el mode en que els programes d’aplicació poden utilitzar la interrupció NetBIOS i els serveis que proporciona.
</p>

</div>

<h3><a id="protocol_smb" >Protocol SMB</a></h3>
<div class="level3">

<p>
El protocol SMB (<em>Server Message Block</em>) el va inventar originalment IBM, però avui dia la versió més comuna és la que Microsoft ha modificat àmpliament. L’any 1998, Microsoft va reanomenar aquest protocol CIFS (<em>Common Internet File System</em>) i hi va afegir més característiques.
</p>

<p>
L’SMB és un protocol del nivell d’aplicació de tipus client - servidor en el que l’ordinador que fa de servidor ofereix recursos (arxius, impressores, etc.) que els ordinadors clients poden utilitzar remotament mitjançant la xarxa.
</p>

<p>
L’SMB forma part dels protocols anomenats petició - resposta, ja que les comunicacions sempre s’inicien des del client com una petició de servei al servidor. El servidor la processa i torna una resposta a aquest client. La resposta del servidor pot ser positiva o negativa, en funció del tipus de petició, la disponibilitat del recurs, els permisos del client, etc.
</p>

<p>
El protocol SMB incorpora dos nivells de seguretat que Són els següents:
</p>
<ul>
<li class="level1"><div class="li"> <strong>Share-level</strong>: Protecció en el recurs compartit. S’assigna una contra-senya a cada recurs compartit. L’accés a cada recurs es permet en funció del coneixement d’aquesta contrasenya. Va ser el primer sistema de seguretat utilitzat amb l’SMB (propi del Windows 3.11/95).</div>
</li>
<li class="level1"><div class="li"> <strong>User-level</strong>: La protecció s’aplica a cada recurs compartit i es basa en drets d’accés de l’usuari. Els usuaris s’han d’autenticar en el servidor. Un cop identificat el client, se li assigna un UID que s’utilitza en els subsegüents accessos al servidor (propi dels dominis Windows NT o 2000).</div>
</li>
</ul>

<p>
El protocol SMB s’implementa habitualment amb el NetBIOS sobre el TCP/IP. Aquesta alternativa s’ha convertit en l’estàndard de fet per compartir recursos entre sistemes Windows.
</p>

</div>

<h3><a id="caracteristiques_del_samba" >Característiques del Samba</a></h3>
<div class="level3">

<p>
El Samba és una implementació lliure del protocol SMB amb les extensions de Microsoft.
</p>

<p>
Essencialment, el Samba el constitueixen dos dimonis anomenats <strong>smbd</strong> i <strong>nmbd</strong>. També utilitza el protocol <strong>windbindd</strong>, encara que no és essencial per al funcionament de l’aplicació. A més, Els dimonis utilitzen el protocol NetBIOS per accedir a la xarxa, de manera que poden conversar amb ordinadors Windows.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Daemon (dimoni)</p>
<p>
Un procés dimoni és un procés que s’executa de forma permanent i en segon pla; el seu codi es repeteix fins a l’infinit per esperar i estar a punt quan un usuari sol·licita el servei al qual està vinculat.
</p>
</div></div>
<p>
El dimoni <strong>smbd</strong> s’encarrega d’oferir els serveis d’accés remot a fitxers i impressores (per fer-ho, implementa el protocol SMB), a més d’autenticar i autoritzar usuaris. El dimoni <strong>smbd</strong> ofereix les dues maneres de compartició de recursos del Windows, això és, compartició basada en usuaris (<strong>user-level</strong>) o compartició basada en recursos (<strong>share-level</strong>).
</p>

<p>
El dimoni <strong>nmbd</strong> permet que el sistema GNU/Linux participi en els mecanismes de resolució de noms propis del Windows, la qual cosa inclou el següent:
</p>
<ul>
<li class="level1"><div class="li"> L’anunci en el grup de treball.</div>
</li>
<li class="level1"><div class="li"> La gestió de la llista d’ordinadors del grup de treball.</div>
</li>
<li class="level1"><div class="li"> La contestació a peticions de resolució de noms.</div>
</li>
<li class="level1"><div class="li"> L’anunci dels recursos compartits.</div>
</li>
</ul>

<p>
D’aquesta manera, els sistemes GNU/Linux poden aparèixer en l’<strong>Entorn de xarxa</strong> de les màquines Windows, com qualsevol altre sistema Windows, i publicar la llista de recursos que ofereix a la resta de la xarxa.
</p>

<p>
El dimoni <strong>windbindd</strong> proporciona el servei <strong>windbind</strong>, el qual resol els problemes d’inici de sessió unificats. El servei <strong>windbind</strong> és utilitzat per resoldre informació d’usuaris i grups corresponent a un servidor Windows NT. El winbind proporciona tres funcions separades:
</p>
<ul>
<li class="level1"><div class="li"> Autenticació d’usuaris (via PAM).</div>
</li>
<li class="level1"><div class="li"> Resolució d’identitat (via NSS).</div>
</li>
<li class="level1"><div class="li"> Manteniment d’una base de dades anomenada winbind_idmap.tdb, en la qual emmagatzema les associacions entre usuaris UNIX UID/GID i NT SID. Aquesta associació només s’utilitza per a usuaris i grups que no tenen UID/GID locals.</div>
</li>
</ul>

<p>
El funcionament en conjunt d’aquests serveis permet transferir fitxers i informació entre sistemes GNU/Linux i Windows, els quals donen suport als protocols SMB/CIFS.
</p>

<p>
Gràcies al Samba, en una xarxa hi pot haver equips amb Windows i equips amb GNU/Linux de manera que puguin intercanviar informació en carpetes compartides i compartir impressores, tal com es faria si tots els equips fossin Windows o GNU/Linux.
</p>

<p>
L’avantatge principal del paquet de programari Samba és que és pràcticament equivalent a qualsevol servidor SMB/CIFS (Windows NT o 2000, servidor Netware, servidor NFS de UNIX, etc.) i, a més, és programari lliure i gratuït.
</p>

</div>

<h2><a id="seguretat_en_el_samba" >Seguretat en el Samba</a></h2>
<div class="level2">

<p>
Abans d’iniciar el procés d’instal·lació i configuració del servidor i del client Samba, analitzarem els mecanismes de seguretat que ens proporciona el paquet de programari.
</p>

<p>
El Samba, a més dels nivells de seguretat que proporciona el protocol SMB (<strong>share</strong> i <strong>user</strong>), incorpora tres subnivells de seguretat en el nivell d’usuari. Així, en total podem utilitzar els nivells de seguretat següents:
</p>
<ul>
<li class="level1"><div class="li"> <strong>share</strong>: cada recurs compartit utilitza una paraula de pas. Tothom que sàpiga aquesta paraula de pas pot accedir al recurs.</div>
</li>
<li class="level1"><div class="li"> <strong>user</strong>: cada recurs compartit del grup de treball està configurat per permetre l’accés a un grup específic d’usuaris. En cada connexió inicial a un servidor Samba autentica l’usuari.</div>
</li>
<li class="level1"><div class="li"> <strong>server</strong>: el sistema és idèntic a l’anterior, però s’utilitza un altre servidor per obtenir la informació dels usuaris.</div>
</li>
<li class="level1"><div class="li"> <strong>domain</strong>: el Samba es converteix en membre d’un domini del Windows NT i utilitza un Controlador de domini primari (PDC, <em>Primary Domain Controller</em>) o un Controlador de còpies de seguretat del domini (BDC, <em>Backup Domain Controller</em>) per implementar l’autenticació. Un cop autenticat l’usuari manté un testimoni (o <strong>tokenamb</strong>), la informació de l’usuari, a partir de la qual es podrà determinar a quins recursos té accés.</div>
</li>
<li class="level1"><div class="li"> <strong>ADS</strong>: el Samba es comporta com a membre d’un domini de directori actiu i, per tant, requereix un servidor W2000 Server o W2003 Server.</div>
</li>
</ul>

</div>

<h3><a id="share-level_security" >Share-level security</a></h3>
<div class="level3">

<p>
En el nivell de seguretat <strong>share</strong>, el client s’autentica de manera separada per cadascun dels recurs als que vol accedir. El funcionament d’aquest nivell de seguretat determina que cada recurs compartit tingui associat una paraula de pas amb independència de l’usuari que es connecti. Val a dir que, tot i que els sistemes Windows associen la contrasenya a un recurs, el Samba utilitza l’esquema d’autenticació de GNU/Linux, en el que la parella a autenticar és <strong>usuari</strong> – <strong>contrasenya</strong> i no pas <strong>recurs</strong> – <strong>contrasenya</strong>. El client envia una paraula de pas cada cop que vol accedir a un recurs, però no envia cap usuari.
</p>

<p>
Per altra banda, els sistemes GNU/Linux, no obstant això, sempre han d’utilitzar un usuari per autenticar-se. Així, doncs, quin usuari s’envia per fer la connexió? Depèn dels paràmetres especificats en la configuració global del servidor, de manera que hi ha diverses possibilitats. Per exemple:
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Guest only i guest account</p>
<p>
Són paràmetres presents en l’arxiu de configuració relacionats amb els paràmetres de seguretat mitjançant el Samba.
</p>
</div></div><ul>
<li class="level1"><div class="li"> Si s’utilitza el paràmetre <strong>guest only</strong> en la configuració del recurs compartit al Samba, aleshores només es utilitza l’usuari convidat especificat amb el paràmetre <strong>guest account</strong> -per defecte, <strong>nobody</strong>.</div>
</li>
<li class="level1"><div class="li"> Els sistemes Windows moderns i el Samba envien com a usuari per defecte l’usuari que està utilitzant, en el moment d’accedir al recurs -la màquina client.</div>
</li>
<li class="level1"><div class="li"> També es poden enviar a altres usuaris, com un inici de sessió previ, el nom del recurs al qual es vol accedir, el nom NetBIOS del client o els usuaris del paràmetre <strong>user list</strong>, depenent de les diferents configuracions.</div>
</li>
</ul>

<p>
Per tant, en iniciar una sessió, els clients passen un usuari al servidor (sense contrasenya). El Samba emmagatzema aquest usuari en una llista de possibles usuaris. Quan el client especifica una contrasenya i accedeix a un recurs concret, el Samba apunta el nom del recurs juntament amb els usuaris vàlids que apareguin en l’arxiu de configuració <strong>/etc/samba/smb.conf</strong> en la llista anterior. Seguidament, es comprova la paraula de pas de cadascun dels possibles usuaris. Si hi ha coincidència, aleshores s’autentica amb aquest usuari.
</p>

<p>
Quan aquesta llista no està disponible, aleshores el Samba envia una petició al sistema GNU/Linux per trobar l’usuari a qui correspon la contrasenya. Això es fa mitjançant el commutador de noms de servei (NSS, <em>Name Service Switch</em>) i la configuració de l’arxiu <strong>/etc/nsswitch.conf</strong>.
</p>

</div>

<h3><a id="user-level_security" >User-level security</a></h3>
<div class="level3">

<p>
L’opció <strong>user</strong> és l’opció per defecte i també és la més senzilla. El client s’identifica en el nivell de sessió amb un usuari i una paraula de pas. El servidor pot acceptar o denegar la sessió, però, necessàriament, no ha de conèixer a quins recursos vol accedir el client. En aquest nivell, doncs, per controlar l’accés als recursos el servidor només es pot basar en els elements següents:
</p>
<ul>
<li class="level1"><div class="li"> L’usuari i la paraula de pas.</div>
</li>
<li class="level1"><div class="li"> El nom de la màquina client.</div>
</li>
</ul>

<p>
Si s’accepta la sessió, el client pot accedir als recursos remots sense haver de tornar a especificar la paraula de pas. En aquest mètode és imprescindible que els usuaris apareguin com a usuaris de GNU/Linux i del Samba. Aquest mètode de seguretat no és gaire recomanable si es volen compartir recursos de xarxa de manera anònima. De totes maneres, hi ha la possibilitat de generar un mode híbrid entre els nivells <strong>user</strong> i <strong>share</strong> mitjançant el paràmetre <strong>map to guest</strong> de les opcions globals de l’arxiu <strong>/etc/samba/smb.conf</strong>. Aquest paràmetre pot tenir diversos valors i, per tant, el servidor també pot tenir diversos comportaments.
</p>

<p>
Així, si establim un valor com <strong>Bad User</strong>, estem configurant un mètode en el qual, si la contrasenya de l’usuari falla, se’l rebutjarà, però si l’usuari no existeix, passarà automàticament a ser un usuari convidat, és a dir, s’activarà com a usuari <strong>guest</strong>.
</p>

</div>

<h3><a id="domain_security_mode_user-level_security" >Domain security mode (user-level security)</a></h3>
<div class="level3">

<p>
En el cas domain, la base de dades d’usuaris està centralitzada en un controlador de domini i tots els membres d’un domini la comparteixen. Un servidor controlador primari de domini (PDC, <em>Primary Domain Controller</em>) és el responsable de mantenir la integritat de la base de dades de comptes de seguretat. Els controladors de còpies de seguretat de domini (BDC, <em>Backup Domain Controllers</em>) només proveeixen serveis d’autenticació i inici de sessió o <strong>logon</strong>.
</p>

<p>
Aleshores, amb aquest sistema de seguretat el servidor Samba és converteix en un servidor membre del domini, controlador primari de domini (PDC) o no. Per aquesta raó, totes les màquines que participen en el domini han de tenir un compte de màquina en la base de dades de seguretat.
</p>

<p>
El nivell de seguretat de domini utilitza un sistema de seguretat basat en l’usuari (<em>user-level security</em>), en el qual, fins i tot, les màquines s’han de validar en l’arrencada del sistema. El compte de màquina és un compte d’usuari més del Samba. L’única diferència que hi ha respecte al compte d’usuari és que el de màquina acaba en <strong>$</strong>. D’aquesta manera, el nom del compte serà <strong>NETBIOS_NAME$</strong>.
</p>

<p>
La contrasenya es genera de manera aleatòria i només la coneixen els controladors de domini i la màquina membre. Si la màquina no es pot validar en iniciar el sistema, els usuaris no podran entrar al domini mitjançant aquesta màquina, ja que es considerarà que no és de confiança (<em>not trusted machine</em>).
</p>

<p>
Hi ha tres configuracions possibles de membres de domini:
</p>
<ul>
<li class="level1"><div class="li"> Controlador primary de control (PDC, <em>Primary domain controller</em>).</div>
</li>
<li class="level1"><div class="li"> Controlador de còpies de seguretat de domini (BDC, <em>Backup domain controller</em>).</div>
</li>
<li class="level1"><div class="li"> Servidor de membres del domini (<em>Domain member server</em>).</div>
</li>
</ul>

</div>

<h3><a id="ads_security_mode_user-level_security" >ADS security mode (user-level security)</a></h3>
<div class="level3">

<p>
Les màquines amb una versió del Samba posterior a la 2.2 es poden unir a un domini de directori actiu. Això és possible si el servidor funciona en mode natiu, ja que el directori actiu en aquest mode accepta perfectament membres de domini de l’estil NT4.
</p>

<p>
A partir de la versió 3 del Samba, a més, el servidor Samba es pot afegir com a membre natiu de directori actiu. Això pot ser útil si hi ha una política de seguretat que prohibeix els protocols d’autenticació d’NT.
</p>

</div>

<h3><a id="server_security_user-level_security" >Server security (user-level security)</a></h3>
<div class="level3">

<p>
Aquest mode es manté per compatibilitat i existeix perquè abans era el mode que s’utilitzava quan el Samba no podia actuar com un PDC. No és gens recomanable utilitzar aquesta opció perquè té moltes deficiències.
</p>

</div>

<h3><a id="opcions_de_seguretat_en_l_apartat_globals_de_l_arxiu_de_configuracio" >Opcions de seguretat en l&#039;apartat GLOBALS de l’arxiu de configuració</a></h3>
<div class="level3">

<p>
En l’arxiu de configuració del Samba <strong>/etc/samba/smb.conf</strong> es poden especificar una gran quantitat de paràmetres per garantir tant la seguretat d’accés al servidor com la seguretat d’accés als recursos compartits. Aquests paràmetres es mostren en les seccions <strong>GLOBALS</strong> i <strong>SHARES</strong> de l’eina gràfica <strong>Swat</strong>. En la <span class="figref"><a href="#Figure38"><span>figura</span></a></span> es mostra un exemple de les diverses opcions de seguretat amb l’aplicació <strong>Swat</strong>.
</p>
<div class="iocfigure"><a name="Figure38"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Opcions de seguretat de Samba

</figcaption><img src="../media/ic10mu8_43.png" alt="" /></figure>
</div>
</div>

<h2><a id="instal_lacio_del_servidor_i_del_client_samba" >Instal·lació del servidor i del client Samba</a></h2>
<div class="level2">

<p>
Si utilitzem l’ordre <strong>apt-cache search samba</strong> trobarem tots els paquets que conté el <strong>Samba</strong>. El paquet de programari <strong>Samba</strong> es compon de moltes aplicacions i molts paquets amb diverses finalitats. Els paquets més utilitzats són els següents:
</p>
<ul>
<li class="level1"><div class="li"> <strong>samba</strong>: Servidor d’arxius i impressores de xarxa local per a Unix/GNU/Linux.</div>
</li>
<li class="level1"><div class="li"> <strong>smbclient</strong>: Client simple de xarxa local per a Unix/GNU/Linux.</div>
</li>
<li class="level1"><div class="li"> <strong>samba-common</strong>: Arxius comuns del Samba que utilitzen els clients i els servidors.</div>
</li>
<li class="level1"><div class="li"> <strong>swat</strong>: Eina d’administració del Samba via web.</div>
</li>
<li class="level1"><div class="li"> <strong>samba-doc</strong>: Documentació del Samba.</div>
</li>
<li class="level1"><div class="li"> <strong>smbfs</strong>: Ordres per muntar i desmuntar unitats de xarxa Samba.</div>
</li>
<li class="level1"><div class="li"> <strong>winbind</strong>: Servei per resoldre informació d’usuaris i grups de servidors Windows.</div>
</li>
</ul>

<p>
Tots aquests paquets es poden trobar en els dipòsits de l’Ubuntu. Per instal·lar el servei i el client Samba a l’Ubuntu hi ha dues possibilitats. Per un costat podem fer-ho de la manera tradicional, és a dir, utilitzar els gestors de paquets del sistema directament. Utilitzarem l’ordre següent:
</p>
<pre class="code">$sudo apt-get install samba smbclient smbfs</pre>

<p>
La segona possibilitat consisteix a utilitzar l’entorn gràfic. Només cal que cliquem, amb el botó dret, al damunt d’una carpeta del nostre equip que vulguem compartir. Seleccionarem l’opció <strong>Opcions de compartició del menú contextual</strong> i, a continuació, s’obrirà un quadre de diàleg del que marcarem la casella <strong>Comparteix aquesta carpeta</strong> i premerem el botó <strong>Crear compartició</strong> (com es mostra a la <span class="figref"><a href="#Figure39"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figure39"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Quadre de compartició de directoris de Gnome

</figcaption><img src="../media/ic10mu8_44.png" alt="" /></figure>
</div>
<p>
Automàticament, la primera vegada que fem aquesta acció, ens dirà que ha d’instal·lar el servei <strong>Samba</strong>. Si acceptem i introduïm la contrasenya de <strong>superusuari</strong>, ens preguntarà si deixem que el <strong>Nautilus</strong> afegeixi els permisos necessaris per poder compartir la carpeta. Si diem que sí, començarà la instal·lació dels paquets <strong>samba</strong>, <strong>smbclient</strong> i <strong>samba-common</strong>, entre d’altres. Per tant, aquesta possibilitat d’instal·lació ens instal·la, a més d’altres eines, el servidor i el client Samba conjuntament. Això ens permet compartir els nostres recursos i accedir als recursos compartits d’altres màquines.
</p>

<p>
Durant el procés d’instal·lació del Samba, una de les accions que es fa mitjançant la compartició de carpetes és crear un grup d’usuaris anomenat <strong>sambashare</strong>. L’usuari que fa la instal·lació s’afegeix a aquest grup, al qual també han de pertànyer tots els usuaris del sistema que vulguin compartir recursos. L’ús d’aquest mecanisme d’instal·lació ens permet, a més, seleccionar algunes opcions de configuració del recurs a compartir. 
</p>

<p>
Aquestes opcions ens permeten especificar si els usuaris que accedeixen al directori poden escriure (crear elements a dins) o no i si es permet l’accés a usuaris convidats, sense cap compte d’usuari <strong>Samba</strong>. Així, aquest serà el mètode que utilitzarem per compartir carpetes fàcilment mitjançant l’entorn gràfic.
</p>

<p>
Una vegada instal·lats els paquets relacionats amb el Samba mitjançant alguna de les possibilitats anteriors, podem consultar les ordres o les aplicacions que s’instal·len en el sistema amb l’ordre següent:
</p>
<pre class="code">dpkg -L samba | grep bin
dpkg -L smbclient | grep bin
dpkg -L smbfs | grep bin</pre>

<p>
Després d’instal·lar el paquet Samba, el servei <strong>Samba</strong> arrenca automàticament. Per comprovar-ho, podem consultar amb l’ordre <strong>nmap</strong> si l’equip escolta els ports que utilitza el Samba.
</p>
<pre class="code">sudo nmap localhost</pre>

<p>
Per defecte, el servidor Samba utilitza els ports 139 i 445.
</p>

<p>
Per aturar el servidor, utilitzarem l’ordre següent:
</p>
<pre class="code">/etc/init.d/samba stop/</pre>

<p>
I per tornar—lo a arrencar,
</p>
<pre class="code">/etc/init.d/samba restart/</pre>

<p>
Aquestes ordres reiniciaran els dimonis <strong>nmbd</strong>, <strong>smbd</strong> i <strong>windbindd</strong>, necessaris pel funcionament del servei <strong>Samba</strong>. Haurem de tornar a arrencar el servei cada vegada que vulguem que algun canvi de configuració es faci efectiu.
</p>

<p>
Per altra banda, podem configurar l’arrencada automàtica del servei <strong>Samba</strong> quan iniciem el sistema amb l’ordre següent:
</p>
<pre class="code">sudo update-rc.d samba defaults</pre>

<p>
Abans de veure el procés de configuració del servidor Samba, observarem com gestiona els usuaris, els grups i els permisos.
</p>

</div>

<h2><a id="gestio_d_usuaris_grups_i_permisos_del_samba" >Gestió d&#039;usuaris, grups i permisos del Samba</a></h2>
<div class="level2">

<p>
El Samba és un servei que requereix l’administració dels usuaris per poderne gestionar els permisos. En funció de l’usuari que hi accedeixi, el Samba es comportarà d’una manera o d’una altra. Quan hi accedeix un usuari normal, generalment, té uns permisos limitats. En canvi, quan hi accedeix un usuari administrador, ha de disposar de tots els permisos.
</p>

<p>
Per tal que aquesta administració sigui possible, el Samba disposa de la seva pròpia base de dades d’usuaris Samba. No obstant això, com que els usuaris utilitzen altres recursos del servidor, com carpetes i impressores, cal que aquests usuaris també estiguin creats en el sistema GNU/Linux.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Per poder ser usuari del Samba, cal disposar d’un compte d’usuari a GNU/Linux i d’un compte d’usuari al Samba.
</p>
</div></div>
</div>

<h3><a id="gestio_d_usuaris_samba" >Gestió d&#039;usuaris Samba</a></h3>
<div class="level3">

<p>
La gestió d’usuaris Samba es fa amb l’ordre smbpasswd. Amb aquesta ordre podem crear i eliminar usuaris, canviar-ne la contrasenya i unes quantes coses més. Vegem-ne les diferents possibilitats.
</p>

<p>
<strong>1. Creació d’usuaris Samba</strong>. Per crear un usuari Samba hem d’utilitzar l’ordre <strong>smbpasswd</strong>. Abans de crear un usuari, aquest ha d’existir en el sis-tema GNU/Linux. Per exemple, suposem que volem que l’usuari <strong>lluís</strong> gaudeixi dels serveis del Samba. En primer lloc, haurem de crear l’usuari a l’Ubuntu amb l’ordre següent:
</p>
<pre class="code">sudo adduser lluis</pre>

<p>
Després, per habilitar-lo al Samba, executarem aquesta ordre:
</p>
<pre class="code">sudo smbpasswd –a lluis</pre>

<p>
L’opció <strong>-a</strong> serveix per indicar al Samba que ha d’afegir l’usuari a la llista d’usuaris Samba. Tot seguit, se’ns demanarà, per dues vegades, la contrasenya que volem establir a l’usuari. El més raonable és que aquesta contrasenya sigui la mateixa que l’usuari té a GNU/Linux.
</p>

<p>
<strong>2. Eliminació d’usuaris Samba</strong>. Per eliminar usuaris Samba també hem d’utilitzar l’ordre <strong>smbpas-swd</strong>. Aquesta vegada, però, l’opció és <strong>–x</strong>. Per exemple, per eliminar l’usuari <strong>lluís</strong>, executarem aquesta ordre:
</p>
<pre class="code">sudo smbpasswd -x lluis</pre>

<p>
Si bé l’usuari desapareixerà immediatament de la base de dades d’usuaris Samba, continuarà essent un usuari de GNU/Linux.
</p>

<p>
<strong>3. Altres opcions de smbpasswd</strong>. L’ordre <strong>smbpasswd</strong> disposa d’altres opcions que considerem interessants. Són les següents:
</p>
<ul>
<li class="level1"><div class="li"> <strong>-d</strong>: Deshabilitar un usuari.</div>
</li>
<li class="level1"><div class="li"> <strong>-i</strong>: Habilitar un usuari.</div>
</li>
<li class="level1"><div class="li"> <strong>-n</strong>: Establir un usuari sense contrasenya (Necessita el paràmetre <strong>null passwords = yes</strong> en la secció <strong>GLOBAL</strong> de l’arxiu de configuració del Samba).</div>
</li>
<li class="level1"><div class="li"> <strong>-m</strong>: Indicar que és un compte de màquina.</div>
</li>
</ul>

<p>
Per més informació, es pot consultar la pàgina del manual del <strong>smbpasswd</strong> amb l’ordre <strong>man smbpasswd</strong>.
</p>

<p>
Abans de veure el mode com el Samba gestiona els permisos d’usuaris i grups, cal tenir clar la diferència que hi ha entre permís i dret en els sistemes operatius.
</p>

</div>

<h3><a id="permisos_i_drets_samba" >Permisos i drets Samba</a></h3>
<div class="level3">

<p>
Després d’identificar cada usuari amb accés al servei Samba, es poden especificar els permisos i els drets que té a la xarxa. L’administrador s’encarrega de determinar l’ús de cada recurs de la xarxa o les operacions que cada usuari pot dur a terme en cada estació de treball. Per exemple, un usuari pot tenir el dret a accedir a un servidor per mitjà de la xarxa, a forçar l’apagada o el reinici d’un equip remotament, a canviar el sistema d’arrencada, etc. Alhora, cada recurs, servei o utilitat té una informació associada que li indica qui pot utilitzar-lo o executar-lo i qui no. 
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Un <strong>dret</strong> autoritza un usuari o grup d’usuaris a fer determinades operacions sobre un servidor o una estació de treball. Els drets fan referència a operacions pròpies del sistema operatiu com, per exemple, el dret a fer còpies de seguretat o a canviar l’hora del sistema.
</p>

<p>
Un <strong>permís</strong> o privilegi és una marca associada a cada recurs de xarxa (arxius, directoris, impressores, etc.) que regula quins usuaris i en quin mode hi tenen accés. els permisos fan referència a l’accés als diferents objectes de xarxa com, per exemple, el permís de llegir un arxiu concret.
</p>
</div></div>
<p>
Cada recurs té associat un grup de marques (<strong>bits</strong>) que determina els permisos que té cada usuari en funció del grup al que pertanyi o de si és el propietari o no del recurs.
</p>

<p>
Cal destacar, a més, que els drets els determinen les accions que cada usuari pot desenvolupar en el sistema. Per exemple, si pertany al grup <strong>root</strong> o al grup <strong>sudo</strong>. De fet, els drets prevalen sobre els permisos. Per exemple, un operador de consola pot tenir dret a fer una còpia de seguretat de tot un disc, però és possible que no pugui accedir a determinats directoris d’usuaris per no disposar de permisos per fer-ho. En conseqüència, podrà fer la còpia de seguretat perquè el dret de còpia de seguretat preval sobre la restricció dels permisos però no podrà llegir la informació que hi ha en els directoris per no tenir els permisos corresponents.
</p>

<p>
L’assignació de permisos en una xarxa es fa en dues fases:
</p>
<ul>
<li class="level1"><div class="li"> <strong>En primer lloc</strong>, es determina el dret d’accés sobre el servei de xarxa. Per exemple, es pot assignar el dret a connectar-se al servidor Samba. Això evita que es puguin obrir unitats remotes de xarxa sobre les quals després no es tingui privilegis d’accés als fitxers que conté, cosa que podria sobrecarregar el servidor.</div>
</li>
<li class="level1"><div class="li"> <strong>En segon lloc</strong>, s’han de configurar els permisos dels fitxers i els directoris que conté aquest servei de xarxa. Depenent del sistema operatiu de xarxa, les marques associades als recursos varien encara que, en general, hi ha les de lectura, escriptura, execució, esborrament, etc. En les xarxes en que coexisteixen sistemes operatius de xarxa de diferents fabricants, cal determinar els permisos per cada sistema.</div>
</li>
</ul>

</div>

<h3><a id="gestio_de_grups_i_permisos" >Gestió de grups i permisos</a></h3>
<div class="level3">

<p>
La gestió de grups, usuaris i permisos és diferent en sistemes GNU/Linux i en sistemes Microsoft Windows. En els sistemes GNU/Linux, la gestió dels permisos que els usuaris i els grups tenen sobre els arxius es fa mitjançant un esquema senzill de tres tipus de permisos (lectura, escriptura i execució) aplicables a tres tipus d’usuaris (propietari, grup propietari i resta d’usuaris).
</p>

<p>
Aquest esquema es va desenvolupar als anys 70 i avui encara és adequat per a la gran majoria dels sistemes en xarxa que hi ha en qualsevol tipus d’organització, tant si es tracta de xarxes petites com de xarxes grans. És cert que té algunes limitacions, però té l’avantatge de ser senzill. Això fa que sigui fàcil d’administrar i que el rendiment sigui molt elevat.
</p>

<p>
En els sistemes Windows, la gestió dels permisos que els usuaris i els grups tenen sobre els arxius es fa mitjançant un esquema complex de llistes de control d’accés (<acronym title="Access Control List">ACL</acronym>, <em>Access Control Lists</em>) per cada directori i arxiu. El sistema <acronym title="Access Control List">ACL</acronym> té l’avantatge de ser molt més flexible que el sistema GNU/Linux, ja que es poden establir més tipus de permisos, donar permisos només a uns quants usuaris i grups, denegar permisos, etc.
</p>

<p>
D’altra banda, el sistema <acronym title="Access Control List">ACL</acronym> és més complex d’administrar i més lent ja que, abans d’accedir a les carpetes o als arxius, el sistema ha de com-provar les llistes. En sistemes de GNU/Linux, en canvi, es fa una operació lògica dels bits que especifiquen els permisos, de manera que és molt més ràpid.
</p>

<p>
Per defecte, el Samba utilitza el sistema de permisos de GNU/Linux. Tot i que també pot implementar el sistema <acronym title="Access Control List">ACL</acronym> i gestionar les llistes mitjançant l’ordre <strong>smbcacls</strong>, és més recomanable utilitzar el sistema de gestió de permisos de GNU/Linux.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Quan compartim directoris amb el Samba, en última instància sempre imperen els permisos GNU/Linux.
</p>
</div></div>
<p>
Per exemple, si tenim compartida una carpeta anomenada <strong>professors</strong> amb permisos d’escriptura per al grup <strong>professors</strong>, tots els usuaris que pertanyin al grup <strong>professors</strong> podran efectuar canvis en la carpeta. No obstant això, si dins d’aquesta carpeta n’hi ha una altra que s’anomena <strong>confidencial</strong>, a la qual el grup <strong>professors</strong> no té permís per entrar, cap professor en podrà veure el contingut, encara que sigui dins d’una carpeta compartida.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Per fer una gestió eficient d’usuaris, grups i permisos, es recomana utilitzar els permisos GNU/Linux, els quals permeten assignar permisos de lectura, escriptura i execució a l’usuari propietari de l’arxiu, al grup propietari de l’arxiu i a la resta d’usuaris del sistema.
</p>
</div></div>
<p>
Pot ser que hi hagi alguna contradicció entre els permisos del sistema GNU/Linux i els permisos del recurs compartit a Samba. Per exemple, podem tenir un directori compartit anomenat <strong>magatzem</strong> amb permisos GNU/Linux de lectura, escriptura i execució per a tots els usuaris del sistema. Tanmateix, si en l’arxiu de configuració del Samba aquest recurs té el paràmetre <strong>read only = yes</strong>, no s’hi podran efectuar canvis, ja que està compartit amb permís només de lectura.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Quan els permisos GNU/Linux es contradiuen amb els permisos Samba, el permís efectiu és el més restrictiu.
</p>
</div></div>
<p>
Per simplificar l’administració dels permisos, es recomana no ser restrictius en els permisos de recurs compartit amb el Samba i aplicar els permisos en el sistema GNU/Linux. D’aquesta manera, a més de ser efectius quan accedim al recurs per mitjà del Samba, també ho serem quan hi accedim d’una altra manera, com per <strong>SSH</strong>, <strong><acronym title="File Transfer Protocol">FTP</acronym></strong> o mitjançant la consola del servidor.
</p>

</div>

<h2><a id="configuracio_del_servidor_samba" >Configuració del servidor Samba</a></h2>
<div class="level2">

<p>
La configuració del servidor Samba es fa a partir l’arxiu <strong>/etc/samba/smb.conf</strong>. La sintaxi de l’arxiu de configuració del Samba és bastant senzilla  donat que està dividit en seccions que es limiten a establir el valor d’uns quants paràmetres i a determinar quines són les carpetes i les impressores compartides, i també els permisos que hi ha. A més, l’arxiu va donant exemples de com hauríem de configurar alguns recursos per compartir-los, com configurar els perfils,compartir la unitat CD-ROM, etc.
</p>

<p>
Considerant que amb l’edició de l’arxiu <strong>/etc/samba/smb.conf</strong> es poden configurar més de 300 paràmetres -donaria lloc a milers de configuracions-,  en el nostre cas ens limitarem a analitzar els paràmetres més rellevants per garantir la seguretat i establir la compartició d’arxius i impressores del servidor.
</p>

<p>
En l’arxiu <strong>/etc/samba/smb.conf</strong> hi ha tres seccions predefinides (<em>global</em>, <em>homes</em> i <em>printers</em>) i tantes seccions addicionals com recursos extra es vulguin compartir. La utilitat i alguns dels paràmetres d’aquestes seccions predefinides es descriuen breument, ja que resulta necessari conèixer-los per la correcta configuració del Samba:
</p>

<p>
<strong>1. [global]</strong>. Defineix els paràmetres a escala global del servidor Samba, a més d’alguns dels paràmetres que s’establiran per defecte en la resta de les seccions.
</p>

<p>
<strong>2. [homes]</strong>. En aquesta secció es defineix automàticament un recurs de xarxa per a cada usuari conegut pel servidor Samba. Aquest recurs, per defecte, està associat al directori de connexió de cada usuari en l’ordinador en el qual el servidor Samba està instal·lat, és a dir, el directori de l’usuari (<em>home directory</em>). Aquesta secció és opcional, és a dir, si no existeix, no es compartiran les carpetes dels usuaris del servidor. S’utilitza quan es volen crear perfils mòbils per tal que, quan l’usuari s’identifiqui en qualsevol dels equips de la xarxa, el perfil s’escanegi automàticament.
</p>

<p>
El funcionament del servei Samba determina que, quan es faci una sol·licitud de connexió a un recurs compartit, s’escanegin les seccions que hi hagi en l’arxiu <strong>/etc/samba/smb.conf</strong> mitjançant la cerca del nom del recurs. Si es troba una coincidència, s’utilitzen els paràmetres de la secció, amb el mateix nom que el recurs sol·licitat, per determinar les propietats i la configuració del recurs.
</p>

<p>
Si no es troba cap coincidència, el nom de la secció sol·licitada es tracta com un nom d’usuari i se’l cerca en l’arxiu de contrasenyes locals. Si el nom existeix i la contrasenya és correcta, es crea un recurs amb el nom d’usuari, el directori de l’usuari s’estableix com a camí o <em>path</em> del recurs i la resta de paràmetres del recurs es copien dels que s’han especificat en la secció <strong>[homes]</strong>, si n’hi ha. Si l’usuari no es troba en l’arxiu de contrasenyes locals, es rebutja la connexió al recurs.
</p>

<p>
La configuració normal de la carpeta de l’usuari (<strong>home</strong>) serà la següent:
</p>
<pre class="code">[home]
path=/home/%u
read only=no</pre>

<p>
Aquí, <strong>%u</strong> és el nom de l’usuari amb el qual ens hem connectat al recurs.
</p>

<p>
Aquesta és una manera ràpida i senzilla de donar accés als directoris a un gran nombre de clients amb un esforç mínim. Aquesta secció pot especificar tots els paràmetres de les seccions dels recursos nous a compartir, encara que alguns paràmetres tindran més sentit que d’altres.
</p>

<p>
Hem de tenir en compte que si permetem que usuaris convidats accedeixin a la secció <strong>[homes]</strong>, tots els directoris d’inici seran visibles i/o modificables si no hem especificat el paràmetre que només permet la lectura, cosa que, des del punt de vista de la seguretat, és poc recomanable. Per tant, per accedir al directori de l’usuari, hem d’especificar directament que ens volem connectar al directori d’inici concret de l’usuari, ja que, per seguretat, cal que els usuaris no puguin veure els directoris de la resta (<strong>browsable = no</strong>).
</p>

<p>
<strong>3. [printers]</strong>. Aquesta secció funciona com <strong>[homes]</strong>, però per a les impressores.
</p>

<p>
Si es troba una secció <strong>[printers]</strong> en l’arxiu de configuració, es permet que els usuaris es connectin a qualsevol impressora especificada en l’arxiu <strong>/etc/printcap</strong> de l’ordinador central o host local. Quan es fa una sol·licitud de connexió a un recurs, s’escanegen les seccions que hi ha en l’arxiu <strong>/etc/samba/smb.conf</strong>. Si es troba alguna coincidència amb el nom del recurs sol·licitat, s’utilitzen els paràmetres de la secció amb el mateix nom per determinar les propietats i la configuració del recurs.
</p>

<p>
En cas que no hi hagi cap secció <strong>[homes]</strong>, el nom de la secció (recurs) sol·licitada es tracta com un nom d’impressora i s’analitza l’arxiu <strong>/etc/printcap</strong> per comprovar si aquest nom és un nom vàlid d’impressora compartida. Si es troba una coincidència, es crea una secció nova amb el nom de la secció buscada i amb els paràmetres especificats en la secció <strong>[printers]</strong> per defecte. Si no es troba cap coincidència, la connexió al recurs es rebutja. A fi que el comportament sigui aquest, el paràmetre <strong>printable</strong> de la secció <strong>[printers]</strong> ha de tenir el valor <strong>yes</strong>, ja que si s’especifica el contrari, és a dir, el valor <strong>no</strong>, el servidor es negarà a carregar l’arxiu de configuració.
</p>

<p>
Un exemple típic de configuració d’aquesta secció és el següent:
</p>
<pre class="code">[printers]
path = /var/spool/samba
guest ok = yes
printable = yes</pre>

<p>
<strong>3. Recursos nous a compartir</strong>. Cada vegada que es vol compartir un recurs (un directori, una impressora, etc.), cal crear una secció nova amb un encapçalament entre claudàtors ([ ]). L’encapçalament d’aquesta secció es correspondrà amb el nom que el recurs tindrà a la xarxa (el nom mitjançant el qual es podrà accedir al recurs des d’una altra màquina). Generalment es fa servir el mateix nom de la impressora o la carpeta a compartir per tal que sigui més aclaridor. Per exemple, si volem compartir la carpeta <strong>/home/samba/alumnes</strong>, crearem una secció <strong>[alumnes]</strong> en què aquest recurs compartit es configurarà amb els paràmetres específics.
</p>

<p>
Recomanacions durant la configuració del Samba:
</p>

<p>
És convenient crear en el directori <strong>/home</strong> una carpeta anomenada samba que contingui totes les carpetes compartides. La finalitat és tenir totes les dades d’usuari dins del directori de l’usuari i que fer les còpies de seguretat sigui senzill.
</p>
<ul>
<li class="level1"><div class="li"> És convenient crear una còpia de seguretat de l’arxiu <strong>/etc/samba/smb.conf</strong> abans de fer cap canvi. La finalitat és poder tornar a l’estat anterior en cas que fem una modificació incorrecta de l’arxiu que impedeixi que el servei arrenqui. El Samba analitza cada 60 segons l’arxiu <strong>/etc/samba/smb.conf</strong> i, si hi ha hagut canvis, es fan efectius.</div>
</li>
<li class="level1"><div class="li"> Per comprovar que el nostre arxiu <strong>/etc/samba/smb.conf</strong> és correcte, podem utilitzar l’ordre <strong>testparm</strong>, la qual analitza cada línia per localitzar-hi errors.</div>
</li>
<li class="level1"><div class="li"> Per tenir una descripció detallada de tots els paràmetres, es pot consultar la pàgina del manual d’<strong>/etc/samba/smb.conf</strong> amb l’ordre <strong>man smb.conf</strong>.</div>
</li>
</ul>

<p>
Per altra banda, el Samba ofereix una interfície d’edició d’aquest fitxer basada en web anomenada Swat (<em>Samba Web Administration Tool</em>). Aquesta eina permet configurar el Samba utilitzant un navegador de xarxa, tant de forma local com remota.
</p>

</div>

<h3><a id="configuracio_grafica_del_servidor_samba" >Configuració gràfica del servidor Samba</a></h3>
<div class="level3">
<div class="iocimportant"><div class="ioccontent">
<p>
El Swat (<em>Samba Web Administration Tool</em>) és una aplicació amb una interfície gràfica basada en web que permet administrar i configurar qualsevol servidor Samba de manera senzilla i visual, sense haver d’editar ni modificar cap fitxer de configuració a mà.
</p>
</div></div>
<p>
Hi ha diverses eines que ens ajuden a gestionar gràficament el Samba o aspectes que hi estan relacionats. D’aquestes eines, en podem destacar 5: el <strong>Gosa</strong>, el <strong>LAM</strong>, l’<strong>ebox</strong>, el <strong>Webmin</strong> i l’<strong>Swat</strong>. En el nostre cas, ens centrarem en l’Swat donat que està totalment orientat a la configuració amb interfície gràfica del servidor Samba.
</p>

<p>
Per utilitzar l’Swat com a eina d’administració de qualsevol servidor Samba, el servidor ha de tenir prèviament instal·lat i funcionant, com a mínim, un servei web. Per obtenir els requisits necessaris per accedir via web al servidor podem instal·lar-hi el paquet de programari <strong>LAMP</strong> de manera ràpida i senzilla amb l’eina <strong>tasksel</strong>. Una vegada instal·lat aquest paquet, disposarem del servei de base de dades <strong>MySQL</strong> i del intèrpret de <strong>PHP</strong>, a més del servei web <strong>Apache</strong>.
</p>

<p>
Per instal·lar l’Swat utilitzarem dos paquets: el paquet <strong>swat</strong> i el paquet <strong>inetutils-inetdn</strong>. Utilitzarem l’ordre següent:
</p>
<pre class="code">sudo apt-get install swat inetutils-inetd</pre>

<p>
Una vegada instal·lat l’swat, l’hem d’activar a <strong>inetd</strong> amb aquesta ordre:
</p>
<pre class="code">sudo update-inetd --enable &#039;swat&#039;</pre>

<p>

</p>

<p>
Finalment, hem d’establir una contrasenya a l’usuari primari (<em>root user</em>) per tal de poder-nos validar al inici de l’aplicació:
</p>
<pre class="code">sudo -s
passwd</pre>

<p>
Per accedir a la interfície gràfica de l’swat, hem d’obrir un navegador. Si som en el mateix servidor, en la barra de cerques haurem d’escriure <a href="http://localhost:901" class="urlextern" title="http://localhost:901"  rel="nofollow">http://localhost:901</a>. Si volguéssim accedir de manera remota al servidor Samba, hauríem de canviar <strong>localhost</strong> per l’adreça IP, el nom de la màquina o el nom de domini. L’aplicació ens demanarà un nom d’usuari i una contrasenya. Si volem accedir a totes les funcionalitats del samba, hem d’entrar com a usuaris primaris i utilitzar la contrasenya que hem establert abans. En accedir a l’swat apareix la pantalla que es mostra en la <span class="figref"><a href="#Figure40"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figure40"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Pantalla inicial de Swat

</figcaption><img src="../media/ic10mu8_45.png" alt="" /></figure>
</div>
<p>
En la part superior de la interfície gràfica tenim un ventall de botons que ens permeten seleccionar diferents opcions de gestió i configuració. Dels més rellevants podem destacar, en primer terme, els següents:
</p>

<p>
<strong>1. HOME</strong>. Se’ns adreça a la pàgina inicial de l’aplicació, la qual ens dóna la benvinguda i ens proporciona una gran quantitat d’enllaços a la documentació més actualitzada del Samba.
</p>

<p>
<strong>2. GLOBALS</strong>. Ens porta a una pàgina que ens permet configurar tots els paràmetres que hi ha en la secció <strong>[global]</strong> del fitxer <strong>/etc/samba/smb.conf</strong>. És aquí on podrem seleccionar si volem configurar els paràmetres bàsics o avançats.
</p>

<p>
Dins d’aquesta secció, els paràmetres es divideixen en grups d’opcions segons l’àmbit del servei amb el qual estan relacionats. Pel nostre exemple, modificarem els paràmetres del grup <em>Base Options</em>. En el paràmetre <strong>workgroup</strong> establirem el nom del grup de treball del servidor i en el paràmetre <strong>netbios name</strong>, el nom amb el qual es coneixerà el servidor. En la resta d’opcions deixarem el valor que tenen per defecte. La configuració quedarà com es mostra en la <span class="figref"><a href="#Figure41"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figure41"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Paràmetres globals de Samba mostrats al Swat

</figcaption><img src="../media/ic10mu8_46.png" alt="" /></figure>
</div>
<p>
<strong>3. SHARES</strong>. Si premem aquest botó, l’aplicació ens mostrarà una pantalla en la qual podrem crear i esborrar els recursos compartits que gestiona el servidor Samba. A més, ens permetrà establir diverses opcions dels directoris compartits i dels arxius que contenen com, per exemple, els tipus d’accés, els usuaris que hi poden accedir o permisos, entre altres. Al costat de cada opció tenim un enllaç, <em>Help</em>, que ens obrirà una altra finestra en què ens explicarà el significat, l’ús i la sintaxi de cada ordre. En el nostre exemple crearem, com es mostra en la <span class="figref"><a href="#Figure42"><span>figura</span></a></span>, una carpeta que només serà de lectura, anomenada <strong>professors</strong>. Com a comentari, hi posarem <strong>Carpeta amb apunts per als alumnes</strong>.
</p>
<div class="iocfigure"><a name="Figure42"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Paràmetres de la secció SHARES

</figcaption><img src="../media/ic10mu8_47.png" alt="" /></figure>
</div>
<p>
Amb el Samba no solament podem compartir directoris i impressores, sinó que també podem compartir altres dispositius, com CD-ROM, particions de disc, etc.
</p>

<p>
En la imatge següent podem veure un exemple de compartició -amb tots els usuaris i les màquines de la xarxa- de la unitat de CD-ROM d’un servidor Samba. Així doncs, les opcions de la secció <em>SHARES</em> serien les que apareixen en la <span class="figref"><a href="#Figure43"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figure43"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Dades d’exemple per a la compartició del CD-ROM

</figcaption><img src="../media/ic10mu8_48.png" alt="" /></figure>
</div>
<p>
<strong>4. PRINTERS</strong>. En aquesta secció podem especificar les impressores a compartir. A més, també hi podem determinar quins paràmetres de compartició volem aplicar a cada impressora com, per exemple, si els convidats hi poden accedir, quins ordinadors centrals poden accedir o no a cada impressora, si està disponible o visible per als usuaris que hi accedeixen al servidor, etc. Si no tenim cap impressora compartida a la llista, al costat del botó <strong>Choose Printer</strong> ens mostra, per defecte, el recurs <strong>print$</strong>. Aquest recurs conté controladors (<strong>drivers</strong>) d’impressores perquè els clients hi pugin accedir si no els troben disponibles localment. El recurs <strong>print$</strong> és opcional i pot ser que no s’utilitzi. En la <span class="figref"><a href="#Figure44"><span>figura</span></a></span> es mostra un exemple de la secció.
</p>
<div class="iocfigure"><a name="Figure44"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Paràmetres de la secció PRINTERS

</figcaption><img src="../media/ic10mu8_49.png" alt="" /></figure>
</div>
<p>
<strong>5. WIZARD</strong>. Aquesta secció ens permet determinar el rol del nostre servidor Samba dins d’una xarxa Windows. Podem especificar quin tipus de servidor serà -només servidor, membre del domini o controlador de domini. També podem determinar si farem servir <strong>WINS</strong> o no, i si el nostre servidor farà de servidor WINS o de client d’un altre servidor WINS. També ens ofereix la possibilitat de mostrar el directori dels usuaris Samba, per tal que s’hi pugui accedir des dels equips de la xarxa local o el grup de treball.
</p>

<p>
<strong>6. STATUS</strong>. Aquest botó ens permet controlar el funcionament del servidor Samba. Amb el botó <strong>Auto Refresh</strong> podem especificar que ens mostri la informació de la situació del servidor (connexions d’usuaris actives, recursos compartits actius i recursos utilitzats o oberts) amb la freqüència que especifiquem en el camp <strong>Refresh Interval</strong>. A més, des d’aquesta secció podem aturar o reiniciar els distints dimonis del servei Samba (<strong>smbd</strong>, <strong>nmbd</strong> i <strong>winbindd</strong>) i finalitzar (<strong>matar</strong>) les connexions establertes pels usuaris.
</p>

<p>
<strong>7. VIEW</strong>. Si seleccionem aquest botó ens mostrarà el contingut de l’arxiu <strong>/etc/samba/smb.conf</strong> perquè puguem veure la configuració actual del servidor Samba.
</p>

<p>
<strong>8. PASSWORD</strong>. Si seleccionem aquest botó ens portarà a una pàgina en la que trobem les seccions <strong>Server Password Managment</strong> i <strong>Client/Server Password Managment</strong>. La primera secció ens permet crear, esborrar, desactivar i reactivar usuaris Samba en la màquina local, mentre que la segona la podem utilitzar per canviar la contrasenya d’un compte d’usuari local.
</p>

</div>

<h2><a id="utilitzacio_del_client_samba" >Utilització del client Samba</a></h2>
<div class="level2">
<div class="iocimportant"><div class="ioccontent">
<p>
El client Samba ens proporciona l’ordre <strong>smbclient</strong> per accedir als recursos compartits dels servidors Samba disponibles mitjançant la xarxa.
</p>
</div></div>
<p>
L’ordre <strong>smbclient</strong> és una petita aplicació que ens permet accedir als servidors Samba com a clients com si d’un accés <strong><acronym title="File Transfer Protocol">FTP</acronym></strong> es tractés. S’utilitza, principalment, per conèixer quins recursos Samba ens ofereix una màquina remota. Per exemple, la sintaxi per llistar els recursos d’una màquina remota és la següent:
</p>
<pre class="code">smbclient -U usuari -L NET_BIOS_NAME</pre>

<p>
En cas que no hi tinguéssim accés, ens mostraria el següent missatge com a resposta a l’execució de nostra línia d’ordre:
</p>
<pre class="code">$smbclient -U lluis -L IOC
Password:
session setup failed: NT_STATUS_LOGON_FAILURE</pre>

<p>

També podem accedir-hi de manera anònima:
</p>
<pre class="code">smbclient -N -L IOC</pre>

<p>
Per connectar-nos al recurs que ens interessa, haurem de utilitzar aquesta ordre:
</p>
<pre class="code">smbclient //NETBIOS_NAME/Recurs</pre>

<p>
Si el recurs està protegit amb contrasenya, hi haurem d’afegir l’opció <strong>–U</strong> amb el nom d’usuari. Després d’executar l’ordre, ens demanarà la contrasenya. L’ordre quedarà així:
</p>
<pre class="code">smbclient -U clientsamba //IOC/apunts</pre>

<p>
Tot i que, quan accedim al recurs compartit, disposem d’una línia d’ordres, també podem executar les ordres típiques del servei <strong><acronym title="File Transfer Protocol">FTP</acronym></strong> -per exemple, com <em>put</em> o <em>get</em>, entre altres-. Per tal que ens mostri totes les ordres que podem utilitzar, hem d’executar l’ordre <em>help</em>:
</p>
<pre class="code">smb: \&gt; help</pre>

<p>
També podem utilitzar les ordres de navegació pel sistema de fitxers de GNU/Linux (<strong>cd</strong>, <strong>ls</strong>) i algunes de les ordres habituals de modificació de fitxers (<strong>rm</strong>, <strong>mkdir</strong>, <strong>del</strong> o <strong>rename</strong>), sempre que tinguem permisos.
</p>

<p>
Suposem, per exemple, que ens volguéssim connectar a la carpeta de l’usuari (<em>home</em>) <strong>clientsamba</strong> i que tinguéssim la secció <strong>HOMES</strong> habilitada en el servidor Samba. En aquest cas, hauríem de utilitzar l’ordre següent:
</p>
<pre class="code">smbclient -U clientsamba //IOC/clientsamba
smb: \&gt; ls</pre>

<p>
Tot i que l’ordre <strong>smbclient</strong> és molt útil, aquesta manera de treballar pot resultar una mica enutjosa. Hi ha, però, la possibilitat de muntar les unitats de xarxa a les quals volem accedir en directoris del nostre sistema, com si es tractés de directoris locals. Per això, haurem de tenir instal·lat el paquet <strong>smbfs</strong>.
</p>

</div>

<h2><a id="muntar_unitats_de_xarxa" >Muntar unitats de xarxa</a></h2>
<div class="level2">
<div class="iocimportant"><div class="ioccontent">
<p>
GNU/Linux disposa de suport per al sistema de fitxers SMB. Així, GNU/Linux, de la mateixa manera que pot muntar un directori exportat via <strong>NFS</strong> en un directori local, pot muntar un recurs SMB ofert per un servidor SMB, com un sistema Windows o un servidor Samba.
</p>
</div></div>
<p>
Un servidor SMB requereix que l’usuari s’autentiqui, i per això necessita un nom d’usuari i una contrasenya. Per muntar un recurs SMB podem utilitzar les ordres <strong>smbmount</strong> o, directament, l’ordre <strong>mount</strong> si li indiquem un tipus de sistema d’arxius específic (en aquest cas, <strong>smbfs</strong>). La sintaxi d’aquestes dues ordres seria la següent:
</p>
<pre class="code">mbmount -username=usuari -password=contrasenya -workgroup=MEUGRUP //servidor_Samba/recurs /punt_de_muntatge/</pre>
<pre class="code">mount -t smbfs –o userna-me=usuari,password=contrasenya,workgroup=MEUGRUP //servidor_Samba/recurs /punt_de_muntatge</pre>

<p>
Si el servidor no requereix que l’usuari s’autentiqui (permet accés a convidats), els paràmetres <strong>username</strong>, <strong>password</strong> i <strong>workgroup</strong> es poden obviar. Si en les ordres anteriors s’omet l’opció <strong>password</strong>, el sistema sol·licita a l’usuari que introdueixi una contrasenya. Si el servidor SMB permet l’accés a l’usuari, s’aconsegueix accedir al recurs (en aquest cas, <strong>servidor_Samba/recurs</strong>) a partir del directori local que hem establert com a punt de muntatge.
</p>

<p>
En el muntatge de sistemes d’arxius, també podem optar per registrar el muntatge en el fitxer <strong>/etc/fstab</strong>. Així, els directoris es poden muntar automàticament en l’arrencada del sistema. No obstant això, en el cas del sistema d’arxius <strong>smbfs</strong>, aquest registre presenta un problema, ja que el muntatge sempre implica la petició d’una contrasenya. Aquesta contrasenya es pot especificar en les opcions de muntatge o bé es pot sol·licitar per teclat en el moment de fer el muntatge.
</p>

<p>
Òbviament, aquesta última opció dificulta el muntatge automàtic en l’arrencada, tret que escrivim la contrasenya en el arxiu <strong>/etc/fstab</strong>. Això, per motius de seguretat, no és gaire recomanable, ja que qualsevol usuari pot llegir aquest arxiu. L’alternativa consisteix a utilitzar un arxiu de identificacions d’usuaris (opció de muntatge <strong>credentials=ARXIU</strong>) en què s’haurà d’escriure el nom i la contrasenya de l’usuari.
</p>

<p>
Tot i que en aquest arxiu la contrasenya també s’escriu en text pla, constitueix una mesura de seguretat suficient, ja que aquest fitxer només el pot llegir l’usuari que fa el muntatge, com ara el primari (<em>root</em>).
</p>

<p>
Vegem un exemple de l’arxiu <strong>/etc/fstab</strong> configurat per muntar recursos Samba remots en l’arrencada del sistema:
</p>
<ul>
<li class="level1"><div class="li"> <strong>Muntar de manera permanent un recurs anònim</strong>:</div>
</li>
</ul>
<pre class="code">//ALFA/apunts /mnt smbfs user,auto,guest,ro,gid=100 0 0</pre>
<ul>
<li class="level1"><div class="li"> <strong>Muntar de manera permanent un recurs protegit</strong>:</div>
</li>
</ul>
<pre class="code">//ALFA/Material_ioc /mnt smbfs username=clientsamba,password=ioc 0 0</pre>
<ul>
<li class="level1"><div class="li"> <strong>Muntar un recurs protegit amb el fitxer d’identificadors d’usuaris</strong>:</div>
</li>
</ul>
<pre class="code">//ALFA/professor /mnt smbfs credenti-als=/home/clientsamba/.smbpasswd 0 0**</pre>

<p>
Un inconvenient addicional és que, si les unitats es munten d’aquesta manera, l’únic usuari que hi podrà escriure serà el primari. Si volem que múltiples usuaris tinguin permís de lectura i escriptura en la unitat muntada, haurem de crear un grup (anomenat, per exemple, <strong>sambau-sersgroup</strong>) i afegir-hi els usuaris. El fitxer <strong>/etc/fstab</strong> quedarà així:
</p>
<pre class="code">//ALFA/professor /mnt smbfs credentials=/home/clientsamba/.smbpasswd,gid=sambausersgroup 0 0</pre>

<p>
Per altra banda, també pot ser molt útil permetre que els usuaris que no tinguin permisos de <em>superusuari</em> puguin muntar unitats Samba remotes. Per fer-ho, haurem de seguir una sèrie de passos:
</p>

<p>
<strong>1.</strong> Crear un grup i afegir-hi els usuaris:
</p>
<pre class="code">sudo groupadd samba
sudo adduser user samba</pre>

<p>
<strong>2.</strong> Editar sudo per permetre que els usuaris del grup puguin muntar unitats Samba:
</p>
<pre class="code">sudo visudo
## Members of the admin group may gain root privileges
%admin ALL=(ALL) ALL
%samba ALL=(ALL) /bin/mount,/bin/umount,/sbin/mount.cifs,/sbin/umount.cifs</pre>

<p>
Ara tots els usuaris del grup afegit podran muntar unitats Samba remotes.
</p>

</div>

<h2><a id="acces_grafic_als_recursos_compartits" >Accés gràfic als recursos compartits</a></h2>
<div class="level2">

<p>
L’Ubuntu ens permet accedir gràficament als recursos disponibles dels grups de treball (paràmetre <strong>workgroup</strong> del Samba) que hi ha a la xarxa local amb el navegador <strong>Nautilus</strong>, per mitjà del menú <strong>Llocs / Xarxa</strong>.
</p>

<p>
En seleccionar aquesta opció del menú, se’ns obrirà una finestra del <strong>Nautilus</strong> en què ens apareixeran tots els grups de treball (dominis) que hi hagi a la xarxa local. Si fem doble clic a cadascun dels grups, ens mostrarà els servidors Samba disponibles. Per veure els recursos que comparteix cada servidor, haurem de fer doble clic al damunt de la icona amb el nom. Aleshores, o bé hi podrem accedir lliurement perquè el servidor permet l’accés a usuaris convidats o bé haurem d’especificar el nom d’usuari Samba i la contrasenya adient.
</p>

<p>
En accedir a qualsevol servidor Samba, automàticament es muntaran totes les carpetes compartides del servidor, cosa que ens permetrà gestionar més fàcilment els recursos als quals tinguem accés. L’accés a cada recurs pot ser lliure o pot requerir un nom d’usuari Samba i una contrasenya. Si ens fixem en les figures 45 i 46 podrem entendre més bé tot el que hem comentat.
</p>

<p>

</p>

<p>
Per moure’ns per les carpetes, els servidors i els grups també podem utilitzar, a més dels clics, la barra de cerques <strong>Ubicació</strong>. La sintaxi de les adreces en la barra <strong>Ubicació</strong> és la següent:
</p>
<pre class="code">smb://nom_servidor/recurs</pre>
<div class="iocfigure"><a name="Figure45"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Accés gràfic als workgroups de la xarxa

</figcaption><img src="../media/ic10mu8_50.png" alt="" /></figure>
</div><div class="iocfigure"><a name="Figure46"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Accés gràfic als workgroups de la xarxa

</figcaption><img src="../media/ic10mu8_51.png" alt="" /></figure>
</div>
</div>

<h2><a id="protocol_nfs" >Protocol NFS</a></h2>
<div class="level2">
<div class="iocimportant"><div class="ioccontent">
<p>
El protocol de sistema de fitxers per xarxa (NFS, <em>Network File System</em>) és un protocol del nivell d’aplicació que s’utilitza en l’àmbit de les xarxes locals per compartir fitxers entre màquines de la mateixa xarxa.
</p>
</div></div>
<p>
El protocol NFS es pot utilitzar per defecte en la majoria de sistemes operatius GNU/Linux. Així, NFS fa possible que diversos sistemes GNU/Linux connectats a una mateixa xarxa puguin accedir a fitxers remots, en altres equips de la xarxa, com si es tractés de fitxers locals.
</p>

<p>
El sistema GNU/Linux només pot treballar amb una jerarquia de directoris. Per tant, si volem accedir a diferents sistemes d’arxius, particions de discos o CD-ROM, entre altres, primer hem de muntar aquests elements en algun punt de la jerarquia.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
L’NFS ens proporciona un servei de xarxa que permet a un ordinador client muntar un sistema d’arxius remot, exportat per un altre ordinador servidor, i accedir-hi. Per tant, el protocol NFS funciona clarament sota una arquitectura client - servidor.
</p>
</div></div>
<p>
El protocol NFS pot ser utilitzat amb múltiples finalitats, sempre dins de l’àmbit de compartició de recursos. Per això, en general, el protocol NFS és molt flexible i admet diferents possibilitats o escenaris de funcionament com, per exemple, els següents:
</p>
<ul>
<li class="level1"><div class="li"> Un servidor NFS pot exportar més d’un directori i atendre simultàniament diversos clients.</div>
</li>
<li class="level1"><div class="li"> Un client NFS pot muntar directoris remots exportats per diferents servidors.</div>
</li>
<li class="level1"><div class="li"> Qualsevol sistema GNU/Linux pot ser alhora client i servidor NFS.</div>
</li>
</ul>

<p>
Tenint en compte això, hi ha diversos usos típics de l’NFS en què aquest servei mostra la utilitat que té. En podem destacar les utilitats tradicionals següents:
</p>
<ol>
<li class="level1"><div class="li"> <strong> Centralització dels directoris de connexió dels usuaris (<em>home directory</em>)</strong>. Quan en una xarxa local de màquines GNU/Linux es vol que els usuaris puguin treballar indistintament en qualsevol, és adient situar els directoris de connexió de tots els usuaris en una mateixa màquina i fer que les altres muntin aquests directoris mitjançant NFS. Si aquest ús es combina amb l’autenticació d’usuaris en xarxa per mitjà de l’<em>LDAP</em>, en els sistemes GNU/Linux es pot implementar quelcom similar a un domini del Windows.</div>
</li>
<li class="level1"><div class="li"> <strong> Compartició de directoris d’ús comú</strong>. Si diversos usuaris des de diferents màquines treballen amb els mateixos arxius, per exemple, d’un projecte comú, també és útil compartir els directoris en què hi ha aquests arxius. Aquesta opció comporta un estalvi de disc en les màquines locals, ja que les dades estan centralitzades en un lloc, de manera que diversos usuaris hi poden accedir i les poden modificar. Per tant, no és necessari replicar la informació.</div>
</li>
<li class="level1"><div class="li"> <strong> Situar programari en un sol ordinador de la xarxa</strong>. És possible instal·lar programari en un directori del servidor NFS i compartir aquest directori via NFS. Si configurem els clients NFS perquè muntin aquest directori remot en un directori local, aquest programari estarà disponible per a tots els ordinadors de la xarxa.</div>
</li>
<li class="level1"><div class="li"> <strong> Compartició per mitjà de la xarxa de dispositius d’emmagatzemat-ge</strong>. És possible compartir dispositius com, per exemple, particions de discos durs, CD-ROM, etc. Això pot reduir la inversió en aquests dispositius i millorar l’aprofitament del maquinari que hi ha en l’organització.</div>
</li>
</ol>

<p>
Totes les operacions sobre fitxers són síncrones. Això significa que l’operació només torna un resultat quan el servidor ha completat tot el treball associat a aquesta operació. Per exemple, en cas d’una sol·licitud d’escriptura, el servidor escriurà físicament les dades en el disc i, si és necessari, actualitzarà l’estructura de directoris abans de tornar una resposta al client. Això garanteix la integritat dels fitxers.
</p>

</div>

<h3><a id="funcionament_de_l_nfs" >Funcionament de l&#039;NFS</a></h3>
<div class="level3">

<p>
En el sistema client, el funcionament de l’NFS es basa en la capacitat de traduir els accessos de les aplicacions a un sistema d’arxius en peticions al servidor corresponent per mitjà de la xarxa. Normalment aquesta funcionalitat del client està programada en el nucli de GNU/Linux, de manera que no necessita cap tipus de configuració.
</p>

<p>
Respecte al servidor, l’NFS s’implementa mitjançant dos serveis de xarxa, el <strong>mountd</strong> i l’<strong>nfsd</strong>. Vegem quines accions controla cadascun d’aquests serveis:
</p>
<ul>
<li class="level1"><div class="li"> <strong>El servei mountd</strong> s’encarrega d’atendre les peticions remotes de muntatge, efectuades per l’ordre <strong>mount</strong> del client. Entre altres coses, aquest servei s’encarrega de comprovar si la petició de muntatge és vàlida i de controlar sota quines condicions s’accedirà al directori exportat (només lectura, lectura/escriptura, etc.). Una petició es considera vàlida quan el directori sol·licitat ha estat explícitament exportat i el client té prou permisos per muntar aquest directori.</div>
</li>
<li class="level1"><div class="li"> <strong>El servei nfsd</strong> s’encarrega de, un cop s’ha muntat un directori remot correctament, atendre i resoldre les peticions d’accés del client als arxius que hi ha en el directori.</div>
</li>
</ul>

</div>

<h3><a id="instal_lacio_i_configuracio_del_client_nfs" >Instal·lació i configuració del client NFS</a></h3>
<div class="level3">

<p>
El client NFS no requereix ni instal·lació ni configuració, ja que els directoris remots es poden importar mitjançant l’ordre <strong>mount</strong>. També es pot utilitzar l’arxiu <strong>/etc/fstab</strong> si es vol que el directori es munti al inici. Les opcions de muntatge de cada directori es poden establir tant amb l’ordre <strong>mount</strong> com amb l’arxiu <strong>etc/fstab</strong>. Amb aquestes opcions es particularitza el comportament que tindrà el sistema d’arxius una vegada s’hagi muntat en el directori corresponent.
</p>

<p>
Per exemple, per muntar un sistema de fitxers NFS mitjançant l’ordre <strong>mount</strong>, podem fer servir la línia següent:
</p>
<pre class="code">   sudo mount -t nfs 192.168.1.15:/home (servidor) /home (client)</pre>

<p>
Si es vol que el directori <strong>/home</strong> es munti al inici de sessió, es pot afegir aquesta entrada permanent a l’arxiu <strong>/etc/fstab</strong>:
</p>
<pre class="code">   192.168.1.15:/home /home nfs soft,users,suid,exec</pre>

<p>
L’opció <strong>exec</strong> permet executar programes a la carpeta muntada i l’opció <strong>users</strong> permet que els usuaris puguin utilitzar <strong>mount</strong> per muntar i desmuntar aquest recurs.
</p>

<p>
Per instal·lar el servidor NFS, cal executar l’ordre següent:
</p>
<pre class="code">   sudo apt-get install nfs-kernel-server</pre>

<p>
El paquet <strong>nfs-kernel-server</strong> depèn del paquet <strong>nfs-common</strong>, el qual alhora depèn del paquet <strong>portmap</strong>. Per tant, tots tres s’instal·laran conjuntament amb l’ordre anterior. A més dels dimonis <strong>mountd</strong> i <strong>nfsd</strong>, el servidor necessita un altre dimoni anomenat <strong>portmap</strong> -el funcionament dels dimonis <strong>mountd</strong> i <strong>nfsd</strong> es basa en el dimoni <strong>portmap</strong>. 
</p>

<p>
Per tal de parar o reiniciar el servei NFS, es poden utilitzar els scripts del servei que hi ha a la carpeta ”<em>/etc/init.d</em>”.
</p>

<p>
Una vegada actius els serveis NFS, el servidor ha d’indicar explícitament quins directoris vol que s’exportin, a quines màquines s’han d’exportar i amb quines opcions s’ha de fer. Per això hi ha un fitxer de configuració denominat <strong>/etc/exports</strong>. Vegem un exemple d’aquest arxiu:
</p>
<pre class="code"># /etc/exports: the access control list for filesystems which may be exported
#to NFS clients. See exports(5).
# Example for NFSv2 and NFSv3:
#/srv/homes hostname1(rw,sync,no_subtree_check) hostna-me2(ro,sync,no_subtree_check)
# Example for NFSv4:
# /srv/nfs4 gss/krb5i(rw,sync,fsid=0,crossmnt,no_subtree_check)
# /srv/nfs4/homes gss/krb5i(rw,sync,no_subtree_check)</pre>

<p>
Cada línia del fitxer <strong>/etc/exports</strong> especifica un directori a exportar, juntament amb una llista d’autoritzacions. És a dir, determina quins ordinadors podran muntar aquest directori i amb quines opcions ho podran fer. Cada element de la llista d’ordinadors pot especificar un sol ordinador (mitjançant un nom simbòlic o una adreça IP) o un grup d’ordinadors (mitjançant l’ús de caràcters comodí, com * o ?). Quan no s’especifica l’ordinador o el rang, significa que el directori corresponent s’exporta a tots els ordinadors de la xarxa.
</p>

<p>
Les opcions de muntatge més importants que es poden especificar entre parèntesis per a cada ordinador o grup són les següents:
</p>
<ul>
<li class="level1"><div class="li"> <strong>()</strong>: Aquesta opció estableix les opcions que l’NFS assumeix per defecte.</div>
</li>
<li class="level1"><div class="li"> <strong>ro</strong>: El directori s’exporta com un sistema d’arxius només de lectura (opció per defecte).</div>
</li>
<li class="level1"><div class="li"> <strong>rw</strong>: El directori s’exporta com un sistema d’arxius de lectura/escriptura.</div>
</li>
<li class="level1"><div class="li"> <strong>root_squash</strong>: Els accessos des del client amb <strong>UID = 0</strong> (<strong>root</strong>) es converteixen en el servidor en accessos amb el <strong>UID</strong> d’un usuari anònim (opció per defecte).</div>
</li>
<li class="level1"><div class="li"> <strong>no_ root_squash</strong>: Es permet l’accés des d’un <strong>UID = 0</strong> sense conversió. És a dir, els accessos d’arrel (<em>root</em>) en el client es converteixen en accessos d’arrel en el servidor.</div>
</li>
<li class="level1"><div class="li"> <strong>all_squash</strong>: Tots els accessos des del client, amb qualsevol UID, es transformen en accessos d’usuari anònim.</div>
</li>
<li class="level1"><div class="li"> <strong>anonuid, anongid</strong>: quan s’activa l’opció <strong>root_squash</strong> o <strong>allsquash</strong>, els accessos anònims utilitzen normalment l’UID i el GID primari de l’usuari denominat <strong>nobody</strong> si aquest usuari existeix en el servidor (opció per defecte). Si es volen utilitzar altres formes d’identificació, els paràmetres <strong>anonuid</strong> i <strong>anongid</strong> estableixen, respectivament, quins UID i GID tindrà el compte anònim que el servidor utilitzarà per accedir al contingut del directori.</div>
</li>
<li class="level1"><div class="li"> <strong>noaccess</strong>: impedeix l’accés al directori especificat. Aquesta opció és útil per impedir que s’accedeixi a un subdirectori d’un directori exportat.</div>
</li>
</ul>

<p>
És important destacar que cada vegada que es modifica aquest fitxer, el servidor NFS s’ha d’actualitzar mitjançant l’ordre <strong>exportfs –ra</strong> perquè s’activin els canvis. Val a dir, a més, que no hi ha cap procés d’acreditació d’usuaris en el NFS, de manera que l’administrador ha de decidir amb cautela a quins ordinadors exporta un determinat directori.
</p>

<p>
Un directori sense restriccions s’exporta, en principi, a qualsevol altre ordinador connectat al servidor per mitjà de la xarxa (també Internet). Si en un ordinador client NFS hi ha un usuari amb un UID igual a <strong>X</strong>, aquest usuari accedirà al servidor NFS, per defecte, amb els permisos de l’usuari amb l’UID igual a <strong>X</strong> del servidor, encara que es tracti de usuaris diferents.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
La manca d’autenticació d’usuaris és un dels majors inconvenients del protocol NFS i per aquesta raó cada vegada s’utilitzen més altres sistemes de compartició de fitxers com, per exemple, el Samba.
</p>
</div></div>
</div>

	 </article>
     <div class="pnpage">
      <div class="left-corner"></div>
      <div id="prevpage">Anar a la p&agrave;gina anterior:<br /><a href="../../../WebContent/u8/referencies.html">Referències</a></div>
      <div id="nextpage">Anar a la p&agrave;gina seg&uuml;ent:<br /><a href="../../../WebContent/u8/a1/activitats.html">Activitats</a></div>
      <div class="right-corner"></div>
     </div>
    </div>
    <footer class="footer">
      <div><small>Aquest document està subjecte a una llicència oberta de Creative Commons, es reserva el dret de reconeixement de l'autoria, d'exigir que no se'n faci cap mena d'ús comercial. Si altereu o transformeu aquesta obra, o en genereu obres derivades, només podeu distribuir l'obra generada amb una llicència idèntica a aquesta.</small></div>
    </footer>
 </div>
 <div id="back_preview" class="hidden"></div>
 <div id="preview" class="hidden">
  <div class="prevcontent"></div>
 </div>
 <div id="help-tooltips">
  <div id="help-toc" class="hidden tooltip"><span>Taula de continguts:</span> Ofereix una vista general de l&#39;estructura del m&ograve;dul, que us facilitar&agrave; la navegaci&oacute; a trav&eacute;s dels seus continguts.<span class="arrow-left"></span></div> 
  <div id="help-settings" class="hidden tooltip"><span>Opcions de format:</span> Permet configurar el format de lectura a partir de les vostres prefer&egrave;ncies, modificant la mida de la lletra, el color del fons, l&#39;amplada de la p&agrave;gina o l&#39;ocultaci&oacute; dels continguts complementaris, entre d&#39;altres.<span class="arrow-left"></span></div>
  <div id="help-printer" class="hidden tooltip"><span>Imprimir:</span>  Envia el contingut seleccionat a la impressora.<span class="arrow-left"></span></div>
  <div id="help-favorites" class="hidden tooltip"><span>Prefereits:</span> Permet desar aquelles parts del contingut a les que us interessi accedir en un moment posterior; us permetr&agrave; anar creant un repositori personalitzat de les seccions que considereu m&eacute;s rellevants. Un cop l&#39;hageu començat a fer servir se us mostrar&agrave; a sota un comptador que us informar&agrave; del nombre de preferits que s&#39;hagin emmagatzemat fins al moment.<span class="arrow-left"></span></div>
  <div id="help-favcounter" class="hidden tooltip"><span>Comptador i llistat de preferits:</span> Indica el nombre de preferits que s&#39;han desat fins el moment; clicant damunt seu accedireu al llistat de preferits, i a trav&eacute;s d&#39;aquest podreu accedir directament als continguts que hageu emmagatzemat.<span class="arrow-left"></span></div>
  <div id="help-help_icon" class="hidden tooltip"><span>Ajuda:</span> Aquesta opci&oacute; activa la informaci&oacute; de les funcionalitats del web tot situant el punter del ratol&iacute; al damunt dels diferents &iacute;tems.<span class="arrow-left"></span></div>
  <div id="help-sidebar-hide" class="hidden tooltip"><span>Mostrar/Ocultar barra lateral:</span>  Deshabilita la barra d&#39;opcions, permetent la seva recuperaci&oacute; quan es desitgi.<span class="arrow-left"></span></div>
  <div id="help-search" class="hidden tooltip"><span>Cerca:</span>  Introdu&iuml;u les paraules clau sobre aquells conceptes que desitgeu localitzar en els continguts del m&ograve;dul. Tamb&eacute; podeu excloure un terme de la cerca tot afegint-hi el signe &#8220;-&#8221; al davant.<span class="arrow-top"></span></div>
  <div id="help-header" class="hidden tooltip"><span>Cap&ccedil;alera:</span>  Indica l&#39;apartat o secci&oacute; que es mostra en pantalla. Tingueu present que les capçaleres de segon, tercer i quart nivell tamb&eacute; es poden desar com a marcadors.<span class="arrow-left"></span></div>
</div> 
</body>
</html>
