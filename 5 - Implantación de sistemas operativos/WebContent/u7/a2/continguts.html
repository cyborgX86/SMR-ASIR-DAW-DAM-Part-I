<!doctype html>

<!--[if lt IE 7 ]> <html class="ie ie6 no-js" lang="ca"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie ie7 no-js" lang="ca"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie ie8 no-js" lang="ca"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie ie9 no-js" lang="ca"> <![endif]-->
<!--[if gt IE 9]><!--><html class="no-js" lang="ca"><!--<![endif]-->
<!-- the "no-js" class is for Modernizr. -->

<head id="www-sitename-com" data-template-set="html5-reset">

	<meta charset="utf-8">
	
	<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title>Implantació de sistemes operatius (ASIX)\ Sistemes informàtics (DAM i DAW)</title>
	
<!-- <meta name="title" content=""> --> 
	<meta name="description" content="">
	<!-- Google will often use this as its description of your page/site. Make it good. -->
	
	<meta name="google-site-verification" content="">
	<!-- Speaking of Google, don't forget to set your site up: http://google.com/webmasters -->
	
	<meta name="author" content="Institut Obert de Catalunya">
	<meta name="Copyright" content="Copyright Institut Obert de Catalunya 2011. All Rights Reserved.">

	<!-- Dublin Core Metadata : http://dublincore.org/ -->
	<meta name="DC.title" content="Implantació de sistemes operatius (ASIX)\ Sistemes informàtics (DAM i DAW)">
	<meta name="DC.subject" content="Informàtica i comunicacions">
	<meta name="DC.creator" content="Institut Obert de Catalunya">
	
	<!--  Mobile Viewport Fix
	j.mp/mobileviewport & davidbcalhoun.com/2010/viewport-metatag 
	device-width : Occupy full width of the screen in its current orientation
	initial-scale = 1.0 retains dimensions instead of zooming out if page height > device height
	maximum-scale = 1.0 retains dimensions instead of zooming in if page width < device width
	-->
	<!-- Uncomment to use � use thoughtfully!
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
	-->

	<link rel="shortcut icon" href="../../../img/favicon.ico">
	<!-- This is the traditional favicon.
		 - size: 16x16 or 32x32
		 - transparency is OK
		 - see wikipedia for info on browser support: http://mky.be/favicon/ -->
		 
	<link rel="apple-touch-icon" href="../../../img/apple-touch-icon.png">
	<!-- The is the icon for iOS's Web Clip.
		 - size: 57x57 for older iPhones, 72x72 for iPads, 114x114 for iPhone4's retina display (IMHO, just go ahead and use the biggest one)
		 - To prevent iOS from applying its styles to the icon name it thusly: apple-touch-icon-precomposed.png
		 - Transparency is not recommended (iOS will put a black BG behind the icon) -->
	
	<!-- CSS: screen, mobile & print are all in the same file -->
	<link rel="stylesheet" href="../../../_/css/style.css">

	<!-- CSS: jQuery UI -->
	<link rel="stylesheet" href="../../../_/css/jquery-ui.css">
	
	<!-- all our JS is at the bottom of the page, except for Modernizr. -->
	<script src="../../../_/js/modernizr-1.7.min.js"></script>
	<script src="../../../_/js/Hyphenator.js" type="text/javascript"></script>
	<script type="text/javascript">
	   Hyphenator.config({
		minwordlength : 4
	   });
	   Hyphenator.run();
	</script>
    <script src="../../../_/js/build.js" type="text/javascript"></script>
</head>

<body class="style-newspaper">

<div class="wrapper"><!-- not needed? up to you: http://camendesign.com/code/developpeurs_sans_frontieres -->

	<header id="header">
		<div class="head"><a href="http://ioc.gencat.cat"><img src="../../../img/logo.png" alt="Institut Obert de Catalunya"/></a><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/es/deed.ca"><img src="../../../img/license.png" alt="Llic&egrave;ncia" class="license"/></a></div>
		<div class="headdocument"><a href="../../../index.html">Implantació de sistemes operatius (ASIX)\ Sistemes informàtics (DAM i DAW)</a></div>
        <div id="search" class="search" name="search">
         <form id="frmsearch" action="../../../search.html" method="get">
          <input type="text" name="q"/>
        </form>
        </div>
	</header>
   <div id="upbutton" class="upbutton" style="display:none;"><img src="../../../img/uparrow.png" alt="Pujar a l'inici de p&agrave;gina"/></div>
   <aside id="aside">
    <div id="menu">
      <ul>
       <li name="toc"><div><img src="../../../img/toc.png" alt="&Iacute;ndex"/></div></li>
       <li name="settings"><div><img src="../../../img/settings.png" alt="Configuraci&oacute;"/></div></li>
       <li name="printer"><div><img src="../../../img/printer.png" alt="Imprimir"/></div></li>
       <li name="favorites"><div><img src="../../../img/favorites.png" alt="Favorits"/></div></li>
       <li name="help_icon" class="help_icon"><div><img src="../../../img/help_icon.png" alt="Ajuda"/></div></li>
      </ul>
     </div>
   </aside>
   <div id="sidebar-hide" name="sidebar-hide"><img src="../../../img/arrows.png"/></div>
   <section>
     <div id="toc" class="hidden">
      <div class="menucontent">
        <ul>
        <li id="u8" class="parentnode"><p><a class="unit" href="../../../WebContent/u8/introduccio.html">8. Administració de l'accés al domini</a></p><ul class="expander"><li id="u8introduccio"><a href="../../../WebContent/u8/introduccio.html">Introducció</a></li><li id="u8resum"><a href="../../../WebContent/u8/resum.html">Resum</a></li><li id="u8objectius"><a href="../../../WebContent/u8/objectius.html">Resultats d'aprenentatge</a></li><li id="u8mapa"><a href="../../../WebContent/u8/mapa.html">Mapa conceptual</a></li><li id="u8referencies"><a href="../../../WebContent/u8/referencies.html">Referències</a></li><li id="u8a1" class="tocsection"><p id='u8a1continguts'><a class="section" href="../../../WebContent/u8/a1/continguts.html">Recursos del domini</a><span class="buttonexp"></span></p><ul><li id="u8a1activitats"><a href="../../../WebContent/u8/a1/activitats.html">Activitats</a></li><li id="u8a1exercicis"><a href="../../../WebContent/u8/a1/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><div data-parent-id='u8a1' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u8/a1/continguts.html#equips_del_domini">Equips del domini</a></li><li><a href="../../../WebContent/u8/a1/continguts.html#recursos_locals">Recursos locals</a></li><li><a href="../../../WebContent/u8/a1/continguts.html#recursos_de_xarxa">Recursos de xarxa</a></li><li><a href="../../../WebContent/u8/a1/continguts.html#samba">Samba</a></li><li><a href="../../../WebContent/u8/a1/continguts.html#seguretat_en_el_samba">Seguretat en el Samba</a></li><li><a href="../../../WebContent/u8/a1/continguts.html#instal_lacio_del_servidor_i_del_client_samba">Instal·lació del servidor i del client Samba</a></li><li><a href="../../../WebContent/u8/a1/continguts.html#gestio_d_usuaris_grups_i_permisos_del_samba">Gestió d'usuaris, grups i permisos del Samba</a></li><li><a href="../../../WebContent/u8/a1/continguts.html#configuracio_del_servidor_samba">Configuració del servidor Samba</a></li><li><a href="../../../WebContent/u8/a1/continguts.html#utilitzacio_del_client_samba">Utilització del client Samba</a></li><li><a href="../../../WebContent/u8/a1/continguts.html#muntar_unitats_de_xarxa">Muntar unitats de xarxa</a></li><li><a href="../../../WebContent/u8/a1/continguts.html#acces_grafic_als_recursos_compartits">Accés gràfic als recursos compartits</a></li><li><a href="../../../WebContent/u8/a1/continguts.html#protocol_nfs">Protocol NFS</a></li></ul></div></div><li id="u8a2" class="tocsection"><p id='u8a2continguts'><a class="section" href="../../../WebContent/u8/a2/continguts.html">Administració de l'accés al domini</a><span class="buttonexp"></span></p><ul><li id="u8a2activitats"><a href="../../../WebContent/u8/a2/activitats.html">Activitats</a></li><li id="u8a2exercicis"><a href="../../../WebContent/u8/a2/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><div data-parent-id='u8a2' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u8/a2/continguts.html#permisos_i_drets">Permisos i drets</a></li><li><a href="../../../WebContent/u8/a2/continguts.html#delegacio_de_permisos">Delegació de permisos</a></li><li><a href="../../../WebContent/u8/a2/continguts.html#llistes_de_control_d_acces_acl">Llistes de control d’accés (ACL)</a></li><li><a href="../../../WebContent/u8/a2/continguts.html#directives_de_grup">Directives de grup</a></li><li><a href="../../../WebContent/u8/a2/continguts.html#directives_de_seguretat">Directives de seguretat</a></li></ul></div></div></ul></li><li id="" class="indexnode"><p><a href="../../../index.html">Anar a l&#39;&iacute;ndex general</a></p></li>
        </ul>
      </div>
    </div>
   </section>
   <section>
   <div id="settings" class="hidden">
    <div class="menucontent">
     <div class="allsettings">
     <div class="settings">
      <label>Font i Color</label>
		<div class="setting-option">
	        <ul class="fontBackground">
				<li id="style-newspaper" title="Newspaper" class="appearance-style-newspaper"><span>Newspaper</span></li>
                <li id="style-novel" title="Novel" class="appearance-style-novel"><span>Novel</span></li>
                <li id="style-ebook" title="eBook" class="appearance-style-ebook"><span>eBook</span></li>
				<li id="style-inverse" title="Inverse" class="appearance-style-inverse active"><span>Inverse</span></li>
				<li id="style-athelas" title="Athelas" class="appearance-style-athelas"><span>Athelas</span></li>
			</ul>
		</div>
     </div>
	<div class="settings">
      <label>Amplada</label>
		<div class="setting-option">
	        <div id="slider-width"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
		<div class="setting-option">
	        <div id="slider-font"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
	  <div class="setting-option">
       <form action="" class="sett-options">
		<ul>
		    <li><input type="checkbox" id="secondary-content" /><label for="secondary-content">Mostra recursos complementaris</label></li>
		    <li><input type="checkbox" id="main-images" /><label for="main-images">Mostra imatges</label></li>
		    <li><input type="checkbox" id="text-alignment" /><label for="text-alignment">Text justificat</label></li>
			<li><input type="checkbox" id="text-hyphen" /><label for="text-hyphen">Partici&oacute; sil·l&agrave;bica</label></li>
		</ul>
       </form>
	  </div>
     </div>
     </div>
    </div>
   </div>
   </section>
 <section>
 <div id="favorites" class="hidden"></div>
 </section>   
 <div id="bridge" class="hidden"></div>
 <div id="help" class="hidden">
  <div class="helptitle">Dreceres del teclat<hr></div>
  <div class="helpsection"><span>General</span>
   <ul>
    <li><span class="shortcut">g</span>: Anar al men&uacute; de navegaci&oacute;</li>
    <li><span class="shortcut">o</span>: Anar a opcions</li>
    <li><span class="shortcut">s</span>: Guardar la p&agrave;gina actual a favorits</li>
    <li><span class="shortcut">p</span>: Imprimir la p&agrave;gina actual</li>
    <li><span class="shortcut">?</span>: Mostrar/Ocultar l&#39;ajuda</li>
   </ul>
  </div>
  <div class="helpsection"><span>Navegaci&oacute;</span>
   <ul>
    <li><span class="shortcut">i</span>: Anar a l&#39;&iacute;ndex general</li>
    <li><span class="shortcut">t</span>: Anar a l&#39;inici de p&agrave;gina</li>
    <li><span class="shortcut">b</span>: Anar al final de p&agrave;gina</li>
    <li><span class="shortcut">j</span>: Anar cap endavant dintre la p&agrave;gina</li>
    <li><span class="shortcut">k</span>: Anar cap enrere dintre la p&agrave;gina</li>
    <li><span class="shortcut">h</span>: Anar a la p&agrave;gina anterior:</li>
    <li><span class="shortcut">l</span>: Anar a la p&agrave;gina seg&uuml;ent:</li>
   </ul>
   </div>
 </div>
 <div id="favcounter" name="favcounter" class="hidden"><span></span></div>
 <div id="navmenu" class="navmenu"><ul class="webnav"><li><a href="../../../index.html" title="Anar a l&#39;&iacute;ndex general">Inici</a></li><li><a href="../introduccio.html">Administració de dominis</a></li><li>Administració de comptes i grups LDAP</li></ul></div>
	<div id="content" lang="ca" class="hyphenate text">
     <article lang="ca" class="sheet">
        <h1><a id="administracio_de_comptes_i_grups_ldap"> Administració de comptes i grups LDAP </a></h1>
    	
<p>
L’administració de comptes i grups LDAP consisteix en la gestió, creació, eliminació i personalització dels comptes d’usuaris i grups del servidor de directori de LDAP. Val a dir que podem dur a terme aquestes tasques d’administració utilitzant l’edició i importació de fitxers ldif utilitzant la consola (interfície en mode text), però aquest mètode és més propens a errors, és feixuc i els resultats que obtenim són els mateixos que si fem servir eines més visuals i intuïtives.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Fitxers LDIF</p>
<p>
Una manera més complexa, però igualment vàlida, de gestionar usuaris i grups LDAP és fer-ho mitjançant els fitxers LDIF, (<em>LDAP data interexchange format</em>), que és un estàndard de fitxer de text pla per representar contingut del directori LDAP i actualitzacions d’aquest contingut.
</p>
</div></div>
<p>
Per dur a terme l’administració d’usuaris i grups del servei LDAP, i facilitar la tasca de l’administrador, utilitzarem l’eina <strong>phpLDAPadmin</strong>.
</p>

<p>
phpLDAPadmin és un client de l’LDAP basat en una interfície web que permet una administració senzilla del servidor LDAP utilitzant un navegador web, d’una manera local, per mitjà d’una xarxa d’àrea local o per Internet.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
phpLDAPadmin és un client d’LDAP basat en una interfície web. Ens permet una administració fàcil, accessible des de qualsevol lloc, del servidor LDAP.
</p>
</div></div>
<p>
phpLDAPadmin mostra la jerarquia d’objectes del servidor de LDAP en forma d’arbre i permet fer cerques avançades i intuïtives. A més a més, com que és una aplicació web, permet funcionar sobre moltes plataformes diferents.
</p>

<h2><a id="administracio_de_comptes_ldap" >Administració de comptes LDAP</a></h2>
<div class="level2">

<p>
En aquest apartat gestionarem els comptes d’usuari del servidor de LDAP, incloent-hi altes, baixes i modificacions d’aquests comptes. Per poder dur a terme aquestes tasques d’administració, el primer pas consistirà a connectar-se al servidor de LDAP utilitzant phpLDAPadmin: ens caldrà obrir un navegador, tant si és en l’ordinador on tenim instal·lat el servidor de LDAP com en un altre ordinador connectat al servidor per xarxa. 
</p>

<p>
En la barra d’adreces del navegador, hi escrivim l’adreça <strong><a href="http://localhost/phpldapadmin/" class="urlextern" title="http://localhost/phpldapadmin/"  rel="nofollow">http://localhost/phpldapadmin/</a></strong>, si ho fem des del mateix servidor, i <strong><a href="http://ip_del_servidor/phpldapadmin" class="urlextern" title="http://ip_del_servidor/phpldapadmin"  rel="nofollow">http://ip_del_servidor/phpldapadmin</a></strong>, si ho fem remotament per mitjà d’una xarxa.
</p>

<p>
Fent això, ens apareixerà la pantalla inicial de phpLDAPadmin, com podeu veure en la <span class="figref"><a href="#Figure1"><span>figura</span></a></span>.
</p>

<p>
Prement l’enllaç <em>entrada</em> (<em>login</em>), podem escriure les credencials (el nom distingit o DN) de l’administrador del servidor LDAP, i la contrasenya, com veieu en la <span class="figref"><a href="#Figure2"><span>figura</span></a></span>. Cal dir que, si hem creat de manera correcta el domini, i l’usuari admin, el nom distingit d’aquest apareixerà automàticament en la caixa de text anomenada <strong>Login DN</strong>. Si no és així, ens pot indicar que s’ha produït algun error a l’hora de configurar el domini.
</p>
<div class="iocfigure"><a name="Figure1"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Pantalla inicial phpLDAPadmin 

</figcaption><img src="../media/ic10mu7_01.png" alt="" /></figure>
<div class="footfigure">Interfície web d'administració del servidor LDAP</div></div><div class="iocfigure"><a name="Figure2"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Finestra d’entrada de phpLDAPadmin 

</figcaption><img src="../media/ic10mu7_02.png" alt="" /></figure>
<div class="footfigure">Cal escriure el nom distingit de l'usuari admin, i la contrasenya corresponent</div></div><div class="iocfigure"><a name="Figure3"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Finestra inicial de phpLDAPadmin

</figcaption><img src="../media/ic10mu7_03.png" alt="" /></figure>
<div class="footfigure">Aspecte que mostra phpLDAPadmin un cop hem inserit les credencials de l'usuari admin.</div></div>
<p>
Un cop escrit el nom distingit de l’usuari admin, i la contrasenya, entrem a la interfície d’administració del servidor de LDAP via web, i podem veure el nom del domini i l’extensió que té, com mostra la <span class="figref"><a href="#Figure3"><span>figura</span></a></span>.
</p>

<p>
Podem expandir l’arbre del directori del servidor de LDAP prement l’enllaç simbolitzat amb el símbol <strong>+</strong> i, d’aquesta manera, visualitzarem els objectes que hem generat a l’hora de crear el domini. Ho podeu veure en la <span class="figref"><a href="#Figure4"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figure4"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Arbre del directori LDAP 

</figcaption><img src="../media/ic10mu7_04.png" alt="" /></figure>
<div class="footfigure">Es mostren tots els objectes que hem creat en el domini.</div></div>
</div>

<h3><a id="comptes_predeterminats" >Comptes predeterminats</a></h3>
<div class="level3">

<p>
Per crear un domini de LDAP és del tot imprescindible crear un usuari administrador. Per tant, podem dir que en la definició d’un domini de LDAP només hi ha un usuari predeterminat, que és l’usuari <strong>admin</strong> (administrador). Tots els altres usuaris es creen posteriorment. 
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Assegurant phpLDAPadmin</p>
<p>
Si tenim un servidor web segur (que utilitzi certificats SSL), s’hauria de configurar per forçar l’aplicació phpLDAPadmin perquè faci servir el mode SSL i així mantenir-la segura.
</p>
</div></div>
<p>
Així doncs, la creació de l’usuari admin es fa al mateix temps que la creació del domini, mitjançant la importació del fitxer ldif corresponent.
Per exemple, si creem un domini que tingui per nom <strong>meudomini.org</strong>, la creació de l’usuari admin es realitza quan s’importa el fitxer <strong>frontend.meudomini.org.ldifv</strong>, concretament, en les línies següents:
</p>
<pre class="code">   # Admin user.
   dn: cn=admin,dc=meudomini,dc=org
   objectClass: simpleSecurityObject
   objectClass: organizationalRole
   cn: admin
   description: administrador LDAP
   userPassword: {CRYPT}aLJLqqUipInfk</pre>

</div>

<h3><a id="contrasenyes" >Contrasenyes</a></h3>
<div class="level3">

<p>
Per a l’establiment de les contrasenyes dels usuaris hem de distingir dos casos diferenciats: d’una banda tenim l’usuari administrador i, de l’altra, la resta dels usuaris.
</p>

<p>
L’establiment de la contrasenya de l’usuari administrador s’ha de dur a terme alhora que es crea el domini, i es realitza mitjançant l’ordre <strong>slappasswd</strong>. Haurem d’utilitzar el modificador -h juntament amb l’algorisme d’encriptació que volem. Per exemple, l’execució de l’ordre següent:
</p>
<pre class="code">slappasswd -h {CRYPT}: 
New password: 123456
Re-enter new password: 123456
{CRYPT}aLJLqqUipInfk </pre>

<p>
Establirà la contrasenya de l’usuari administrador del domini de LDAP en 123456 utilitzant el mètode d’encriptació CRYPT. 
</p>

<p>
Aquest mètode d’encriptació correspon a la utilització de la funció d’encriptació de contrasenyes crypt, que està basada en l’algorisme estàndard d’encriptació de dades (DES), modificat de manera que faci difícil la cerca basada en maquinari de la clau d’encriptació.
</p>

<p>
Per tal d’establir la contrasenya de la resta d’usuaris del domini podem utilitzar l’eina gràfica phpLDAPadmin: primer de tot cal connectar-se com a usuari administrador del domini, desplegar l’arbre i seleccionar l’entrada corresponent a l’usuari. En aquest cas, hem suposat que ja havíem creat un usuari en el domini de LDAP anomenat <strong>usuari</strong>. Ho podeu veure en la <span class="figref"><a href="#Figure5"><span>figura</span></a></span>. 
</p>
<div class="iocfigure"><a name="Figure5"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Selecció de l’usuari en l’arbre del domini

</figcaption><img src="../media/ic10mu7_05.png" alt="" /></figure>
</div>
<p>
Un cop escollit l’usuari, hem de cercar la caixa de text que té per títol <strong>Password</strong>, i allà li podrem assignar la contrasenya que volem, tal com podeu veure en la <span class="figref"><a href="#Figure6"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figure6"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Establiment de la contrasenya de l’usuari

</figcaption><img src="../media/ic10mu7_06.png" alt="" /></figure>
</div>
<p>
Per defecte, la contrasenya de l’usuari s’estableix amb text pla, però si ho volem fer utilitzant el desplegable, que hi ha al costat dret de la caixa de text, podem escollir algun mètode d’encriptació de la contrasenya. Ho podeu veure en la <span class="figref"><a href="#Figure7"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figure7"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Tria de la forma d’encriptació de la contrasenya

</figcaption><img src="../media/ic10mu7_07.png" alt="" /></figure>
</div>
</div>

<h3><a id="bloquejos_de_comptes" >Bloquejos de comptes</a></h3>
<div class="level3">

<p>
No hi ha cap manera automatitzada de bloquejar l’accés d’un usuari al servidor de LDAP. Una solució possible consisteix a iniciar la sessió en el phpLDAPadmin, com a usuari administrador, seleccionar l’usuari al qual volem bloquejar l’accés, deixar el camp de la contrasenya en blanc i actualitzar l’objecte. 
</p>

<p>
D’aquesta manera, serà impossible que s’autentiqui i evitarem que pugui iniciar la sessió en el servidor. Ho podeu comprovar en la <span class="figref"><a href="#Figure8"><span>figura</span></a></span>.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Bloquejos de comptes</p>
<p>
Es bloquejos de compte són útils per evitar accessos que no volem als recursos del domini.
</p>
</div></div><div class="iocfigure"><a name="Figure8"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Eliminant la contrasenya de l’usuari

</figcaption><img src="../media/ic10mu7_08.png" alt="" /></figure>
</div>
</div>

<h3><a id="comptes_d_usuaris" >Comptes d&#039;usuaris</a></h3>
<div class="level3">

<p>
Mitjançant phpLDAPadmin podem dur a terme tota la gestió d’usuaris en el nostre domini de LDAP: crear, eliminar i actualitzar les propietats d’un usuari determinat. 
</p>

<p>
<strong>1.</strong> <strong>Creació d’un usuari</strong>. Per tal de crear un usuari nou, ens situem sota la unitat organitzativa <strong>People</strong> i cliquem a l’enllaç <strong>Create new entry here</strong>, tal com veieu en la <span class="figref"><a href="#Figure9"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figure9"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Creació d’un nou usuari

</figcaption><img src="../media/ic10mu7_09.png" alt="" /></figure>
</div>
<p>
Seleccionem l’opció <strong>Generic: User Account</strong>, i se’ns presentarà la finestra que podeu veure en la <span class="figref"><a href="#Figure10"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figure10"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Creant un nou usuari

</figcaption><img src="../media/ic10mu7_10.png" alt="" /></figure>
</div>
<p>
Les caixes de text que apareixen amb el fons de color groc s’han d’omplir obligatòriament. Cal dir que l’ID (‘identificador d’usuari’) es crea automàticament, concatenant la inicial del nom (<em>first name</em>) amb el cognom sencer (<em>last name</em>). El nom comú està format pel nom i el cognom sencers. Ho podeu veure en la <span class="figref"><a href="#Figure11"><span>figura</span></a></span>.
</p>

<p>
També podeu veure en la <span class="figref"><a href="#Figure11"><span>figura</span></a></span> com s’ha d’inserir la contrasenya dos cops per tal de confirmar-la, i hem de triar el mètode d’encriptació d’aquesta.
</p>
<div class="iocfigure"><a name="Figure11"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Nom i contrasenya del nou usuari

</figcaption><img src="../media/ic10mu7_11.png" alt="" /></figure>
</div>
<p>
Es calcula automàticament un identificador d’usuari (<em>UID number</em>); cal especificar un identificador de grup (GID), el directori personal i l’intèrpret de ordres, com es mostra en la <span class="figref"><a href="#Figure12"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figure12"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Paràmetres addicionals de creació d’usuari

</figcaption><img src="../media/ic10mu7_12.png" alt="" /></figure>
</div>
<p>
Un cop completada aquesta informació, hem de prémer el botó <strong>Create object</strong>, i apareix la finestra de la <span class="figref"><a href="#Figure13"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figure13"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Propietats de l’usuari creat

</figcaption><img src="../media/ic10mu7_13.png" alt="" /></figure>
</div>
<p>
Premem el botó <strong>Commit</strong>, i podreu comprovar en la <span class="figref"><a href="#Figure14"><span>figura</span></a></span> que s’ha afegit l’objecte corresponent a l’usuari segon dins la unitat organitzativa <strong>People</strong>.
</p>
<div class="iocfigure"><a name="Figure14"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Arbre amb el nou objecte (usuari) creat

</figcaption><img src="../media/ic10mu7_14.png" alt="" /></figure>
</div>
<p>
<strong>2.</strong> <strong>Modificació d’un compte d’usuari</strong>. Per tal de dur a terme modificacions en el compte d’un usuari que ja hem creat en el domini, només cal seleccionar l’objecte corresponent dins de l’arbre del servidor de LDAP. Això ens permetrà accedir a les propietats d’aquest objecte, modificar-ne el nom, el cognom, l’identificador d’usuari, la contrasenya, el directori personal, el número identificador d’usuari i l’intèrpret de ordres associat. Una altra opció interessant és l’anomenada <strong>switch template</strong>, o canvi de plantilla, que es presenta en forma d’enllaç. Si fem un clic en aquest enllaç, el sistema mostra una altra finestra com la de la <span class="figref"><a href="#Figure15"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figure15"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Opcions de plantilla de l’objecte usuari

</figcaption><img src="../media/ic10mu7_15.png" alt="" /></figure>
</div>
<p>
Triem l’opció <strong>generic address book</strong> i ens apareixeran més camps que en la plantilla genèrica. Concretament, podrem afegir una fotografia, el nom d’una organització (<em>organization</em>), un carrer (<em>street</em>), una ciutat (<em>city</em>), un estat (<em>state</em>), un codi postal (<em>postal code</em>), un telèfon de treball (<em>work phone</em>), un número de fax, un telèfon mòbil (<em>mobile</em>) i un correu electrònic. Podeu veure alguns d’aquests nous camps en la <span class="figref"><a href="#Figure16"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figure16"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Camps addicionals per a l’objecte usuari

</figcaption><img src="../media/ic10mu7_16.png" alt="" /></figure>
</div>
<p>
Quan haurem acabat de fer totes les modificacions necessàries, premem el botó <strong>update object</strong>. 
</p>

<p>
<strong>3.</strong> <strong>Eliminació d’un compte d’usuari</strong>. Quan una persona deixa de ser usuari del sistema d’una manera permanent, convé eliminar l’objecte usuari corresponent de la base de dades del servidor de LDAP. D’aquesta manera, ens assegurem que els objectes que hi són presents corresponen a usuaris actuals del sistema, evitem accessos indeguts i, a més, mantenim actualitzada la base de dades, minimitzant l’espai que ocupa. Per tal d’eliminar un usuari de LDAP, només cal accedir a l’arbre de LDAP dins del phpLDAPadmin i seleccionar l’objecte corresponent a l’usuari, com podeu veure en la <span class="figref"><a href="#Figure17"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figure17"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Selecció i eliminació d’un objecte d’usuari LDAP

</figcaption><img src="../media/ic10mu7_17.png" alt="" /></figure>
</div>
<p>
Seleccionem l’enllaç anomenat <strong>Delete this entry</strong> i el sistema ens demanarà confirmació, com mostra la <span class="figref"><a href="#Figure18"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figure18"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Confirmació d’eliminació d’objecte usuari

</figcaption><img src="../media/ic10mu7_18.png" alt="" /></figure>
</div>
<p>
Premem el botó <strong>Delete</strong> i el sistema ens mostrarà un missatge informatiu sobre si ha pogut dur a terme la petició. A més a més, l’objecte haurà desaparegut de l’arbre de l’LDAP. Ho podeu veure en la <span class="figref"><a href="#Figure19"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figure19"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Resultat de l’eliminació d’un objecte usuari

</figcaption><img src="../media/ic10mu7_19.png" alt="" /></figure>
</div>
</div>

<h3><a id="comptes_d_equips" >Comptes d&#039;equips</a></h3>
<div class="level3">

<p>
LDAP permet l’autenticació basada en nodes de la xarxa. L’autenticació basada en nodes permet restringir a qui es permet iniciar la sessió en una màquina que fa servir LDAP per dur a terme l’autenticació. Bàsicament, es tracta d’afegir un atribut a cadascun dels usuaris del servidor LDAP, que inclogui en quins dels nodes de la xarxa se’ls permet iniciar la sessió.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Usuaris</p>
<p>
Correctament configurat, els usuaris que hem creat dins del directori LDAP es poden validar localment o per mitjà de la xarxa en el servidor, iniciant la sessió com si es tractés d’un usuari local.
</p>
</div></div>
<p>
Cadascun dels sistemes dels clients comprova el valor camp i el compara amb el nom de l’amfitrió, permetent o denegant l’inici de sessió segons aquest atribut. Hi ha dos mètodes que serveixen per forçar l’autenticació basada en el node de la xarxa (amfitrió): el primer és utilitzar <strong>libpam-ldap</strong> i el segon es fer servir un filtre pam (<strong>pam_filter</strong>) a LDAP.
</p>

</div>

<h4><a id="autenticacio_mitjancant_libpam-ldap" >Autenticació mitjançant libpam-ldap</a></h4>
<div class="level4">

<p>
Si fem servir la directiva <strong>pam_check_host_attr</strong> per tal de forçar l’autenticació en funció de l’amfitrió, els usuaris seran informats explícitament que no poden iniciar la sessió en aquell node amb un missatge d’error semblant a: Accés denegat per aquest amfitrió.
</p>

<p>
Per tal d’utilitzar <strong>libpam-ldap</strong> cal utilitzar l’atribut <strong>host</strong>. Amb la documentació d’aquest paquet podem trobar un esquema que ens dóna aquest atribut, i està localitzat en el fitxer <code>/usr/share/doc/libpam-ldap/ldapns.schema</code>, el qual es pot afegir al fitxer <code>slapd.conf</code>, si cal. Per definir aquest atribut podem utilitzar phpLDAPadmin o bé podem crear un fitxer anomenat <code>nodes.ldif</code> amb el contingut següent:
</p>
<pre class="code">dn: uid=user_to_change,ou=Users,dc=example,dc=com
changetype: modify
add: host
host: hostname</pre>

<p>
on hem de substituïr “hostname” pel nom del node. Fet això, aplicarem els canvis utilitzant l’ordre següent:
</p>
<pre class="code">ldapmodify -H ldaps://ldapserver -D &quot;cn=admin,dc=example,dc=com&quot; -x -W -f nodes.ldif</pre>

<p>
En el client, hem de modificar el fitxer <code>/etc/ldap.conf</code> (o qualsevol altre fitxer de configuració, tal com hem definit en el pam.d) de manera que inclogui la línia següent:
</p>
<pre class="code">pam_check_host_attr yes</pre>

<p>
Cal tenir en compte que el fitxer  <code>/etc/nsswitch.conf</code> no hauria de contenir <strong>ldap</strong> en l’entrada corresponent a <strong>shadow</strong>; si no és així, sempre ens podrem autenticar independentment de quin sigui el node.
</p>

</div>

<h4><a id="autenticacio_mitjancant_un_filtre_de_pam_pam_filter" >Autenticació mitjançant un filtre de pam (pam_filter)</a></h4>
<div class="level4">

<p>
Si fem servir la directiva <strong>pam_filter</strong> en el fitxer  <code>/etc/ldap.conf</code> és possible forçar PAM perquè permeti només els comptes d’usuari amb els atributs que escollim. Els usuaris als quals no es permet l’accés al node des d’on intenten iniciar sessió, no rebran cap error. En aquest cas, PAM els informarà que han entrat una contrasenya incorrecta.
Podem crear, utilitzant l’atribut libpam-ldap host, un filtre que coincideixi amb el nom del node o qualsevol (*) en el fitxer <code>/etc/ldap.conf</code>:
</p>
<pre class="code">   pam_filter |(host=thehostname)(host=\*)</pre>

</div>

<h3><a id="perfils_d_usuari" >Perfils d&#039;usuari</a></h3>
<div class="level3">

<p>
Un perfil d’usuari fa referència al conjunt de preferències que té aquest usuari determinat: el fons d’escriptori, l’aspecte de l’entorn gràfic, les aplicacions instal·lades, els permisos sobre aquestes aplicacions i sobre els recursos. Quan instal·lem un sistema operatiu, els perfils d’usuari es creen i es carreguen localment, és a dir, en el mateix disc dur de l’ordinador on hem instal·lat el sistema operatiu. Quan disposem d’una xarxa d’àrea local amb molts ordinadors, és molt difícil gestionar aquests perfils, i és aconsellable fer-ne una gestió centralitzada.
</p>

<p>
Per fer això, cal disposar d’un controlador de domini, o en el nostre cas concret, d’un servidor amb un servei de directori LDAP instal·lat. La manera que té un servidor de LDAP de gestionar els usuaris, els grups, els comptes de màquines, els perfils d’usuaris i les seves carpetes personals és integrant el protocol SAMBA. Aquest protocol permet que, mitjançant el servei LDAP, usuaris tant d’estacions GNU/Linux com estacions amb Windows es puguin autenticar, carreguin els seus perfils i accedeixin a carpetes personals en el servidor.
</p>

<p>
Hi ha tres paquets necessaris per integrar Samba amb LDAP: <strong>samba</strong>, <strong>samba-doc</strong> i <strong>smbldap-tools</strong>. Per instal·lar aquests paquets escriurem des d’un terminal, i com a usuari administrador (<em>root</em>), el següent:
</p>
<pre class="code">   apt-get install samba samba-doc smbldap-tools</pre>

</div>

<h4><a id="configuracio_d_openldap" >Configuració d&#039;OpenLDAP</a></h4>
<div class="level4">

<p>
Per tal que SAMBA faci servir OpenLDAP com a proveïdor de la comprovació d’usuaris i contrasenyes, els objectes d’usuari en el directori de LDAP han de tenir atributs addicionals. Suposem que volem configurar Samba com un servidor de domini de Windows NT. Vegem, doncs, els passos per aconseguir-ho:
</p>

<p>
<strong>1.</strong> Els atributs Samba es defineixen en el fitxer <strong>samba.schema</strong> que és una part del paquet <strong>samba-doc</strong>. El fitxer d’esquema (<em>schema</em>) s’ha de descomprimir (està comprimit en format zip) i s’ha de copiar al directori <code>/etc/ldap/</code> amb el mateix nom. Per fer això escrivim des d’un terminal: 
</p>
<pre class="code">cp /usr/share/doc/samba-doc/examples/LDAP/samba.schema.gz /etc/ldap/schema/
gzip -d /etc/ldap/schema/samba.schema.gz</pre>

<p>
<strong>2.</strong> Ara l’esquema samba (<em>schema</em>) s’ha d’afegir a la branca <strong>cn=config</strong> de l’arbre de ldap. De primer creem un fitxer de configuraicó anomenat <code>schema_convert.conf</code>, que contingui les línies següents: 
</p>
<pre class="code">include /etc/ldap/schema/core.schema
include /etc/ldap/schema/collective.schema
include /etc/ldap/schema/corba.schema
include /etc/ldap/schema/cosine.schema
include /etc/ldap/schema/duaconf.schema
include /etc/ldap/schema/dyngroup.schema
include /etc/ldap/schema/inetorgperson.schema
include /etc/ldap/schema/java.schema
include /etc/ldap/schema/misc.schema
include /etc/ldap/schema/nis.schema
include /etc/ldap/schema/openldap.schema
include /etc/ldap/schema/ppolicy.schema
include /etc/ldap/schema/samba.schema</pre>

<p>
Tot seguit creem un directori temporal per desar la sortida que generarà la inclusió d’aquest fitxer de configuració:
</p>
<pre class="code">mkdir /tmp/ldif_output</pre>

<p>
Ara utilitzarem slapcat per convertir els fitxers d’esquema a un format que pugui entendre LDAP:
</p>
<pre class="code">slapcat -f schema_convert.conf -F /tmp/ldif_output -n0 -s &quot;cn={12}samba,cn=schema,cn=config&quot; &gt; /tmp/cn=samba.ldif</pre>

<p>
Editem el fitxer generat amb aquesta ordre <code>/tmp/cn=samba.ldif</code> i canviem els atributs següents (eliminant el {12}, són a les tres primeres línies): 
</p>
<pre class="code">dn: cn=samba,cn=schema,cn=config
...
cn: samba</pre>

<p>
I eliminem les línies següents del final del fitxer:
</p>
<pre class="code">structuralObjectClass: olcSchemaConfig
entryUUID: b53b75ca-083f-102d-9fff-2f64fd123c95
creatorsName: cn=config
createTimestamp: 20080827045234Z
entryCSN: 20080827045234.341425Z#000000#000#000000
modifiersName: cn=config
modifyTimestamp: 20080827045234Z</pre>

<p>
Finalment, fent servir la utilitat ldapadd, afegim el nou esquema al directori LDAP:
</p>
<pre class="code">ldapadd -x -D cn=admin,cn=config -W -f /tmp/cn\=samba.ldif</pre>

<p>

</p>

<p>
<strong>3.</strong> Creem un fitxer anomenat <code>samba_indexes.ldif</code> amb el contingut següent: 
</p>
<pre class="code">dn: olcDatabase={1}hdb,cn=config
changetype: modify
add: olcDbIndex
olcDbIndex: uidNumber eq
olcDbIndex: gidNumber eq
olcDbIndex: loginShell eq
olcDbIndex: uid eq,pres,sub
olcDbIndex: memberUid eq,pres,sub
olcDbIndex: uniqueMember eq,pres
olcDbIndex: sambaSID eq
olcDbIndex: sambaPrimaryGroupSID eq
olcDbIndex: sambaGroupType eq
olcDbIndex: sambaSIDList eq
olcDbIndex: sambaDomainName eq
olcDbIndex: default sub</pre>

<p>
<strong>4.</strong> Utilitzem ldapmodify per carregar els nous índexs:
</p>
<pre class="code">ldapmodify -x -D cn=admin,cn=config -W -f samba_indexes.ldif</pre>

<p>
<strong>5.</strong> Si el procediment s’ha seguit correctament, podem visualitzar els nous índexs fent servir l’ordre <strong>ldapsearch</strong>:
</p>
<pre class="code">ldapsearch -xLLL -D cn=admin,cn=config -x -b cn=config -W olcDatabase={1}hdb</pre>

<p>
<strong>6.</strong> Ens assegurem que el servidor samba està instal·lat i iniciat:
</p>
<pre class="code">smbd status
smbd start/running process 2113</pre>

<p>
En aquest cas, el servidor SAMBA s’està executant i té el número de procés 2113.
</p>

<p>
<strong>7.</strong> Tot seguit hem de configurar el paquet <strong>smbldap-tools package</strong> d’una manera adequada perquè sigui coherent amb el nostre entorn. Aquest paquet inclou uns fitxers <em>script</em> de configuració que ens faran preguntes sobre les opcions necessitades. Per executar l’<em>script</em> escrivim en una consola:
</p>
<pre class="code">gzip -d /usr/share/doc/smbldap-tools/configure.pl.gz
perl /usr/share/doc/smbldap-tools/configure.pl</pre>

<p>
<strong>8.</strong> Ens demanarà on està localitzat el fitxer de configuració del samba; deixem l’opció per defecte (<code>/etc/samba/smb.conf</code>), prement retorn.
</p>

<p>
<strong>9.</strong> Ens demanarà on és el directori on hi ha la configuració per defecte de samba-ldap; també deixem l’opció per defecte (<code>/etc/smbldap-tools/</code>).
</p>

<p>
<strong>10.</strong> Tot seguit ens demanarà el nom del grup de treball o domini al qual s’ha de connectar samba; escrivim <strong>meudomini</strong>.
</p>

<p>
<strong>11.</strong> Després ens preguntarà el nom NetBIOS del controlador SAMBA (el mateix que el servidor LDAP): <strong>alumne-desktop</strong>.
</p>

<p>
<strong>12.</strong> Nom de la unitat de xarxa que assignarem als clients; per defecte, la unitat H:. 
</p>

<p>
<strong>13.</strong> Després ens demanarà el directori personal de l’usuari un cop aquest iniciï sessió; deixem l’opció per defecte (<strong>meudomini\nom_usuari</strong>), on <strong>nom_usuari</strong> és el nom d’usuari amb què hem iniciat la sessió.
</p>

<p>
<strong>14.</strong> També ens demanarà el directori on s’emmagatzemen els perfils d’usuari (<strong>meudomini.org\profiles\nom_usuari</strong>).
</p>

<p>
<strong>15.</strong> Prefix del directori de l’usuari; deixem l’opció per defecte (<code>/home/nom_usuari</code>).
</p>

<p>
<strong>16.</strong> Permisos per defecte del directori personal de l’usuari; per defecte és 700 (lectura, escriptura, execució per l’usuari, cap permís per als altres usuaris).
</p>

<p>
<strong>17.</strong> Nom per defecte de l’<em>script</em> inicial de l’usuari; ho podem deixar a l’opció per defecte: (<strong>nom_usuari</strong>).
</p>

<p>
<strong>18.</strong> Temps de validació de contrasenya: 45 dies, que és l’opció per defecte.
</p>

<p>
<strong>19.</strong> Sufix LDAP; farem servir l’extensió (<strong>.org</strong>).
</p>

<p>
<strong>20.</strong> Sufix de grup LDAP; podem posar, per exemple, usuaris.
</p>

<p>
<strong>21.</strong> Sufix de l’usuari LDAP; el podem deixar buit.
</p>

<p>
<strong>22.</strong> Sufix de la màquina LDAP; el deixem buit.
</p>

<p>
<strong>23.</strong> Sufix Idmap; deixem l’opció per defecte (<strong>ou=Idmap</strong>).
</p>

<p>
<strong>24.</strong> Lloc on volem desar l’identificador d’usuari i l’identificador de grup pels nous usuaris i grups; deixem l’opció per defecte.
</p>

<p>
<strong>25.</strong> Nom o adreça IP del servidor LDAP; podem escriure 127.0.0.1.
</p>

<p>
<strong>26.</strong> Port per defecte de LDAP; deixem l’opció per defecte (389).
</p>

<p>
<strong>27.</strong> Nom distingit de l’usuari admin (<strong>cn=admin,dc=meudomini,dc=org</strong>). 
</p>

<p>
<strong>28.</strong> Contrasenya de l’usuari admin de LDAP.
</p>

<p>
<strong>29.</strong> Servidor LDAP esclau; ho deixem en blanc, com la resta d’opcions que fan referència a aquest servidor esclau.
</p>

<p>
<strong>30.</strong> Suport de TLS (connexions encriptades). Si està activat TLS escollim 1; si no, escollim 0.
</p>

<p>
<strong>31.</strong> Identificador del grup de treball (SID); el podem obtenir amb l’ordre <strong>net getlocalsid alumne-desktop</strong>.
</p>

<p>
<strong>32.</strong> Forma d’encriptació de les contrasenyes unix; escollim l’opció per defecte (SSHA).
</p>

<p>
<strong>33.</strong> Després pregunta l’identificador d’usuari, de grup, intèrpret d’ordres i directori amb el perfil d’usuari per defecte; deixem les opcions per defecte.
</p>

<p>
<strong>34.</strong> Finalment escollim l’extensió del correu del domini (<strong>meudomini.org</strong>).
</p>

<p>
Un cop haurem contestat totes les preguntes, s’han d’haver creat dos fitxers: <code>/etc/smbldap-tools/smbldap.conf</code> i <code>/etc/smbldap-tools/smbldap_bind.conf</code>. L’<em>script</em> de configuració ha generat aquests fitxers; per tant, si ens hem equivocat en alguna de les respostes, els podem editar directament, o podem tornar a executar l’<em>script</em> (fitxer per lots).
</p>

<p>
<strong>35.</strong> Ara haurem d’executar l’<em>script</em> anomenat <strong>smbldap-populate</strong> que afegirà els usuaris i grups necessaris que Samba requereix. És recomanable fer una còpia de seguretat del fitxer ldif (<em>LDAP data interchange format</em>), amb l’eina <em>slapcat before</em> executant l’ordre següent:
</p>
<pre class="code">slapcat -l backup.ldif</pre>

<p>
<strong>36.</strong> Un cop hem fet la còpia de seguretat, executem l’<em>script</em>:
</p>
<pre class="code">smbldap-populate</pre>

<p>
Cal tenir en compte que podem crear un fitxer LDIF que contingui els nous objectes de Samba executant l’ordre <strong>smbldap-populate -e samba.ldif</strong>. Això ens permet mirar els canvis que aplicarem al sistema i assegurar-nos que tot està bé. Si hem seguit tots aquests passos, el directori LDAP tindrà tota la informació necessària per autenticar usuaris SAMBA.
</p>

<p>
Hi ha diverses maneres de configurar Samba, però per configurar Samba perquè faci servir LDAP hem d’editar el fitxer de configuració principal de Samba <code>/etc/samba/smb.conf</code>, comentant l’opció <strong>passdb backend</strong> i afegint-hi les línies següents:
</p>
<pre class="code">#   passdb backend = tdbsam

# LDAP Settings
passdb backend = ldapsam:ldap://ubuntu-server
ldap suffix = dc=meudomini,dc=org
ldap user suffix = ou=People
ldap group suffix = ou=Groups
ldap machine suffix = ou=Computers
ldap idmap suffix = ou=Idmap
ldap admin dn = cn=admin,dc=meudomini,dc=org
ldap ssl = start tls
ldap passwd sync = yes
...
add machine script = sudo /usr/sbin/smbldap-useradd -t 0 -w &quot;%u&quot;</pre>

<p>
<strong>37.</strong> Reiniciem el servei samba per aplicar els nous canvis:
</p>
<pre class="code">restart smbd
restart nmbd</pre>

<p>
<strong>38.</strong> Ara cal que Samba conegui la contrasenya d’administrador de LDAP; escrivim des d’un terminal:
</p>
<div class="iocnote"><div class="ioccontent">
<p>
El servei nmbd serveix per proveir serveis de resolució de noms de NetBIOS fent servir el protocol IP.
</p>
</div></div><pre class="code">smbpasswd -w 123456</pre>

<p>
<strong>39.</strong> Hem de reemplaçar 123456 amb la contrasenya d’administrador de l’LDAP. Si tenim usuaris LDAP i volem que s’autentiquin usant Samba, hem de definir un seguit d’atributs en el fitxer <code>samba.schema</code>. Afegim els atributs Samba als usuaris existents emprant la utilitat <strong>smbpasswd</strong>, reemplaçant nom_usuari pel nom d’usuari real, i escrivint la seva contrasenya:
</p>
<pre class="code">smbpasswd -a nom_usuari</pre>

<p>
<strong>40.</strong> Per afegir un nou usuari, grup i compte de màquina, hem de fer servir les utilitats que conté el paquet <strong>smbldap-tools</strong>. Per afegir un usuari al directori LDAP amb atributs Samba, escrivim el següent, reemplaçant nom_usuari amb el nom d’usuari real:
</p>
<pre class="code">smbldap-useradd -a -P nom_usuari</pre>

<p>
L’opció -a afegeix els atributs Samba, i l’opció -P permet entrar la contrasenya per l’usuari un cop s’ha creat.
</p>

<p>
<strong>41.</strong> Si volem eliminar un usuari del directori LDAP, escrivim:
</p>
<pre class="code">smbldap-userdel username</pre>

<p>
Si fem servir l’opció -r amb aquesta ordre, podem eliminar el directori personal de l’usuari.
</p>

<p>
<strong>42.</strong> Podem fer servir la utilitat <strong>smbldap-groupadd</strong> per afegir un nou grup d’usuaris, reemplaçant nom_grup amb el nom de grup que vulguem:
</p>
<pre class="code">smbldap-groupadd -a nom_grup</pre>

<p>
Igual que en el cas de la utilitat <strong>smbldap-useradd</strong>, l’opció -a afegeix els atributs Samba.
</p>

<p>
<strong>43.</strong> Per afegir un usuari a un grup, utilitzem <strong>smbldap-groupmod</strong>:
</p>
<pre class="code">smbldap-groupmod -m nom_usuari nom_grup</pre>

<p>
Hem de reemplaçar el nom_usuari amb el nom d’usuari real, i nom_grup amb el nom del grup real. L’opció -m permet afegir més d’un usuari al mateix temps, separant-los per comes.
</p>

<p>
<strong>44.</strong> Per eliminar un usuari d’un grup també podem utilitzar <strong>smbldap-groupmod</strong>:
</p>
<pre class="code">smbldap-groupmod -x username groupname</pre>

<p>
<strong>45.</strong> Finalment, la utilitat <strong>mbldap-useradd</strong> permet afegir comptes d’equips Samba:
</p>
<pre class="code">smbldap-useradd -t 0 -w username</pre>

</div>

<h4><a id="configuracio_de_samba_perque_faci_de_controlador_de_domini" >Configuració de SAMBA perquè faci de controlador de domini</a></h4>
<div class="level4">

<p>
Malgrat tots els passos que hem dut a terme per configurar l’OpenLDAP, encara ens fa falta instal·lar alguns paquets perquè Samba esdevingui un controlador de domini.
</p>

<p>

</p>

<p>
<strong>1.</strong> Instal·lem el paquet <strong>libpam-smbpass</strong>:
</p>
<pre class="code">apt-get install samba libpam-smbpass</pre>

<p>
<strong>2.</strong> Després configurem Samba editant el fitxer <code>/etc/samba/smb.conf</code>. El mode de seguretat s’hauria d’inicialitzar a user i el grup de treball s’hauria de relacionar amb l’organització:
</p>
<pre class="code">workgroup = meudomini
   ...
security = user</pre>

<p>
<strong>3.</strong> En la secció comentada “Domains” afegim el següent:
</p>
<pre class="code">domain logons = yes
logon path = \%N\%U\profile
logon drive = H:
logon home = \%N\%U
logon script = logon.cmd
add machine script = sudo /usr/sbin/useradd -N -g machines -c Machine -d /var/lib/samba -s /bin/false %u</pre>

<p>
Vegem el significat de totes aquestes línies a la <span class="tabref"><a href="#Table5"><span>taula</span></a></span>.
</p>
<div class="ioctable ">
<div class="titletable"><a name="Table5"><span>Taula: </span></a>Opcions de configuració del fitxer /etc/samba/smb.conf</div>
<div class="table"><table class="inline">
	<tr class="row0">
		<th class="col0"> Opció </th><th class="col1"> Significat </th>
	</tr>
	<tr class="row1">
		<td class="col0"> domain logons </td><td class="col1"> Proveeix el servei <strong>netlogon</strong> per tal que Samba actuï com un controlador de domini. </td>
	</tr>
	<tr class="row2">
		<td class="col0"> logon path </td><td class="col1"> Posa el perfil de Windows en el directori personal de l’usuari. També és possible configurar un directori compartit que contingui tots els perfils en un sol directori. </td>
	</tr>
	<tr class="row3">
		<td class="col0"> logon drive </td><td class="col1"> Especifica la ruta local del directori personal. </td>
	</tr>
	<tr class="row4">
		<td class="col0"> logon home </td><td class="col1"> Especifica la localització del directori personal. </td>
	</tr>
	<tr class="row5">
		<td class="col0"> logon script </td><td class="col1"> Determina el fitxer per lots (<em>script</em>), que s’ha d’executar localment un cop l’usuari ha iniciat sessió. Cal que aquest <em>script</em> se situï en el directori compartit especificat per [netlogon]. </td>
	</tr>
	<tr class="row6">
		<td class="col0"> add machine script </td><td class="col1"> Un fitxer per lots (<em>script</em>), que crearà automàticament el compte de màquina confiable, per tal que una estació de treball s’uneixi al domini </td>
	</tr>
</table></div>
</div>
<p>
<strong>4.</strong> Cal que el grup de màquines s’hagi creat fent servir la utilitat <strong>addgroup</strong>. A més a més, cal donar permisos de manera explícita al grup d’administradors del domini per permetre que l’<em>script</em> d’afegir màquina funcioni. Això es pot aconseguir executant:
</p>
<pre class="code">net rpc rights grant &quot;EXAMPLE\Domain Admins&quot; SeMachineAccountPrivilege SePrintOperatorPrivilege \
SeAddUsersPrivilege SeDiskOperatorPrivilege SeRemoteShutdownPrivilege</pre>

<p>
Val a dir que això crea per defecte perfils mòbils; és a dir, independentment de la màquina des de la qual l’usuari s’autentica, es carregarà el perfil des del servidor.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Perfils mòbils Windows</p>
<p>
Els perfils mòbils en sistemes Windows permeten personalitzar l’escriptori, canviant el fons, l’aspecte de les finestres i els programes disponibles per a cada estació.
</p>
</div></div>
<p>
Per tal de carregar un determinat perfil mòbil de Windows a un usuari quan aquest iniciï la sessió, de primer creem aquest perfil localment i, un cop fet això, copiem la carpeta personal de l’usuari (dins de <em>Documents and settings</em> en el cas de Windows XP, i dins de <em>Users</em> en el cas de Vista i 7), al directori del servidor especificat per la línia <strong>logon path</strong> del fitxer de configuració del SAMBA.
</p>
<div class="ioctextl"><div class="ioccontent"><p class="ioctitle">PDC</p>
<p>
El terme <em>PDC</em> és un acrònim de l’anglès que significa &#039;<em>primary domain controller</em>’ (‘controlador de domini primari’); és en una xarxa d’ordinadors, l’ordinador que fa de servidor de domini. El PDC pot ser un ordinador que funcioni amb Windows Server i Active Directory, o bé amb una distribució de GNU/Linux i OpenLDAP.
</p>
</div></div>
</div>

<h3><a id="carpetes_personals" >Carpetes personals</a></h3>
<div class="level3">

<p>
Per tal que els usuaris puguin accedir a les carpetes personals, hem d’editar el fitxer <code>/etc/smb/smb.conf</code> i descomentar les línies sota la secció [homes]:
</p>
<pre class="code">   [homes]
   comment = Home Directories
   browseable = no
   read only = no
   create mask = 0700
   directory mask = 0700
   valid users = %S</pre>

<p>
Com que hem configurat el servidor com un servidor de domini, hem de configurar la compartició de [netlogon]. Per tal d’habilitar-ho, descomentem:
</p>
<pre class="code">   [netlogon]
   comment = Network Logon Service
   path = /srv/samba/netlogon
   guest ok = yes
   read only = yes
   share modes = no</pre>

<p>
Cal dir que el camí on inicialment es comparteixen tots els fitxers d’inici de sessió (<em>netlogon</em>), és <code>/home/samba/netlogon</code>, però segons l’estàndard de jerarquia del sistema de fitxers (FHS), el directori <code>/srv</code> és la localització correcta.
</p>

<p>
També haurem de crear el directori <em>netlogon</em>, i un fitxer per lots anomenat <code>logon.cmd</code>, que de moment estarà buit:
</p>
<pre class="code">   mkdir -p /srv/samba/netlogon
   touch /srv/samba/netlogon/logon.cmd</pre>

<p>
Podem utilitzar qualsevol instrucció de Windows en el fitxer per lots d’inici de sessió <strong>per tal de configurar l’entorn del client</strong>.
</p>

<p>
Com que, per defecte, l’usuari <strong>root</strong> està deshabilitat, per tal que una estació de treball s’uneixi al domini cal crear un grup de sistema que es correspondrà amb un grup d’administradors del domini de Windows. Farem servir la utilitat <strong>net</strong> des d’un terminal executant el següent:
</p>
<pre class="code">   net groupmap add ntgroup=&quot;Domain Admins&quot; unixgroup=sysadmin rid=512 type=d</pre>

<p>
S’ha de canviar <strong>sysadmin</strong> per qualsevol nom de grup que vulguem. A més a més, l’usuari que s’ha d’unir al domini ha de formar part del grup <strong>sysadmin</strong>, a més de ser un membre del grup d’administradors del sistema. Els grups d’administrador permeten la utilització de <strong>sudo</strong>.
</p>

<p>
Per acabar, cal reiniciar el servei Samba per habilitar el nou controlador de domini:
</p>
<pre class="code">   restart smbd
   restart nmbd</pre>

<p>
D’aquesta manera, podrem afegir clients Windows al domini, com ho faríem si tinguéssim un servidor de Windows NT.
</p>

</div>

<h3><a id="plantilles_d_usuari" >Plantilles d&#039;usuari</a></h3>
<div class="level3">

<p>
A l’hora de crear un usuari del domini podem utilitzar plantilles diferents. Si per gestionar els usuaris utilitzem phpLDAPadmin, ens adonarem que disposa de tot un seguit de plantilles que ens faciliten aquesta tasca. Podem observar les diverses plantilles per a la creació d’objectes en el domini LDAP en la <span class="figref"><a href="#Figure9"><span>figura</span></a></span>. D’entre totes aquestes plantilles, no totes serveixen per crear usuaris del sistema; podem utilitzar les que detallem en la <span class="tabref"><a href="#Table6"><span>taula</span></a></span>.
</p>
<div class="ioctable ">
<div class="titletable"><a name="Table6"><span>Taula: </span></a>Plantilles utilitzables per a la creació d’usuaris</div>
<div class="table"><table class="inline">
	<tr class="row0">
		<th class="col0"> Tipus de plantilla </th><th class="col1"> Significat </th>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign"> Generic: User Account  </td><td class="col1"> Compte genèric de creació d’usuaris </td>
	</tr>
	<tr class="row2">
		<td class="col0"> Samba: Account </td><td class="col1"> La podem utilitzar si hem integrat Samba amb LDAP, de manera que els usuaris creats amb Samba són usuaris del domini. </td>
	</tr>
	<tr class="row3">
		<td class="col0"> Default </td><td class="col1"> Plantilla de creació d’objectes LDAP per defecte; serveix també per a usuaris </td>
	</tr>
	<tr class="row4">
		<td class="col0"> Courier Mail: Account </td><td class="col1"> Compte de correu electrònic, no serveix perquè un usuari iniciï la sessió interactiva en el sistema </td>
	</tr>
</table></div>
</div>
<p>
Totes les plantilles que presenta phpLDAPadmin estan emmagatzemades en el subdirectori <code>/usr/share/phpldapadmin/templates/</code>. Aquestes plantilles són un conjunt de fitxers xml, on els nodes pare són les característiques, paràmetres i atributs. Vegem, per exemple, el fitxer xml que s’utilitza per crear un compte d’usuari LDAP (<code>posixAccount.xml</code>):
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">XML</p>
<p>
XML és un acrònim anglès que significa <em>eXtensible Markup Language</em>; és a dir, llenguatge de marques extensible. És un llenguatge d’etiquetes, desenvolupat pel World Wide Web Consortium (<acronym title="World Wide Web Consortium">W3C</acronym>), que prové de la simplificació i adaptació de l’experimentat SGML, i permet definir la gramàtica de llenguatges específics (de la mateixa manera que <acronym title="HyperText Markup Language">HTML</acronym> és, alhora, un llenguatge definit per SGML).
</p>
</div></div><pre class="code">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;!DOCTYPE template SYSTEM &quot;template.dtd&quot;&gt;

&lt;template&gt;
&lt;askcontainer&gt;1&lt;/askcontainer&gt;
&lt;description&gt;New User Account&lt;/description&gt;
&lt;icon&gt;ldap-user.png&lt;/icon&gt;
&lt;invalid&gt;0&lt;/invalid&gt;
&lt;rdn&gt;cn&lt;/rdn&gt;
&lt;!--&lt;regexp&gt;^ou=People,o=.*,&lt;/regexp&gt;--&gt;
&lt;title&gt;Generic: User Account&lt;/title&gt;
&lt;visible&gt;1&lt;/visible&gt;

&lt;objectClasses&gt;
&lt;objectClass id=&quot;inetOrgPerson&quot;&gt;&lt;/objectClass&gt;
&lt;objectClass id=&quot;posixAccount&quot;&gt;&lt;/objectClass&gt;
&lt;/objectClasses&gt;

&lt;attributes&gt;
&lt;attribute id=&quot;givenName&quot;&gt;
    &lt;display&gt;First name&lt;/display&gt;
    &lt;icon&gt;ldap-uid.png&lt;/icon&gt;
    &lt;onchange&gt;=autoFill(cn;%givenName% %sn%)&lt;/onchange&gt;
    &lt;onchange&gt;=autoFill(uid;%givenName|0-1/l%%sn/l%)&lt;/onchange&gt;
    &lt;order&gt;1&lt;/order&gt;
    &lt;page&gt;1&lt;/page&gt;
&lt;/attribute&gt;
&lt;attribute id=&quot;sn&quot;&gt;
    &lt;display&gt;Last name&lt;/display&gt;
    &lt;onchange&gt;=autoFill(cn;%givenName% %sn%)&lt;/onchange&gt;
    &lt;onchange&gt;=autoFill(uid;%givenName|0-1/l%%sn/l%)&lt;/onchange&gt;
    &lt;!-- &lt;onchange&gt;=autoFill(homeDirectory;/home/users/%uid|0-1/l%/%uid%)&lt;/onchange&gt; --&gt;
    &lt;order&gt;2&lt;/order&gt;
    &lt;page&gt;1&lt;/page&gt;
&lt;/attribute&gt;
&lt;attribute id=&quot;cn&quot;&gt;
    &lt;display&gt;Common Name&lt;/display&gt;
    &lt;order&gt;3&lt;/order&gt;
    &lt;page&gt;1&lt;/page&gt;
&lt;/attribute&gt;
&lt;attribute id=&quot;uid&quot;&gt;
    &lt;display&gt;User ID&lt;/display&gt;
    &lt;onchange&gt;=autoFill(homeDirectory;/home/users/%uid%)&lt;/onchange&gt;
    &lt;order&gt;4&lt;/order&gt;
    &lt;page&gt;1&lt;/page&gt;
    &lt;spacer&gt;1&lt;/spacer&gt;
&lt;/attribute&gt;
&lt;attribute id=&quot;homeDirectory&quot;&gt;
    &lt;display&gt;Home directory&lt;/display&gt;
    &lt;!-- &lt;onchange&gt;=autoFill(homeDirectory;/home/users/%gidNumber|0-0/T%/%uid|3-%)&lt;/onchange&gt; --&gt;
    &lt;order&gt;8&lt;/order&gt;
    &lt;page&gt;1&lt;/page&gt;
&lt;/attribute&gt;
&lt;attribute id=&quot;uidNumber&quot;&gt;
    &lt;display&gt;UID Number&lt;/display&gt;
    &lt;icon&gt;terminal.png&lt;/icon&gt;
    &lt;order&gt;6&lt;/order&gt;
    &lt;page&gt;1&lt;/page&gt;
    &lt;readonly&gt;1&lt;/readonly&gt;
    &lt;value&gt;=php.GetNextNumber(/;uidNumber)&lt;/value&gt;
&lt;/attribute&gt;
&lt;attribute id=&quot;gidNumber&quot;&gt;
    &lt;display&gt;GID Number&lt;/display&gt;
    &lt;!-- &lt;onchange&gt;=autoFill(homeDirectory;/home/users/%gidNumber|0-0/T%/%uid|3-%)&lt;/onchange&gt; --&gt;
    &lt;order&gt;7&lt;/order&gt;
    &lt;page&gt;1&lt;/page&gt;
    &lt;value&gt;&lt;![CDATA[=php.PickList(/;(&amp;(objectClass=posixGroup));gidNumber;%cn%;;;;cn)]]&gt;&lt;/value&gt;
&lt;/attribute&gt;
&lt;attribute id=&quot;loginShell&quot;&gt;
    &lt;display&gt;Login shell&lt;/display&gt;
    &lt;order&gt;9&lt;/order&gt;
    &lt;page&gt;1&lt;/page&gt;
    &lt;!-- &lt;value&gt;&lt;![CDATA[=php.PickList(/;(&amp;(objectClass=posixAccount));loginShell;%loginShell%;;;;loginShell)]]&gt;&lt;/value&gt; --&gt;
    &lt;type&gt;select&lt;/type&gt;
    &lt;value id=&quot;/bin/sh&quot;&gt;/bin/sh&lt;/value&gt;
    &lt;value id=&quot;/bin/csh&quot;&gt;/bin/csh&lt;/value&gt;
    &lt;value id=&quot;/bin/tsh&quot;&gt;/bin/tsh&lt;/value&gt;
&lt;/attribute&gt;
&lt;attribute id=&quot;userPassword&quot;&gt;
    &lt;display&gt;Password&lt;/display&gt;
    &lt;!-- &lt;helper&gt;
        &lt;display&gt;Encryption&lt;/display&gt;
        &lt;id&gt;enc&lt;/id&gt;
        &lt;value&gt;=php.PasswordEncryptionTypes()&lt;/value&gt;
    &lt;/helper&gt; --&gt;
    &lt;icon&gt;lock.png&lt;/icon&gt;
    &lt;order&gt;5&lt;/order&gt;
    &lt;page&gt;1&lt;/page&gt;
    &lt;post&gt;=php.PasswordEncrypt(%enc%;%userPassword%)&lt;/post&gt;
    &lt;spacer&gt;1&lt;/spacer&gt;
    &lt;verify&gt;1&lt;/verify&gt;
&lt;/attribute&gt;
&lt;/attributes&gt;

&lt;/template&gt;
</pre>

<p>
Podem veure refletit en el codi del fitxer posixAccount.xml cadascun dels camps que hem d’omplir quan creem un usuari utilitzant la plantilla <strong>Generic: User Account</strong>.
</p>

<p>
A més de les plantilles per defecte, podem crear plantilles personalitzades i utilitzar-les en phpLDAPadmin. Per fer això, podem copiar alguna de les plantilles existents, reanomenar-la afegint el prefix <strong>custom_</strong> al nom del fitxer i editant-lo, afegint o eliminant els camps que considerem convenient.
</p>

</div>

<h3><a id="variables_d_entorn" >Variables d&#039;entorn</a></h3>
<div class="level3">

<p>
Les variables d’entorn que afecten els usuaris es poden establir en el fitxer de configuració de samba. Vegem una llista de les variables d’entorn que podem utilitzar per als usuaris que es connecten a un domini LDAP amb SAMBA i el significat corresponent: 
</p>
<ul>
<li class="level1"><div class="li"> %U : Nom d’usuari que ha iniciat la sessió.</div>
</li>
<li class="level1"><div class="li"> %G : Nom del grup primari al qual pertany l’usuari %U.</div>
</li>
<li class="level1"><div class="li"> %h : Nom del node de la xarxa (<em>host name</em>), en el qual s’està executant SAMBA. </div>
</li>
<li class="level1"><div class="li"> %m : Nom netbios de la màquina client.</div>
</li>
<li class="level1"><div class="li"> %L : Nom netbios del servidor.</div>
</li>
<li class="level1"><div class="li"> %M : Nom d’Internet de la màquina client.</div>
</li>
<li class="level1"><div class="li"> %R : Nivell de protocol escollit després de la seva negociació; pot ser CORE, COREPLUS, LANMAN1, LANMAN2 o NT1.</div>
</li>
<li class="level1"><div class="li"> %d : Identificador del procés del servidor. </div>
</li>
<li class="level1"><div class="li"> %a : Arquitectura de la màquina remota: pot ser samba, el sistema de fitxers Linux (CIFS), <acronym title="Operating System">OS</acronym>/2, Windows per a grups de treball (WfWg), Windows 9x/Me (Win95), Windows NT (WintNT), Windows 2000 (Win2K), Windows XP (WinXP), Windows XP 64 bit (WinXP64), Windows 2003 incloent-hi 2003R2 (Win2K3) i Windows Vista (Vista); qualsevol altre s’anomenarà UNKNOWN.</div>
</li>
<li class="level1"><div class="li"> %I : Adreça IP de la màquina client.</div>
</li>
<li class="level1"><div class="li"> %i : Adreça IP local a la qual el client està connectat.</div>
</li>
<li class="level1"><div class="li"> %T : Data i hora actuals.</div>
</li>
<li class="level1"><div class="li"> %D : Nom del domini o grup de treball de l’usuari actual.</div>
</li>
<li class="level1"><div class="li"> %w : El separador <em>winbind</em>.</div>
</li>
<li class="level1"><div class="li"> %$ (envvar) : El valor de la variable d’entorn <strong>envar</strong>. </div>
</li>
<li class="level1"><div class="li"> %$ : El nom del servei actual. </div>
</li>
<li class="level1"><div class="li"> %P : El directori arrel del servei actual. </div>
</li>
<li class="level1"><div class="li"> %u : El nom d’usuari del servei actual. </div>
</li>
<li class="level1"><div class="li"> %g : El nom del grup primari de %u.</div>
</li>
<li class="level1"><div class="li"> %H : El directori personal de l’usuari %u. </div>
</li>
<li class="level1"><div class="li"> %N : El nom del directori personal NIS. </div>
</li>
<li class="level1"><div class="li"> %p : La ruta al directori de l’usuari del servei, obtinguda a partir de l’entrada NIS auto.map. L’entrada NIS auto.map es dividirà com %N:%p. </div>
</li>
</ul>

</div>

<h2><a id="administracio_de_grups_ldap" >Administració de grups LDAP</a></h2>
<div class="level2">

<p>

Els grups són una manera ràpida de donar als usuaris accesos comuns a certes prestacions o funcionalitats dins d’un directori LDAP. L’administració dels grups d’LDAP també es pot dur a terme mitjançant phpLDAPadmin.
</p>

<p>
Ens permet crear un grup nou, modificar-ne els paràmetres i eliminar-lo. També podem assignar usuaris a un grup determinat.
</p>

<p>
En qualsevol cas, per tal de poder crear un grup d’usuaris cal que s’hagi creat prèviament una unitat organitzativa anomenada <strong>Groups</strong>. Si s’acompleix aquest requeriment, podem crear, modificar i eliminar grups d’usuaris en el directori del servidor LDAP.
</p>

<p>
<strong>1. Creació d’un grup d’usuaris </strong> Per tal de crear un nou grup d’usuaris, ens hem de situar a sota de la unitat organitzativa <strong>groups</strong> i clicar a l’enllaç <strong>Create new entry here</strong>. Ens apareixerà la finestra de la <span class="figref"><a href="#Figure20"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figure20"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Creació d’un nou objecte grup d’usuaris

</figcaption><img src="../media/ic10mu7_20.png" alt="" /></figure>
</div>
<p>
Triem l’opció <strong>Generic: Posix Group</strong> i el sistema mostrarà la finestra de la <span class="figref"><a href="#Figure21"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figure21"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Edició dels paràmetres del nou grup

</figcaption><img src="../media/ic10mu7_21.png" alt="" /></figure>
</div>
<p>
Podrem especificar el nom del grup (en el nostre exemple utilitzarem usuaris), i podrem seleccionar quins usuaris volem que pertanyin al nou grup, clicant el botó de selecció corresponent. Un cop fet això, premem el botó <strong>Create object</strong>, i el sistema mostra una pantalla de confirmació de creació del grup d’usuaris, com podeu comprovar en la <span class="figref"><a href="#Figure22"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figure22"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Confirmació de la creació del grup d’usuaris

</figcaption><img src="../media/ic10mu7_22.png" alt="" /></figure>
</div>
<p>
Prement el botó <strong>Commit</strong>, el sistema ens informarà de l’èxit en la creació del nou grup d’usuaris i, a més, podrem comprovar que s’ha creat aquest nou grup d’usuaris perquè apareix l’entrada en l’arbre. Es pot veure en la <span class="figref"><a href="#Figure23"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figure23"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Resultat de la creació del nou grup

</figcaption><img src="../media/ic10mu7_23.png" alt="" /></figure>
</div>
<p>
<strong>2. Modificació dels paràmetres d’un grup</strong>. Per tal de modificar els paràmetres d’un grup d’usuaris que hem creat, només cal seleccionar l’entrada corresponent dins de l’arbre del directori LDAP, com mostra la <span class="figref"><a href="#Figure24"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figure24"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Propietats del grup d’usuaris

</figcaption><img src="../media/ic10mu7_24.png" alt="" /></figure>
</div>
<p>
En aquest apartat podrem modificar el nom del grup d’usuaris i seleccionar quins usuaris volem assignar a aquest grup. Un cop fetes les modificacions pertinents, premem el botó <strong>Update object</strong> per completar els canvis.
</p>

<p>
<strong>3. Eliminació d’un grup d’usuaris</strong>. Per eliminar un grup d’usuaris, seleccionem l’objecte corresponent dins de l’arbre LDAP, i cliquem a l’enllaç <strong>Delete this entry</strong>. Si fem això, el sistema ens demanarà una confirmació, com es mostra en la <span class="figref"><a href="#Figure25"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figure25"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Confirmació eliminació grup d’usuaris

</figcaption><img src="../media/ic10mu7_25.png" alt="" /></figure>
</div>
<p>
Prement el botó <strong>Delete</strong>, el sistema ens informarà de l’eliminació del grup d’usuaris, com veieu en la <span class="figref"><a href="#Figure26"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figure26"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Resultat eliminació grup d’usuaris

</figcaption><img src="../media/ic10mu7_26.png" alt="" /></figure>
</div>
</div>

<h3><a id="tipus" >Tipus</a></h3>
<div class="level3">

<p>
En un domini LDAP, els grups d’usuaris que podem crear segueixen l’estàndard POSIX; per tant, tots els grups que creem són d’aquest tipus. Els grups d’usuaris POSIX són equivalents als grups d’usuaris que es poden crear localment amb qualsevol ordinador que funcioni amb GNU/Linux, i que mitjançant phpLDAPadmin podrem fer correspondre també a grups d’usuaris de LDAP.
</p>

<p>
Dit d’una altra manera, mitjançant phpLDAPadmin, podem crear grups d’usuaris del domini, que es correspondrien a grups d’usuaris locals si utilitzéssim l’eina corresponent per a la gestió d’usuaris de manera local (eina <em>groupadd</em>).
</p>

</div>

<h3><a id="estrategies_d_imbricacio" >Estratègies d&#039;imbricació</a></h3>
<div class="level3">

<p>
Entenem el concepte d’imbricació d’una manera general com la inclusió d’una estructura dins una altra de tipus semblant. En particular, inclusió d’una subrutina (o bloc d’instruccions) dins d’una altra. En el cas d’un domini, la imbricació pot fer referència a la inclusió d’un usuari dins d’un grup o unitat organitzativa, la inclusió d’usuaris dins d’un grup o, fins i tot, la creació d’un subdomini dins del domini principal.
</p>

<p>
Les estratègies d’imbricació s’han de tenir en compte a l’hora de crear aquest mateix domini, i són un conjunt de regles que serveixen per fer un bon disseny d’aquest domini i, per tant, podem pensar que és un requeriment a l’hora d’implementar-lo. 
</p>

<p>
Per definir el domini cal tenir en compte que, com a mínim, s’han de crear dues unitats organitzatives: l’una contindrà tots els grups d’usuaris (ou=groups), i l’altra, tots els usuaris del domini (ou=people). 
</p>
<div class="iocfigure"><a name="Figure27"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Assignació d’usuaris a un grup

</figcaption><img src="../media/ic10mu7_27.png" alt="" /></figure>
</div>
<p>
Per tant, en primer lloc haurem de pensar quins grups d’usuari volem definir dins del nostre domini i els haurem de crear dins de la unitat organitzativa <em>groups</em>. En cap cas hi ha la possibilitat de crear un grup dins d’un altre; tots els grups són “fills” d’aquesta unitat organitzativa.
</p>

<p>
Un cop fet això, afegirem tots els usuaris dins de la unitat organitzativa <em>people</em>. Tots els usuaris han de ser “fills” d’aquesta unitat organitzativa.
</p>

<p>
Finalment, caldrà establir la relació entre els usuaris i els grups als quals pertanyen. Això ho podem fer, des del mateix phpLDAPadmin, obrint l’enllaç corresponent, i seleccionant els usuaris que volem que pertanyin al grup. Ho podeu veure en la <span class="figref"><a href="#Figure27"><span>figura</span></a></span>.
</p>

</div>

<h3><a id="grups_predeterminats" >Grups predeterminats</a></h3>
<div class="level3">

<p>
A l’hora de crear un domini no hi ha cap grup predeterminat, si bé és cert que com a mínim s’ha de crear l’usuari admin, aquest no pertany a cap grup en concret i, per tant, la definició dels grups (sempre sota la unitat organitzativa <em>people</em>) és lliure i depèn del criteri de l’administrador del domini.
En qualsevol cas, és aconsellable agrupar els usuaris segons els departaments, o tipus d’usuaris, per facilitar-ne la gestió.
</p>

</div>

	 </article>
     <div class="pnpage">
      <div class="left-corner"></div>
      <div id="prevpage">Anar a la p&agrave;gina anterior:<br /><a href="../../../WebContent/u7/a1/exercicis.html">Exercicis d'autoavaluació</a></div>
      <div id="nextpage">Anar a la p&agrave;gina seg&uuml;ent:<br /><a href="../../../WebContent/u7/a2/activitats.html">Activitats</a></div>
      <div class="right-corner"></div>
     </div>
    </div>
    <footer class="footer">
      <div><small>Aquest document està subjecte a una llicència oberta de Creative Commons, es reserva el dret de reconeixement de l'autoria, d'exigir que no se'n faci cap mena d'ús comercial. Si altereu o transformeu aquesta obra, o en genereu obres derivades, només podeu distribuir l'obra generada amb una llicència idèntica a aquesta.</small></div>
    </footer>
 </div>
 <div id="back_preview" class="hidden"></div>
 <div id="preview" class="hidden">
  <div class="prevcontent"></div>
 </div>
 <div id="help-tooltips">
  <div id="help-toc" class="hidden tooltip"><span>Taula de continguts:</span> Ofereix una vista general de l&#39;estructura del m&ograve;dul, que us facilitar&agrave; la navegaci&oacute; a trav&eacute;s dels seus continguts.<span class="arrow-left"></span></div> 
  <div id="help-settings" class="hidden tooltip"><span>Opcions de format:</span> Permet configurar el format de lectura a partir de les vostres prefer&egrave;ncies, modificant la mida de la lletra, el color del fons, l&#39;amplada de la p&agrave;gina o l&#39;ocultaci&oacute; dels continguts complementaris, entre d&#39;altres.<span class="arrow-left"></span></div>
  <div id="help-printer" class="hidden tooltip"><span>Imprimir:</span>  Envia el contingut seleccionat a la impressora.<span class="arrow-left"></span></div>
  <div id="help-favorites" class="hidden tooltip"><span>Prefereits:</span> Permet desar aquelles parts del contingut a les que us interessi accedir en un moment posterior; us permetr&agrave; anar creant un repositori personalitzat de les seccions que considereu m&eacute;s rellevants. Un cop l&#39;hageu començat a fer servir se us mostrar&agrave; a sota un comptador que us informar&agrave; del nombre de preferits que s&#39;hagin emmagatzemat fins al moment.<span class="arrow-left"></span></div>
  <div id="help-favcounter" class="hidden tooltip"><span>Comptador i llistat de preferits:</span> Indica el nombre de preferits que s&#39;han desat fins el moment; clicant damunt seu accedireu al llistat de preferits, i a trav&eacute;s d&#39;aquest podreu accedir directament als continguts que hageu emmagatzemat.<span class="arrow-left"></span></div>
  <div id="help-help_icon" class="hidden tooltip"><span>Ajuda:</span> Aquesta opci&oacute; activa la informaci&oacute; de les funcionalitats del web tot situant el punter del ratol&iacute; al damunt dels diferents &iacute;tems.<span class="arrow-left"></span></div>
  <div id="help-sidebar-hide" class="hidden tooltip"><span>Mostrar/Ocultar barra lateral:</span>  Deshabilita la barra d&#39;opcions, permetent la seva recuperaci&oacute; quan es desitgi.<span class="arrow-left"></span></div>
  <div id="help-search" class="hidden tooltip"><span>Cerca:</span>  Introdu&iuml;u les paraules clau sobre aquells conceptes que desitgeu localitzar en els continguts del m&ograve;dul. Tamb&eacute; podeu excloure un terme de la cerca tot afegint-hi el signe &#8220;-&#8221; al davant.<span class="arrow-top"></span></div>
  <div id="help-header" class="hidden tooltip"><span>Cap&ccedil;alera:</span>  Indica l&#39;apartat o secci&oacute; que es mostra en pantalla. Tingueu present que les capçaleres de segon, tercer i quart nivell tamb&eacute; es poden desar com a marcadors.<span class="arrow-left"></span></div>
</div> 
</body>
</html>
