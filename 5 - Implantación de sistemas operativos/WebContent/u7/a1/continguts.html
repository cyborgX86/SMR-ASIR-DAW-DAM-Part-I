<!doctype html>

<!--[if lt IE 7 ]> <html class="ie ie6 no-js" lang="ca"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie ie7 no-js" lang="ca"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie ie8 no-js" lang="ca"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie ie9 no-js" lang="ca"> <![endif]-->
<!--[if gt IE 9]><!--><html class="no-js" lang="ca"><!--<![endif]-->
<!-- the "no-js" class is for Modernizr. -->

<head id="www-sitename-com" data-template-set="html5-reset">

	<meta charset="utf-8">
	
	<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title>Implantació de sistemes operatius (ASIX)\ Sistemes informàtics (DAM i DAW)</title>
	
<!-- <meta name="title" content=""> --> 
	<meta name="description" content="">
	<!-- Google will often use this as its description of your page/site. Make it good. -->
	
	<meta name="google-site-verification" content="">
	<!-- Speaking of Google, don't forget to set your site up: http://google.com/webmasters -->
	
	<meta name="author" content="Institut Obert de Catalunya">
	<meta name="Copyright" content="Copyright Institut Obert de Catalunya 2011. All Rights Reserved.">

	<!-- Dublin Core Metadata : http://dublincore.org/ -->
	<meta name="DC.title" content="Implantació de sistemes operatius (ASIX)\ Sistemes informàtics (DAM i DAW)">
	<meta name="DC.subject" content="Informàtica i comunicacions">
	<meta name="DC.creator" content="Institut Obert de Catalunya">
	
	<!--  Mobile Viewport Fix
	j.mp/mobileviewport & davidbcalhoun.com/2010/viewport-metatag 
	device-width : Occupy full width of the screen in its current orientation
	initial-scale = 1.0 retains dimensions instead of zooming out if page height > device height
	maximum-scale = 1.0 retains dimensions instead of zooming in if page width < device width
	-->
	<!-- Uncomment to use � use thoughtfully!
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
	-->

	<link rel="shortcut icon" href="../../../img/favicon.ico">
	<!-- This is the traditional favicon.
		 - size: 16x16 or 32x32
		 - transparency is OK
		 - see wikipedia for info on browser support: http://mky.be/favicon/ -->
		 
	<link rel="apple-touch-icon" href="../../../img/apple-touch-icon.png">
	<!-- The is the icon for iOS's Web Clip.
		 - size: 57x57 for older iPhones, 72x72 for iPads, 114x114 for iPhone4's retina display (IMHO, just go ahead and use the biggest one)
		 - To prevent iOS from applying its styles to the icon name it thusly: apple-touch-icon-precomposed.png
		 - Transparency is not recommended (iOS will put a black BG behind the icon) -->
	
	<!-- CSS: screen, mobile & print are all in the same file -->
	<link rel="stylesheet" href="../../../_/css/style.css">

	<!-- CSS: jQuery UI -->
	<link rel="stylesheet" href="../../../_/css/jquery-ui.css">
	
	<!-- all our JS is at the bottom of the page, except for Modernizr. -->
	<script src="../../../_/js/modernizr-1.7.min.js"></script>
	<script src="../../../_/js/Hyphenator.js" type="text/javascript"></script>
	<script type="text/javascript">
	   Hyphenator.config({
		minwordlength : 4
	   });
	   Hyphenator.run();
	</script>
    <script src="../../../_/js/build.js" type="text/javascript"></script>
</head>

<body class="style-newspaper">

<div class="wrapper"><!-- not needed? up to you: http://camendesign.com/code/developpeurs_sans_frontieres -->

	<header id="header">
		<div class="head"><a href="http://ioc.gencat.cat"><img src="../../../img/logo.png" alt="Institut Obert de Catalunya"/></a><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/es/deed.ca"><img src="../../../img/license.png" alt="Llic&egrave;ncia" class="license"/></a></div>
		<div class="headdocument"><a href="../../../index.html">Implantació de sistemes operatius (ASIX)\ Sistemes informàtics (DAM i DAW)</a></div>
        <div id="search" class="search" name="search">
         <form id="frmsearch" action="../../../search.html" method="get">
          <input type="text" name="q"/>
        </form>
        </div>
	</header>
   <div id="upbutton" class="upbutton" style="display:none;"><img src="../../../img/uparrow.png" alt="Pujar a l'inici de p&agrave;gina"/></div>
   <aside id="aside">
    <div id="menu">
      <ul>
       <li name="toc"><div><img src="../../../img/toc.png" alt="&Iacute;ndex"/></div></li>
       <li name="settings"><div><img src="../../../img/settings.png" alt="Configuraci&oacute;"/></div></li>
       <li name="printer"><div><img src="../../../img/printer.png" alt="Imprimir"/></div></li>
       <li name="favorites"><div><img src="../../../img/favorites.png" alt="Favorits"/></div></li>
       <li name="help_icon" class="help_icon"><div><img src="../../../img/help_icon.png" alt="Ajuda"/></div></li>
      </ul>
     </div>
   </aside>
   <div id="sidebar-hide" name="sidebar-hide"><img src="../../../img/arrows.png"/></div>
   <section>
     <div id="toc" class="hidden">
      <div class="menucontent">
        <ul>
        <li id="u8" class="parentnode"><p><a class="unit" href="../../../WebContent/u8/introduccio.html">8. Administració de l'accés al domini</a></p><ul class="expander"><li id="u8introduccio"><a href="../../../WebContent/u8/introduccio.html">Introducció</a></li><li id="u8resum"><a href="../../../WebContent/u8/resum.html">Resum</a></li><li id="u8objectius"><a href="../../../WebContent/u8/objectius.html">Resultats d'aprenentatge</a></li><li id="u8mapa"><a href="../../../WebContent/u8/mapa.html">Mapa conceptual</a></li><li id="u8referencies"><a href="../../../WebContent/u8/referencies.html">Referències</a></li><li id="u8a1" class="tocsection"><p id='u8a1continguts'><a class="section" href="../../../WebContent/u8/a1/continguts.html">Recursos del domini</a><span class="buttonexp"></span></p><ul><li id="u8a1activitats"><a href="../../../WebContent/u8/a1/activitats.html">Activitats</a></li><li id="u8a1exercicis"><a href="../../../WebContent/u8/a1/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><div data-parent-id='u8a1' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u8/a1/continguts.html#equips_del_domini">Equips del domini</a></li><li><a href="../../../WebContent/u8/a1/continguts.html#recursos_locals">Recursos locals</a></li><li><a href="../../../WebContent/u8/a1/continguts.html#recursos_de_xarxa">Recursos de xarxa</a></li><li><a href="../../../WebContent/u8/a1/continguts.html#samba">Samba</a></li><li><a href="../../../WebContent/u8/a1/continguts.html#seguretat_en_el_samba">Seguretat en el Samba</a></li><li><a href="../../../WebContent/u8/a1/continguts.html#instal_lacio_del_servidor_i_del_client_samba">Instal·lació del servidor i del client Samba</a></li><li><a href="../../../WebContent/u8/a1/continguts.html#gestio_d_usuaris_grups_i_permisos_del_samba">Gestió d'usuaris, grups i permisos del Samba</a></li><li><a href="../../../WebContent/u8/a1/continguts.html#configuracio_del_servidor_samba">Configuració del servidor Samba</a></li><li><a href="../../../WebContent/u8/a1/continguts.html#utilitzacio_del_client_samba">Utilització del client Samba</a></li><li><a href="../../../WebContent/u8/a1/continguts.html#muntar_unitats_de_xarxa">Muntar unitats de xarxa</a></li><li><a href="../../../WebContent/u8/a1/continguts.html#acces_grafic_als_recursos_compartits">Accés gràfic als recursos compartits</a></li><li><a href="../../../WebContent/u8/a1/continguts.html#protocol_nfs">Protocol NFS</a></li></ul></div></div><li id="u8a2" class="tocsection"><p id='u8a2continguts'><a class="section" href="../../../WebContent/u8/a2/continguts.html">Administració de l'accés al domini</a><span class="buttonexp"></span></p><ul><li id="u8a2activitats"><a href="../../../WebContent/u8/a2/activitats.html">Activitats</a></li><li id="u8a2exercicis"><a href="../../../WebContent/u8/a2/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><div data-parent-id='u8a2' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u8/a2/continguts.html#permisos_i_drets">Permisos i drets</a></li><li><a href="../../../WebContent/u8/a2/continguts.html#delegacio_de_permisos">Delegació de permisos</a></li><li><a href="../../../WebContent/u8/a2/continguts.html#llistes_de_control_d_acces_acl">Llistes de control d’accés (ACL)</a></li><li><a href="../../../WebContent/u8/a2/continguts.html#directives_de_grup">Directives de grup</a></li><li><a href="../../../WebContent/u8/a2/continguts.html#directives_de_seguretat">Directives de seguretat</a></li></ul></div></div></ul></li><li id="" class="indexnode"><p><a href="../../../index.html">Anar a l&#39;&iacute;ndex general</a></p></li>
        </ul>
      </div>
    </div>
   </section>
   <section>
   <div id="settings" class="hidden">
    <div class="menucontent">
     <div class="allsettings">
     <div class="settings">
      <label>Font i Color</label>
		<div class="setting-option">
	        <ul class="fontBackground">
				<li id="style-newspaper" title="Newspaper" class="appearance-style-newspaper"><span>Newspaper</span></li>
                <li id="style-novel" title="Novel" class="appearance-style-novel"><span>Novel</span></li>
                <li id="style-ebook" title="eBook" class="appearance-style-ebook"><span>eBook</span></li>
				<li id="style-inverse" title="Inverse" class="appearance-style-inverse active"><span>Inverse</span></li>
				<li id="style-athelas" title="Athelas" class="appearance-style-athelas"><span>Athelas</span></li>
			</ul>
		</div>
     </div>
	<div class="settings">
      <label>Amplada</label>
		<div class="setting-option">
	        <div id="slider-width"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
		<div class="setting-option">
	        <div id="slider-font"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
	  <div class="setting-option">
       <form action="" class="sett-options">
		<ul>
		    <li><input type="checkbox" id="secondary-content" /><label for="secondary-content">Mostra recursos complementaris</label></li>
		    <li><input type="checkbox" id="main-images" /><label for="main-images">Mostra imatges</label></li>
		    <li><input type="checkbox" id="text-alignment" /><label for="text-alignment">Text justificat</label></li>
			<li><input type="checkbox" id="text-hyphen" /><label for="text-hyphen">Partici&oacute; sil·l&agrave;bica</label></li>
		</ul>
       </form>
	  </div>
     </div>
     </div>
    </div>
   </div>
   </section>
 <section>
 <div id="favorites" class="hidden"></div>
 </section>   
 <div id="bridge" class="hidden"></div>
 <div id="help" class="hidden">
  <div class="helptitle">Dreceres del teclat<hr></div>
  <div class="helpsection"><span>General</span>
   <ul>
    <li><span class="shortcut">g</span>: Anar al men&uacute; de navegaci&oacute;</li>
    <li><span class="shortcut">o</span>: Anar a opcions</li>
    <li><span class="shortcut">s</span>: Guardar la p&agrave;gina actual a favorits</li>
    <li><span class="shortcut">p</span>: Imprimir la p&agrave;gina actual</li>
    <li><span class="shortcut">?</span>: Mostrar/Ocultar l&#39;ajuda</li>
   </ul>
  </div>
  <div class="helpsection"><span>Navegaci&oacute;</span>
   <ul>
    <li><span class="shortcut">i</span>: Anar a l&#39;&iacute;ndex general</li>
    <li><span class="shortcut">t</span>: Anar a l&#39;inici de p&agrave;gina</li>
    <li><span class="shortcut">b</span>: Anar al final de p&agrave;gina</li>
    <li><span class="shortcut">j</span>: Anar cap endavant dintre la p&agrave;gina</li>
    <li><span class="shortcut">k</span>: Anar cap enrere dintre la p&agrave;gina</li>
    <li><span class="shortcut">h</span>: Anar a la p&agrave;gina anterior:</li>
    <li><span class="shortcut">l</span>: Anar a la p&agrave;gina seg&uuml;ent:</li>
   </ul>
   </div>
 </div>
 <div id="favcounter" name="favcounter" class="hidden"><span></span></div>
 <div id="navmenu" class="navmenu"><ul class="webnav"><li><a href="../../../index.html" title="Anar a l&#39;&iacute;ndex general">Inici</a></li><li><a href="../introduccio.html">Administració de dominis</a></li><li>Implementació de dominis LDAP</li></ul></div>
	<div id="content" lang="ca" class="hyphenate text">
     <article lang="ca" class="sheet">
        <h1><a id="implementacio_de_dominis_ldap"> Implementació de dominis LDAP </a></h1>
    	
<p>
Inicialment, quan muntem una xarxa informàtica amb pocs nodes, podem establir un esquema, en què cadascun dels nodes té les mateixes funcionalitats, sense cap tipus de jerarquia. Això s’anomena <em>xarxa d’igual a igual</em>, i conforma el que podem designar com a <em>grup de treball</em>.
</p>

<p>
En aquest esquema de funcionament de la xarxa, la informació no està centralitzada, i cadascun dels nodes té uns usuaris amb les preferències corresponents. D’aquesta manera, hi ha la possibilitat que un usuari determinat pugui accedir a un dels nodes de la xarxa, però que no ho pugui fer des d’altres.
</p>

<p>
A més a més, pot ser que aquesta xarxa es vagi ampliant amb nous usuaris i nous equipaments, els quals s’hauran de connectar a un ordinador determinat, amb uns usuaris concrets, cosa que en complica molt la gestió.
</p>

<p>
És evident que, davant d’això, cal una gestió centralitzada dels usuaris i dels recursos dels ordinadors que formen part de la xarxa d’àrea local. Ha de realitzar aquesta tasca un ordinador en concret que farà la funció de <strong>servidor</strong> de domini.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Un <strong>domini</strong> és un conjunt d’ordinadors que estan connectats en xarxa entre ells, i que formen part d’una estructura jerarquitzada que permet gestionar d’una manera centralitzada en un servidor l’accés a un conjunt de recursos per part dels usuaris i equips que en formen part.
</p>
</div></div>
<p>
Mitjançant aquesta filosofia, s’augmenta d’una manera significativa la fiabilitat i disponibilitat dels recursos del domini, i l’accés als recursos d’un determinat usuari del domini és independent de l’ordinador des del qual vol accedir a aquests recursos.
</p>

<h2><a id="dominis_ldap" >Dominis LDAP</a></h2>
<div class="level2">

<p>
LDAP és una especificació oberta que permet una implementació d’un domini mitjançant sistemes operatius lliures, i també propietaris. Podem obtenir implementacions lliures de LDAP; per exemple, <em>OpenLDAP</em>, que pot funcionar en sistemes operatius lliures com ara GNU/Linux.
</p>

</div>

<h3><a id="estructura_client-servidor" >Estructura client-servidor</a></h3>
<div class="level3">

<p>
Per poder crear un domini, cal implementar una estructura en forma de client-servidor. Això vol dir que hi ha d’haver un o més nodes de la xarxa (generalment, ordinadors amb un sistema operatiu orientat a la xarxa), que funcionin d’una manera ininterrompuda i que, mitjançant una base de dades, permeten els recursos de la xarxa. Aquests ordinadors s’anomenen <strong>servidors</strong>.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
Sistemes operatius diferents de LDAP tenen una implementació diferent dels dominis, com, per exemple, l’Active Directory de Windows Server.
</p>
</div></div><div class="ioctext"><div class="ioccontent"><p class="ioctitle">OpenLDAP</p>
<p>
El programari OpenLDAP és una implementació basada en codi obert, del Protocol d’Accés Lleuger a Directori.
</p>
</div></div>
<p>
Els servidors gestionen i permeten l’accés a aquests recursos dels clients que s’hi connecten. Per tal de permetre l’accés a algun recurs de la xarxa, el client ha d’estar donat d’alta en una base de dades desada en el servidor de domini.
</p>

<p>
Quan els clients volen accedir a un determinat recurs del domini, s’han d’identificar mitjançant un compte d’usuari i una contrasenya, o des d’un  compte d’equip específic, que estarà emmagatzemat en el servidor, i que, per tant, no dependrà del client concret des del qual es vulgui identificar l’usuari.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
L’accés als recursos del domini és independent de l’ordinador físic des del qual es duu a terme la connexió: només depèn de l’usuari del domini amb el qual es vol fer aquest accés.
</p>
</div></div>
</div>

<h3><a id="el_protocol_ldap" >El protocol LDAP</a></h3>
<div class="level3">

<p>
LDAP és un acrònim anglès de <em>lightweight directory access protocol</em>; és a dir, ‘protocol d’accés a directori lleuger’. És un protocol del tipus client-servidor que permet llegir i editar directoris a través d’una xarxa que funciona sobre el protocol TCP/IP. Un directori és un conjunt de registres. Per exemple: una llista telefònica ordenada alfabèticament en què cada persona i organització té un telèfon i una adreça associats.
</p>

<p>
En el cas dels dominis, LDAP serveix per accedir a un servei de directori (com ara un servidor de domini amb usuaris, equips i recursos); la darrera versió és la 3.
</p>

<p>
Inicialment, el 1993, va ser desenvolupat per la Universitat de Michigan per tal de reemplaçar el protocol DAP (que es feia servir per accedir als serveis de directori X.500 d’OSI), integrant-lo d’una manera adequada a les xarxes TCP/IP. Des del 1995, DAP es va convertir en un LDAP autosuficient, de manera que es pot utilitzar per altres coses a banda d’accedir als directoris del tipus X.500.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Protocol X.500</p>
<p>
És el protocol d’accés a directori (DAP), que segueix la norma ISO/IEC 9594. És el precursor de LDAP i permet una manera de desenvolupar un directori de persones en una organització, perquè pugui formar part d’un directori global disponible per qualsevol persona d’arreu del món per mitjà d’Internet.
</p>
</div></div>
<p>
De fet, LDAP defineix el mètode d’accés a les dades en el servidor a nivell del client, i no la manera com s’emmagatzema aquesta informació. LDAP dóna a l’usuari un conjunt de mètodes que permeten:
</p>
<ul>
<li class="level1"><div class="li"> Connectar-se.</div>
</li>
<li class="level1"><div class="li"> Desconnectar-se.</div>
</li>
<li class="level1"><div class="li"> Cercar informació.</div>
</li>
<li class="level1"><div class="li"> Comparar informació.</div>
</li>
<li class="level1"><div class="li"> Inserir entrades.</div>
</li>
<li class="level1"><div class="li"> Canviar entrades.</div>
</li>
<li class="level1"><div class="li"> Esborrar entrades.</div>
</li>
</ul>

<p>
A més a més, en la seva versió actual (la 3), LDAP ofereix encriptació via protocol SSL, i mecanismes d’autenticació per tal d’accedir a la informació emmagatzemada a la base de dades d’una manera segura.
</p>

<p>
LDAP presenta la informació en forma d’una estructura d’arbre jeràrquica, anomenada <em>DIT</em> (<em>directory information tree</em>, ‘arbre d’informació de directori’). En aquest arbre, la informació anomenada <em>entrades</em> o <em>DSE</em> (<em>directory service entry</em>, ‘entrada de servei de directori’), és representada en forma de branques. La branca localitzada a l’arrel és l’entrada arrel.
Cada entrada en el directori LDAP està relacionada amb un objecte real o abstracte; per exemple, una persona, un ordinador, paràmetres, etc.
</p>

<p>
Cada entrada està formada per una col·lecció de parells de valors (o claus), anomenada <em>atributs</em>. D’aquesta manera es permet distingir cada objecte que consta en l’arbre. Hi ha dos tipus d’atributs:
</p>
<ul>
<li class="level1"><div class="li"> <strong>Atributs normals</strong>: són els habituals, com ara el nom, el cognom…), que serveixen per distingir l’objecte.</div>
</li>
<li class="level1"><div class="li"> <strong>Atributs operacionals</strong>: atributs als quals només pot accedir el servidor per tal de manipular les dades del directori (per exemple, modificar dades).</div>
</li>
</ul>

<p>
Cadascuna de les entrades està indexada per un DN (<em>distinguished name</em>, ‘nom distingit’), de manera que es pot identificar aquest element d’una manera unívoca.
Per crear un DN, prenem el nom de l’element anomenat <em>RDN</em> (<em>relative distinguished name</em>, ‘nom distingit relatiu’), i hi afegim el nom sencer de l’entrada pare.
La identificació unívoca d’una entrada depèn de la utilització correcta de parells de valors o claus. El conjunt de claus que es fa servir normalment són les següents:
</p>
<ul>
<li class="level1"><div class="li"> <strong>uid</strong> (<em>userid</em>): és un identificador únic per a cada usuari.</div>
</li>
<li class="level1"><div class="li"> <strong>cn</strong> (<em>common name</em>): és el nom d’usuari.</div>
</li>
<li class="level1"><div class="li"> <strong>givenname</strong>: és el nom de la persona.</div>
</li>
<li class="level1"><div class="li"> <strong>sn</strong> (<em>surname</em>): és el cognom de la persona.</div>
</li>
<li class="level1"><div class="li"> <strong>o</strong> (<em>organitzation</em>: és l’organització o companyia a la qual pertany aquesta persona.</div>
</li>
<li class="level1"><div class="li"> <strong>u</strong> (<em>organizational unit</em>): és el departament de l’organització o companyia on treballa aquesta persona.</div>
</li>
<li class="level1"><div class="li"> <strong>mail</strong>: és l’adreça de correu electrònic personal.</div>
</li>
</ul>

<p>
A més a més d’aquestes claus, n’hi pot haver d’altres sempre que siguin necessàries.
Amb tot això, un exemple de DN (‘nom distingit’), prendria la forma:
</p>
<pre class="code">   uid=jeapil,cn=pillou,givenname=jean-francois</pre>

<p>
El RDN (‘nom distingit relatiu’) seria:
</p>
<pre class="code">   uid=jeapil</pre>

<p>
En general, els usuaris en un domini LDAP tindran un nom distingit que consistirà en el seu <strong>uid</strong>, més el nom del domini més l’extensió d’aquest.
</p>

<p>
La col·lecció d’objectes i definicions d’atributs que un servidor LDAP pot gestionar s’anomena <em>esquema</em>. Això fa possible definir si un atribut pot tenir un valor o més, o fer que aquest sigui obligatori o opcional.
</p>

<p>
LDAP ens dóna tot un conjunt de funcions (o procediments) per tal de dur a terme consultes en les dades desades en el servidor, com per exemple cercar, modificar i eliminar entrades en el directori.
</p>

<p>
En la <span class="tabref"><a href="#Table1"><span>taula</span></a></span>, es mostren les operacions principals que es poden dur a terme amb LDAP:
</p>
<div class="ioctable ">
<div class="titletable"><a name="Table1"><span>Taula: </span></a>Operacions que podem dur a terme amb LDAP</div>
<div class="table"><table class="inline">
	<tr class="row0">
		<th class="col0"> Operació </th><th class="col1"> Descripció </th>
	</tr>
	<tr class="row1">
		<td class="col0"> <em>Abandon </em> </td><td class="col1"> Abandonar l’operació prèvia enviada al servidor. </td>
	</tr>
	<tr class="row2">
		<td class="col0"> <em>Add</em> </td><td class="col1"> Afegir una entrada al directori. </td>
	</tr>
	<tr class="row3">
		<td class="col0"> <em>Bind</em> </td><td class="col1"> Iniciar una nova sessió en el servidor LDAP. </td>
	</tr>
	<tr class="row4">
		<td class="col0"> <em>Compare</em> </td><td class="col1 leftalign"> Comparar les entrades en un directori en funció dels criteris.  </td>
	</tr>
	<tr class="row5">
		<td class="col0"> <em>Delete</em> </td><td class="col1"> Esborrar una entrada d’un directori. </td>
	</tr>
	<tr class="row6">
		<td class="col0"> <em>Extended</em> </td><td class="col1"> Dur a terme operacions esteses. </td>
	</tr>
	<tr class="row7">
		<td class="col0"> <em>Rename</em> </td><td class="col1"> Canviar el nom d’una entrada. </td>
	</tr>
	<tr class="row8">
		<td class="col0"> <em>Search</em> </td><td class="col1"> Cercar entrades en un directori. </td>
	</tr>
	<tr class="row9">
		<td class="col0"> <em>Start TLS</em> </td><td class="col1"> Fer servir l’extensió de seguretat TLS (<em>transport layer security</em>, ‘seguretat de capa de transport’) de la versió 3 per obtenir una connexió segura. </td>
	</tr>
	<tr class="row10">
		<td class="col0"> <em>Unbind</em> </td><td class="col1"> Aturar la sessió en el servidor LDAP. </td>
	</tr>
</table></div>
</div>
<p>
LDAP també ens dóna un format d’intercanvi de dades (LDIF: <em>lightweight data interchange format</em>), que permet exportar i importar dades des d’un directori o cap a aquest fent servir un fitxer de text simple. La majoria de servidors LDAP suporten aquest format, fet que permet un grau d’interoperabilitat molt gran entre ells.
</p>

<p>
La sintaxi d’aquest format és la següent:
</p>
<pre class="code">   [&lt;id&gt;]
   dn: &lt;nom distingit&gt;
   &lt;attribut&gt;: &lt;valor&gt;
   &lt;attribut&gt;: &lt;valor&gt;
   ...</pre>
<div class="ioctextl"><div class="ioccontent"><p class="ioctitle">Exemple de LDAP</p><pre class="code">   dn: cn=John Doe,dc=example,dc=com
   cn: John Doe
   givenName: John
   sn: Doe
   telephoneNumber: +1 888 555 6789
   telephoneNumber: +1 888 555 1232
   mail: john@example.com
   manager: cn=Barbara Doe,dc=example,dc=com
   objectClass: inetOrgPerson
   objectClass: organizationalPerson
   objectClass: person
   objectClass: top</pre>

<p>
on
</p>
<ul>
<li class="level1"><div class="li"> <strong>dn</strong>: és el nom distingit de l’entrada (nom complet, com si fos un directori absolut si parléssim de fitxers). No és cap atribut ni forma part de l’entrada.</div>
</li>
<li class="level1"><div class="li"> <strong>cn=John Doe</strong>: és l’entrada RDN (‘nom relatiu distingit’).</div>
</li>
<li class="level1"><div class="li"> <strong>dc=example, dc=com</strong>: són els noms distingits de l’entrada pare, on <strong>dc</strong> significa ‘component de domini’ (<em>domain component</em>).</div>
</li>
<li class="level1"><div class="li"> La resta de línies són atributs en aquesta entrada, que habitualment fan servir cadenes mnemotècniques per tal de recordar més fàcilment el significat: “cn” per ‘nom comú’, “dc” per ‘component de domini’, “mail” per ‘correu electrònic’ i “sn” per ‘cognom’.</div>
</li>
</ul>

<p>
En aquest fitxer l’identificador (id) és opcional; és un nombre enter positiu que permet identificar cada entrada a la base de dades.
</p>
</div></div>
<p>
En relació amb aquest tipus de fitxers LDIF, cal tenir en compte que:
</p>
<ul>
<li class="level1"><div class="li"> Cada nova entrada ha d’estar separada de l’anterior mitjançant una línia buida.</div>
</li>
<li class="level1"><div class="li"> Es pot definir un atribut que ocupi diverses línies sempre que a partir de la segona línia es comenci amb un espai en blanc o una tabulació.</div>
</li>
<li class="level1"><div class="li"> Es poden definir diversos valors per un atribut repetint la cadena de caràcters nom: valor en línies separades.</div>
</li>
<li class="level1"><div class="li"> Quan el valor conté un caràcter especial (no imprimible, espai en blanc o dos punts), l’atribut ha d’anar seguit per <strong>::</strong> si el valor és codificat en base 64.</div>
</li>
</ul>

<p>
Un servidor emmagatzema un subarbre que comença a partir d’una entrada específica (per exemple, “dc=example, dc=com”), i tots els seus fills. els servidors també poden tenir referències a altres servidors, de manera que un intent d’accés a “ou=department, dc=example, dc=com” pot resultar en un redireccionament a un altre servidor que conté aquesta part de l’arbre de directori. Si és així, el client pot contactar amb l’altre servidor.
</p>

<p>
Alguns servidors suporten encadenament; és a dir, un servidor pot contactar amb un altre i retornar el resultat al client.
</p>

<p>
Normalment, LDAP no defineix cap ordre en concret. Així, un servidor pot tornar valors d’un atribut, els atributs d’una entrada i les entrades trobades a partir d’una operació de cerca en qualsevol ordre.
</p>

</div>

<h3><a id="dominis_subdominis" >Dominis, subdominis</a></h3>
<div class="level3">

<p>
Per entendre el funcionament de l’autenticació d’usuaris en xarxes GNU/Linux cal conèixer el significat del concepte <em>domini/subdomini</em> i la traducció d’aquest concepte en sistemes GNU/Linux.
</p>

<p>
També és imprescindible saber com funciona el sistema de gestió d’usuaris i grups en els sistemes GNU/Linux i el procés de configuració de l’autenticació d’usuaris en una xarxa formada per xarxes GNU/Linux.
</p>

<p>
El terme <em>domini</em> pot fer referència a dos conceptes:
</p>
<ul>
<li class="level1"><div class="li"> Domini d’Internet.</div>
</li>
<li class="level1"><div class="li"> Domini local, d’administració de sistemes.</div>
</li>
</ul>
<div class="iocimportant"><div class="ioccontent">
<p>
Un domini d’Internet és una estructura jeràrquica de noms separats per punts que, per mitjà dels servidors de noms de domini, permet determinar la ubicació (adreça IP) d’un equip connectat a Internet.
</p>
</div></div>
<p>
Cada nom de l’estructura determina un servidor <acronym title="Domain Name System">DNS</acronym> que coneix l’adreça IP de l’equip amb el nom anterior en l’estructura (excepte el primer nom que determina el node en qüestió).
L’objectiu, juntament amb el servei de noms de domini, és traduir les adreces IP dels nodes actius de la xarxa en paraules més fàcils de recordar per a les persones.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Des del punt de vista de l’administració de sistemes, un domini local constitueix un conjunt d’equips interconnectats en una xarxa local que comparteixen informació administrativa centralitzada (usuaris, grups, contrasenyes…). Aquesta informació es fa servir per poder autenticar-se i crear un entorn inicial de treball per als usuaris que, segons els permisos que tinguin, podran accedir als recursos que proporciona el sistema.
</p>
</div></div>
<p>
L’autenticació per mitjà de la xarxa en sistemes GNU/Linux requereix fonamentalment la disponibilitat d’almenys un o diversos ordinadors que emmagatzemin físicament aquesta informació i que la comuniquin a la resta de màquines connectades en xarxa, quan calgui, mitjançant un esquema client-servidor.
</p>

<p>
Per exemple, quan un usuari vol iniciar una sessió en qualsevol ordinador client del grup d’autenticació (domini), aquest ordinador haurà de validar les dades de l’usuari en el servidor i obtenir del mateix servidor tota la informació necessària per poder crear el context inicial de treball per a l’usuari.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Un subdomini és un nivell de classificació jeràrquica dels noms de domini, definits amb finalitats administratives o organitzatives. Es podria considerar com un domini de segon nivell. Normalment, es tracta d’una sèrie de caràcters o d’una paraula, que s’escriu a l’esquerra del domini i separat per un punt.
</p>
</div></div>
<p>
A nivell d’Internet es pot dir que el subdomini s’utilitza per referir-se a una adreça web que treballa com un annex (o lloc relacionat) d’un domini principal. Per exemple, un subdomini es pot representar de la manera següent:
</p>
<pre class="code">http://subdomini.domini-principal.com/
http://www.domini-principal.org/subdomini/</pre>

<p>
Dintre de l’estructura del servidor es reflecteix com un directori, el qual conté la informació per mostrar.
</p>

<p>
Els subdominis són definits per les mateixes empreses que realitzen l’allotjament del servei web. Es pot tractar tant de la mateixa empresa interessada com d’una empresa especialitzada a oferir serveis d’hostatge (<em>hosting</em>) per a tercers. En aquest últim cas, hi pot haver unes certes limitacions, tant pel nombre de subdominis permesos com pel tipus de servei que ofereixen. Per exemple, hi ha empreses que regalen un subdomini en el moment de registrar un bloc amb ells, o d’altres ofereixen serveis d’hostatge gratuït.
</p>

<p>
A nivell local, un subdomini seria una subdivisió d’un domini amb finalitats organitzatives, per tal de facilitar la gestió i administració del domini principal. Podem pensar que un subdomini és equivalent a un departament dins d’una empresa gran.
</p>

</div>

<h2><a id="disseny_del_domini" >Disseny del domini</a></h2>
<div class="level2">

<p>
Dissenyar un domini implica fer una planificació anticipada de la forma que tindrà. Habitualment, els dominis es representen en forma d’arbre (si més no, la implementació d’aquests mitjançant el protocol LDAP). Per tant, abans de començar, hem de pensar quina forma tindrà aquest arbre, és a dir, si hi haurà subdominis, quines branques tindrà, quins usuaris i quins grups d’usuaris contindrà.
</p>

<p>
En qualsevol cas, a l’inici del disseny, l’administrador haurà de pensar en quins departaments ha de dividir el domini, i quins usuaris corresponen a cadascun d’aquests departaments.
</p>

<p>
Per tal d’entendre i seguir les explicacions d’aquests materials, haurem de fixar un disseny concret, que serà el que haurem de tenir en ment per tal d’implementar-lo, i seguir totes les passes necessàries per implementar-lo. És impossible de seguir amb la implantació d’un domini, si no tenim enllestit aquest domini, o si més si no tenim un esboç dels elements principals de què ha de constar.
</p>

<p>
En un domini creat emb LDAP, tenim una sèrie d’elements que són prefixats:
</p>
<ul>
<li class="level1"><div class="li"> <strong>Usuari administrador (cn=admin)</strong>: és l’usuari amb drets d’administració que pot crear, eliminar i modificar els usuaris i els grups del domini.</div>
</li>
<li class="level1"><div class="li"> <strong>Unitat organitzativa People (ou=People)</strong>: aquesta unitat organitzativa inclou tots els usuaris individuals del domini, que es distingeixen els uns dels altres mitjançant el seu identificador (uid). </div>
</li>
<li class="level1"><div class="li"> <strong>Unitat organitzativa Groups (ou=Groups)</strong>: aquesta unitat organitzativa inclou tots els grups d’usuaris. És molt important agrupar els usuaris en funció de característiques semblants, per tal de simplificar-ne la gestió. Així, podem agrupar els usuaris en funció dels drets i dels permisos d’accés a objectes del domini. Cal dir que els grups del domini s’han de crear abans que els usuaris individuals, perquè d’aquesta manera simplifiquem el procés de creació d’usuaris. Un cop s’han creat els grups del domini, quan creem l’usuari, el podem assignar directament a un determinat grup sense haver de fer cap altre pas posterior. Si quan creem els usuaris no s’han creat els grups d’usuaris prèviament, hauríem de crear aquests grups posteriorment, i després hauríem d’editar les propietats dels usuaris un per un, per tal d’assignar-los a un grup concret.</div>
</li>
</ul>

<p>
Dins dels elements que no són prefixats, haurem d’escollir:
</p>
<ul>
<li class="level1"><div class="li"> <strong>Nom del domini</strong>: és un nom distingit, format pel nom pròpiament dit, i la seva extensió. Crearem un domini amb el nom <strong>meudomini</strong> i extensió <strong>org</strong>, per tant, el nom distingit del domini serà <strong>dc=meudomini, dc=org</strong>.</div>
</li>
<li class="level1"><div class="li"> <strong>Nom del grup d’usuaris</strong>: escollirem com a nom del grup <strong>usuaris</strong>, i el nom distingit corresponent serà <strong>cn=usuaris, ou=Groups, dc=meudomini, dc=org</strong>.</div>
</li>
<li class="level1"><div class="li"> <strong>Nom d’usuari</strong> : per tal que el domini tingui un mínim de funcionalitat, i puguem realitzar alguna prova, haurem de crear com a mínim un usuari del domini. Aquest usuari tindrà com a nom <strong>usuari</strong>, i penjarà de la unitat organitzativa <strong>People</strong>. El seu nom distingit complet serà <strong>uid=usuari, dc=meudomini, dc=org</strong>.</div>
</li>
</ul>

<p>
Seguint aquestes orientacions, podeu veure l’esquema dels objectes mínims del domini en forma d’arbre en la <span class="figref"><a href="#fff1"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="fff1"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Esquema del domini

</figcaption><img src="../media/ic10mu7_01a.png" alt="" /></figure>
<div class="footfigure">Representació en forma d'arbre dels objectes del domini descrits</div></div>
</div>

<h3><a id="analisi_dels_requeriments" >Anàlisi dels requeriments</a></h3>
<div class="level3">

<p>
A l’hora de dissenyar un domini, com a mínim, hem d’especificar:
</p>
<ul>
<li class="level1"><div class="li"> Extensió del domini: que correspon en el model ldap a un component de domini. Aquesta extensió pot tenir el valor .com, .org, etc. i l’indiquem mitjançant <strong>dc=com</strong>, <strong>dc=org</strong>, etc.</div>
</li>
<li class="level1"><div class="li"> Nom del domini: també correspon a un component del domini. Pot tenir el valor que vulguem; en qualsevol cas, ha de començar amb un caràcter, i ha de tenir un cert significat. Per exemple, pot ser: meudomini, dominiexemple, etc. i l’indiquem mitjançant <strong>dc=meudomini</strong>, <strong>dc=dominiexemple</strong>, etc.</div>
</li>
<li class="level1"><div class="li"> La unitat organitzativa <strong>People</strong>: contindrà tots els usuaris individuals del sistema, i s’indica mitjançant <strong>ou=People</strong>.</div>
</li>
<li class="level1"><div class="li"> Els usuaris del sistema, que en la representació gràfica, són fills de la unitat organitzativa People. Cadascun dels usuaris s’ha d’identificar unívocament mitjançant un identificador d’usuari. Per exemple, en el protocol LDAP, un usuari anomenat <em>pepet</em> s’indicaria de la manera següent: <strong>uid=pepet</strong>.</div>
</li>
<li class="level1"><div class="li"> La unitat organitzativa <strong>Group</strong>: conté unitats organitzatives que serveixen per agrupar els usuaris del sistema mitjançant grups. En la implementació LDAP s’anomena <strong>ou=Group</strong>.</div>
</li>
<li class="level1"><div class="li"> Els grups d’usuari del sistema: en la representació gràfica, són fills de la unitat organitzativa Group. Cadascun dels grups d’usuaris s’identifica unívocament amb un nom de grup. Per exemple, el grup d’usuaris desenvolupadors s’identificaria mitjançant un nom comú (cn) de la forma <strong>cn=desenvolupadors</strong>.</div>
</li>
</ul>

<p>

</p>

<p>
A més de tots aquests requeriments de planificació, també tenim una sèrie de requeriments de maquinari i programari:
</p>
<ul>
<li class="level1"><div class="li"> <strong>Sistema operatiu</strong>: un sistema operatiu que suporti la implementació de LDAP. Si ens fixem en la implementació OpenLDAP, aleshores ens pot servir qualsevol distribució de GNU/Linux. En el nostre cas utilitzarem <strong>Ubuntu Server 10.04 LTS</strong>. </div>
</li>
<li class="level1"><div class="li"> <strong>Ordinador servidor</strong>: és necessari un ordinador que suporti el sistema operatiu de xarxa. En el cas d’Ubuntu Server 10.04 LTS, si no utilitzem un entorn gràfic, els requeriments mínims del sistema són els que podem veure en la <span class="tabref"><a href="#Table2"><span>taula</span></a></span>.</div>
</li>
<li class="level1"><div class="li"> <strong>Ordinadors clients</strong>: han d’estar connectats mitjançant una xarxa al servidor. Per tal de facilitar-ne la configuració, és convenient que el seu sistema operatiu sigui el mateix que el del servidor (Ubuntu 10.04 LTS), si bé es poden utilitzar altres distribucions de GNU/Linux i, fins i tot, és possible fer servir ordinadors que funcionin amb sistemes operatius de la família Windows.<br/>
 En cas que utilitzem com a sistema operatiu dels clients Ubuntu 10.04 (edició d’escriptori), hi ha els requeriments que es mostren en la <span class="tabref"><a href="#Table3"><span>taula</span></a></span>. Podem observar que els requeriments de l’edició d’escriptori són força més elevats que la versió de servidor, suposant que el servidor només s’hi instal·li l’intèrpret de ordres en mode text.</div>
</li>
<li class="level1"><div class="li"> <strong>Altres elements necessaris per crear la xarxa</strong>: commutadors (<em>switches</em>), encaminadors (<em>routers</em>), armaris, cablejat, etc.</div>
</li>
</ul>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Requeriments de maquinari</p>
<p>
Qualsevol ordinador pot fer de servidor, però és convenient que si emmagatzema informació important tingui maquinari tolerant a errors, com ara fonts d’alimentació redundant o sistemes de discos en RAID
</p>
</div></div><div class="ioctable ">
<div class="titletable"><a name="Table2"><span>Taula: </span></a>04 LTS</div>
<div class="table"><table class="inline">
	<tr class="row0">
		<th class="col0 leftalign"> Element  </th><th class="col1"> Requeriment </th>
	</tr>
	<tr class="row1">
		<td class="col0"> Processador (x86) amb el joc d’instruccions i686 </td><td class="col1"> 300 <acronym title="Megahertz">MHz</acronym> </td>
	</tr>
	<tr class="row2">
		<td class="col0"> Memòria RAM </td><td class="col1"> 128 <acronym title="Megabyte">MB</acronym> (megabytes) </td>
	</tr>
	<tr class="row3">
		<td class="col0"> Disc dur (o espai lliure) </td><td class="col1"> 1 <acronym title="Gigabyte">GB</acronym> (gigabyte) </td>
	</tr>
	<tr class="row4">
		<td class="col0"> Resolució monitor </td><td class="col1"> VGA (640 x 480 píxels) </td>
	</tr>
</table></div>
</div><div class="ioctable ">
<div class="titletable"><a name="Table3"><span>Taula: </span></a>04 LTS edició d’escriptori</div>
<div class="table"><table class="inline">
	<tr class="row0">
		<th class="col0 leftalign"> Element  </th><th class="col1"> Requeriment </th>
	</tr>
	<tr class="row1">
		<td class="col0"> Processador (x86) amb el joc d’instruccions i686 </td><td class="col1"> 1 <acronym title="Gigahertz">GHz</acronym> </td>
	</tr>
	<tr class="row2">
		<td class="col0"> Memòria RAM </td><td class="col1"> 512 <acronym title="Megabyte">MB</acronym> (megabytes) </td>
	</tr>
	<tr class="row3">
		<td class="col0"> Disc dur (o espai lliure) </td><td class="col1"> 5 <acronym title="Gigabyte">GB</acronym> (gigabytes) </td>
	</tr>
	<tr class="row4">
		<td class="col0"> Resolució monitor </td><td class="col1"> VGA (1024&times;768) </td>
	</tr>
</table></div>
</div>
</div>

<h3><a id="implementacio" >Implementació</a></h3>
<div class="level3">

<p>
Per tal d’implementar el domini de LDAP, suposarem que ja tenim instal·lat un sistema <strong>Ubuntu Server 10.04 LTS</strong> i que en coneixem la contrasenya d’administració. Cal recordar que, per fer tots aquests passos, ens cal ser usuari administrador del sistema, cosa que podem aconseguir obrint una consola del sistema, i executar l’ordre:
</p>
<pre class="code">usuari@ubuntu-server~$sudo bash
[sudo] password for usuari : 
root@ubuntu-server~#</pre>

<p>
Un cop hem iniciat l’intèrpret d’ordres com a usuari administrador (<strong>root</strong>), podrem fer tots els passos necessaris per implementar el domini mitjançant LDAP. Suposarem que volem crear un domini anomenat <strong>meudomini.org</strong>, i que la contrasenya de l’administrador és 123456. Vegem tot seguit els passos que hem de dur a terme:
</p>

<p>
<strong>1.</strong> Instal·lem el servidor:
</p>
<pre class="code">apt-get install slapd ldap-utils</pre>

<p>
<strong>2.</strong> Instal·lem uns quants fitxers d’esquema:
</p>
<pre class="code">ldapadd -Y EXTERNAL -H ldapi:/// -f /etc/ldap/schema/cosine.ldif
ldapadd -Y EXTERNAL -H ldapi:/// -f /etc/ldap/schema/nis.ldif
ldapadd -Y EXTERNAL -H ldapi:/// -f /etc/ldap/schema/inetorgperson.ldif</pre>

<p>
<strong>3.</strong> Establim la contrasenya de l’LDAP (en l’exemple posem 123456): 
</p>
<pre class="code">slappasswd -h {CRYPT}: 
New password: 123456
Re-enter new password: 123456
{CRYPT}aLJLqqUipInfk</pre>

<p>
<strong>4.</strong> Creem el fitxer <code>config.ldif</code> amb el contingut següent:
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Algorismes d&#039;encriptació</p>
<p>
Un algorisme d’encriptació s’utilitza per codificar informació a fi que únicament hi puguin accedir les persones que en coneixen la clau per descodificar-la. Per encriptar les contrasenyes es fan servir diferents algorismes, com ara DES, MD5, SHA, . . .
</p>
</div></div><pre class="code">dn: cn=config
changetype: modify

dn: olcDatabase={0}config,cn=config
changetype: modify
add: olcRootDN
olcRootDN: cn=admin,cn=config

dn: olcDatabase={0}config,cn=config
changetype: modify
add: olcRootPW
olcRootPW: {CRYPT}aLJLqqUipInfk

dn: olcDatabase={0}config,cn=config
changetype: modify
delete: olcAccess</pre>

<p>
En la línia que conté <strong>olcRootPW</strong> hem d’escriure el que retorna la instrucció <strong>slappasswd -h {CRYPT}</strong>
</p>

<p>

</p>

<p>
<strong>5.</strong> Carreguem aquest fitxer de configuració en el servidor LDAP:
</p>
<pre class="code">ldapadd -Y EXTERNAL -H ldapi:/// -f config.ldif</pre>

<p>
<strong>6.</strong> Creem el fitxer <code>backend.meudomini.org.ldif</code> amb el contingut següent:
</p>
<pre class="code"># Load dynamic backend modules

dn: cn=module,cn=config
objectClass: olcModuleList
cn: module
olcModulepath: /usr/lib/ldap
olcModuleload: back_hdb
# Database settings

dn: olcDatabase=hdb,cn=config
objectClass: olcDatabaseConfig
objectClass: olcHdbConfig
olcDatabase: {1}hdb
olcSuffix: dc=meudomini,dc=org
olcDbDirectory: /var/lib/ldap
olcRootDN: cn=admin,dc=meudomini,dc=org
olcRootPW: {CRYPT}aLJLqqUipInfk
olcDbConfig: set_cachesize 0 2097152 0
olcDbConfig: set_lk_max_objects 1500
olcDbConfig: set_lk_max_locks 1500
olcDbConfig: set_lk_max_lockers 1500
olcDbIndex: objectClass eq
olcLastMod: TRUE
olcDbCheckpoint: 512 30
olcAccess: to attrs=userPassword by dn=&quot;cn=admin,dc=meudomini,dc=org&quot; write by anonymous auth by self write by * none
olcAccess: to attrs=shadowLastChange by self write by * read
olcAccess: to dn.base=&quot;&quot; by * read
olcAccess: to * by dn=&quot;cn=admin,dc=meudomini,dc=org&quot; write by * read</pre>

<p>
Hem de tornar a escriure la contrasenya encriptada mitjançant el mètode {CRYPT} en la línia que conté <strong>olcRootPW</strong>, i hem d’escriure el nom distingit de l’usuari administrador a la línia que conté <strong>olcAccess</strong>.
</p>

<p>
<strong>7.</strong> Carreguem el fitxer ldif al directori:
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">389 Directory Server</p>
<p>
Les distribucions de GNU/Linux com ara Red Hat, CentOS, i Fedora disposen d’una interfície gràfica per dur a terme les tasques d’instal·lació i administració d’un domini, que s’anomena <em>Red Hat Directory Server</em> (en el cas de Red Hat), i 389 Directory Server en el cas de CentOS i Fedora.
</p>
</div></div><pre class="code">ldapadd -Y EXTERNAL -H ldapi:/// -f backend.meudomini.org.ldif</pre>

<p>
<strong>8.</strong> Omplim el directori del <em>front-end</em>. Creem el fitxer <code>frontend.meudomini.org.ldif</code> amb el contingut següent:
</p>
<pre class="code"># Create top-level object in domain

dn: dc=meudomini,dc=org
objectClass: top
objectClass: dcObject
objectclass: organization
o: Example Organization
dc: meudomini
description: Domini exemple LDAP meudomini
# Admin user.

dn: cn=admin,dc=meudomini,dc=org
objectClass: simpleSecurityObject
objectClass: organizationalRole
cn: admin
description: administrador LDAP
userPassword: {CRYPT}aLJLqqUipInfk

dn: ou=people,dc=meudomini,dc=org
objectClass: organizationalUnit
ou: people

dn: ou=groups,dc=meudomini,dc=org
objectClass: organizationalUnit
ou: groups

dn: uid=usuari,ou=people,dc=meudomini,dc=org
objectClass: inetOrgPerson
objectClass: posixAccount
objectClass: shadowAccount
uid: usuari
sn: usuari
givenName: usuari
cn: usuari
displayName: usuari
uidNumber: 1000
gidNumber: 10000
userPassword: usuari
gecos: usuari
loginShell: /bin/bash
homeDirectory: /home/usuari
shadowExpire: -1
shadowFlag: 0
shadowWarning: 7
shadowMin: 8
shadowMax: 999999
shadowLastChange: 10877
mail: usuari@meudomini.org
postalCode: 31000
l: Manresa
o: Example
mobile: +34 (0)6 xx xx xx xx
homePhone: +34 (0)9 xx xx xx xx
title: System Administrator
postalAddress:
initials: usuari

dn: cn=meudomini,ou=groups,dc=meudomini,dc=org
objectClass: posixGroup
cn: example
gidNumber: 10000</pre>

<p>
<strong>9.</strong> Afegim les entrades al directori LDAP:
</p>
<pre class="code">ldapadd -x -D cn=admin,dc=meudomini,dc=org -W -f frontend.meudomini.org.ldif</pre>

<p>
<strong>10.</strong> Comprovem que el contingut s’ha afegit satisfactòriament fent una cerca:
</p>
<pre class="code">ldapsearch -xLLL -b &quot;dc=meudomini,dc=org&quot; uid=usuari sn givenName cn

dn: uid=usuari,ou=people,dc=meudomini,dc=org
sn: usuari
givenName: usuari
cn: usuari</pre>

<p>
<strong>11.</strong> Amb aquest pas ja hem fet la configuració bàsica del domini i n’hem creat els elements mínims. Si ho volem, per facilitar la tasca d’administració podem instal·lar phpladapadmin, mitjançant l’ordre:
</p>
<div class="iocnote"><div class="ioccontent">
<p>
phpLDAPadmin es pot fer servir des de qualsevol màquina amb qualsevol sistema operatiu que tingui un navegador web, i que estigui connectada en xarxa al servidor.
</p>
</div></div><pre class="code">apt-get install phpldapadmin</pre>

<p>
<strong>12.</strong> Editem el fitxer de configuració, per exemple, amb l’editor nano:
</p>
<pre class="code">nano /etc/phpldapadmin/config.php</pre>

<p>
<strong>13.</strong> Cerquem les línies següents:
</p>
<pre class="code">$servers-&gt;setValue(&#039;server&#039;,&#039;base&#039;,array(&#039;dc=example,dc=com&#039;));
$servers-&gt;setValue(&#039;login&#039;,&#039;bind_id&#039;,&#039;cn=admin,dc=example,dc=com&#039;);</pre>

<p>
<strong>14.</strong> Les substituïm per aquestes:
</p>
<pre class="code">$servers-&gt;setValue(&#039;server&#039;,&#039;base&#039;,array(&#039;dc=meudomini,dc=org&#039;));
$servers-&gt;setValue(&#039;login&#039;,&#039;bind_id&#039;,&#039;cn=admin,dc=meudomini,dc=org&#039;);</pre>

<p>
<strong>15.</strong> Reiniciem el servidor web apache:
</p>
<pre class="code">/etc/init.d/apache2 restart</pre>

<p>
<strong>16.</strong> Accedim a phpldapadmin iniciant un navegador i escrivint la <acronym title="Uniform Resource Locator">URL</acronym> següent a la barra de navegació:
</p>

<p>
<a href="http://127.0.0.1/phpldapadmin" class="urlextern" title="http://127.0.0.1/phpldapadmin"  rel="nofollow">http://127.0.0.1/phpldapadmin</a>
</p>

</div>

<h4><a id="autenticacio_amb_ldap" >Autenticació amb LDAP</a></h4>
<div class="level4">

<p>
Un cop tenim el servidor LDAP funcionant, podem configurar el client, per tal que els usuaris que hem creat amb LDAP puguin iniciar la sessió en el servidor. El client pot ser el mateix servidor o un altre ordinador connectat a ell mitjançant la xarxa. Per fer això cal seguim els passos següents:
</p>

<p>
<strong>1.</strong> Instal·lem els paquets <strong>auth-client-config</strong> i <strong>libnss-ldap</strong> que faciliten l’autenticació d’un client Ubuntu en un servidor LDAP. Per fer-ho, hem d’escriure en una consola:
</p>
<pre class="code">apt-get install libnss-ldap auth-client-config</pre>

<p>
<strong>2.</strong> Ens demanarà l’adreça del servidor LDAP. Contestem:
</p>
<pre class="code">ldapi:///127.0.0.1</pre>

<p>
<strong>3.</strong> Tot seguit escrivim el nom distingit del domini i l’extensió corresponent:
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Connexió d&#039;altres clients per xarxa</p>
<p>
En cas que ens connectem al servidor LDAP mitjançant un client connectat en xarxa, hem de modificar <strong>127.0.0.1</strong>, o <strong>localhost</strong>,  per l’adreça IP del servidor; la resta de la configuració és la mateixa que si ho fem localment.
</p>
</div></div><pre class="code">dc=meudomini,dc=org</pre>

<p>
<strong>4.</strong> Ens demana quina versió de l’LDAP farem servir; escollim la versió 3.
</p>

<p>
<strong>5.</strong> Ens demana si el <em>root</em> local ha de ser administrador de l’LDAP; contestem que sí.
</p>

<p>
<strong>6.</strong> Pregunta si necessitem autenticar per accedir a les entrades de la base de dades; contestem l’opció per defecte (no).
</p>

<p>
<strong>7.</strong> Ens demana el compte que s’ha de fer servir quan el <em>root</em> canviï una contrasenya. Contestem:
</p>
<pre class="code">dc=admin,dc=meudomini,dc=org</pre>

<p>
<strong>8.</strong> Escrivim la contrasenya de <em>root</em>, i s’acaba la configuració del paquet.
</p>

<p>

</p>

<p>
<strong>9.</strong> Un cop hem configurat <strong>libnss-ldap</strong>, habilitem el perfil LDAP del paquet <strong>auth-client-config</strong> LDAP escrivint:
</p>
<pre class="code">auth-client-config -t nss -p lac_ldap</pre>

<p>
Podem veure el significat dels paràmetres d’aquesta instrucció en la <span class="tabref"><a href="#Table4"><span>taula</span></a></span>.
</p>
<div class="ioctable ">
<div class="titletable"><a name="Table4"><span>Taula: </span></a>Paràmetres de auth-client-config</div>
<div class="table"><table class="inline">
	<tr class="row0">
		<th class="col0"> Paràmetre </th><th class="col1"> Significat </th>
	</tr>
	<tr class="row1">
		<td class="col0"> <strong>-t</strong> </td><td class="col1"> Només modifica el fitxer /etc/nsswitch.conf. </td>
	</tr>
	<tr class="row2">
		<td class="col0"><strong> -p</strong> </td><td class="col1"> Nom del perfil que s’ha d’habilitar o deshabilitar. </td>
	</tr>
	<tr class="row3">
		<td class="col0"> <strong>lac_ldap</strong> </td><td class="col1"> El perfil de auth-client-config que és part del paquet ldap-auth-config </td>
	</tr>
</table></div>
</div>
<p>
<strong>10.</strong> Fent servir la utilitat <strong>pam-auth-update</strong> configurem el sistema perquè faci servir autenticació via LDAP:
</p>
<pre class="code">pam-auth-update</pre>

<p>
<strong>11.</strong> En el menú de configuració de la utilitat, habilitem com a mínim l’autenticació LDAP.
</p>

<p>
<strong>12.</strong> Ens assegurem que tenim habilitat el connector (<em>plug-in</em>) <strong>pam_mkhomedir</strong>, perquè, quan un usuari s’autentiqui via LDAP, es creï automàticament el seu directori personal (si no, no podrà iniciar la sessió). Per fer-ho, comprovem que el fitxer pam_mkhomedir.so està en el directori <code>/lib/security</code>.
</p>

<p>
<strong>13.</strong> Cerquem dins dels fitxers <code>/etc/pam.d/gdm</code> i <code>/etc/pam.d/login</code> les línies que comencen per:
</p>
<pre class="code">   session . . .</pre>

<p>
I hi afegim la línia:
</p>
<pre class="code">   session required /lib/security/pam_mkhomedir.so skel=/etc/skel umask=0022</pre>

</div>

<h4><a id="assegurament_de_l_autenticacio_mitjancant_tls_i_ssl" >Assegurament de l&#039;autenticació mitjançant TLS i SSL</a></h4>
<div class="level4">

<p>
Quan un usuari s’autentiqui en un servidor OpenLDAP, és aconsellable fer-ho amb una sessió encriptada. Això es pot aconseguir utilitzant el protocol TLS (‘capa de transport segura’) i el protocol SSL (‘capa de sòcols segura’). Per a això, hem de seguir una sèrie de passos que detallem tot seguit:
</p>

<p>
<strong>1.</strong> Primer de tot, hem d’obtenir o crear un certificat. Com que el domini de LDAP (slapd) està compilat utilitzant la llibreria gnutls, és aconsellable fer servir la utilitat certtool per crear aquest certificat. Instal·lem <strong>gnutls-bin</strong> mitjançant l’ordre següent:
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">TLS i SSL</p>
<p>
<em>secure sockets layer</em>, ‘protocol de capa de connexió segura (SSL) i <em>transport layer security</em>, ‘seguretat de la capa de transport’ (TLS), que n’és el successor, són protocols criptogràfics que proporcionen comunicacions segures en una xarxa, que habitualment és Internet.
</p>
</div></div><pre class="code">apt-get install gnutls-bin</pre>

<p>
<strong>2.</strong> Tot seguit, creem la clau privada per un certificat d’autoritat (CA):
</p>
<pre class="code">sh -c &quot;certtool --generate-privkey &gt; /etc/ssl/private/cakey.pem&quot;</pre>

<p>
<strong>3.</strong> Creem el fitxer <code>/etc/ssl/ca.info</code> que, automàticament, signarà el certificat d’autoritat (CA), amb el contingut següent:
</p>
<pre class="code">cn = Example Company
ca
cert_signing_key</pre>

<p>
<strong>4.</strong> Creem el certificat d’autoritat autosignat:
</p>
<pre class="code">certtool --generate-self-signed --load-privkey \
/etc/ssl/private/cakey.pem --template \
/etc/ssl/ca.info --outfile /etc/ssl/certs/cacert.pem</pre>

<p>
<strong>5.</strong> Creem una clau privada per al servidor:
</p>
<pre class="code">sh -c &quot;certtool --generate-privkey &gt; /etc/ssl/private/ldap01_slapd_key.pem&quot;</pre>

<p>
Per facilitar les coses, cal reemplaçar <strong>ldap01</strong> en el nom del fitxer amb el nom de l’amfitrió del servidor. 
</p>

<p>
<strong>6.</strong> Per tal de signar el certificat del servidor amb el certificat d’autoritat (CA), creem el fitxer <code>/etc/ssl/ldap01.info</code> amb el contingut següent:
</p>
<pre class="code">organization = Example Company
cn = ldap01.meudomini.org
tls_www_server
encryption_key
signing_key</pre>

<p>
<strong>7.</strong> Creem el certificat del servidor:
</p>
<pre class="code">certtool --generate-certificate --load-privkey \
/etc/ssl/private/ldap01_slapd_key.pem \ 
--load-ca-certificate /etc/ssl/certs/cacert.pem \ 
--load-ca-privkey /etc/ssl/private/cakey.pem \
--template /etc/ssl/ldap01.info \
--outfile /etc/ssl/certs/ldap01_slapd_cert.pem</pre>

<p>
<strong>8.</strong> Un cop tenim un certificat, una clau i un certificat d’autoritat instal·lats, fem servir l’eina <strong>ldapmodify</strong> per afegir les noves opcions de configuració:
</p>
<pre class="code">ldapmodify -Y EXTERNAL -H ldapi:///

Enter LDAP Password:
dn: cn=config 
add: olcTLSCACertificateFile
olcTLSCACertificateFile: /etc/ssl/certs/cacert.pem
-
add: olcTLSCertificateFile
olcTLSCertificateFile: /etc/ssl/certs/ldap01_slapd_cert.pem
-
add: olcTLSCertificateKeyFile
olcTLSCertificateKeyFile: /etc/ssl/private/ldap01_slapd_key.pem

modifying entry &quot;cn=config&quot;</pre>

<p>
Cal modificar el nom dels fitxers <code>ldap01_slap_cert.pem</code>, <code>ldap01_slapd_key.pem</code> i <code>cacert.pem</code>, si els que hem utilitzat són diferents.
</p>

<p>

</p>

<p>
<strong>9.</strong> Tot seguit, editem el fitxer <code>/etc/default/slapd</code> i descomentem (traiem el símbol # del principi de la línia) de l’opció SLAPD_SERVICES:
</p>
<pre class="code">SLAPD_SERVICES=&quot;ldap:/// ldapi:/// ldaps:///&quot;</pre>

<p>
<strong>10.</strong> Ara, els usuaris d’openldap necessiten accedir al servidor per mitjà del certificat:
</p>
<pre class="code">adduser openldap ssl-cert
chgrp ssl-cert /etc/ssl/private/ldap01_slapd_key.pem
sudo chmod g+r /etc/ssl/private/ldap01_slapd_key.pem</pre>

<p>
Si els fitxers <code>/etc/ssl/private</code> i <code>/etc/ssl/private/server.key</code> tenen permisos diferents, ajustem les instruccions de la manera adient.
</p>

<p>
<strong>11.</strong> Per acabar, reiniciem el domini slapd:
</p>
<pre class="code">/etc/init.d/slapd restart</pre>

<p>
Fet això, el domini de slapd hauria d’escoltar les connexions LDAPS i ser capaç d’utilitzar STARTTLS durant l’autenticació.
</p>

</div>

<h3><a id="documentacio" >Documentació</a></h3>
<div class="level3">

<p>
Per comprendre i poder mantenir fàcilment el funcionament d’un domini, cal tenir una bona documentació que reflecteixi tots els elements que en formen part.
</p>

<p>
De fet, els documents que parlen de l’arquitectura d’un domini són uns dels més estesos, però, al mateix temps, sovint no són massa ben entesos ni queda clar què han de contenir.
</p>

<p>
De vegades, aquests documents no estan ordenats, i es troben en estats d’elaboració diferents: alguns són esborranys, d’altres són complets però no estan actualitzats, d’altres contenen informació no rellevant.
</p>

<p>
En qualsevol cas, a l’hora d’elaborar aquesta documentació ens hem de fixar a qui s’adreça i també ens hem d’assegurar que es pot mantenir actualitzada. Hem de tenir en compte a qui va destinat cada document, i estructurar la documentació de manera adequada. Vegem diferents aspectes que hem de considerar a l’hora d’elaborar-la:
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Eines informàtiques</p>
<p>
Per realitzar l’esquema del domini podem utilitzar qualsevol programa de creació de dibuixos, com ara l’OpenOffice Draw. Per crear esquemes visuals de la xarxa podem fer servir eines en línia gratuïtes, com, per exemple, <a href="http://www.gliffy.com" class="urlextern" title="http://www.gliffy.com"  rel="nofollow">Pàgina web Gliffy</a>
</p>
</div></div><ul>
<li class="level1"><div class="li"> Les audiències principals a les quals s’adreça la documentació del domini és el seu administrador, i el grup de suport corresponent. En aquest tipus de document es pot utilitzar terminologia tècnica.</div>
</li>
<li class="level1"><div class="li"> El contingut primari de la documentació són els principis de disseny, les categories, els grups, els usuaris, etc.</div>
</li>
<li class="level1"><div class="li"> El contingut ha de ser descriptiu, però al mateix temps no s’ha de convertir en una guia d’aprenentatge llarga; no es tracta de documents educacionals.</div>
</li>
<li class="level1"><div class="li"> Per dur-ne a terme l’elaboració, serà necessària la col·laboració entre diferents departaments de l’organització. </div>
</li>
<li class="level1"><div class="li"> Els diversos documents que realitzem poden tenir nivells d’especificacions i detall diferents; per tant, no cal que siguin tots iguals.</div>
</li>
</ul>

<p>
En qualsevol cas, una bona documentació referent a un domini ha de recollir els aspectes següents:
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">OCS</p>
<p>
<a href="http://www.ocsinventory-ng.org/" class="urlextern" title="http://www.ocsinventory-ng.org/"  rel="nofollow">http://www.ocsinventory-ng.org/</a> <em>Open computer and software inventory next generation</em> (‘inventari de maquinari i programari obert de nova generació’) és una aplicació dissenyada per facilitar a un administrador d’una xarxa el manteniment de l’inventari dels ordinadors i el programari instal·lats en aquesta xarxa. 
</p>
</div></div><ul>
<li class="level1"><div class="li"> Un inventari de tot el maquinari instal·lat en el domini. Això inclou les configuracions de maquinari dels diversos clients, com del servidor (microprocessador, memòria RAM, disc dur…). També ha d’incloure tot el maquinari de xarxa com ara encaminadors, commutadors i altres elements (impressores, NAS, projectors, escàners…).</div>
</li>
<li class="level1"><div class="li"> Un inventari amb tots els sistemes operatius instal·lats i els ordinadors als quals corresponen. La configuració de xarxa corresponent, incloent-hi la IP i el nom de cada amfitrió.</div>
</li>
<li class="level1"><div class="li"> Un esquema visual de la xarxa, que permet analitzar i planificar millores sobre aquesta xarxa.</div>
</li>
<li class="level1"><div class="li"> Un inventari del programari instal·lat en el domini, tant en el servidor de domini com en les màquines client. Això hauria d’incloure una llista detallada de tots els sistemes operatius i les aplicacions instal·lades en cada node de la xarxa, i la versió corresponent. D’aquesta manera, l’administrador del domini pot veure si el programari dels clients del domini està actualitzat o no.</div>
</li>
<li class="level1"><div class="li"> Una llista on constin el nom de tots els elements del domini, amb el nom distingit corresponent. Això inclou el nom del domini, l’extensió, l’usuari administrador, les unitats organitzatives, els usuaris i els grups. </div>
</li>
<li class="level1"><div class="li"> Un esquema visual en forma d’arbre del domini.</div>
</li>
<li class="level1"><div class="li"> També cal tenir una llista de totes les contrasenyes actualitzades, documentació que només ha de ser accessible per l’usuari administrador del domini.</div>
</li>
</ul>

<p>
Val a dir que, per dur a terme aquesta tasca, disposem d’un conjunt d’eines informàtiques que permeten crear esquemes de xarxes, esquemes visuals genèrics (per crear l’esquema del domini) i programari que permet crear inventaris del maquinari instal·lat a la xarxa d’una manera automatitzada.
</p>

</div>

	 </article>
     <div class="pnpage">
      <div class="left-corner"></div>
      <div id="prevpage">Anar a la p&agrave;gina anterior:<br /><a href="../../../WebContent/u7/referencies.html">Referències</a></div>
      <div id="nextpage">Anar a la p&agrave;gina seg&uuml;ent:<br /><a href="../../../WebContent/u7/a1/activitats.html">Activitats</a></div>
      <div class="right-corner"></div>
     </div>
    </div>
    <footer class="footer">
      <div><small>Aquest document està subjecte a una llicència oberta de Creative Commons, es reserva el dret de reconeixement de l'autoria, d'exigir que no se'n faci cap mena d'ús comercial. Si altereu o transformeu aquesta obra, o en genereu obres derivades, només podeu distribuir l'obra generada amb una llicència idèntica a aquesta.</small></div>
    </footer>
 </div>
 <div id="back_preview" class="hidden"></div>
 <div id="preview" class="hidden">
  <div class="prevcontent"></div>
 </div>
 <div id="help-tooltips">
  <div id="help-toc" class="hidden tooltip"><span>Taula de continguts:</span> Ofereix una vista general de l&#39;estructura del m&ograve;dul, que us facilitar&agrave; la navegaci&oacute; a trav&eacute;s dels seus continguts.<span class="arrow-left"></span></div> 
  <div id="help-settings" class="hidden tooltip"><span>Opcions de format:</span> Permet configurar el format de lectura a partir de les vostres prefer&egrave;ncies, modificant la mida de la lletra, el color del fons, l&#39;amplada de la p&agrave;gina o l&#39;ocultaci&oacute; dels continguts complementaris, entre d&#39;altres.<span class="arrow-left"></span></div>
  <div id="help-printer" class="hidden tooltip"><span>Imprimir:</span>  Envia el contingut seleccionat a la impressora.<span class="arrow-left"></span></div>
  <div id="help-favorites" class="hidden tooltip"><span>Prefereits:</span> Permet desar aquelles parts del contingut a les que us interessi accedir en un moment posterior; us permetr&agrave; anar creant un repositori personalitzat de les seccions que considereu m&eacute;s rellevants. Un cop l&#39;hageu començat a fer servir se us mostrar&agrave; a sota un comptador que us informar&agrave; del nombre de preferits que s&#39;hagin emmagatzemat fins al moment.<span class="arrow-left"></span></div>
  <div id="help-favcounter" class="hidden tooltip"><span>Comptador i llistat de preferits:</span> Indica el nombre de preferits que s&#39;han desat fins el moment; clicant damunt seu accedireu al llistat de preferits, i a trav&eacute;s d&#39;aquest podreu accedir directament als continguts que hageu emmagatzemat.<span class="arrow-left"></span></div>
  <div id="help-help_icon" class="hidden tooltip"><span>Ajuda:</span> Aquesta opci&oacute; activa la informaci&oacute; de les funcionalitats del web tot situant el punter del ratol&iacute; al damunt dels diferents &iacute;tems.<span class="arrow-left"></span></div>
  <div id="help-sidebar-hide" class="hidden tooltip"><span>Mostrar/Ocultar barra lateral:</span>  Deshabilita la barra d&#39;opcions, permetent la seva recuperaci&oacute; quan es desitgi.<span class="arrow-left"></span></div>
  <div id="help-search" class="hidden tooltip"><span>Cerca:</span>  Introdu&iuml;u les paraules clau sobre aquells conceptes que desitgeu localitzar en els continguts del m&ograve;dul. Tamb&eacute; podeu excloure un terme de la cerca tot afegint-hi el signe &#8220;-&#8221; al davant.<span class="arrow-top"></span></div>
  <div id="help-header" class="hidden tooltip"><span>Cap&ccedil;alera:</span>  Indica l&#39;apartat o secci&oacute; que es mostra en pantalla. Tingueu present que les capçaleres de segon, tercer i quart nivell tamb&eacute; es poden desar com a marcadors.<span class="arrow-left"></span></div>
</div> 
</body>
</html>
