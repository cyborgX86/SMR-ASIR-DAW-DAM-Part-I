<!doctype html>

<!--[if lt IE 7 ]> <html class="ie ie6 no-js" lang="ca"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie ie7 no-js" lang="ca"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie ie8 no-js" lang="ca"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie ie9 no-js" lang="ca"> <![endif]-->
<!--[if gt IE 9]><!--><html class="no-js" lang="ca"><!--<![endif]-->
<!-- the "no-js" class is for Modernizr. -->

<head id="www-sitename-com" data-template-set="html5-reset">

	<meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html">
        
	<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title>Serveis de Xarxa i Internet</title>
	
<!-- <meta name="title" content=""> --> 
	<meta name="description" content="">
	<!-- Google will often use this as its description of your page/site. Make it good. -->
	
	<meta name="google-site-verification" content="">
	<!-- Speaking of Google, don't forget to set your site up: http://google.com/webmasters -->
	
	<meta name="author" content="Institut Obert de Catalunya">
	<meta name="Copyright" content="Copyright Institut Obert de Catalunya 2011. All Rights Reserved.">

	<!-- Dublin Core Metadata : http://dublincore.org/ -->
	<meta name="DC.title" content="Serveis de Xarxa i Internet">
	<meta name="DC.subject" content="Informàtica i comunicacions">
	<meta name="DC.creator" content="Institut Obert de Catalunya">
	
	<!--  Mobile Viewport Fix
	j.mp/mobileviewport & davidbcalhoun.com/2010/viewport-metatag 
	device-width : Occupy full width of the screen in its current orientation
	initial-scale = 1.0 retains dimensions instead of zooming out if page height > device height
	maximum-scale = 1.0 retains dimensions instead of zooming in if page width < device width
	-->
	<!-- Uncomment to use � use thoughtfully!
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
	-->

	<link rel="shortcut icon" href="../../../img/favicon.ico">
	<!-- This is the traditional favicon.
		 - size: 16x16 or 32x32
		 - transparency is OK
		 - see wikipedia for info on browser support: http://mky.be/favicon/ -->
		 
	<link rel="apple-touch-icon" href="../../../img/apple-touch-icon.png">
	<!-- The is the icon for iOS's Web Clip.
		 - size: 57x57 for older iPhones, 72x72 for iPads, 114x114 for iPhone4's retina display (IMHO, just go ahead and use the biggest one)
		 - To prevent iOS from applying its styles to the icon name it thusly: apple-touch-icon-precomposed.png
		 - Transparency is not recommended (iOS will put a black BG behind the icon) -->
	
	<!-- CSS: screen, mobile & print are all in the same file -->
	<link rel="stylesheet" href="../../../_/css/style.css">

	<!-- CSS: jQuery UI -->
	<link rel="stylesheet" href="../../../_/css/jquery-ui.css">
	
	<!-- all our JS is at the bottom of the page, except for Modernizr. -->
	<script src="../../../_/js/modernizr-1.7.min.js"></script>
	<script src="../../../_/js/Hyphenator.js" type="text/javascript"></script>
	<script type="text/javascript">
	   Hyphenator.config({
		minwordlength : 4
	   });
	   Hyphenator.run();
	</script>
    <script src="../../../_/js/build.js" type="text/javascript"></script>
</head>

<body class="style-newspaper">

<div class="wrapper"><!-- not needed? up to you: http://camendesign.com/code/developpeurs_sans_frontieres -->

	<header id="header">
		<div class="head"><a href="http://ioc.gencat.cat"><img src="../../../img/logo.png" alt="Institut Obert de Catalunya"/></a><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/es/deed.ca"><img src="../../../img/license.png" alt="Llic&egrave;ncia" class="license"/></a></div>
		<div class="headdocument"><a href="../../../index.html">Serveis de Xarxa i Internet</a></div>
        <div id="search" class="search" name="search">
         <form id="frmsearch" action="../../../search.html" method="get">
          <input type="text" name="q"/>
        </form>
        </div>
	</header>
   <div id="upbutton" class="upbutton" style="display:none;"><img src="../../../img/uparrow.png" alt="Pujar a l'inici de p&agrave;gina"/></div>
   <aside id="aside">
    <div id="menu">
      <ul>
       <li name="toc"><div><img src="../../../img/toc.png" alt="&Iacute;ndex"/></div></li>
       <li name="settings"><div><img src="../../../img/settings.png" alt="Configuraci&oacute;"/></div></li>
       <li name="printer"><div><img src="../../../img/printer.png" alt="Imprimir"/></div></li>
       <li name="favorites"><div><img src="../../../img/favorites.png" alt="Favorits"/></div></li>
       <li name="help_icon" class="help_icon"><div><img src="../../../img/help_icon.png" alt="Ajuda"/></div></li>
      </ul>
     </div>
   </aside>
   <div id="sidebar-hide" name="sidebar-hide"><img src="../../../img/arrows.png"/></div>
   <section>
     <div id="toc" class="hidden">
      <div class="menucontent">
        <ul>
        <li id="u4" class="parentnode"><p><a class="unit" href="../../../WebContent/u4/introduccio.html">4. Serveis d'àudio i vídeo</a></p><ul class="expander"><li id="u4introduccio"><a href="../../../WebContent/u4/introduccio.html">Introducció</a></li><li id="u4resum"><a href="../../../WebContent/u4/resum.html">Resum</a></li><li id="u4resultats"><a href="../../../WebContent/u4/resultats.html">Resultats d'aprenentatge</a></li><li id="u4referencies"><a href="../../../WebContent/u4/referencies.html">Referències</a></li><li id="u4a1" class="tocsection"><p id='u4a1continguts'><a class="section" href="../../../WebContent/u4/a1/continguts.html">Instal·lació i administració del servei d’àudio</a><span class="buttonexp"></span></p><ul><li id="u4a1activitats"><a href="../../../WebContent/u4/a1/activitats.html">Activitats</a></li><li id="u4a1exercicis"><a href="../../../WebContent/u4/a1/exercicis.html">Exercicis</a></li></ul></li><div data-parent-id='u4a1' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u4/a1/continguts.html#servidors_de_reproduccio_en_temps_real">Servidors de reproducció en temps real</a></li><li><a href="../../../WebContent/u4/a1/continguts.html#audio_digital">Àudio digital</a></li><li><a href="../../../WebContent/u4/a1/continguts.html#subscripcio_d_audio">Subscripció d’àudio</a></li><li><a href="../../../WebContent/u4/a1/continguts.html#reproduccio_en_temps_real">Reproducció en temps real</a></li><li><a href="../../../WebContent/u4/a1/continguts.html#programari_de_servidors_de_difusio_en_temps_real_d_audio">Programari de servidors de difusió en temps real d’àudio</a></li></ul></div></div><li id="u4a2" class="tocsection"><p id='u4a2continguts'><a class="section" href="../../../WebContent/u4/a2/continguts.html">Instal·lació i administració del servei de vídeo</a><span class="buttonexp"></span></p><ul><li id="u4a2activitats"><a href="../../../WebContent/u4/a2/activitats.html">Activitats</a></li><li id="u4a2exercicis"><a href="../../../WebContent/u4/a2/exercicis.html">Exercicis</a></li></ul></li><div data-parent-id='u4a2' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u4/a2/continguts.html#video_digital">Vídeo digital</a></li><li><a href="../../../WebContent/u4/a2/continguts.html#servidors_de_video">Servidors de vídeo</a></li><li><a href="../../../WebContent/u4/a2/continguts.html#videoconferencies">Videoconferències</a></li></ul></div></div></ul></li><li id="" class="indexnode"><p><a href="../../../index.html">Anar a l&#39;&iacute;ndex general</a></p></li>
        </ul>
      </div>
    </div>
   </section>
   <section>
   <div id="settings" class="hidden">
    <div class="menucontent">
     <div class="allsettings">
     <div class="settings">
      <label>Font i Color</label>
		<div class="setting-option">
	        <ul class="fontBackground">
				<li id="style-newspaper" title="Newspaper" class="appearance-style-newspaper"><span>Newspaper</span></li>
                <li id="style-novel" title="Novel" class="appearance-style-novel"><span>Novel</span></li>
                <li id="style-ebook" title="eBook" class="appearance-style-ebook"><span>eBook</span></li>
				<li id="style-inverse" title="Inverse" class="appearance-style-inverse active"><span>Inverse</span></li>
				<li id="style-athelas" title="Athelas" class="appearance-style-athelas"><span>Athelas</span></li>
			</ul>
		</div>
     </div>
	<div class="settings">
      <label>Amplada</label>
		<div class="setting-option">
	        <div id="slider-width"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
		<div class="setting-option">
	        <div id="slider-font"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
	  <div class="setting-option">
       <form action="" class="sett-options">
		<ul>
		    <li><input type="checkbox" id="secondary-content" /><label for="secondary-content">Mostra recursos complementaris</label></li>
		    <li><input type="checkbox" id="main-images" /><label for="main-images">Mostra imatges</label></li>
		    <li><input type="checkbox" id="text-alignment" /><label for="text-alignment">Text justificat</label></li>
			<li><input type="checkbox" id="text-hyphen" /><label for="text-hyphen">Partici&oacute; sil·l&agrave;bica</label></li>
		</ul>
       </form>
	  </div>
     </div>
     </div>
    </div>
   </div>
   </section>
 <section>
 <div id="favorites" class="hidden"></div>
 </section>   
 <div id="bridge" class="hidden"></div>
 <div id="help" class="hidden">
  <div class="helptitle">Dreceres del teclat<hr></div>
  <div class="helpsection"><span>General</span>
   <ul>
    <li><span class="shortcut">g</span>: Anar al men&uacute; de navegaci&oacute;</li>
    <li><span class="shortcut">o</span>: Anar a opcions</li>
    <li><span class="shortcut">s</span>: Guardar la p&agrave;gina actual a favorits</li>
    <li><span class="shortcut">p</span>: Imprimir la p&agrave;gina actual</li>
    <li><span class="shortcut">?</span>: Mostrar/Ocultar l&#39;ajuda</li>
   </ul>
  </div>
  <div class="helpsection"><span>Navegaci&oacute;</span>
   <ul>
    <li><span class="shortcut">i</span>: Anar a l&#39;&iacute;ndex general</li>
    <li><span class="shortcut">t</span>: Anar a l&#39;inici de p&agrave;gina</li>
    <li><span class="shortcut">b</span>: Anar al final de p&agrave;gina</li>
    <li><span class="shortcut">j</span>: Anar cap endavant dintre la p&agrave;gina</li>
    <li><span class="shortcut">k</span>: Anar cap enrere dintre la p&agrave;gina</li>
    <li><span class="shortcut">h</span>: Anar a la p&agrave;gina anterior:</li>
    <li><span class="shortcut">l</span>: Anar a la p&agrave;gina seg&uuml;ent:</li>
   </ul>
   </div>
 </div>
 <div id="favcounter" name="favcounter" class="hidden"><span></span></div>
 <div id="navmenu" class="navmenu"><ul class="webnav"><li><a href="../../../index.html" title="Anar a l&#39;&iacute;ndex general">Inici</a></li><li><a href="../introduccio.html">Serveis d'àudio i vídeo</a></li><li><a href="continguts.html">Instal·lació i administració del servei d’àudio</a></li><li>Activitats</li></ul></div>
	<div id="content" lang="ca" class="hyphenate text">
     <article lang="ca" class="sheet">
        <h1><a id="activitats"> Activitats </a></h1>
    	
<h2><a id="servei_d_audio_a_la_carta_amb_el_servidor_de_reproduccio_en_temps_real_icecast" >Servei d&#039;àudio a la carta amb el servidor de reproducció en temps real Icecast</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és instal·lar i configurar el servidor d’<em>streaming</em> d’àudio IceCast per tal de crear una estació de ràdio a internet, així com la seva utilització per part dels clients.
</p>

<p>
Feu les següents tasques:
</p>
<ol>
<li class="level1"><div class="li"> Instal·lació del servidor de reproducció en temps real Icecast</div>
</li>
<li class="level1"><div class="li"> Configuració del servidor</div>
</li>
<li class="level1"><div class="li"> Instal·lació del <em>source</em> client IceS2</div>
</li>
<li class="level1"><div class="li"> Consum de l’<em>streaming</em> d’àudio des del client</div>
</li>
</ol>

<p>
<form action=""><div class="solution ioccontent">
<p>
<strong>1.</strong> Instal·lació del servidor de reproducció en temps real Icecast
</p>

<p>
Doneu un cop d’ull a <a href="https://wiki.xiph.org/Icecast_Server/Getting_Started" class="urlextern" title="https://wiki.xiph.org/Icecast_Server/Getting_Started"  rel="nofollow">Icecast Server/Getting Started (XiphWiki)</a> per entendre com funciona. Especialment, a l’esquema i a l’apartat <em>How it works</em>.
</p>

<p>
Descarregueu de la pàgina principal el paquet .deb (<em>binary packages</em>):
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># wget http://download.opensuse.org/repositories/multimedia:/xiph/Debian_9.0/i386/icecast2_2.4.4-1_i386.deb</div></li><li class="li1"><div class="de1">--2019-10-09 06:41:33--  http://download.opensuse.org/repositories/multimedia:/xiph/Debian_9.0/i386/icecast2_2.4.4-1_i386.deb</div></li><li class="li1"><div class="de1">S'està resolent download.opensuse.org (download.opensuse.org)… 195.135.221.134, 2620:113:80c0:8::13</div></li><li class="li1"><div class="de1">S'està connectant a download.opensuse.org (download.opensuse.org)|195.135.221.134|:80… connectat.</div></li><li class="li1"><div class="de1">HTTP: s'ha enviat la petició, s'està esperant una resposta… 302 Found</div></li><li class="li1"><div class="de1">Ubicació: https://ftp.gwdg.de/pub/opensuse/repositories/multimedia:/xiph/Debian_9.0/i386/icecast2_2.4.4-1_i386.deb [es segueix]</div></li><li class="li1"><div class="de1">--2019-10-09 06:41:33--  https://ftp.gwdg.de/pub/opensuse/repositories/multimedia:/xiph/Debian_9.0/i386/icecast2_2.4.4-1_i386.deb</div></li><li class="li1"><div class="de1">S'està resolent ftp.gwdg.de (ftp.gwdg.de)… 134.76.12.6, 2001:638:60f:110::1:2</div></li><li class="li1"><div class="de1">S'està connectant a ftp.gwdg.de (ftp.gwdg.de)|134.76.12.6|:443… connectat.</div></li><li class="li1"><div class="de1">HTTP: s'ha enviat la petició, s'està esperant una resposta… 200 OK</div></li><li class="li1"><div class="de1">Mida: 1559192 (1,5M) [application/octet-stream]</div></li><li class="li1"><div class="de1">S'està desant a: «icecast2_2.4.4-1_i386.deb»</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">icecast2_2.4.4-1_i386.deb        100%[=========================================================&gt;]   1,49M   340KB/s    in 4,3s    </div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">2019-10-09 06:41:38 (356 KB/s) - s'ha desat «icecast2_2.4.4-1_i386.deb» [1559192/1559192]</div></li></ol></pre>

<p>
Instal·leu-lo:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># dpkg -i icecast2_2.4.4-1_i386.deb </div></li><li class="li1"><div class="de1">S'està seleccionant el paquet icecast2 prèviament no seleccionat.</div></li><li class="li1"><div class="de1">(S'està llegint la base de dades… hi ha 132211 fitxers i directoris instal·lats actualment.)</div></li><li class="li1"><div class="de1">S'està preparant per desempaquetar icecast2_2.4.4-1_i386.deb…</div></li><li class="li1"><div class="de1">S'està desempaquetant icecast2 (2.4.4-1)…</div></li><li class="li1"><div class="de1">S'està configurant icecast2 (2.4.4-1)…</div></li><li class="li1"><div class="de1">Configuring icecast2..</div></li><li class="li1"><div class="de1">Done Configuring icecast2..</div></li><li class="li1"><div class="de1">S'estan processant els activadors per a systemd (232-25+deb9u1)…</div></li><li class="li1"><div class="de1">S'estan processant els activadors per a man-db (2.7.6.1-2)…</div></li></ol></pre>

<p>
En la instal·lació s’inicia un assistent per configurar certs paràmetres. Ignoreu-los (ja ho fareu a través dels fitxers de configuració). Si voleu tornar a executar l’assistent, es fa amb <em>dpkg-reconfigure icecast2</em>.
</p>

<p>
Els fitxers de configuració són:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># dpkg -s icecast2</div></li><li class="li1"><div class="de1">Package: icecast2</div></li><li class="li1"><div class="de1">Status: install ok installed</div></li><li class="li1"><div class="de1">Priority: optional</div></li><li class="li1"><div class="de1">Section: sound</div></li><li class="li1"><div class="de1">Installed-Size: 2089</div></li><li class="li1"><div class="de1">Maintainer: Thomas B. Ruecker &lt;thomas@ruecker.fi&gt;</div></li><li class="li1"><div class="de1">Architecture: i386</div></li><li class="li1"><div class="de1">Version: 2.4.4-1</div></li><li class="li1"><div class="de1">Depends: adduser, libc6 (&gt;= 2.4), libcurl3-gnutls (&gt;= 7.16.2), libogg0 (&gt;= 1.0rc3), libspeex1 (&gt;= 1.2~beta3-1), libssl1.1 (&gt;= 1.1.0), libtheora0 (&gt;= 0.0.0.alpha7.dfsg), libvorbis0a (&gt;= 1.1.2), libxml2 (&gt;= 2.7.4), libxslt1.1 (&gt;= 1.1.25), debconf (&gt;= 0.5) | debconf-2.0</div></li><li class="li1"><div class="de1">Suggests: ices2</div></li><li class="li1"><div class="de1">Conffiles:</div></li><li class="li1"><div class="de1"> /etc/default/icecast2 3544ff088d4b119e3f12665c2dedc908</div></li><li class="li1"><div class="de1"> /etc/icecast2/admin/listclients.xsl 08f13609b09b23b277fd692528abd746</div></li><li class="li1"><div class="de1"> /etc/icecast2/admin/listmounts.xsl dbbd2f41e7ea853f41f1ab3970650703</div></li><li class="li1"><div class="de1"> /etc/icecast2/admin/manageauth.xsl 38ac86cc8959125cb7f7249442de6ee2</div></li><li class="li1"><div class="de1"> /etc/icecast2/admin/moveclients.xsl fdf3a0f4e1102d8cadd02a7d581dcd45</div></li><li class="li1"><div class="de1"> /etc/icecast2/admin/response.xsl 2a709877bff008bb2ebbf51c0114f681</div></li><li class="li1"><div class="de1"> /etc/icecast2/admin/stats.xsl 4ed67395b5e2f53ed50d7abfa6c88619</div></li><li class="li1"><div class="de1"> /etc/icecast2/admin/updatemetadata.xsl 534f48e58104ac59809ba3fd66c062fc</div></li><li class="li1"><div class="de1"> /etc/icecast2/admin/vclt.xsl 899bfc3b5c51a0ac59f61c1e36d94cd4</div></li><li class="li1"><div class="de1"> /etc/icecast2/admin/xspf.xsl 9b07fc5bd3ae21f9e6570e03c7328fa6</div></li><li class="li1"><div class="de1"> /etc/icecast2/icecast.xml 5ad6ebefdb4c3f9a65558268c27e3eaf</div></li><li class="li1"><div class="de1"> /etc/icecast2/web/auth.xsl 3e7eb2534a0f7e10fd3cd9f2b1fc447f</div></li><li class="li1"><div class="de1"> /etc/icecast2/web/server_version.xsl 678c656dcf6d9ef84a7f24dfda7b0f3f</div></li><li class="li1"><div class="de1"> /etc/icecast2/web/status-json.xsl 37df1c52cf31a6e70056454f1e68e63c</div></li><li class="li1"><div class="de1"> /etc/icecast2/web/status.xsl f1d95d016e31e22239e78fb3dd4b1879</div></li><li class="li1"><div class="de1"> /etc/icecast2/web/style.css e798129bc9d1bc79615c87e49aa9ad45</div></li><li class="li1"><div class="de1"> /etc/init.d/icecast2 e2d28ff05a11120c77ace41310f87368</div></li><li class="li1"><div class="de1"> /etc/logrotate.d/icecast2 1605806984e553c1f8c21428b27760da</div></li><li class="li1"><div class="de1">Description: streaming media server</div></li><li class="li1"><div class="de1"> Icecast is a versatile multimedia streaming server which can create</div></li><li class="li1"><div class="de1"> (for instance) a private jukebox or &quot;Internet radio station&quot;. It</div></li><li class="li1"><div class="de1"> supports Ogg streaming using the Vorbis and Theora codecs, as well as</div></li><li class="li1"><div class="de1"> other formats such as MP3, AAC, or NSV, and is compatible with most</div></li><li class="li1"><div class="de1"> media players.</div></li><li class="li1"><div class="de1">Homepage: http://www.icecast.org/</div></li></ol></pre>

<p>
Observeu que el principal és /etc/default/icecast2.
</p>

<p>
Comproveu l’estat del servei:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># service icecast2 status</div></li><li class="li1"><div class="de1">● icecast2.service - LSB: Starts the icecast audio streaming server daemon</div></li><li class="li1"><div class="de1">   Loaded: loaded (/etc/init.d/icecast2; generated; vendor preset: enabled)</div></li><li class="li1"><div class="de1">   Active: active (running) since Wed 2019-10-09 06:45:37 CEST; 4min 2s ago</div></li><li class="li1"><div class="de1">     Docs: man:systemd-sysv-generator(8)</div></li><li class="li1"><div class="de1">  Process: 25475 ExecStart=/etc/init.d/icecast2 start (code=exited, status=0/SUCCESS)</div></li><li class="li1"><div class="de1">    Tasks: 4 (limit: 4915)</div></li><li class="li1"><div class="de1">   CGroup: /system.slice/icecast2.service</div></li><li class="li1"><div class="de1">           └─25477 /usr/bin/icecast2 -b -c /etc/icecast2/icecast.xml</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">oct 09 06:45:37 server.ioc.cat systemd[1]: Starting LSB: Starts the icecast audio streaming server daemon...</div></li><li class="li1"><div class="de1">oct 09 06:45:37 server.ioc.cat icecast2[25475]: Starting icecast2: Starting icecast2</div></li><li class="li1"><div class="de1">oct 09 06:45:37 server.ioc.cat icecast2[25475]: Detaching from the console</div></li><li class="li1"><div class="de1">oct 09 06:45:37 server.ioc.cat icecast2[25475]: icecast2.</div></li><li class="li1"><div class="de1">oct 09 06:45:37 server.ioc.cat systemd[1]: Started LSB: Starts the icecast audio streaming server daemon.</div></li><li class="li1"><div class="de1">oct 09 06:45:37 server.ioc.cat icecast2[25475]: [2019-10-09  06:45:37] WARN CONFIG/_parse_root Warning, &lt;hostname&gt; not configured, </div></li><li class="li1"><div class="de1">oct 09 06:45:37 server.ioc.cat icecast2[25475]: [2019-10-09  06:45:37] WARN CONFIG/_parse_root Warning, &lt;location&gt; not configured, </div></li><li class="li1"><div class="de1">oct 09 06:45:37 server.ioc.cat icecast2[25475]: [2019-10-09  06:45:37] WARN CONFIG/_parse_root Warning, &lt;admin&gt; contact not configu</div></li><li class="li1"><div class="de1">oct 09 06:45:37 server.ioc.cat icecast2[25475]: Starting icecast2</div></li><li class="li1"><div class="de1">oct 09 06:45:37 server.ioc.cat icecast2[25475]: Detaching from the console</div></li></ol></pre>

<p>
Mireu quin o quins ports ha obert amb Nmap:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># nmap -A -T4 localhost</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">Starting Nmap 7.40 ( https://nmap.org ) at 2019-10-09 06:50 CEST</div></li><li class="li1"><div class="de1">Nmap scan report for localhost (127.0.0.1)</div></li><li class="li1"><div class="de1">Host is up (0.0000080s latency).</div></li><li class="li1"><div class="de1">Other addresses for localhost (not scanned): ::1</div></li><li class="li1"><div class="de1">Not shown: 997 closed ports</div></li><li class="li1"><div class="de1">PORT     STATE SERVICE VERSION</div></li><li class="li1"><div class="de1">8000/tcp open  http    Icecast streaming media server 2.4.4</div></li><li class="li1"><div class="de1">|_http-server-header: Icecast 2.4.4</div></li><li class="li1"><div class="de1">|_http-title: Icecast Streaming Media Server</div></li><li class="li1"><div class="de1">Device type: general purpose</div></li><li class="li1"><div class="de1">Running: Linux 3.X|4.X</div></li><li class="li1"><div class="de1">OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4</div></li><li class="li1"><div class="de1">OS details: Linux 3.8 - 4.6</div></li><li class="li1"><div class="de1">Network Distance: 0 hops</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</div></li><li class="li1"><div class="de1">Nmap done: 1 IP address (1 host up) scanned in 23.99 seconds</div></li></ol></pre>

<p>
<strong>2.</strong> Configuració del servidor
</p>

<p>
Ha obert un servidor web al port 8000 per tal d’administrar el servidor IceCast.
</p>

<p>
<div class="imgelem">
<img src="../media/icescast1.png" alt="" /></div>

</p>

<p>
Si mireu el fitxer principal de configuració, us remet al fitxer /etc/icecast2/icecast.xml per realitzar la configuració. També aconsella canviar tots els <em>passwords</em> per defecte:
</p>
<pre class="code"># 
# Defaults for icecast2 initscript
# sourced by /etc/init.d/icecast2
# installed at /etc/default/icecast2 by the maintainer scripts

#
# This is a POSIX shell fragment
#

# Full path to the server configuration file
CONFIGFILE=&quot;/etc/icecast2/icecast.xml&quot;

# Name or ID of the user and group the daemon should run under
USERID=icecast2
GROUPID=icecast

# Edit /etc/icecast2/icecast.xml and change at least the passwords.
# Change this to true when done to enable the init.d script
ENABLE=true</pre>

<p>
El format d’aquest fitxer de configuració és XML. El port usat es defineix en la secció &lt;listen-socket&gt; i permet tenir múltiples ports per a aquest servei:
</p>
<pre class="code xml"><ol><li class="li1"><div class="de1">    &lt;!-- You may have multiple &lt;listen-socket&gt; elements --&gt;</div></li><li class="li1"><div class="de1">    &lt;listen-socket&gt;</div></li><li class="li1"><div class="de1">        &lt;port&gt;8000&lt;/port&gt;</div></li><li class="li1"><div class="de1">        &lt;!-- &lt;bind-address&gt;127.0.0.1&lt;/bind-address&gt; --&gt;</div></li><li class="li1"><div class="de1">        &lt;!-- &lt;shoutcast-mount&gt;/stream&lt;/shoutcast-mount&gt; --&gt;</div></li><li class="li1"><div class="de1">    &lt;/listen-socket&gt;</div></li><li class="li1"><div class="de1">    &lt;!--</div></li><li class="li1"><div class="de1">    &lt;listen-socket&gt;</div></li><li class="li1"><div class="de1">        &lt;port&gt;8080&lt;/port&gt;</div></li><li class="li1"><div class="de1">    &lt;/listen-socket&gt;</div></li><li class="li1"><div class="de1">    --&gt;</div></li><li class="li1"><div class="de1">    &lt;!--</div></li><li class="li1"><div class="de1">    &lt;listen-socket&gt;</div></li><li class="li1"><div class="de1">        &lt;port&gt;8443&lt;/port&gt;</div></li><li class="li1"><div class="de1">        &lt;ssl&gt;1&lt;/ssl&gt;</div></li><li class="li1"><div class="de1">    &lt;/listen-socket&gt;</div></li><li class="li1"><div class="de1">    --&gt;</div></li></ol></pre>

<p>
Les contrasenyes, entre d’altres les d’administrador, es troben en la secció &lt;authentication&gt;:
</p>
<pre class="code xml"><ol><li class="li1"><div class="de1">    &lt;authentication&gt;</div></li><li class="li1"><div class="de1">        &lt;!-- Sources log in with username 'source' --&gt;</div></li><li class="li1"><div class="de1">        &lt;source-password&gt;hackme&lt;/source-password&gt;</div></li><li class="li1"><div class="de1">        &lt;!-- Relays log in with username 'relay' --&gt;</div></li><li class="li1"><div class="de1">        &lt;relay-password&gt;hackme&lt;/relay-password&gt;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">        &lt;!-- Admin logs in with the username given below --&gt;</div></li><li class="li1"><div class="de1">        &lt;admin-user&gt;admin&lt;/admin-user&gt;</div></li><li class="li1"><div class="de1">        &lt;admin-password&gt;hackme&lt;/admin-password&gt;</div></li><li class="li1"><div class="de1">    &lt;/authentication&gt;</div></li></ol></pre>

<p>
<strong>3.</strong> Instal·lació del <em>source</em> client IceS2
</p>

<p>
Instal·leu el programari IceS2:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># apt-get install ices2</div></li><li class="li1"><div class="de1">S'està llegint la llista de paquets… Fet </div></li><li class="li1"><div class="de1">S'està construint l'arbre de dependències       </div></li><li class="li1"><div class="de1">S'està llegint la informació de l'estat… Fet</div></li><li class="li1"><div class="de1">El paquets següents s'han instal·lat automàticament i ja no seran necessaris:</div></li><li class="li1"><div class="de1">  libfam0 spawn-fcgi</div></li><li class="li1"><div class="de1">Empreu «apt autoremove» per suprimir-los.</div></li><li class="li1"><div class="de1">S'instal·laran els paquets NOUS següents:</div></li><li class="li1"><div class="de1">  ices2</div></li><li class="li1"><div class="de1">0 actualitzats, 1 nous a instal·lar, 0 a suprimir i 320 no actualitzats.</div></li><li class="li1"><div class="de1">S'ha d'obtenir 0 B/65,6 kB d'arxius.</div></li><li class="li1"><div class="de1">Després d'aquesta operació s'empraran 196 kB d'espai en disc addicional.</div></li><li class="li1"><div class="de1">S'està seleccionant el paquet ices2 prèviament no seleccionat.</div></li><li class="li1"><div class="de1">(S'està llegint la base de dades… hi ha 132308 fitxers i directoris instal·lats actualment.)</div></li><li class="li1"><div class="de1">S'està preparant per desempaquetar …/ices2_2.0.2-2+b1_i386.deb…</div></li><li class="li1"><div class="de1">S'està desempaquetant ices2 (2.0.2-2+b1)…</div></li><li class="li1"><div class="de1">S'està configurant ices2 (2.0.2-2+b1)…</div></li><li class="li1"><div class="de1">S'estan processant els activadors per a man-db (2.7.6.1-2)…</div></li></ol></pre>

<p>
Llisteu els fitxers instal·lats en el sistema:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># dpkg-query -L ices2</div></li><li class="li1"><div class="de1">/.</div></li><li class="li1"><div class="de1">/usr</div></li><li class="li1"><div class="de1">/usr/bin</div></li><li class="li1"><div class="de1">/usr/bin/ices2</div></li><li class="li1"><div class="de1">/usr/share</div></li><li class="li1"><div class="de1">/usr/share/doc</div></li><li class="li1"><div class="de1">/usr/share/doc/ices2</div></li><li class="li1"><div class="de1">/usr/share/doc/ices2/AUTHORS</div></li><li class="li1"><div class="de1">/usr/share/doc/ices2/README</div></li><li class="li1"><div class="de1">/usr/share/doc/ices2/README.Debian</div></li><li class="li1"><div class="de1">/usr/share/doc/ices2/TODO</div></li><li class="li1"><div class="de1">/usr/share/doc/ices2/buildinfo_i386.gz</div></li><li class="li1"><div class="de1">/usr/share/doc/ices2/changelog.Debian.gz</div></li><li class="li1"><div class="de1">/usr/share/doc/ices2/changelog.Debian.i386.gz</div></li><li class="li1"><div class="de1">/usr/share/doc/ices2/copyright</div></li><li class="li1"><div class="de1">/usr/share/doc/ices2/examples</div></li><li class="li1"><div class="de1">/usr/share/doc/ices2/examples/ices-alsa.xml</div></li><li class="li1"><div class="de1">/usr/share/doc/ices2/examples/ices-oss.xml</div></li><li class="li1"><div class="de1">/usr/share/doc/ices2/examples/ices-playlist.xml</div></li><li class="li1"><div class="de1">/usr/share/doc/ices2/examples/ices-roar.xml</div></li><li class="li1"><div class="de1">/usr/share/doc/ices2/html</div></li><li class="li1"><div class="de1">/usr/share/doc/ices2/html/basic.html</div></li><li class="li1"><div class="de1">/usr/share/doc/ices2/html/config.html</div></li><li class="li1"><div class="de1">/usr/share/doc/ices2/html/faq.html</div></li><li class="li1"><div class="de1">/usr/share/doc/ices2/html/index.html</div></li><li class="li1"><div class="de1">/usr/share/doc/ices2/html/inputs.html</div></li><li class="li1"><div class="de1">/usr/share/doc/ices2/html/intro.html</div></li><li class="li1"><div class="de1">/usr/share/doc/ices2/html/style.css</div></li><li class="li1"><div class="de1">/usr/share/doc/ices2/ices.init.example</div></li><li class="li1"><div class="de1">/usr/share/doc-base</div></li><li class="li1"><div class="de1">/usr/share/doc-base/ices2</div></li><li class="li1"><div class="de1">/usr/share/man</div></li><li class="li1"><div class="de1">/usr/share/man/man1</div></li><li class="li1"><div class="de1">/usr/share/man/man1/ices2.1.gz</div></li></ol></pre>

<p>
En el contingut veureu un exemple de configuració per a la llista de reproducció (<em>playlist</em>), el fitxer /usr/share/doc/ices2/examples/ices-playlist.xml. L’usareu després.
</p>

<p>
Creeu la carpeta <em>/var/log/ices</em>:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">mkdir /var/log/ices</div></li></ol></pre>

<p>
Creeu la llista de reproducció que conté les cançons (en aquest cas, en format OGG):
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># ls *.ogg &gt; llista.m3u</div></li></ol></pre>

<p>
Copieu l’exemple de configuració per a la llista de reproducció comentat anteriorment:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># cp /usr/share/doc/ices2/examples/ices-playlist.xml /home/usuari</div></li></ol></pre>

<p>
I modifiqueu del fitxer ices-playlist.xml la secció &lt;input&gt; per indicar-li la llista de reproducció (es podrien modificar altres paràmetres, com que l’ordre de les cançons fos aleatori):
</p>
<pre class="code xml"><ol><li class="li1"><div class="de1">       &lt;input&gt;</div></li><li class="li1"><div class="de1">            &lt;module&gt;playlist&lt;/module&gt;</div></li><li class="li1"><div class="de1">            &lt;param name=&quot;type&quot;&gt;basic&lt;/param&gt;</div></li><li class="li1"><div class="de1">            &lt;param name=&quot;file&quot;&gt;llista.m3u&lt;/param&gt;</div></li><li class="li1"><div class="de1">            &lt;!-- random play --&gt;</div></li><li class="li1"><div class="de1">            &lt;param name=&quot;random&quot;&gt;0&lt;/param&gt;</div></li><li class="li1"><div class="de1">            &lt;!-- if the playlist get updated that start at the beginning --&gt;</div></li><li class="li1"><div class="de1">            &lt;param name=&quot;restart-after-reread&quot;&gt;0&lt;/param&gt;</div></li><li class="li1"><div class="de1">            &lt;!-- if set to 1 , plays once through, then exits. --&gt;</div></li><li class="li1"><div class="de1">            &lt;param name=&quot;once&quot;&gt;0&lt;/param&gt;</div></li><li class="li1"><div class="de1">        &lt;/input&gt;</div></li></ol></pre>

<p>
I la secció &lt;instance&gt;, on definiu el punt de muntatge:
</p>
<pre class="code xml"><ol><li class="li1"><div class="de1">        &lt;instance&gt;</div></li><li class="li1"><div class="de1">            &lt;!-- Server details:</div></li><li class="li1"><div class="de1">                You define hostname and port for the server here, along with</div></li><li class="li1"><div class="de1">                the source password and mountpoint.  --&gt;</div></li><li class="li1"><div class="de1">            &lt;hostname&gt;localhost&lt;/hostname&gt;</div></li><li class="li1"><div class="de1">            &lt;port&gt;8000&lt;/port&gt;</div></li><li class="li1"><div class="de1">            &lt;password&gt;usuari&lt;/password&gt;</div></li><li class="li1"><div class="de1">            &lt;mount&gt;/radio&lt;/mount&gt;</div></li></ol></pre>

<p>
Reinicieu el servidor i executeu IceS2 per tal que comenci a retransmetre cap al servidor:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># service icecast2 restart</div></li><li class="li1"><div class="de1"># ices2 /home/usuari/ices-playlist.xml &amp;</div></li><li class="li1"><div class="de1"># ices2 ices-playlist.xml</div></li><li class="li1"><div class="de1">root@server:~# ps -A | grep ice</div></li><li class="li1"><div class="de1">  546 ?        00:00:06 VBoxService</div></li><li class="li1"><div class="de1">  831 ?        00:00:00 dconf-service</div></li><li class="li1"><div class="de1">27485 ?        00:00:00 icecast2</div></li><li class="li1"><div class="de1">27872 pts/0    00:00:00 ices2</div></li></ol></pre>

<p>
Mireu els punts muntats des de la web d’administració:
</p>

<p>
<div class="imgelem">
<img src="../media/icescast2.png" alt="" /></div>

</p>

<p>
<strong>4.</strong> Consum de l’<em>streaming</em> d’àudio des del client
</p>

<p>
Escolteu el canal d’àudio des d’un navegador en un client qualsevol:
</p>

<p>
<div class="imgelem">
<img src="../media/icescast3.png" alt="" /></div>

</p>

<p>
Des del servidor IceCast podeu veure la llista dels punts muntats on es veuen els clients:
</p>

<p>
<div class="imgelem">
<img src="../media/icescast4.png" alt="" /></div>

</p>

<p>
<strong>Referències</strong>
</p>

<p>
<a href="http://icecast.org/" class="urlextern" title="http://icecast.org/"  rel="nofollow">Icecast</a>
</p>

<p>
<a href="http://icecast.org/ices/" class="urlextern" title="http://icecast.org/ices/"  rel="nofollow">IceS</a>
</p>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

<h2><a id="servei_d_audio_a_la_carta_amb_el_servidor_de_reproduccio_en_temps_real_ampache" >Servei d&#039;àudio a la carta amb el servidor de reproducció en temps real Ampache</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és instal·lar i configurar Ampache. El servidor d’<em>streaming</em> Ampache es munta sobre un servidor LAMP. LAMP és l’acrònim de Linux, Apache, MySQL i PHP. És una plataforma completa per a la programació de pàgines web dinàmiques.
</p>

<p>
Feu les següents tasques:
</p>
<ol>
<li class="level1"><div class="li"> Instal·lació del servidor de reproducció en temps real Ampache</div>
</li>
<li class="level1"><div class="li"> Configuració del servidor</div>
</li>
<li class="level1"><div class="li"> Administració del servidor</div>
</li>
<li class="level1"><div class="li"> Consum de l’<em>streaming</em> d’àudio des d’un client</div>
</li>
</ol>

<p>
<form action=""><div class="solution ioccontent">
<p>
<strong>1</strong>. Instal·lació del servidor de reproducció en temps real Ampache
</p>

<p>
Instal·leu el servidor LAMP:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># apt-get install apache2 mysql-server php php-mysql</div></li><li class="li1"><div class="de1">S'està llegint la llista de paquets… Fet </div></li><li class="li1"><div class="de1">S'està construint l'arbre de dependències       </div></li><li class="li1"><div class="de1">S'està llegint la informació de l'estat… Fet</div></li><li class="li1"><div class="de1">El paquets següents s'han instal·lat automàticament i ja no seran necessaris:</div></li><li class="li1"><div class="de1">  libfam0 spawn-fcgi</div></li><li class="li1"><div class="de1">Empreu «apt autoremove» per suprimir-los.</div></li><li class="li1"><div class="de1">S'instal·laran els següents paquets extres:</div></li><li class="li1"><div class="de1">  apache2-bin apache2-data apache2-utils default-mysql-server galera-3 gawk libaio1 libapache2-mod-php7.0 libapr1 libaprutil1</div></li><li class="li1"><div class="de1">  libaprutil1-dbd-sqlite3 libaprutil1-ldap libconfig-inifiles-perl libdbd-mysql-perl libdbi-perl libhtml-template-perl</div></li><li class="li1"><div class="de1">  libjemalloc1 libmariadbclient18 libreadline5 libsigsegv2 libterm-readkey-perl mariadb-client-10.1 mariadb-client-core-10.1</div></li><li class="li1"><div class="de1">  mariadb-common mariadb-server-10.1 mariadb-server-core-10.1 mysql-common php-common php7.0 php7.0-cli php7.0-common php7.0-json</div></li><li class="li1"><div class="de1">  php7.0-mysql php7.0-opcache php7.0-readline rsync socat ssl-cert</div></li><li class="li1"><div class="de1">Paquets suggerits:</div></li><li class="li1"><div class="de1">  apache2-doc apache2-suexec-pristine | apache2-suexec-custom gawk-doc php-pear libclone-perl libmldbm-perl libnet-daemon-perl</div></li><li class="li1"><div class="de1">  libsql-statement-perl libipc-sharedcache-perl mailx mariadb-test netcat-openbsd tinyca openssh-server openssl-blacklist</div></li><li class="li1"><div class="de1">S'instal·laran els paquets NOUS següents:</div></li><li class="li1"><div class="de1">  apache2 apache2-bin apache2-data apache2-utils default-mysql-server galera-3 gawk libaio1 libapache2-mod-php7.0 libapr1</div></li><li class="li1"><div class="de1">  libaprutil1 libaprutil1-dbd-sqlite3 libaprutil1-ldap libconfig-inifiles-perl libdbd-mysql-perl libdbi-perl</div></li><li class="li1"><div class="de1">  libhtml-template-perl libjemalloc1 libmariadbclient18 libreadline5 libsigsegv2 libterm-readkey-perl mariadb-client-10.1</div></li><li class="li1"><div class="de1">  mariadb-client-core-10.1 mariadb-common mariadb-server-10.1 mariadb-server-core-10.1 mysql-common mysql-server php php-common</div></li><li class="li1"><div class="de1">  php-mysql php7.0 php7.0-cli php7.0-common php7.0-json php7.0-mysql php7.0-opcache php7.0-readline rsync socat ssl-cert</div></li><li class="li1"><div class="de1">0 actualitzats, 42 nous a instal·lar, 0 a suprimir i 322 no actualitzats.</div></li><li class="li1"><div class="de1">S'han d'obtenir 31,9 MB d'arxius.</div></li><li class="li1"><div class="de1">Després d'aquesta operació s'empraran 202 MB d'espai en disc addicional.</div></li><li class="li1"><div class="de1">Voleu continuar? [S/n]</div></li></ol></pre>

<p>
Comproveu l’estat:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># service apache2 status</div></li><li class="li1"><div class="de1">● apache2.service - The Apache HTTP Server</div></li><li class="li1"><div class="de1">   Loaded: loaded (/lib/systemd/system/apache2.service; enabled; vendor preset: enabled)</div></li><li class="li1"><div class="de1">   Active: active (running) since Tue 2019-10-08 07:01:29 CEST; 1h 16min ago</div></li><li class="li1"><div class="de1"> Main PID: 19660 (apache2)</div></li><li class="li1"><div class="de1">    Tasks: 6 (limit: 4915)</div></li><li class="li1"><div class="de1">   CGroup: /system.slice/apache2.service</div></li><li class="li1"><div class="de1">           ├─19660 /usr/sbin/apache2 -k start</div></li><li class="li1"><div class="de1">           ├─19664 /usr/sbin/apache2 -k start</div></li><li class="li1"><div class="de1">           ├─19665 /usr/sbin/apache2 -k start</div></li><li class="li1"><div class="de1">           ├─19666 /usr/sbin/apache2 -k start</div></li><li class="li1"><div class="de1">           ├─19667 /usr/sbin/apache2 -k start</div></li><li class="li1"><div class="de1">           └─19668 /usr/sbin/apache2 -k start</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">oct 08 07:01:29 server.ioc.cat systemd[1]: Stopped The Apache HTTP Server.</div></li><li class="li1"><div class="de1">oct 08 07:01:29 server.ioc.cat systemd[1]: Starting The Apache HTTP Server...</div></li><li class="li1"><div class="de1">oct 08 07:01:29 server.ioc.cat systemd[1]: Started The Apache HTTP Server.</div></li></ol></pre>

<p>
I mireu amb Nmap els ports oberts (80 per al servidor web i 3306 per al servidor SQL):
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">Starting Nmap 7.40 ( https://nmap.org ) at 2019-10-08 08:18 CEST</div></li><li class="li1"><div class="de1">Nmap scan report for localhost (127.0.0.1)</div></li><li class="li1"><div class="de1">Host is up (0.0000070s latency).</div></li><li class="li1"><div class="de1">Other addresses for localhost (not scanned): ::1</div></li><li class="li1"><div class="de1">Not shown: 998 closed ports</div></li><li class="li1"><div class="de1">PORT     STATE SERVICE VERSION</div></li><li class="li1"><div class="de1">80/tcp   open  http    Apache httpd 2.4.25 ((Debian))</div></li><li class="li1"><div class="de1">|_http-server-header: Apache/2.4.25 (Debian)</div></li><li class="li1"><div class="de1">|_http-title: Site doesn't have a title (text/html).</div></li><li class="li1"><div class="de1">3306/tcp open  mysql   MySQL 5.5.5-10.1.41-MariaDB-0+deb9u1</div></li><li class="li1"><div class="de1">| mysql-info: </div></li><li class="li1"><div class="de1">|   Protocol: 10</div></li><li class="li1"><div class="de1">|   Version: 5.5.5-10.1.41-MariaDB-0+deb9u1</div></li><li class="li1"><div class="de1">|   Thread ID: 3</div></li><li class="li1"><div class="de1">|   Capabilities flags: 63487</div></li><li class="li1"><div class="de1">|   Some Capabilities: IgnoreSigpipes, Speaks41ProtocolOld, Support41Auth, SupportsTransactions, Speaks41ProtocolNew, DontAllowDatabaseTableColumn, InteractiveClient, SupportsCompression, LongPassword, IgnoreSpaceBeforeParenthesis, FoundRows, ConnectWithDatabase, SupportsLoadDataLocal, ODBCClient, LongColumnFlag, SupportsMultipleResults, SupportsMultipleStatments, SupportsAuthPlugins</div></li><li class="li1"><div class="de1">|   Status: Autocommit</div></li><li class="li1"><div class="de1">|   Salt: }l%p)u4B0g9'TT'eGs.*</div></li><li class="li1"><div class="de1">|_  Auth Plugin Name: 103</div></li><li class="li1"><div class="de1">Device type: general purpose</div></li><li class="li1"><div class="de1">Running: Linux 3.X|4.X</div></li><li class="li1"><div class="de1">OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4</div></li><li class="li1"><div class="de1">OS details: Linux 3.8 - 4.6</div></li><li class="li1"><div class="de1">Network Distance: 0 hops</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</div></li><li class="li1"><div class="de1">Nmap done: 1 IP address (1 host up) scanned in 11.26 seconds</div></li></ol></pre>

<p>
Configureu MySQL amb la configuració per defecte, és a dir, la que proposa (opcions en majúscules):
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># mysql_secure_installation</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MariaDB</div></li><li class="li1"><div class="de1">      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">In order to log into MariaDB to secure it, we'll need the current</div></li><li class="li1"><div class="de1">password for the root user.  If you've just installed MariaDB, and</div></li><li class="li1"><div class="de1">you haven't set the root password yet, the password will be blank,</div></li><li class="li1"><div class="de1">so you should just press enter here.</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">Enter current password for root (enter for none):</div></li></ol></pre>

<p>
Descarregueu la darrera versió estable d’Ampache:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># cd /var/www/html</div></li><li class="li1"><div class="de1"># mkdir ampache</div></li><li class="li1"><div class="de1"># cd ampache</div></li><li class="li1"><div class="de1"># wget https://github.com/ampache/ampache/releases/download/3.9.0/ampache-3.9.0_all.zip</div></li><li class="li1"><div class="de1">--2019-10-08 08:22:07--  https://github.com/ampache/ampache/releases/download/3.9.0/ampache-3.9.0_all.zip</div></li><li class="li1"><div class="de1">S'està resolent github.com (github.com)… 140.82.118.3</div></li><li class="li1"><div class="de1">S'està connectant a github.com (github.com)|140.82.118.3|:443… connectat.</div></li><li class="li1"><div class="de1">HTTP: s'ha enviat la petició, s'està esperant una resposta… 302 Found</div></li><li class="li1"><div class="de1">Ubicació: https://github-production-release-asset-2e65be.s3.amazonaws.com/8933498/cc257300-f272-11e8-882c-1dae5982de33?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20191008%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20191008T062158Z&amp;X-Amz-Expires=300&amp;X-Amz-Signature=d0f9ac81f09c9c31a5ee4a764e588d4fb7ced5e8b7f5e1ea5cccecd977e1dc69&amp;X-Amz-SignedHeaders=host&amp;actor_id=0&amp;response-content-disposition=attachment%3B%20filename%3Dampache-3.9.0_all.zip&amp;response-content-type=application%2Foctet-stream [es segueix]</div></li><li class="li1"><div class="de1">--2019-10-08 08:22:08--  https://github-production-release-asset-2e65be.s3.amazonaws.com/8933498/cc257300-f272-11e8-882c-1dae5982de33?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20191008%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20191008T062158Z&amp;X-Amz-Expires=300&amp;X-Amz-Signature=d0f9ac81f09c9c31a5ee4a764e588d4fb7ced5e8b7f5e1ea5cccecd977e1dc69&amp;X-Amz-SignedHeaders=host&amp;actor_id=0&amp;response-content-disposition=attachment%3B%20filename%3Dampache-3.9.0_all.zip&amp;response-content-type=application%2Foctet-stream</div></li><li class="li1"><div class="de1">S'està resolent github-production-release-asset-2e65be.s3.amazonaws.com (github-production-release-asset-2e65be.s3.amazonaws.com)… 52.217.39.44</div></li><li class="li1"><div class="de1">S'està connectant a github-production-release-asset-2e65be.s3.amazonaws.com (github-production-release-asset-2e65be.s3.amazonaws.com)|52.217.39.44|:443… connectat.</div></li><li class="li1"><div class="de1">HTTP: s'ha enviat la petició, s'està esperant una resposta… 200 OK</div></li><li class="li1"><div class="de1">Mida: 65010214 (62M) [application/octet-stream]</div></li><li class="li1"><div class="de1">S'està desant a: «ampache-3.9.0_all.zip»</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">ampache-3.9.0_all.zip            100%[=========================================================&gt;]  62,00M   793KB/s    in 1m 42s  </div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">2019-10-08 08:23:50 (624 KB/s) - s'ha desat «ampache-3.9.0_all.zip» [65010214/65010214]</div></li></ol></pre>

<p>
I descomprimiu-la:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># unzip ampache-3.9.0_all.zip</div></li><li class="li1"><div class="de1">...</div></li><li class="li1"><div class="de1">  inflating: video.php               </div></li><li class="li1"><div class="de1">  inflating: waveform.php            </div></li><li class="li1"><div class="de1">  inflating: web_player.php          </div></li><li class="li1"><div class="de1">  inflating: web_player_embedded.php  </div></li><li class="li1"><div class="de1">   creating: webdav/</div></li><li class="li1"><div class="de1">  inflating: webdav/index.php        </div></li></ol></pre>

<p>
<strong>2.</strong> Configuració del servidor Ampache
</p>

<p>
Per a la configuració del servidor d’<em>streaming</em> cal configurar el servidor SQL i l’aplicació web, en aquest ordre.
</p>

<p>
Creeu un usuari anomenat <em>ampache</em> per a la base de dades. Useu el següent codi (alguna comanda podria variar depenent de la versió de la base de dades):
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># mysql -u root -p</div></li><li class="li1"><div class="de1">Enter password: </div></li><li class="li1"><div class="de1">Welcome to the MariaDB monitor.  Commands end with ; or \g.</div></li><li class="li1"><div class="de1">Your MariaDB connection id is 12</div></li><li class="li1"><div class="de1">Server version: 10.1.41-MariaDB-0+deb9u1 Debian 9.9</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">MariaDB [(none)]&gt; CREATE DATABASE ampache;</div></li><li class="li1"><div class="de1">Query OK, 1 row affected (0.06 sec)</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">MariaDB [(none)]&gt; CREATE USER 'ampache'@'localhost';</div></li><li class="li1"><div class="de1">Query OK, 0 rows affected (0.07 sec)</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">MariaDB [(none)]&gt; SET PASSWORD FOR 'ampache'@'localhost' = PASSWORD('ampache');</div></li><li class="li1"><div class="de1">Query OK, 0 rows affected (0.00 sec)</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">MariaDB [(none)]&gt; GRANT ALL PRIVILEGES ON ampache.* TO 'ampache'@'localhost';</div></li><li class="li1"><div class="de1">Query OK, 0 rows affected (0.05 sec)</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">MariaDB [(none)]&gt; flush privileges;</div></li><li class="li1"><div class="de1">Query OK, 0 rows affected (0.00 sec)</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">MariaDB [(none)]&gt; select user, host, password, plugin, authentication_string from mysql.user;</div></li><li class="li1"><div class="de1">+---------+-----------+-------------------------------------------+-------------+-----------------------+</div></li><li class="li1"><div class="de1">| user    | host      | password                                  | plugin      | authentication_string |</div></li><li class="li1"><div class="de1">+---------+-----------+-------------------------------------------+-------------+-----------------------+</div></li><li class="li1"><div class="de1">| root    | localhost | *81F5E21E35407D884A6CD4A731AEBFB6AF209E1B | unix_socket |                       |</div></li><li class="li1"><div class="de1">| ampache | localhost | *3770D52AC8F864CBE7CA08DE21B6627BD6AB80AA |             |                       |</div></li><li class="li1"><div class="de1">+---------+-----------+-------------------------------------------+-------------+-----------------------+</div></li><li class="li1"><div class="de1">2 rows in set (0.03 sec)</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">MariaDB [(none)]&gt; exit;</div></li><li class="li1"><div class="de1">Bye</div></li></ol></pre>

<p>
Configureu Ampache des del navegador amb la <acronym title="Uniform Resource Locator">URL</acronym> <a href="http://localhost/ampache" class="urlextern" title="http://localhost/ampache"  rel="nofollow">http://localhost/ampache</a> i seguiu l’assistent: 
</p>

<p>
<div class="imgelem">
<img src="../media/ampache1.png" alt="" /></div>

</p>

<p>
<div class="imgelem">
<img src="../media/ampache2.png" alt="" /></div>

</p>

<p>
Els avisos que estan en taronja es poden deixar tal com estan (per a les proves no seran necessaris). El missatge en vermell ja el solucionareu més endavant. El punt següent és crític, ja que si no s’ha creat bé l’usuari de la base de dades no deixarà continuar endavant.
</p>

<p>
<div class="imgelem">
<img src="../media/ampache3.png" alt="" /></div>

</p>

<p>
<div class="imgelem">
<img src="../media/ampache4.png" alt="" /></div>

</p>

<p>
En aquest pas, si intenteu escriure els fitxers de configuració i no teniu permisos, dona error. Els fitxers afectats són aquests:
</p>

<p>
<div class="imgelem">
<img src="../media/ampache5.png" alt="" /></div>

</p>

<p>
L’opció més segura (en un entorn real) seria anar baixant els fitxers i substituir-los en la carpeta corresponent. Per a la realització de l’activitat donarem permisos d’escriptura a tots aquests fitxers.
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># cd /var/www/html/ampache/</div></li><li class="li1"><div class="de1"># chmod 777 channel/.htaccess</div></li><li class="li1"><div class="de1"># chmod 777 rest/.htaccess</div></li><li class="li1"><div class="de1"># chmod 777 play/.htaccess</div></li><li class="li1"><div class="de1"># chmod 777 config</div></li></ol></pre>

<p>
Feu <em>Recheck Config</em> i continueu:
</p>

<p>
<div class="imgelem">
<img src="../media/ampache6.png" alt="" /></div>

</p>

<p>
Actualitzeu:
</p>

<p>
<div class="imgelem">
<img src="../media/ampache7.png" alt="" /></div>

</p>

<p>
I finalment:
</p>

<p>
<div class="imgelem">
<img src="../media/ampache8.png" alt="" /></div>

</p>

<p>
<strong>3.</strong> Administració del servidor Ampache
</p>

<p>
En una carpeta ja teniu diverses cançons per fer el vostre catàleg.
</p>

<p>
Identifiqueu-vos com a “administrador” i aneu a administració:
</p>

<p>
<div class="imgelem">
<img src="../media/ampache9.png" alt="" /></div>

</p>

<p>
Creeu el catàleg tot indicant la carpeta on hi ha la música:
</p>

<p>
<div class="imgelem">
<img src="../media/ampache10.png" alt="" /></div>

</p>

<p>
Finalment, creeu un usuari amb nivell d’accés d’usuari:
</p>

<p>
<div class="imgelem">
<img src="../media/ampache11.png" alt="" /></div>

</p>

<p>
<strong>4.</strong> Consum de l’<em>streaming</em> d’àudio des d’un client
</p>

<p>
Des d’un client, connecte-vos com a l’usuari creat en el pas anterior. Podreu escoltar el canal d’àudio via <em>streaming</em>:
</p>

<p>
<div class="imgelem">
<img src="../media/ampache12.png" alt="" /></div>

</p>

<p>
Si aneu al servidor, des d’administració es poden veure els clients connectats. Malauradament no es pot veure des d’on es connecten.
</p>

<p>
<div class="imgelem">
<img src="../media/ampache13.png" alt="" /></div>

</p>

<p>
<strong>Referències</strong>
</p>

<p>
<a href="http://ampache.org/" class="urlextern" title="http://ampache.org/"  rel="nofollow">Ampache</a>
</p>

<p>
<a href="https://www.apache.org/" class="urlextern" title="https://www.apache.org/"  rel="nofollow">Apache</a>
</p>

<p>
<a href="https://www.mysql.com/" class="urlextern" title="https://www.mysql.com/"  rel="nofollow">MySQL</a>
</p>

<p>
<a href="https://www.php.net/" class="urlextern" title="https://www.php.net/"  rel="nofollow">PHP</a>
</p>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

<h2><a id="servei_d_audio_a_la_carta_amb_el_servidor_de_reproduccio_en_temps_real_darwin" >Servei d&#039;àudio a la carta amb el servidor de reproducció en temps real Darwin</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és instal·lar i configurar el servidor d’<em>streaming</em> d’àudio Darwin.
</p>

<p>
Darwin és la versió de programari lliure del servidor de reproducció en temps real QuickTime d’Apple. Disposa de versions per a Windows, Mac, Linux, etc. Usa el protocol RTSP per a l’<em>streaming</em> multimèdia i és compatible amb els formats més actuals, com MP4 i 3GP.
</p>

<p>
Realitzeu les següents tasques:
</p>
<ol>
<li class="level1"><div class="li"> Instal·lació dels requisits</div>
</li>
<li class="level1"><div class="li"> Instal·lació del servidor de reproducció en temps real Darwin</div>
</li>
<li class="level1"><div class="li"> Preparació del servidor</div>
</li>
<li class="level1"><div class="li"> Configuració del servidor Darwin Stream Server</div>
</li>
<li class="level1"><div class="li"> Preparació de l’<em>streaming</em> d’àudio en el servidor</div>
</li>
<li class="level1"><div class="li"> Reproducció (consum) de l’<em>streaming</em> d’àudio des d’un client web</div>
</li>
</ol>

<p>
<form action=""><div class="solution ioccontent">
<p>
<strong>1</strong>. Instal·lació dels requisits
</p>

<p>
Creeu el grup qtss com a grup de sistema:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># sudo addgroup --system qtss</div></li><li class="li1"><div class="de1">S'està afegint el grup qtss (GID 121)…</div></li><li class="li1"><div class="de1">Fet.</div></li></ol></pre>

<p>
Creeu l’usuari “qtss” com a usuari de sistema, sense carpeta d’inici i que pertanyi al grup qtss:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># sudo adduser --system --no-create-home --ingroup qtss qtss </div></li><li class="li1"><div class="de1">S'està afegint l'usuari del sistema «qtss» (UID 115)…</div></li><li class="li1"><div class="de1">S'està afegint l'usuari nou «qtss» (UID 115) amb grup «qtss»…</div></li><li class="li1"><div class="de1">No es crea el directori personal «/home/qtss».</div></li></ol></pre>

<p>
<strong>2</strong>. Instal·lació del servidor de reproducció en temps real Darwin
</p>

<p>
Descarregueu el <a href="https://macosforge.github.io/dss/" class="urlextern" title="https://macosforge.github.io/dss/"  rel="nofollow">Darwin Streaming Server</a>, preferiblement la versió que conté els compilats per a Linux. També es pot fer a través del codi font, però caldria compilar el programari.
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># wget https://github.com/macosforge/dss/releases/download/5.5.5/DarwinStreamingSrvr5.5.5-Linux.tar.gz</div></li><li class="li1"><div class="de1">--2019-10-21 11:32:59--  https://github.com/macosforge/dss/releases/download/5.5.5/DarwinStreamingSrvr5.5.5-Linux.tar.gz</div></li><li class="li1"><div class="de1">S'està resolent github.com (github.com)… 140.82.118.3</div></li><li class="li1"><div class="de1">S'està connectant a github.com (github.com)|140.82.118.3|:443… connectat.</div></li><li class="li1"><div class="de1">HTTP: s'ha enviat la petició, s'està esperant una resposta… 302 Found</div></li><li class="li1"><div class="de1">Ubicació: https://github-production-release-asset-2e65be.s3.amazonaws.com/50219011/c1c116fa-c145-11e5-80d0-5ceee280d374?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20191021%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20191021T093523Z&amp;X-Amz-Expires=300&amp;X-Amz-Signature=aaabf26e0db78d869eec2ece4ca808e43ae3ab38f4e8f8b50ce8c0757bbd155a&amp;X-Amz-SignedHeaders=host&amp;actor_id=0&amp;response-content-disposition=attachment%3B%20filename%3DDarwinStreamingSrvr5.5.5-Linux.tar.gz&amp;response-content-type=application%2Foctet-stream [es segueix]</div></li><li class="li1"><div class="de1">--2019-10-21 11:33:02--  https://github-production-release-asset-2e65be.s3.amazonaws.com/50219011/c1c116fa-c145-11e5-80d0-5ceee280d374?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20191021%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20191021T093523Z&amp;X-Amz-Expires=300&amp;X-Amz-Signature=aaabf26e0db78d869eec2ece4ca808e43ae3ab38f4e8f8b50ce8c0757bbd155a&amp;X-Amz-SignedHeaders=host&amp;actor_id=0&amp;response-content-disposition=attachment%3B%20filename%3DDarwinStreamingSrvr5.5.5-Linux.tar.gz&amp;response-content-type=application%2Foctet-stream</div></li><li class="li1"><div class="de1">S'està resolent github-production-release-asset-2e65be.s3.amazonaws.com (github-production-release-asset-2e65be.s3.amazonaws.com)… 52.217.36.220</div></li><li class="li1"><div class="de1">S'està connectant a github-production-release-asset-2e65be.s3.amazonaws.com (github-production-release-asset-2e65be.s3.amazonaws.com)|52.217.36.220|:443… connectat.</div></li><li class="li1"><div class="de1">HTTP: s'ha enviat la petició, s'està esperant una resposta… 200 OK</div></li><li class="li1"><div class="de1">Mida: 22588263 (22M) [application/octet-stream]</div></li><li class="li1"><div class="de1">S'està desant a: «DarwinStreamingSrvr5.5.5-Linux.tar.gz»</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">DarwinStreamingSrvr5.5.5-Linux. 100%[======================================================&gt;]  21,54M  2,12MB/s    in 10s     </div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">2019-10-21 11:33:13 (2,08 MB/s) - s'ha desat «DarwinStreamingSrvr5.5.5-Linux.tar.gz» [22588263/22588263]</div></li></ol></pre>

<p>
Descomprimiu el fitxer a la carpeta corresponent:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># tar xzvf DarwinStreamingSrvr5.5.5-Linux.tar.gz</div></li><li class="li1"><div class="de1">DarwinStreamingSrvrlinux-Linux/</div></li><li class="li1"><div class="de1">DarwinStreamingSrvrlinux-Linux/readme.txt</div></li><li class="li1"><div class="de1">DarwinStreamingSrvrlinux-Linux/sample_300kbit.mp4</div></li><li class="li1"><div class="de1">DarwinStreamingSrvrlinux-Linux/streamingadminserver.pl</div></li><li class="li1"><div class="de1">DarwinStreamingSrvrlinux-Linux/relayconfig.xml-Sample</div></li><li class="li1"><div class="de1">DarwinStreamingSrvrlinux-Linux/sample_50kbit.3gp</div></li><li class="li1"><div class="de1">DarwinStreamingSrvrlinux-Linux/StreamingServerModules/</div></li><li class="li1"><div class="de1">DarwinStreamingSrvrlinux-Linux/StreamingServerModules/QTSSHomeDirectoryModule</div></li><li class="li1"><div class="de1">DarwinStreamingSrvrlinux-Linux/StreamingServerModules/QTSSRefMovieModule</div></li><li class="li1"><div class="de1">DarwinStreamingSrvrlinux-Linux/sample_h264_100kbit.mp4</div></li><li class="li1"><div class="de1">DarwinStreamingSrvrlinux-Linux/qtpasswd</div></li><li class="li1"><div class="de1">...</div></li></ol></pre>

<p>
Entreu a la carpeta corresponent:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># cd DarwinStreamingSrvrlinux-Linux </div></li></ol></pre>

<p>
Si llisteu els fitxers, podeu observar que l’arxiu principal és DarwinStreamingServer, però s’arranca amb el fitxer streamingadminserver.pl:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># ls -alis</div></li><li class="li1"><div class="de1">total 28536</div></li><li class="li1"><div class="de1">264637    4 drwxr-xr-x 4 root root    4096 mai  7  2007 .</div></li><li class="li1"><div class="de1">262201    4 drwx------ 5 root root    4096 oct 21 11:34 ..</div></li><li class="li1"><div class="de1">267991    8 -rw-r--r-- 1 root root    5669 mai  7  2007 3rdPartyAcknowledgements.rtf</div></li><li class="li1"><div class="de1">265275    4 drwxr-xr-x 5 root root    4096 mai  7  2007 AdminHtml</div></li><li class="li1"><div class="de1">268003    4 -rwxr-xr-x 1 root root    3289 mai  7  2007 createuserstreamingdir</div></li><li class="li1"><div class="de1">267998 4036 -rwxr-xr-x 1 root root 4131781 mai  7  2007 DarwinStreamingServer</div></li><li class="li1"><div class="de1">267995   16 -rwxr-xr-x 1 root root   13427 mai  7  2007 Install</div></li><li class="li1"><div class="de1">264651  576 -rwxr-xr-x 1 root root  588168 mai  7  2007 MP3Broadcaster</div></li><li class="li1"><div class="de1">267996    4 -rw-r--r-- 1 root root     620 mai  7  2007 perlpath.pl</div></li><li class="li1"><div class="de1">268001 1532 -rwxr-xr-x 1 root root 1564908 mai  7  2007 PlaylistBroadcaster</div></li><li class="li1"><div class="de1">267999    4 -rw-r--r-- 1 root root      16 mai  7  2007 qtgroups</div></li><li class="li1"><div class="de1">264649  160 -rwxr-xr-x 1 root root  162194 mai  7  2007 qtpasswd</div></li><li class="li1"><div class="de1">268002    4 -rw-r--r-- 1 root root      79 mai  7  2007 qtusers</div></li><li class="li1"><div class="de1">264638   16 -rw-r--r-- 1 root root   12869 mai  7  2007 readme.txt</div></li><li class="li1"><div class="de1">264641    8 -rw-r--r-- 1 root root    4732 mai  7  2007 relayconfig.xml-Sample</div></li><li class="li1"><div class="de1">267990 1032 -rw-r--r-- 1 root root 1055700 mai  7  2007 sample_100kbit.mov</div></li><li class="li1"><div class="de1">267992  912 -rw-r--r-- 1 root root  933456 mai  7  2007 sample_100kbit.mp4</div></li><li class="li1"><div class="de1">267993 2460 -rw-r--r-- 1 root root 2518388 mai  7  2007 sample_300kbit.mov</div></li><li class="li1"><div class="de1">264639 2388 -rw-r--r-- 1 root root 2445088 mai  7  2007 sample_300kbit.mp4</div></li><li class="li1"><div class="de1">264642  592 -rw-r--r-- 1 root root  603730 mai  7  2007 sample_50kbit.3gp</div></li><li class="li1"><div class="de1">264647  980 -rw-r--r-- 1 root root  999438 mai  7  2007 sample_h264_100kbit.mp4</div></li><li class="li1"><div class="de1">268004 8720 -rw-r--r-- 1 root root 8925466 mai  7  2007 sample_h264_1mbit.mp4</div></li><li class="li1"><div class="de1">268000 2424 -rw-r--r-- 1 root root 2478521 mai  7  2007 sample_h264_300kbit.mp4</div></li><li class="li1"><div class="de1">268005 1752 -rw-r--r-- 1 root root 1789985 mai  7  2007 sample.mp3</div></li><li class="li1"><div class="de1">264640   64 -rwxr-xr-x 1 root root   61531 mai  7  2007 streamingadminserver.pl</div></li><li class="li1"><div class="de1">267989  768 -rwxr-xr-x 1 root root  786144 mai  7  2007 StreamingLoadTool</div></li><li class="li1"><div class="de1">264650    4 -rw-r--r-- 1 root root    3318 mai  7  2007 streamingloadtool.conf</div></li><li class="li1"><div class="de1">264644    4 drwxr-xr-x 2 root root    4096 mai  7  2007 StreamingServerModules</div></li><li class="li1"><div class="de1">267994   28 -rw-r--r-- 1 root root   27930 mai  7  2007 streamingserver.xml</div></li><li class="li1"><div class="de1">267997   28 -rw-r--r-- 1 root root   27930 mai  7  2007 streamingserver.xml-sample</div></li></ol></pre>

<p>
Hi ha fragments d’aquest servidor escrits amb el llenguatge de programació Perl. Es poden trobar algunes incompatibilitats amb les noves versions del llenguatge que facin que no arrenqui el servidor o que no es pugui configurar correctament. Abans d’instal·lar el servidor s’ha de corregir un <em>bug</em> que fa que es vegi la pàgina web sense el text (perquè el codi no és completament compatible amb la nova versió de Perl) i no tradueix les cadenes de text:
</p>

<p>
<em>streamingadminserver.pl is poorly written so is not compatible with new perl. As the result you got a web page without any text</em>.
</p>

<p>
La solució és aplicar les següents <a href="https://vk.com/wingcatlab?w=wall-99790498_55" class="urlextern" title="https://vk.com/wingcatlab?w=wall-99790498_55"  rel="nofollow">correccions</a>:
</p>
<ul>
<li class="level1"><div class="li"> Afegiu al fitxer streamingadminserver.pl, en l’apartat <em>Require needed libraries</em> (al principi), després de l’últim <em>use</em>: </div>
</li>
</ul>
<pre class="code">use Data::Dumper; </pre>

<p>
Ha de quedar així:
</p>
<pre class="code"># Require needed libraries
package streamingadminserver;
use Socket;
use POSIX;
use Sys::Hostname;
#eval &quot;use Net::SSLeay&quot;;
use Data::Dumper;</pre>
<ul>
<li class="level1"><div class="li"> Al mateix fitxer, després de la línia que conté la variable d’entorn ENV{“HTTPS”}:</div>
</li>
</ul>
<pre class="code">$ENV{&quot;LMSG&quot;} = Dumper($messages{&quot;en&quot;}); </pre>

<p>
Ha de quedar així:
</p>
<pre class="code">$ENV{&quot;HTTPS&quot;} =  &quot;ON&quot; if ($use_ssl);
$ENV{&quot;LMSG&quot;} = Dumper($messages{&quot;en&quot;});
if (defined($header{&quot;content-length&quot;})) {
...</pre>
<ul>
<li class="level1"><div class="li"> Canvieu al fitxer AdminHtml/parse_xml.cgi, a la funció <em>foundString</em>, el valor de retorn (al final de la funció): </div>
</li>
</ul>
<pre class="code">return &quot;$messages{$name}&quot;; </pre>

<p>
Ha de quedar així: 
</p>
<pre class="code">$lmsg = $ENV{&quot;LMSG&quot;}; 
my %copied_hash = %{ eval $lmsg }; 
return $copied_hash{$name}; </pre>

<p>
Instal·leu-lo. Demanarà l’usuari i constrasenya per al servidor d’<em>streaming</em>:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># sudo ./Install</div></li><li class="li1"><div class="de1">Installing Darwin Streaming Server</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">Checking for and Killing currently running Darwin Streaming Server</div></li><li class="li1"><div class="de1">kill: (30822): El procés no existeix</div></li><li class="li1"><div class="de1">Removing previous versions of Darwin Streaming Server</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">Backing up previous config files</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">Inserting path to perl into scripts..</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">Creating unprivileged user to run the server = &quot;qtss&quot;.</div></li><li class="li1"><div class="de1">copying DarwinStreamingServer to /usr/local/sbin/DarwinStreamingServer</div></li><li class="li1"><div class="de1">copying PlaylistBroadcaster to /usr/local/bin/PlaylistBroadcaster</div></li><li class="li1"><div class="de1">copying MP3Broadcaster to /usr/local/bin/MP3Broadcaster</div></li><li class="li1"><div class="de1">copying qtpasswd to /usr/local/bin/qtpasswd</div></li><li class="li1"><div class="de1">creating /usr/local/sbin/StreamingServerModules directory</div></li><li class="li1"><div class="de1">copying createuserstreamingdir to /usr/local/bin/createuserstreamingdir</div></li><li class="li1"><div class="de1">creating /etc/streaming directory</div></li><li class="li1"><div class="de1">Generating a new prefs file at /etc/streaming/streamingserver.xml</div></li><li class="li1"><div class="de1">INFO: Module Loaded...QTSSRefMovieModule [dynamic]</div></li><li class="li1"><div class="de1">INFO: Module Loaded...QTSSHomeDirectoryModule [dynamic]</div></li><li class="li1"><div class="de1">INFO: Module Loaded...QTSSFileModule [static]</div></li><li class="li1"><div class="de1">INFO: Module Loaded...QTSSReflectorModule [static]</div></li><li class="li1"><div class="de1">INFO: Module Loaded...QTSSRelayModule [static]</div></li><li class="li1"><div class="de1">INFO: Module Loaded...QTSSAccessLogModule [static]</div></li><li class="li1"><div class="de1">INFO: Module Loaded...QTSSFlowControlModule [static]</div></li><li class="li1"><div class="de1">INFO: Module Loaded...QTSSPosixFileSysModule [static]</div></li><li class="li1"><div class="de1">INFO: Module Loaded...QTSSAdminModule [static]</div></li><li class="li1"><div class="de1">INFO: Module Loaded...QTSSMP3StreamingModule [static]</div></li><li class="li1"><div class="de1">INFO: Module Loaded...QTSSAccessModule [static]</div></li><li class="li1"><div class="de1">WARNING: No users file found at /etc/streaming/qtusers.</div></li><li class="li1"><div class="de1">WARNING: No groups file found at /etc/streaming/qtgroups.</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">copying relayconfig.xml-Sample to /etc/streaming/relayconfig.xml-Sample</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">copying qtusers to /etc/streaming/qtusers</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">copying qtgroups to /etc/streaming/qtgroups</div></li><li class="li1"><div class="de1">copying readme.txt to /var/streaming/readme.txt</div></li><li class="li1"><div class="de1">copying 3rdPartyAcknowledgements.rtf to /var/streaming/3rdPartyAcknowledgements.rtf</div></li><li class="li1"><div class="de1">creating /usr/local/movies directory</div></li><li class="li1"><div class="de1">creating /var/streaming/playlists directory</div></li><li class="li1"><div class="de1">copying sample_100kbit.mov into /usr/local/movies/sample_100kbit.mov</div></li><li class="li1"><div class="de1">copying sample_300kbit.mov into /usr/local/movies/sample_300kbit.mov</div></li><li class="li1"><div class="de1">copying sample_100kbit.mp4 into /usr/local/movies/sample_100kbit.mp4</div></li><li class="li1"><div class="de1">copying sample_300kbit.mp4 into /usr/local/movies/sample_300kbit.mp4</div></li><li class="li1"><div class="de1">copying sample.mp3 into /usr/local/movies/sample.mp3</div></li><li class="li1"><div class="de1">copying sample_50kbit.3gp into /usr/local/movies/sample_50kbit.3gp</div></li><li class="li1"><div class="de1">copying sample_h264_100kbit.mp4 into /usr/local/movies/sample_h264_100kbit.mp4</div></li><li class="li1"><div class="de1">copying sample_h264_300kbit.mp4 into /usr/local/movies/sample_h264_300kbit.mp4</div></li><li class="li1"><div class="de1">copying sample_h264_1mbit.mp4 into /usr/local/movies/sample_h264_1mbit.mp4</div></li><li class="li1"><div class="de1">copying StreamingLoadTool to /usr/local/bin/StreamingLoadTool</div></li><li class="li1"><div class="de1">copying streamingloadtool.conf to /etc/streaming/streamingloadtool.conf</div></li><li class="li1"><div class="de1">copying streamingadminserver.pl into /usr/local/sbin/streamingadminserver.pl</div></li><li class="li1"><div class="de1">copying Admin HTML to /var/streaming/AdminHtml directory</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">Launching streamingadminserver.pl</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">Installation Complete</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">Darwin Streaming Server Setup</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">In order to administer the Darwin Streaming Server you must create an administrator user [Note: The administrator user name cannot contain spaces, or single or double quote characters, and cannot be more than 255 characters long].</div></li><li class="li1"><div class="de1">Please enter a new administrator user name: admin</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">You must also enter a password for the administrator user [Note: The administrator password cannot contain spaces, or quotes, either single or double, and cannot be more than 80 characters long].</div></li><li class="li1"><div class="de1">Please enter a new administrator Password: </div></li><li class="li1"><div class="de1">Re-enter the new administrator password: </div></li><li class="li1"><div class="de1">Adding userName admin</div></li><li class="li1"><div class="de1">Setup Complete!</div></li></ol></pre>

<p>
Ha d’acabar creant bé els usuaris. 
</p>

<p>
<strong>3</strong>. Preparació del servidor
</p>

<p>
Després de la instal·lació, el servidor ha quedat iniciat. Atureu el servidor, però com que no disposa d’<em>script</em> a /etc/init.d s’ha de fer amb <em>kill</em>. 
</p>

<p>
Esbrineu els processos que usa Darwin Stream Server. 
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># ps -aef | grep Darwin </div></li><li class="li1"><div class="de1">root     30904     1  0 12:14 ?        00:00:00 /usr/local/sbin/DarwinStreamingServer</div></li><li class="li1"><div class="de1">qtss     30905 30904  0 12:14 ?        00:00:00 /usr/local/sbin/DarwinStreamingServer</div></li><li class="li1"><div class="de1">root     32295  2415  0 12:16 pts/0    00:00:00 grep Darwin</div></li><li class="li1"><div class="de1"># killall DarwinStreamingServer</div></li></ol></pre>

<p>
Encara queda algun procés més:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># ps -aef | grep qtss</div></li><li class="li1"><div class="de1">root       406  2415  0 12:17 pts/0    00:00:00 grep qtss</div></li><li class="li1"><div class="de1">qtss     30902     1  0 12:14 ?        00:00:00 /usr/bin/perl /usr/local/sbin/streamingadminserver.pl</div></li><li class="li1"><div class="de1"># kill -9 30902</div></li></ol></pre>

<p>
Afegiu el directori actual (.) al <em>path</em> de Perl:
</p>
<pre class="code">export PERL5LIB=$PERL5LIB:. </pre>

<p>
Comproveu que està afegit amb perl -V:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">#perl -V</div></li><li class="li1"><div class="de1">...</div></li><li class="li1"><div class="de1">  @INC:</div></li><li class="li1"><div class="de1">    .</div></li><li class="li1"><div class="de1">    /etc/perl</div></li><li class="li1"><div class="de1">    /usr/local/lib/i386-linux-gnu/perl/5.24.1</div></li><li class="li1"><div class="de1">    /usr/local/share/perl/5.24.1</div></li><li class="li1"><div class="de1">    /usr/lib/i386-linux-gnu/perl5/5.24</div></li><li class="li1"><div class="de1">    /usr/share/perl5</div></li><li class="li1"><div class="de1">    /usr/lib/i386-linux-gnu/perl/5.24</div></li><li class="li1"><div class="de1">    /usr/share/perl/5.24</div></li><li class="li1"><div class="de1">    /usr/local/lib/site_perl</div></li><li class="li1"><div class="de1">    /usr/lib/i386-linux-gnu/perl-base</div></li></ol></pre>

<p>
Arranquem el servidor de nou:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># /usr/bin/perl /usr/local/sbin/streamingadminserver.pl </div></li></ol></pre>

<p>
<strong>4</strong>. Configuració del servidor Darwin Stream Server
</p>

<p>
Un cop instal·lat, aneu a <a href="http://IP_servidor:1220/" class="urlextern" title="http://IP_servidor:1220/"  rel="nofollow">http://IP_servidor:1220/</a> i apareixerà el <em>login</em>. Entreu l’usuari i la contrasenya de la instal·lació. Si no es veu el text, és que no s’ha fet bé el pas de la correcció del <em>bug</em>.
</p>

<p>
<div class="imgelem">
<img src="../media/darwin1.png" alt="" /></div>

</p>

<p>
Especifiqueu la contrasenya de <em>broadcast</em> per a MP3 (no el fareu servir):
</p>

<p>
<div class="imgelem">
<img src="../media/darwin2.png" alt="" /></div>

</p>

<p>
Per si voleu que les comunicacions estiguin encriptadades. No ho marqueu:
</p>

<p>
<div class="imgelem">
<img src="../media/darwin3.png" alt="" /></div>

</p>

<p>
Especifiqueu la carpeta on anirà el contingut multimèdia: 
</p>

<p>
<div class="imgelem">
<img src="../media/darwin4.png" alt="" /></div>

</p>

<p>
Demanarà si voleu utilitzar el port 80 per a l’<em>streaming</em>. Tampoc ho marqueu. Per defecte treballarà amb el port 8000:
</p>

<p>
<div class="imgelem">
<img src="../media/darwin5.png" alt="" /></div>

</p>

<p>
Un cop finalitzada la configuració, apareixerà el panell de control des d’on fer les diferents tasques i obtenir informació del servidor:
</p>

<p>
<div class="imgelem">
<img src="../media/darwin6.png" alt="" /></div>

</p>

<p>
<strong>5</strong>. Preparació de l’<em>streaming</em> d’àudio en el servidor
</p>

<p>
Primer de tot, heu de posar la música que volem reproduir en <em>streaming</em> a la carpeta especificada en la configuració (en el nostre cas, <em>/usr/local/movies</em>).
</p>

<p>
Voleu crear una llista de reproducció. Cal anar a <em>Playlists / New MP3 Playlist</em> i afegir les cançons per a aquesta <em>playlist</em>. És important que el punt de muntatge no porti espais en blancs, ja que aquest és el nom amb què s’especificarà a la <acronym title="Uniform Resource Locator">URL</acronym>.
</p>

<p>
<div class="imgelem">
<img src="../media/darwin7.png" alt="" /></div>

</p>

<p>
Un cop creada la llista de reproducció, deixeu que es reprodueixi: 
</p>

<p>
<div class="imgelem">
<img src="../media/darwin8.png" alt="" /></div>

</p>

<p>
<strong>6</strong>. Reproducció (consum) de l’<em>streaming</em> d’àudio des d’un <strong>client web</strong>.
</p>

<p>
Per escoltar-la des del client cal escriure IP_servidor:8000/CentRegards en un navegador:
</p>

<p>
<div class="imgelem">
<img src="../media/darwin9.png" alt="" /></div>

</p>

<p>
Atenció:
</p>
<pre class="code">RTSP/1.0 400 Bad Request 
Server: DSS/5.5.5 (Build/489.16; Platform/Linux; Release/Darwin; state/beta; ) 
Cseq: 
Connection: Close</pre>

<p>
Cal tornar a parar i engegar la reproducció en el servidor.
</p>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

<h2><a id="servei_d_audio_a_la_carta_amb_el_servidor_de_reproduccio_en_temps_real_airsonic" >Servei d&#039;àudio a la carta amb el servidor de reproducció en temps real Airsonic</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és instal·lar i configurar el servidor d’<em>streaming</em> d’àudio Airsonic.
</p>

<p>
AirSonic és un <em>fork</em> del programari SubSonic que inicialment era programari lliure i llavors es va tancar. A partir de la darrera versió amb llicència lliure s’han anat desenvolupant noves millores. Com que està basat en Java, es pot executar en una multitud de plataformes només instal·lant la plataforma Java corresponent.
</p>

<p>
Realitzeu les següents tasques:
</p>
<ol>
<li class="level1"><div class="li"> Instal·lació dels prerequisits</div>
</li>
<li class="level1"><div class="li"> Instal·lació del servidor de reproducció en temps real Airsonic</div>
</li>
<li class="level1"><div class="li"> Configuració del servidor</div>
</li>
<li class="level1"><div class="li"> Creació d’una <em>playlist</em></div>
</li>
</ol>

<p>
<form action=""><div class="solution ioccontent">
<p>
<strong>1.</strong> Instal·lació dels prerequisits
</p>

<p>
Com a prerequisit es necessita el Java Development Kit (JDK). Pot ser OpenJDK 1.8.x (o superior) o Oracle JDK 8+ (o superior).
</p>

<p>
Instal·leu l’OpenJDK:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># apt-get install openjdk-8-jre</div></li><li class="li1"><div class="de1">S'està llegint la llista de paquets… Fet </div></li><li class="li1"><div class="de1">S'està construint l'arbre de dependències       </div></li><li class="li1"><div class="de1">S'està llegint la informació de l'estat… Fet</div></li><li class="li1"><div class="de1">S'instal·laran els següents paquets extres:</div></li><li class="li1"><div class="de1">  libatk-wrapper-java libatk-wrapper-java-jni</div></li><li class="li1"><div class="de1">Paquets suggerits:</div></li><li class="li1"><div class="de1">  icedtea-8-plugin</div></li><li class="li1"><div class="de1">S'instal·laran els paquets NOUS següents:</div></li><li class="li1"><div class="de1">  libatk-wrapper-java libatk-wrapper-java-jni openjdk-8-jre</div></li><li class="li1"><div class="de1">0 actualitzats, 3 nous a instal·lar, 0 a suprimir i 121 no actualitzats.</div></li><li class="li1"><div class="de1">S'han d'obtenir 155 kB d'arxius.</div></li><li class="li1"><div class="de1">Després d'aquesta operació s'empraran 445 kB d'espai en disc addicional.</div></li><li class="li1"><div class="de1">Voleu continuar? [S/n] </div></li></ol></pre>

<p>
Dins el sistema operatiu es poden tenir diferents versions de màquines virtuals Java. Assegureu-nos que la predeterminada és la que acabeu d’instal·lar:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># update-alternatives --config java</div></li><li class="li1"><div class="de1">Hi ha dues possibilitats per a l'alternativa Java (que proveeix /usr/bin/java).</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  Selecció    Camí                                          Prioritat  Estat</div></li><li class="li1"><div class="de1">------------------------------------------------------------</div></li><li class="li1"><div class="de1">* 0            /usr/lib/jvm/java-8-openjdk-i386/jre/bin/java   1081      mode automàtic</div></li><li class="li1"><div class="de1">  1            /usr/bin/gij-6                                  1060      mode manual</div></li><li class="li1"><div class="de1">  2            /usr/lib/jvm/java-8-openjdk-i386/jre/bin/java   1081      mode manual</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">Premeu retorn per mantenir l'opció per defecte[*], o introduïu un número de selecció: </div></li></ol></pre>

<p>
Seleccioneu el 0, que és la versió acabada d’instal·lar.
</p>

<p>
<strong>2.</strong> Instal·lació del servidor de reproducció en temps real Airsonic
</p>

<p>
L’aplicació Airsonic es distribueix en format WAR (<em>Web Application Resource</em>). Aquest és un fitxer utilitzat en la plataforma Java per distribuir un conjunt de fitxers JAR (Java Archive), JavaServer Pages, Java Servlets, fitxers XML i altres recursos que formen una aplicació web.
</p>

<p>
Descarregueu l’aplicació directament des de la línia de comandes:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># wget https://github.com/airsonic/airsonic/releases/download/v10.1.2/airsonic.war</div></li><li class="li1"><div class="de1">--2019-10-29 11:31:24--  https://github.com/airsonic/airsonic/releases/download/v10.1.2/airsonic.war</div></li><li class="li1"><div class="de1">S'està resolent github.com (github.com)… 140.82.118.4</div></li><li class="li1"><div class="de1">S'està connectant a github.com (github.com)|140.82.118.4|:443… connectat.</div></li><li class="li1"><div class="de1">HTTP: s'ha enviat la petició, s'està esperant una resposta… 302 Found</div></li><li class="li1"><div class="de1">Ubicació: https://github-production-release-asset-2e65be.s3.amazonaws.com/96242277/f086bc94-926f-11e8-8e36-3234c6d0dbaf?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20191029%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20191029T103450Z&amp;X-Amz-Expires=300&amp;X-Amz-Signature=4dd69e58c3995264bc07611c41ff14a52ee9d79fb4ccaab923950c4e7da669ca&amp;X-Amz-SignedHeaders=host&amp;actor_id=0&amp;response-content-disposition=attachment%3B%20filename%3Dairsonic.war&amp;response-content-type=application%2Foctet-stream [es segueix]</div></li><li class="li1"><div class="de1">--2019-10-29 11:31:24--  https://github-production-release-asset-2e65be.s3.amazonaws.com/96242277/f086bc94-926f-11e8-8e36-3234c6d0dbaf?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20191029%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20191029T103450Z&amp;X-Amz-Expires=300&amp;X-Amz-Signature=4dd69e58c3995264bc07611c41ff14a52ee9d79fb4ccaab923950c4e7da669ca&amp;X-Amz-SignedHeaders=host&amp;actor_id=0&amp;response-content-disposition=attachment%3B%20filename%3Dairsonic.war&amp;response-content-type=application%2Foctet-stream</div></li><li class="li1"><div class="de1">S'està resolent github-production-release-asset-2e65be.s3.amazonaws.com (github-production-release-asset-2e65be.s3.amazonaws.com)… 52.216.166.43</div></li><li class="li1"><div class="de1">S'està connectant a github-production-release-asset-2e65be.s3.amazonaws.com (github-production-release-asset-2e65be.s3.amazonaws.com)|52.216.166.43|:443… connectat.</div></li><li class="li1"><div class="de1">HTTP: s'ha enviat la petició, s'està esperant una resposta… 200 OK</div></li><li class="li1"><div class="de1">Mida: 73122327 (70M) [application/octet-stream]</div></li><li class="li1"><div class="de1">S'està desant a: «airsonic.war»</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">airsonic.war                     100%[========================================================&gt;]  69,73M  2,06MB/s    in 35s     </div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">2019-10-29 11:32:00 (2,02 MB/s) - s'ha desat «airsonic.war» [73122327/73122327]</div></li></ol></pre>

<p>
Creeu les carpetes i usuaris necessaris per a l’execució del servidor:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># mkdir /var/airsonic/</div></li><li class="li1"><div class="de1"># chown -R jciberta:jciberta /var/airsonic/</div></li></ol></pre>

<p>
Finalment, arranqueu el servidor (triga una estona a arrancar del tot).
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># java -jar airsonic.war</div></li><li class="li1"><div class="de1">           _                       _          </div></li><li class="li1"><div class="de1">     /\   (_)                     (_)         </div></li><li class="li1"><div class="de1">    /  \   _ _ __  ___  ___  _ __  _  ___     </div></li><li class="li1"><div class="de1">   / /\ \ | | '__|/ __|/ _ \| '_ \| |/ __|    </div></li><li class="li1"><div class="de1">  / ____ \| | |   \__ \ (_) | | | | | (__     </div></li><li class="li1"><div class="de1"> /_/    \_\_|_|   |___/\___/|_| |_|_|\___|    </div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">                        10.1.2-RELEASE</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">2019-10-29 11:45:32.260  INFO --- org.airsonic.player.Application          : Starting Application v10.1.2-RELEASE on server.ioc.cat with PID 27789 (/root/airsonic.war started by root in /root)</div></li><li class="li1"><div class="de1">2019-10-29 11:45:32.272  INFO --- org.airsonic.player.Application          : The following profiles are active: legacy</div></li><li class="li1"><div class="de1">2019-10-29 11:45:38.250  INFO --- o.a.p.service.SettingsService            : Java: 1.8.0_232, OS: Linux</div></li><li class="li1"><div class="de1">2019-10-29 11:45:51.620  INFO --- liquibase                                : Successfully acquired change log lock</div></li><li class="li1"><div class="de1">2019-10-29 11:45:53.908  INFO --- liquibase                                : Reading from DATABASECHANGELOG</div></li><li class="li1"><div class="de1">2019-10-29 11:45:54.249  INFO --- liquibase                                : Successfully released change log lock</div></li><li class="li1"><div class="de1">2019-10-29 11:45:54.255  INFO --- liquibase                                : Successfully acquired change log lock</div></li><li class="li1"><div class="de1">2019-10-29 11:45:54.286  INFO --- liquibase                                : Reading from DATABASECHANGELOG</div></li><li class="li1"><div class="de1">2019-10-29 11:45:54.421  INFO --- liquibase                                : Successfully released change log lock</div></li><li class="li1"><div class="de1">2019-10-29 11:45:55.055  INFO --- o.a.p.service.PodcastService             : Automatic Podcast update scheduled to run every 24 hour(s), starting at Tue Oct 29 11:50:55 CET 2019</div></li><li class="li1"><div class="de1">2019-10-29 11:45:55.205  INFO --- o.a.p.s.MediaScannerService              : Automatic media library scanning scheduled to run every 1 day(s), starting at Wed Oct 30 03:00:00 CET 2019</div></li><li class="li1"><div class="de1">2019-10-29 11:46:02.526  INFO --- org.airsonic.player.Application          : Started Application in 38.172 seconds (JVM running for 39.604)</div></li></ol></pre>

<p>
<strong>3.</strong> Configuració del servidor
</p>

<p>
Entreu al servidor via web. El primer cop l’usuari és “admin” i la contrasenya també:
</p>

<p>
<div class="imgelem">
<img src="../media/airsonic1.png" alt="" /></div>

</p>

<p>
Especifiqueu la carpeta on hi haurà la música:
</p>

<p>
<div class="imgelem">
<img src="../media/airsonic2.png" alt="" /></div>

</p>

<p>
Escanegeu la carpeta de música:
</p>

<p>
<div class="imgelem">
<img src="../media/airsonic3.png" alt="" /></div>

</p>

<p>
La discografia trobada apareix a l’esquerra:
</p>

<p>
<div class="imgelem">
<img src="../media/airsonic4.png" alt="" /></div>

</p>

<p>
Creeu un usuari:
</p>

<p>
<div class="imgelem">
<img src="../media/airsonic5.png" alt="" /></div>

</p>

<p>
<strong>4.</strong> Creació d’una llista de reproducció
</p>

<p>
A part d’escanejar les carpetes, també podeu crear llistes de reproducció en diversos formats.
</p>

<p>
Creeu la vostra pròpia llista amb el format M3U:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># ls &quot;$PWD&quot;/* &gt; LlistaDeProva.m3u</div></li><li class="li1"><div class="de1"># cat LlistaDeProva.m3u </div></li><li class="li1"><div class="de1">/home/jciberta/Música/Pascal Comelade. Cent regards/01. Vals en diagonal.mp3</div></li><li class="li1"><div class="de1">/home/jciberta/Música/Pascal Comelade. Cent regards/02. Bolero callejero.mp3</div></li><li class="li1"><div class="de1">/home/jciberta/Música/Pascal Comelade. Cent regards/03. Quatre roses pour Marie.mp3</div></li><li class="li1"><div class="de1">/home/jciberta/Música/Pascal Comelade. Cent regards/04. Tango del Rosselló.mp3</div></li><li class="li1"><div class="de1">/home/jciberta/Música/Pascal Comelade. Cent regards/05. Rock del veneno.mp3</div></li><li class="li1"><div class="de1">/home/jciberta/Música/Pascal Comelade. Cent regards/06. Les filles du calvaire.mp3</div></li><li class="li1"><div class="de1">/home/jciberta/Música/Pascal Comelade. Cent regards/07. Nocturn a Joan Salvat Papasseit.mp3</div></li><li class="li1"><div class="de1">/home/jciberta/Música/Pascal Comelade. Cent regards/08. The way I walk.mp3</div></li><li class="li1"><div class="de1">/home/jciberta/Música/Pascal Comelade. Cent regards/09. Egyptian reggae.mp3</div></li></ol></pre>

<p>
Importeu la <em>playlist</em> amb l’opció <em>Import playist</em>, a l’esquerra, just a sota de <em>Create new playlist</em>:
</p>

<p>
<div class="imgelem">
<img src="../media/airsonic6.png" alt="" /></div>

</p>

<p>
<strong>5.</strong> Consum de l’<em>streaming</em> d’àudio des del client
</p>

<p>
Des d’un client, identifiqueu-vos al servidor via web:
</p>

<p>
<div class="imgelem">
<img src="../media/airsonic7.png" alt="" /></div>

</p>

<p>
I reproduïu la llista:
</p>

<p>
<div class="imgelem">
<img src="../media/airsonic8.png" alt="" /></div>

</p>

<p>
<strong>6.</strong> Consum de l’<em>streaming</em> d’àudio des d’un client mòbil
</p>

<p>
Per a la realització d’aquest apartat cal tenir una xarxa domèstica amb WiFi i un <em>smartphone</em> Android.
</p>

<p>
Connecteu-vos amb el telèfon a la xarxa Wi-Fi. Comproveu que la IP és del mateix rang de xarxa que la IP del servidor:
</p>

<p>
<div class="imgelem">
<img src="../media/ultrasonic1.png" alt="" /></div>

</p>

<p>
Instal·leu l’<a href="https://play.google.com/store/apps/details?id=org.moire.ultrasonic" class="urlextern" title="https://play.google.com/store/apps/details?id=org.moire.ultrasonic"  rel="nofollow">app Ultrasonic</a>.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
<a href="https://ultrasonic.github.io/" class="urlextern" title="https://ultrasonic.github.io/"  rel="nofollow">Ultrasonic</a> és un client <em>open source</em> per a servidors d’<em>streaming</em> que suportin l’API de Subsonic.
</p>
</div></div>
<p>
<div class="iocfigurec">
<ul>
<li>
<img src="../media/ultrasonic2.png" class="imgB" alt="" /></li></ul></div>

</p>

<p>
Configureu l’<em>app</em> perquè es connecti al servidor d’<em>streaming</em> Airsonic amb el paràmetres convenients (IP, usuari i <em>password</em>). Opció <em>Setting / Add server</em>:
</p>

<p>
<div class="iocfigurec">
<ul>
<li>
<img src="../media/ultrasonic3.png" class="imgB" alt="" /></li></ul></div>

</p>

<p>
<div class="iocfigurec">
<ul>
<li>
<img src="../media/ultrasonic4.png" class="imgB" alt="" /></li></ul></div>

</p>

<p>
Connecteu-vos al servidor:
</p>

<p>
<div class="iocfigurec">
<ul>
<li>
<img src="../media/ultrasonic5.png" class="imgB" alt="" /></li></ul></div>

</p>

<p>
Aneu a àlbums i trieu alguna cançó per escoltar en <em>streaming</em>:
</p>

<p>
<div class="iocfigurec">
<ul>
<li>
<img src="../media/ultrasonic6.png" class="imgB" alt="" /></li></ul></div>

</p>

<p>
<div class="iocfigurec">
<ul>
<li>
<img src="../media/ultrasonic7.png" class="imgB" alt="" /></li></ul></div>

</p>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

<h2><a id="servei_d_audio_a_la_carta_amb_el_servidor_de_reproduccio_en_temps_real_gnump3d" >Servei d&#039;àudio a la carta amb el servidor de reproducció en temps real GNUMP3d</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és instal·lar i configurar el servidor d’<em>streaming</em> d’àudio GNUMP3d.
</p>

<p>
Feu les següents tasques:
</p>
<ol>
<li class="level1"><div class="li"> Instal·lació del servidor de reproducció en temps real GNUMP3d</div>
</li>
<li class="level1"><div class="li"> Configuració del servidor GNUMP3d</div>
</li>
<li class="level1"><div class="li"> Preparació i reproducció de l’<em>streaming</em> d’àudio</div>
</li>
<li class="level1"><div class="li"> Creació d’una llista de reproducció (<em>playlist</em>) en format PLS</div>
</li>
</ol>

<p>
<form action=""><div class="solution ioccontent">
<p>
<strong>1.</strong> Instal·lació del servidor de reproducció en temps real GNUMP3d
</p>

<p>
Descarregueu servidor d’<em>streaming</em> GNUMP3d de la pàgina web oficial:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># wget http://savannah.gnu.org/download/gnump3d/gnump3d-3.0.tar.gz</div></li><li class="li1"><div class="de1">--2019-10-24 10:07:00--  http://savannah.gnu.org/download/gnump3d/gnump3d-3.0.tar.gz</div></li><li class="li1"><div class="de1">S'està resolent savannah.gnu.org (savannah.gnu.org)… 209.51.188.79, 2001:470:142:5::79</div></li><li class="li1"><div class="de1">S'està connectant a savannah.gnu.org (savannah.gnu.org)|209.51.188.79|:80… connectat.</div></li><li class="li1"><div class="de1">HTTP: s'ha enviat la petició, s'està esperant una resposta… 301 Moved Permanently</div></li><li class="li1"><div class="de1">Ubicació: http://download.savannah.gnu.org/releases/gnump3d/gnump3d-3.0.tar.gz [es segueix]</div></li><li class="li1"><div class="de1">--2019-10-24 10:07:02--  http://download.savannah.gnu.org/releases/gnump3d/gnump3d-3.0.tar.gz</div></li><li class="li1"><div class="de1">S'està resolent download.savannah.gnu.org (download.savannah.gnu.org)… 209.51.188.200, 2001:470:142:5::200</div></li><li class="li1"><div class="de1">S'està connectant a download.savannah.gnu.org (download.savannah.gnu.org)|209.51.188.200|:80… connectat.</div></li><li class="li1"><div class="de1">HTTP: s'ha enviat la petició, s'està esperant una resposta… 302 Moved Temporarily</div></li><li class="li1"><div class="de1">Ubicació: http://mirrors.up.pt/pub/nongnu/gnump3d/gnump3d-3.0.tar.gz [es segueix]</div></li><li class="li1"><div class="de1">--2019-10-24 10:07:05--  http://mirrors.up.pt/pub/nongnu/gnump3d/gnump3d-3.0.tar.gz</div></li><li class="li1"><div class="de1">S'està resolent mirrors.up.pt (mirrors.up.pt)… 193.137.29.15, 2001:690:2200:1200::15</div></li><li class="li1"><div class="de1">S'està connectant a mirrors.up.pt (mirrors.up.pt)|193.137.29.15|:80… connectat.</div></li><li class="li1"><div class="de1">HTTP: s'ha enviat la petició, s'està esperant una resposta… 200 OK</div></li><li class="li1"><div class="de1">Mida: 671376 (656K) [application/x-gzip]</div></li><li class="li1"><div class="de1">S'està desant a: «gnump3d-3.0.tar.gz»</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">gnump3d-3.0.tar.gz              100%[======================================================&gt;] 655,64K  81,6KB/s    in 8,0s    </div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">2019-10-24 10:07:16 (81,6 KB/s) - s'ha desat «gnump3d-3.0.tar.gz» [671376/671376]</div></li></ol></pre>

<p>
Descomprimiu el fitxer:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># gunzip gnump3d-3.0.tar.gz </div></li><li class="li1"><div class="de1"># tar -xvf gnump3d-3.0.tar</div></li><li class="li1"><div class="de1">gnump3d-3.0/</div></li><li class="li1"><div class="de1">gnump3d-3.0/README.MacOSX</div></li><li class="li1"><div class="de1">gnump3d-3.0/COPYING</div></li><li class="li1"><div class="de1">gnump3d-3.0/ChangeLog</div></li><li class="li1"><div class="de1">gnump3d-3.0/templates/</div></li><li class="li1"><div class="de1">gnump3d-3.0/templates/Thexder/</div></li><li class="li1"><div class="de1">gnump3d-3.0/templates/Thexder/COPYING.html</div></li><li class="li1"><div class="de1">gnump3d-3.0/templates/Thexder/error.html</div></li><li class="li1"><div class="de1">gnump3d-3.0/templates/Thexder/prefs.html</div></li><li class="li1"><div class="de1">gnump3d-3.0/templates/Thexder/now.html</div></li><li class="li1"><div class="de1">gnump3d-3.0/templates/Thexder/playlist.html</div></li><li class="li1"><div class="de1">gnump3d-3.0/templates/Thexder/link_1.jpg</div></li><li class="li1"><div class="de1">gnump3d-3.0/templates/Thexder/link_3.jpg</div></li><li class="li1"><div class="de1">gnump3d-3.0/templates/Thexder/link_2.jpg</div></li><li class="li1"><div class="de1">gnump3d-3.0/templates/Thexder/random.html</div></li><li class="li1"><div class="de1">gnump3d-3.0/templates/Thexder/dig_temp2_01.jpg</div></li><li class="li1"><div class="de1">gnump3d-3.0/templates/Thexder/dig_temp2_10.jpg</div></li><li class="li1"><div class="de1">gnump3d-3.0/templates/Thexder/hr.gif</div></li><li class="li1"><div class="de1">...</div></li></ol></pre>

<p>
Instal·leu-lo:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># cd gnump3d-3.0</div></li><li class="li1"><div class="de1"># make install</div></li><li class="li1"><div class="de1">install -d //etc/gnump3d</div></li><li class="li1"><div class="de1">install -d //usr/bin</div></li><li class="li1"><div class="de1">install -d //usr/share/gnump3d</div></li><li class="li1"><div class="de1">install -d //usr/local/man/man1</div></li><li class="li1"><div class="de1">install -d /`perl bin/getlibdir`/gnump3d/plugins</div></li><li class="li1"><div class="de1">install -d /`perl bin/getlibdir`/gnump3d/lang</div></li><li class="li1"><div class="de1">install -d //var/log/gnump3d</div></li><li class="li1"><div class="de1">install -d //var/cache/gnump3d</div></li><li class="li1"><div class="de1">chmod 777 //var/cache/gnump3d</div></li><li class="li1"><div class="de1">install -d //var/cache/gnump3d/serving</div></li><li class="li1"><div class="de1">chmod 777 //var/cache/gnump3d/serving</div></li><li class="li1"><div class="de1">chmod a+rx /`perl bin/getlibdir`/gnump3d/</div></li><li class="li1"><div class="de1">chmod a+rx /`perl bin/getlibdir`/gnump3d/plugins</div></li><li class="li1"><div class="de1">chmod a+rx /`perl bin/getlibdir`/gnump3d/lang</div></li><li class="li1"><div class="de1">...</div></li><li class="li1"><div class="de1">rm -f /`perl bin/getlibdir`/gnump3d/FreezeThaw.pm</div></li><li class="li1"><div class="de1">rm -f /`perl bin/getlibdir`/gnump3d/playlist.pm</div></li></ol></pre>

<p>
Amb la comanda <em>whereis</em> esbrineu on es troben els fitxers principals, entre ells el servei i la carpeta de configuració:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># whereis gnump3d</div></li><li class="li1"><div class="de1">gnump3d: /usr/bin/gnump3d /etc/gnump3d /usr/share/gnump3d</div></li></ol></pre>

<p>
I arranqueu el servei:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># /usr/bin/gnump3d &amp;</div></li><li class="li1"><div class="de1">[1] 9049</div></li><li class="li1"><div class="de1"> The server root directory you specified, /home/mp3, is missing.</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  Please update your configuration file to specify the actual</div></li><li class="li1"><div class="de1"> root directory you wish to serve media from.  </div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  You can fix this error by changing the line that currently</div></li><li class="li1"><div class="de1"> reads:</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">   root = /home/mp3</div></li></ol></pre>

<p>
<strong>2</strong>. Configuració del servidor gnump3d
</p>

<p>
Cerqueu el fitxer o fitxers de configuració de gnump3d:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># find / -name gnump3*.conf 2&gt;/dev/null</div></li><li class="li1"><div class="de1">/etc/gnump3d/gnump3d.conf</div></li></ol></pre>

<p>
Si doneu un cop d’ull a aquest fitxer, veureu que es poden configurar diverses coses. Entre elles, les següents directives:
</p>
<ul>
<li class="level1"><div class="li"> <em>user</em>: usuari que utilitza el servei.</div>
</li>
<li class="level1"><div class="li"> <em>port</em>: port que utilitza el servei. Per defecte, 8888.</div>
</li>
<li class="level1"><div class="li"> <em>root</em>: carpeta on s’emmagatzemen els arxius.</div>
</li>
<li class="level1"><div class="li"> <em>logfile</em>: fitxer de log. Per defecte és /var/log/gnump3d/access.log.</div>
</li>
<li class="level1"><div class="li"> <em>errorlog</em>: fitxer de log per errors. Per defecte és /var/log/gnump3d/error.log.</div>
</li>
<li class="level1"><div class="li"> <em>allowed_clients</em>: permet clients donades les IP. Es poden permetre també rangs.</div>
</li>
<li class="level1"><div class="li"> <em>denied_clients</em>: denega clients donades les IP.  </div>
</li>
</ul>

<p>
Configureu el servei perquè escolti el port 7777:
</p>
<pre class="code">#
#  The port upon which we are going to serve.  This may be any
# port which is not already in use upon your machine.
#
#  You may use a low port, for example 80, if you are running
# as root - but that is only recommended if you make use of
# the `user&#039; option, which occurs later in this file.
#
port = 7777</pre>

<p>
I els arxius multimèdia siguin a /var/music:
</p>
<pre class="code">#
#  The root directory where we serve content from, this should be
# the directory containing the MP3, OGG, or other media files that
# you wish to share.
#
#  Obviously the files which you wish to serve should be accessible
# to the user who this server is running as - which is set via the
# &#039;user&#039; setting below.
#
#  If you&#039;re on a multi-user system its probably a good idea to
# make the audio files readable to other users anyway, share the
# musical goodness!
#
root = /var/music</pre>

<p>
Evidentment, cal crear aquesta carpeta:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># mkdir /var/music</div></li></ol></pre>

<p>
Reinicieu el servei. Cal matar el procés (ja que l’havíeu arrancat) i tornar a executar el programari:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># kill -9 9049</div></li><li class="li1"><div class="de1"># /usr/bin/gnump3d &amp;</div></li><li class="li1"><div class="de1">[1] 11667</div></li><li class="li1"><div class="de1">GNUMP3d v3.0 by Steve Kemp</div></li><li class="li1"><div class="de1">http://www.gnump3d.org/</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">GNUMP3d is free software, covered by the GNU General Public License,</div></li><li class="li1"><div class="de1">and you are welcome to change it and/or distribute copies of it under</div></li><li class="li1"><div class="de1">certain conditions.</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">For full details please visit the COPYING URL given below:</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  Copying details:</div></li><li class="li1"><div class="de1">    http://localhost:7777/COPYING</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  GNUMP3d now serving upon:</div></li><li class="li1"><div class="de1">    http://localhost:7777/</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  GNUMP3d website:</div></li><li class="li1"><div class="de1">    http://www.gnump3d.org/</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1"> Indexing your music collection, this may take some time.</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1"> (Run with '--fast' if you do not wish this to occur at startup).</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">  Indexing complete.</div></li></ol></pre>

<p>
<strong>3.</strong> Preparació i reproducció de l’<em>streaming</em> d’àudio
</p>

<p>
Primer heu de comprovar que gnump3d està en mode <em>streaming</em>. Això es pot veure al fitxer de configuració:
</p>
<pre class="code">#
#  This next option controls what happens when you click upon a
# single MP3 file.
#
#  If always_stream is set to &#039;1&#039;, and you click upon it you&#039;ll
# actually get a .m3u (playlist) file containing a link to it -
# the advantage of doing this is that you don&#039;t have to download
# the file in its entirety to listen to it - it should start playing
# immediately.
#
#  If set to &#039;0&#039; the playlists will work via streaming, but selecting
# an individual MP3 file will cause it to be downloaded to your local
# machine prior to playing - one drawback of this is that playback
# will probably not start until the entire file has downloaded.
#  
always_stream = 1</pre>

<p>
Ara voleu comprovar el servei amb un navegador:
</p>

<p>
<div class="imgelem">
<img src="../media/gnump3d1.png" alt="" /></div>

</p>

<p>
Si afegiu cançons o un disc directament a la carpeta, aquests hi apareixen també directament:
</p>

<p>
<div class="imgelem">
<img src="../media/gnump3d2.png" alt="" /></div>

</p>

<p>
Observeu que es mostra una etiqueta que diu <em>new</em>. Aquesta etiqueta es configura amb el paràmetre <em>new_days</em> (per defecte, 7) del fitxer de configuració principal. Es mostra l’etiqueta <em>New</em> si l’arxiu fa menys de 7 dies (en aquest cas) que ha estat modificat.
</p>

<p>
Si en reproduïu algun, es descarrega el <em>link</em> i s’escolta en <em>streaming</em>:
</p>

<p>
<div class="imgelem">
<img src="../media/gnump3d4.png" alt="" /></div>

</p>

<p>
<strong>4.</strong> Característiques avançades
</p>

<p>
Si voleu saber quins són els formats de <em>playlist</em> que suporta el servidor, cal anar a /etc/gnump3d/file.types:
</p>
<pre class="code">#
#  This is a list of all the file suffixes which we consider
# playlist files.
#
#  Files with these suffixes will be included in the HTML pages
# served to clients.
#
m3u  = playlist
ram  = playlist
pls  = playlist</pre>

<p>
Creeu una llista de reproducció en format PLS i situeu-la a <em>/var/music</em>:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># echo [playlist] &gt; Llista.pls</div></li><li class="li1"><div class="de1"># ls &quot;$PWD&quot;/* | awk '{f=&quot;File&quot;NR&quot;=\&quot;&quot;$0&quot;\&quot;&quot;; print f}' &gt;&gt; Llista.pls</div></li><li class="li1"><div class="de1"># cat Llista.pls </div></li><li class="li1"><div class="de1">[playlist]</div></li><li class="li1"><div class="de1">File1=&quot;/var/music/Pascal Comelade. Cent regards/01. Vals en diagonal.mp3&quot;</div></li><li class="li1"><div class="de1">File2=&quot;/var/music/Pascal Comelade. Cent regards/02. Bolero callejero.mp3&quot;</div></li><li class="li1"><div class="de1">File3=&quot;/var/music/Pascal Comelade. Cent regards/03. Quatre roses pour Marie.mp3&quot;</div></li><li class="li1"><div class="de1">File4=&quot;/var/music/Pascal Comelade. Cent regards/04. Tango del Rosselló.mp3&quot;</div></li><li class="li1"><div class="de1">File5=&quot;/var/music/Pascal Comelade. Cent regards/05. Rock del veneno.mp3&quot;</div></li><li class="li1"><div class="de1">File6=&quot;/var/music/Pascal Comelade. Cent regards/06. Les filles du calvaire.mp3&quot;</div></li><li class="li1"><div class="de1">File7=&quot;/var/music/Pascal Comelade. Cent regards/07. Nocturn a Joan Salvat Papasseit.mp3&quot;</div></li><li class="li1"><div class="de1">File8=&quot;/var/music/Pascal Comelade. Cent regards/08. The way I walk.mp3&quot;</div></li><li class="li1"><div class="de1">File9=&quot;/var/music/Pascal Comelade. Cent regards/09. Egyptian reggae.mp3&quot;</div></li><li class="li1"><div class="de1">File10=&quot;/var/music/Pascal Comelade. Cent regards/Llista.pls&quot;</div></li></ol></pre>

<p>
I també la detecta automàticament:
</p>

<p>
<div class="imgelem">
<img src="../media/gnump3d3.png" alt="" /></div>

</p>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

<h2><a id="radionomyinstal_lacio_i_configuracio" >Radionomy: instal·lació i configuració</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és entrar en contacte amb un servei de ràdio per internet implementat i present a la xarxa. Més enllà de configurar els paràmetres tècnics, aprendre a configurar els continguts.
</p>

<p>
Radionomy és una plataforma belga de creació de ràdios en línia. A grans trets, es tracta d’una comunitat d’usuaris, tot i que en aquest cas està especialitzada en la ràdio per internet. Podem ser oients i també podem disposar del nostre propi canal de ràdio des del qual emetre els temes musicals que més ens agradin i altres continguts.
</p>
<div class="iocfigure"><a name=""></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Finestra principal de Radionomy

</figcaption><img src="../media/w_uf4m8_37.png" alt="" /></figure>
<div class="footfigure"></div></div>
<p>
Creeu una emissora radiofònica mitjançant Radionomy.
</p>

<p>
<form action=""><div class="solution ioccontent">
<p>
En primer lloc, registreu-vos en el lloc <a href="/doku.php?id=fp:asx:m08:www.radionomy.com" class="wikilink2" title="fp:asx:m08:www.radionomy.com" rel="nofollow">Radionomy</a>. Ho podeu fer tant com a usuaris nous com mitjançant el vostre compte de Facebook.
</p>

<p>
Heu de descarregar el RadioManager. El programa us permetrà configurar la vostra ràdio a l’ordinador, crear llistes de reproducció, graelles de programació i tot el que cal per posar en marxa una emissora de ràdio.
</p>
<ol>
<li class="level1"><div class="li"> Entreu al lloc web de <a href="http://www.radionomy.com" class="urlextern" title="http://www.radionomy.com"  rel="nofollow">Radionomy</a> amb el correu electrònic i la contrasenya que hàgiu utilitzat per registrar-vos.</div>
</li>
<li class="level1"><div class="li"> Abans de descarregar-vos el programari RadioManager, us demanarà que introduïu algunes dades sobre la vostra ràdio en el web: el nom de la ràdio, l’estil i paraules clau perquè els oients puguin trobar-la. Disposar d’una ràdio ben classificada us facilitarà aconseguir oients.</div>
</li>
<li class="level1"><div class="li"> Fet això, la web mostrarà un enllaç per descarregar RadioManager. Heu de fer clic a <em>Última versió de RadioManager</em> i començarà la descàrrega.</div>
</li>
<li class="level1"><div class="li"> Un cop descarregat i instal·lat el programari, ja ho teniu tot per començar a emetre.</div>
</li>
</ol>

<p>
Per comprendre com funciona RadioManager heu de conèixer la funció de les cinc pestanyes principals:
</p>
<ul>
<li class="level1"><div class="li"> <em>Audiolibrary</em>: hi ha tots els continguts (<em>jingles</em>, cançons, programes, publicitat pròpia…). Es pot organitzar en carpetes.</div>
</li>
<li class="level1"><div class="li"> <em>Clocks and Playlists</em>: es creen les diferents llistes de reproducció, també anomenades <em>clocks</em>. A grans trets, es tracta de l’ordre de les cançons i dels <em>jingles</em> que es reproduiran en la vostra ràdio. Podeu crear <em>clocks</em> per a diferents franges horàries. </div>
</li>
<li class="level1"><div class="li"> <em>Day Template</em>: és la graella amb els horaris de cada dia. Arrossegar un <em>clock</em> a una determinada hora de la graella fa que a aquesta hora comenci a funcionar la nostra ràdio. Es poden definir diverses graelles; per exemple, una per entre setmana i una altra per als caps de setmana.</div>
</li>
<li class="level1"><div class="li"> <em>Planning</em>: en aquest apartat hi ha un calendari. Cal que arrossegueu les graelles diàries al dia corresponent de reproducció. Val a dir que si un dia queda sense graella aquell dia la ràdio no emetrà.</div>
</li>
<li class="level1"><div class="li"> <em>Upload Files</em>: és l’espai per a la gestió dels nostres continguts. Hi podeu pujar programes, música, <em>jingles</em>…</div>
</li>
</ul>

<p>
És molt important que us assegureu de no infringir les lleis de drets d’autor. Si ho feu, correu el risc que el compte de Radionomy sigui cancel·lat.
</p>

<p>
Un cop hàgiu emplenat el <em>Planning</em>, la ràdio s’activarà.
</p>

<p>
Els passos que cal seguir per a la creació de l’emissora són els següents:
</p>
<ol>
<li class="level1"><div class="li"> Definir i omplir les nostres carpetes de música. Obrirem <em>Audiolibrary</em> i crearem tantes carpetes de música com vulguem. Podem omplir les carpetes tant amb música de Radionomy com pujant les nostres pròpies cançons. Per fer-ho, haurem d’usar <em>Upload Files</em>. Per exemple, si volem posar un <em>jingle</em> a la ràdio haurem de crear una carpeta de <em>jingles</em> i pujar-hi el nostre.</div>
</li>
<li class="level1"><div class="li"> Un cop haguem fet les nostres carpetes de música, haurem de crear i configurar els nostres <em>clocks</em>. Anem a <em>Clocks and Playlists</em> i creem un nou <em>clock</em>. A continuació, hem d’arrossegar i deixar anar les carpetes de música. Podrem veure un gràfic circular, tipus formatgets, amb les nostres carpetes de música. </div>
<ul>
<li class="level2"><div class="li"> També podem fer algunes <em>playlists</em>. Al contrari d’un <em>clock</em>, una <em>playlist</em> és una seqüència específica de cançons, una llista de reproducció no aleatòria.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> A continuació configurarem el <em>Day Template</em>: </div>
<ul>
<li class="level2"><div class="li"> Hem de situar els nostres <em>clocks</em> i <em>playlists</em> en un <em>Day Template</em>. Creem un nou <em>Day Template</em>, que es pot dir, per exemple, “Entre setmana”. Podem, a més, situar els <em>clocks</em> i <em>playlists</em> en els intervals de temps que desitgem.</div>
</li>
<li class="level2"><div class="li"> Si el nostre <em>clock</em> de música s’establís des de les 17.00 fins a les 22.00 h, durant les 5 hores, el programari aniria a buscar les cançons seguint l’ordre definit en el <em>clock</em>.</div>
</li>
<li class="level2"><div class="li"> També podem arrossegar les nostres <em>playlists</em> a la part esquerra de l’horari. Els <em>playlists</em> no són extensibles. Atenció: el <em>Day Template</em> ha d’estar ple. Si hi ha un buit no podrem generar un <em>Planning</em>.</div>
</li>
<li class="level2"><div class="li"> Si volem assegurar-nos que no hi ha cap buit en el <em>Day Template</em>, podem fer clic amb el botó dret sobre els <em>clocks</em> i els <em>playlists</em> del <em>Day Template</em> i seleccionar “Intercalar amb l’element anterior o el següent”.</div>
</li>
<li class="level2"><div class="li"> La part dreta de l’horari serveix per programar <em>podcasts</em>. Com hi afegim un <em>podcast</em>? Doncs creant una carpeta de <em>podcasts</em> en la llibreria i carregant-ne un. Després els arrosseguem a la part dreta del <em>Day Template</em>.</div>
</li>
<li class="level2"><div class="li"> El pas següent és la planificació.</div>
</li>
<li class="level2"><div class="li"> Si fem clic a <em>Planning</em> ens apareix el calendari de la ràdio, que ens permetrà generar fins a 30 dies de programació.</div>
</li>
<li class="level2"><div class="li"> Arrossegueu el <em>Day Template</em> als dies que vulgueu. A continuació, feu clic a <em>Enviament del planning</em>. Veurem que canvia si canvia de color quan és generat: blau (= tot bé) o groc (alguns advertiments, per exemple, canvi de tempo entre dues cançons).</div>
</li>
<li class="level2"><div class="li"> Veureu la planificació generada per un dia. Si hi ha algunes parts que no us agraden podeu editar la planificació, eliminant o afegint-hi cançons, per exemple. Quan n’estigueu convençuts guardeu els canvis i feu clic a <em>Enviament del Planning</em>.</div>
</li>
<li class="level2"><div class="li"> Trobareu un reproductor i eines per compartir la vostra ràdio a la vostra pàgina: <code>http://www.radionomy.com/nom-de-la-nostra-ràdio</code>.</div>
</li>
</ul>
</li>
</ol>

<p>
A la biblioteca d’àudio teniu altres funcionalitats disponibles.
</p>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

	 </article>
     <div class="pnpage">
      <div class="left-corner"></div>
      <div id="prevpage">Anar a la p&agrave;gina anterior:<br /><a href="../../../WebContent/u4/a1/continguts.html">Instal·lació i administració del servei d’àudio</a></div>
      <div id="nextpage">Anar a la p&agrave;gina seg&uuml;ent:<br /><a href="../../../WebContent/u4/a1/exercicis.html">Exercicis</a></div>
      <div class="right-corner"></div>
     </div>
    </div>
    <footer class="footer">
      <div><small>Aquest document està subjecte a una llicència oberta de Creative Commons, es reserva el dret de reconeixement de l'autoria, d'exigir que no se'n faci cap mena d'ús comercial. Si altereu o transformeu aquesta obra, o en genereu obres derivades, només podeu distribuir l'obra generada amb una llicència idèntica a aquesta.</small></div>
    </footer>
 </div>
 <div id="back_preview" class="hidden"></div>
 <div id="preview" class="hidden">
  <div class="prevcontent"></div>
 </div>
 <div id="help-tooltips">
  <div id="help-toc" class="hidden tooltip"><span>Taula de continguts:</span> Ofereix una vista general de l&#39;estructura del m&ograve;dul, que us facilitar&agrave; la navegaci&oacute; a trav&eacute;s dels seus continguts.<span class="arrow-left"></span></div> 
  <div id="help-settings" class="hidden tooltip"><span>Opcions de format:</span> Permet configurar el format de lectura a partir de les vostres prefer&egrave;ncies, modificant la mida de la lletra, el color del fons, l&#39;amplada de la p&agrave;gina o l&#39;ocultaci&oacute; dels continguts complementaris, entre d&#39;altres.<span class="arrow-left"></span></div>
  <div id="help-printer" class="hidden tooltip"><span>Imprimir:</span>  Envia el contingut seleccionat a la impressora.<span class="arrow-left"></span></div>
  <div id="help-favorites" class="hidden tooltip"><span>Prefereits:</span> Permet desar aquelles parts del contingut a les que us interessi accedir en un moment posterior; us permetr&agrave; anar creant un repositori personalitzat de les seccions que considereu m&eacute;s rellevants. Un cop l&#39;hageu començat a fer servir se us mostrar&agrave; a sota un comptador que us informar&agrave; del nombre de preferits que s&#39;hagin emmagatzemat fins al moment.<span class="arrow-left"></span></div>
  <div id="help-favcounter" class="hidden tooltip"><span>Comptador i llistat de preferits:</span> Indica el nombre de preferits que s&#39;han desat fins el moment; clicant damunt seu accedireu al llistat de preferits, i a trav&eacute;s d&#39;aquest podreu accedir directament als continguts que hageu emmagatzemat.<span class="arrow-left"></span></div>
  <div id="help-help_icon" class="hidden tooltip"><span>Ajuda:</span> Aquesta opci&oacute; activa la informaci&oacute; de les funcionalitats del web tot situant el punter del ratol&iacute; al damunt dels diferents &iacute;tems.<span class="arrow-left"></span></div>
  <div id="help-sidebar-hide" class="hidden tooltip"><span>Mostrar/Ocultar barra lateral:</span>  Deshabilita la barra d&#39;opcions, permetent la seva recuperaci&oacute; quan es desitgi.<span class="arrow-left"></span></div>
  <div id="help-search" class="hidden tooltip"><span>Cerca:</span>  Introdu&iuml;u les paraules clau sobre aquells conceptes que desitgeu localitzar en els continguts del m&ograve;dul. Tamb&eacute; podeu excloure un terme de la cerca tot afegint-hi el signe &#8220;-&#8221; al davant.<span class="arrow-top"></span></div>
  <div id="help-header" class="hidden tooltip"><span>Cap&ccedil;alera:</span>  Indica l&#39;apartat o secci&oacute; que es mostra en pantalla. Tingueu present que les capçaleres de segon, tercer i quart nivell tamb&eacute; es poden desar com a marcadors.<span class="arrow-left"></span></div>
</div> 
</body>
</html>
