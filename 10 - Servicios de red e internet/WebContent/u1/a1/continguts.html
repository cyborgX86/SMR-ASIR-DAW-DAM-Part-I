<!doctype html>

<!--[if lt IE 7 ]> <html class="ie ie6 no-js" lang="ca"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie ie7 no-js" lang="ca"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie ie8 no-js" lang="ca"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie ie9 no-js" lang="ca"> <![endif]-->
<!--[if gt IE 9]><!--><html class="no-js" lang="ca"><!--<![endif]-->
<!-- the "no-js" class is for Modernizr. -->

<head id="www-sitename-com" data-template-set="html5-reset">

	<meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html">
        
	<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title>Serveis de Xarxa i Internet</title>
	
<!-- <meta name="title" content=""> --> 
	<meta name="description" content="">
	<!-- Google will often use this as its description of your page/site. Make it good. -->
	
	<meta name="google-site-verification" content="">
	<!-- Speaking of Google, don't forget to set your site up: http://google.com/webmasters -->
	
	<meta name="author" content="Institut Obert de Catalunya">
	<meta name="Copyright" content="Copyright Institut Obert de Catalunya 2011. All Rights Reserved.">

	<!-- Dublin Core Metadata : http://dublincore.org/ -->
	<meta name="DC.title" content="Serveis de Xarxa i Internet">
	<meta name="DC.subject" content="Informàtica i comunicacions">
	<meta name="DC.creator" content="Institut Obert de Catalunya">
	
	<!--  Mobile Viewport Fix
	j.mp/mobileviewport & davidbcalhoun.com/2010/viewport-metatag 
	device-width : Occupy full width of the screen in its current orientation
	initial-scale = 1.0 retains dimensions instead of zooming out if page height > device height
	maximum-scale = 1.0 retains dimensions instead of zooming in if page width < device width
	-->
	<!-- Uncomment to use � use thoughtfully!
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
	-->

	<link rel="shortcut icon" href="../../../img/favicon.ico">
	<!-- This is the traditional favicon.
		 - size: 16x16 or 32x32
		 - transparency is OK
		 - see wikipedia for info on browser support: http://mky.be/favicon/ -->
		 
	<link rel="apple-touch-icon" href="../../../img/apple-touch-icon.png">
	<!-- The is the icon for iOS's Web Clip.
		 - size: 57x57 for older iPhones, 72x72 for iPads, 114x114 for iPhone4's retina display (IMHO, just go ahead and use the biggest one)
		 - To prevent iOS from applying its styles to the icon name it thusly: apple-touch-icon-precomposed.png
		 - Transparency is not recommended (iOS will put a black BG behind the icon) -->
	
	<!-- CSS: screen, mobile & print are all in the same file -->
	<link rel="stylesheet" href="../../../_/css/style.css">

	<!-- CSS: jQuery UI -->
	<link rel="stylesheet" href="../../../_/css/jquery-ui.css">
	
	<!-- all our JS is at the bottom of the page, except for Modernizr. -->
	<script src="../../../_/js/modernizr-1.7.min.js"></script>
	<script src="../../../_/js/Hyphenator.js" type="text/javascript"></script>
	<script type="text/javascript">
	   Hyphenator.config({
		minwordlength : 4
	   });
	   Hyphenator.run();
	</script>
    <script src="../../../_/js/build.js" type="text/javascript"></script>
</head>

<body class="style-newspaper">

<div class="wrapper"><!-- not needed? up to you: http://camendesign.com/code/developpeurs_sans_frontieres -->

	<header id="header">
		<div class="head"><a href="http://ioc.gencat.cat"><img src="../../../img/logo.png" alt="Institut Obert de Catalunya"/></a><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/es/deed.ca"><img src="../../../img/license.png" alt="Llic&egrave;ncia" class="license"/></a></div>
		<div class="headdocument"><a href="../../../index.html">Serveis de Xarxa i Internet</a></div>
        <div id="search" class="search" name="search">
         <form id="frmsearch" action="../../../search.html" method="get">
          <input type="text" name="q"/>
        </form>
        </div>
	</header>
   <div id="upbutton" class="upbutton" style="display:none;"><img src="../../../img/uparrow.png" alt="Pujar a l'inici de p&agrave;gina"/></div>
   <aside id="aside">
    <div id="menu">
      <ul>
       <li name="toc"><div><img src="../../../img/toc.png" alt="&Iacute;ndex"/></div></li>
       <li name="settings"><div><img src="../../../img/settings.png" alt="Configuraci&oacute;"/></div></li>
       <li name="printer"><div><img src="../../../img/printer.png" alt="Imprimir"/></div></li>
       <li name="favorites"><div><img src="../../../img/favorites.png" alt="Favorits"/></div></li>
       <li name="help_icon" class="help_icon"><div><img src="../../../img/help_icon.png" alt="Ajuda"/></div></li>
      </ul>
     </div>
   </aside>
   <div id="sidebar-hide" name="sidebar-hide"><img src="../../../img/arrows.png"/></div>
   <section>
     <div id="toc" class="hidden">
      <div class="menucontent">
        <ul>
        <li id="u1" class="parentnode"><p><a class="unit" href="../../../WebContent/u1/introduccio.html">1. Serveis de noms i configuració automàtica</a></p><ul class="expander"><li id="u1introduccio"><a href="../../../WebContent/u1/introduccio.html">Introducció</a></li><li id="u1resum"><a href="../../../WebContent/u1/resum.html">Resum</a></li><li id="u1resultats"><a href="../../../WebContent/u1/resultats.html">Resultats d'aprenentatge</a></li><li id="u1referencies"><a href="../../../WebContent/u1/referencies.html">Més informació</a></li><li id="u1a1" class="tocsection"><p id='u1a1continguts'><a class="section" href="../../../WebContent/u1/a1/continguts.html">Instal·lació i administració de serveis de noms de domini</a><span class="buttonexp"></span></p><ul><li id="u1a1activitats"><a href="../../../WebContent/u1/a1/activitats.html">Activitats</a></li><li id="u1a1exercicis"><a href="../../../WebContent/u1/a1/exercicis.html">Exercicis</a></li><li id="u1a1annexos"><a href="../../../WebContent/u1/a1/annexos.html">Annexos</a></li></ul></li><div data-parent-id='u1a1' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u1/a1/continguts.html#el_servei_de_resolucio_de_noms">El servei de resolució de noms</a></li><li><a href="../../../WebContent/u1/a1/continguts.html#funcionalitat_del_sistema_de_noms_jerarquics">Funcionalitat del sistema de noms jeràrquics</a></li><li><a href="../../../WebContent/u1/a1/continguts.html#instal_lacio_i_configuracio_del_servei_dns">Instal·lació i configuració del servei DNS</a></li><li><a href="../../../WebContent/u1/a1/continguts.html#resolucio_forwarding_i_memoria_cau">Resolució, 'forwarding' i memòria cau</a></li><li><a href="../../../WebContent/u1/a1/continguts.html#creacio_de_zones">Creació de zones</a></li><li><a href="../../../WebContent/u1/a1/continguts.html#transferencies_de_zona">Transferències de zona</a></li><li><a href="../../../WebContent/u1/a1/continguts.html#extensions_del_protocol_dns">Extensions del protocol DNS</a></li></ul></div></div><li id="u1a2" class="tocsection"><p id='u1a2continguts'><a class="section" href="../../../WebContent/u1/a2/continguts.html">Instal·lació i administració de serveis de configuració automàtica de xarxa</a><span class="buttonexp"></span></p><ul><li id="u1a2activitats"><a href="../../../WebContent/u1/a2/activitats.html">Activitats</a></li><li id="u1a2exercicis"><a href="../../../WebContent/u1/a2/exercicis.html">Exercicis</a></li><li id="u1a2annexos"><a href="../../../WebContent/u1/a2/annexos.html">Annexos</a></li></ul></li><div data-parent-id='u1a2' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u1/a2/continguts.html#configuracio_automatitzada_de_xarxa">Configuració automatitzada de xarxa</a></li><li><a href="../../../WebContent/u1/a2/continguts.html#funcionament_del_protocol_dhcp">Funcionament del protocol DHCP</a></li><li><a href="../../../WebContent/u1/a2/continguts.html#instal_lacio_del_servidor_dhcp">Instal·lació del servidor DHCP</a></li><li><a href="../../../WebContent/u1/a2/continguts.html#configuracio_del_servei">Configuració del servei</a></li><li><a href="../../../WebContent/u1/a2/continguts.html#assignacions_estatiques_i_dinamiques">Assignacions estàtiques i dinàmiques</a></li><li><a href="../../../WebContent/u1/a2/continguts.html#opcions_addicionals_de_configuracio">Opcions addicionals de configuració</a></li><li><a href="../../../WebContent/u1/a2/continguts.html#documentacio_de_procediments">Documentació de procediments</a></li></ul></div></div></ul></li><li id="" class="indexnode"><p><a href="../../../index.html">Anar a l&#39;&iacute;ndex general</a></p></li>
        </ul>
      </div>
    </div>
   </section>
   <section>
   <div id="settings" class="hidden">
    <div class="menucontent">
     <div class="allsettings">
     <div class="settings">
      <label>Font i Color</label>
		<div class="setting-option">
	        <ul class="fontBackground">
				<li id="style-newspaper" title="Newspaper" class="appearance-style-newspaper"><span>Newspaper</span></li>
                <li id="style-novel" title="Novel" class="appearance-style-novel"><span>Novel</span></li>
                <li id="style-ebook" title="eBook" class="appearance-style-ebook"><span>eBook</span></li>
				<li id="style-inverse" title="Inverse" class="appearance-style-inverse active"><span>Inverse</span></li>
				<li id="style-athelas" title="Athelas" class="appearance-style-athelas"><span>Athelas</span></li>
			</ul>
		</div>
     </div>
	<div class="settings">
      <label>Amplada</label>
		<div class="setting-option">
	        <div id="slider-width"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
		<div class="setting-option">
	        <div id="slider-font"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
	  <div class="setting-option">
       <form action="" class="sett-options">
		<ul>
		    <li><input type="checkbox" id="secondary-content" /><label for="secondary-content">Mostra recursos complementaris</label></li>
		    <li><input type="checkbox" id="main-images" /><label for="main-images">Mostra imatges</label></li>
		    <li><input type="checkbox" id="text-alignment" /><label for="text-alignment">Text justificat</label></li>
			<li><input type="checkbox" id="text-hyphen" /><label for="text-hyphen">Partici&oacute; sil·l&agrave;bica</label></li>
		</ul>
       </form>
	  </div>
     </div>
     </div>
    </div>
   </div>
   </section>
 <section>
 <div id="favorites" class="hidden"></div>
 </section>   
 <div id="bridge" class="hidden"></div>
 <div id="help" class="hidden">
  <div class="helptitle">Dreceres del teclat<hr></div>
  <div class="helpsection"><span>General</span>
   <ul>
    <li><span class="shortcut">g</span>: Anar al men&uacute; de navegaci&oacute;</li>
    <li><span class="shortcut">o</span>: Anar a opcions</li>
    <li><span class="shortcut">s</span>: Guardar la p&agrave;gina actual a favorits</li>
    <li><span class="shortcut">p</span>: Imprimir la p&agrave;gina actual</li>
    <li><span class="shortcut">?</span>: Mostrar/Ocultar l&#39;ajuda</li>
   </ul>
  </div>
  <div class="helpsection"><span>Navegaci&oacute;</span>
   <ul>
    <li><span class="shortcut">i</span>: Anar a l&#39;&iacute;ndex general</li>
    <li><span class="shortcut">t</span>: Anar a l&#39;inici de p&agrave;gina</li>
    <li><span class="shortcut">b</span>: Anar al final de p&agrave;gina</li>
    <li><span class="shortcut">j</span>: Anar cap endavant dintre la p&agrave;gina</li>
    <li><span class="shortcut">k</span>: Anar cap enrere dintre la p&agrave;gina</li>
    <li><span class="shortcut">h</span>: Anar a la p&agrave;gina anterior:</li>
    <li><span class="shortcut">l</span>: Anar a la p&agrave;gina seg&uuml;ent:</li>
   </ul>
   </div>
 </div>
 <div id="favcounter" name="favcounter" class="hidden"><span></span></div>
 <div id="navmenu" class="navmenu"><ul class="webnav"><li><a href="../../../index.html" title="Anar a l&#39;&iacute;ndex general">Inici</a></li><li><a href="../introduccio.html">Serveis de noms i configuració automàtica</a></li><li>Instal·lació i administració de serveis de noms de domini</li></ul></div>
	<div id="content" lang="ca" class="hyphenate text">
     <article lang="ca" class="sheet">
        <h1><a id="instal_lacio_i_administracio_de_serveis_de_noms_de_domini"> Instal·lació i administració de serveis de noms de domini </a></h1>
    	
<p>
El <strong>sistema de noms de domini</strong> o <strong><acronym title="Domain Name System">DNS</acronym></strong> (Domain Name System) proporciona un mecanisme eficaç per fer la resolució de noms de domini a adreces IP. Com a usuaris (humans) ens és més fàcil adreçar-nos a un nom de domini (de <em>host</em>, de web, de servidor de correu…) utilitzant un text identificatiu com per exemple www.ioc.cat que no pas l’adreça IP 213.73.40.230. El servei <acronym title="Domain Name System">DNS</acronym> no solament permet fer la resolució de noms de domini a adreces IP, sinó també la resolució inversa. És a dir, a partir d’una adreça IP esbrinar el nom de domini del <em>host</em>.
</p>

<p>
El servei <acronym title="Domain Name System">DNS</acronym> proporciona independència del nom de domini respecte a l’adreça IP. Així un domini pot canviar d’adreça IP de manera transparent per als usuaris del domini. Fins i tot és usual que un domini s’identifiqui amb més d’una adreça IP com a mesura de redundància contra la caiguda del sistema o com a balanceig de càrregues. Altres serveis proporcionats pel <acronym title="Domain Name System">DNS</acronym> són la identificació dels servidors de correu d’un domini, de cada un dels <em>hosts</em> que pertanyen a la xarxa, servidors d’impressió…
</p>

<h2><a id="el_servei_de_resolucio_de_noms" >El servei de resolució de noms</a></h2>
<div class="level2">

<p>
El problema d’identificar els equips es produeix des de bon principi de l’existència de les xarxes d’ordinadors i no és específic de les xarxes TCP/IP. Cal un mecanisme en “llenguatge humà” per identificar els equips de la xarxa. En especial els que proporcionen serveis als altres equips i usuaris. En la xarxa inicial Arpanet, els equips ja rebien un nom. Aquests noms es feien públics per mitjà d’un fitxer centralitzat que contenia els noms de tots els equips de la xarxa i la seva identificació. Aquest fitxer era hosts.txt, conegut en sistemes GNU/Linux com a /etc/hosts.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Un <strong>sistema de noms pla</strong> es basa en la utilització d’un <strong>fitxer de text</strong> que descriu cada <em>host</em> amb la seva corresponent adreça IP. Es pot usar per definir àlies per equips locals en xarxes petites, però no és escalable a xarxes grans, i molt menys a Internet.
</p>
</div></div>
<p>

</p>

<p>
En una xarxa petita es pot generar un fitxer amb el nom i l’adreça IP de tots els <em>hosts</em> centralitzat en un servidor, i encarregar-se de distribuir còpies d’aquest fitxer a tots els equips de la xarxa. Però aquest model de coneixement no és escalable. Si la xarxa creix és impossible de mantenir. Utilitzar aquest model significaria que hi ha un equip que centralitza els noms de tots els <em>hosts</em> d’Internet en un sol fitxer! D’altra banda, també significaria que aquest fitxer s’ha de repartir entre tots els equips d’Internet perquè sàpiguen com es diuen els altres equips cada cop que hi ha una actualització. Evidentment cal una altra solució.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
El 1983 sorgeix el Domain Name System (<acronym title="Domain Name System">DNS</acronym>) per aportar una solució escalable i pràctica. El <acronym title="Domain Name System">DNS</acronym> es fonamenta en una base de dades de noms de domini jeràrquica i distribuïda. És <strong>jeràrquica</strong> perquè s’organitza en una estructura de <strong>dominis</strong> que es poden compondre de subdominis que també es poden dividir en subdominis i així fins a 127 nivells (originàriament). Aquests dominis són gestionats per servidors <acronym title="Domain Name System">DNS</acronym> responsables de cada <strong>zona</strong>. I és una base de dades <strong>distribuïda</strong> perquè la informació no està tota junta en un sol repositori central, sinó que es troba repartida per parts en els servidors <acronym title="Domain Name System">DNS</acronym> d’Internet. Cada servidor <acronym title="Domain Name System">DNS</acronym> <strong>autoritari</strong> conté la base de dades de la seva zona.
</p>
</div></div><div class="ioctext"><div class="ioccontent"><p class="ioctitle">Problemes d&#039;actualització d&#039;una xarxa</p>
<p>
Imagineu els problemes que es presenten en voler fer arribar un mateix fitxer a tots els <em>hosts</em>. Hi haurà inconsistències entre els equips que han rebut l’actualització i els que no. El procés de copiar el fitxer en cada equip és molt laboriós/feixuc. Un nou equip a Internet vol dir escriure de nou el fitxer i tornar-lo enviar a tothom!
</p>
</div></div>
</div>

<h3><a id="classificacio_dels_mecanismes_de_resolucio" >Classificació dels mecanismes de resolució</a></h3>
<div class="level3">

<p>
Els administradors de xarxes tenen la tasca d’establir el mecanisme d’identificació de <em>hosts</em> que volen usar. Determinar quins noms usaran i com es farà per identificar cada nom amb l’adreça IP corresponent. Els mecanismes per anomenar els <em>hosts</em> pot ser local a cada <em>host</em>, local i intern a una organització i global a Internet.
</p>

<p>
Un cop posats els noms cal saber-los resoldre, trobar-ne l’adreça IP apropiada. La resolució pot ser local en un <em>host</em> usant un fitxer d’associacions o implementada usant el servei de noms <acronym title="Domain Name System">DNS</acronym>. Aquest servei es basa en l’estructura client/servidor, de manera que caldrà aprendre a configurar tant l’un com l’altre. Primerament es descriurà com configurar el client o <em>resolver</em> i el servidor serà tractat al llarg dels apartats posteriors. Aquests dos mecanismes, local i <acronym title="Domain Name System">DNS</acronym>, es poden combinar i determinar-ne la precedència. 
</p>

<p>
El servei <acronym title="Domain Name System">DNS</acronym> proporciona múltiples maneres de treballar. Segons quina sigui la seva configuració actuarà de manera diferent en fer la resolució. Caldrà estudiar què és un servidor només cau, què fa quan es permet la utilització de la memòria cau, la utilització d’un forwarder i quina diferència hi ha entre usar recursió o no utilitzar-la. La gestió de dominis i zones pròpies, la creació de subdominis i la delegació són aspectes clau del funcionament d’un servidor de noms de domini que també es tractaran més endavant.
</p>

</div>

<h3><a id="noms_de_host_locals_dominis_locals_i_dominis_d_internet" >Noms de &#039;host&#039; locals, dominis locals i dominis d&#039;Internet</a></h3>
<div class="level3">

<p>
Sabem que els <em>hosts</em> s’identifiquen en una xarxa i a Internet per la seva adreça IP, però en general els usuaris desconeixen quina és aquesta adreça. Els usuaris estan habituats a connectar-se per exemple a un altre dels ordinadors de casa seva posant un <em>nom local</em> que s’han inventat (per exemple, pcJocs, portatilMarta…). 
</p>

<p>

</p>

<p>
A la feina, els mateixos usuaris accedeixen a diversos equips que tenen noms que els hi han posat els administradors del sistema. Així, per exemple, els informes estan en un ordinador anomenat <em>watergate</em>, la gestió de la comptabilitat en un servidor que es diu <em>blackhole</em> i les nòmines es gestionen des del servidor <em>minix</em>. Tots aquests ordinadors pertanyen a la xarxa de l’empresa, que s’identifica amb el nom de domini local empresa.cat.
</p>

<p>
A més a més, resulta que tant des de casa com des de la feina aquests usuaris treballen habitualment consultant serveis a <em>hosts</em> com gmail.com, youtube.com, ara.cat… És a dir, consulten serveis i <em>hosts</em> de dominis d’Internet.
</p>

<p>
Aquests tres casos exposats permeten observar tres tipus diferents de resolució de noms:
</p>
<ul>
<li class="level1"><div class="li"> Resolució de noms de <em>host</em> locals</div>
</li>
<li class="level1"><div class="li"> Resolució de noms d’un domini local (no integrat a Internet)</div>
</li>
<li class="level1"><div class="li"> Resolució de noms global (domini integrat a Internet)</div>
</li>
</ul>

<p>
Les tres resolucions no són excloents, sinó que s’implementen totes a la vegada combinant la resolució local i la resolució via <acronym title="Domain Name System">DNS</acronym>. Existeix també un mecanisme per indicar la precedència de la resolució, és a dir, indicar si es prefereix primer la resolució local i després la de <acronym title="Domain Name System">DNS</acronym> o a l’inrevés.
</p>

</div>

<h3><a id="el_client_dnsresolver" >El client DNS: &#039;resolver&#039;</a></h3>
<div class="level3">

<p>
Un equip client que vol resoldre un nom de <em>host</em> té diferents maneres de fer-ho. Es pot fer localment mitjançant un fitxer de <em>hosts</em> (típicament /etc/hosts) o de manera distribuïda usant <acronym title="Domain Name System">DNS</acronym> (el <em>resolver</em>). De fet, es poden aplicar tots dos mètodes conjuntament indicant-ne la precedència en algun fitxer de configuració del sistema (en sistemes GNU/Linux, el fitxer /etc/ nsswitch.conf).
</p>

<p>
El <em>resolver</em> és la part client del sistema de noms de dominis <acronym title="Domain Name System">DNS</acronym>, que està organitzat en una estructura client/servidor. Cada <em>resolver</em> implementa les seves opcions, però n’hi ha que són suficientment genèriques per descriure-les aquí. En la majoria de sistemes GNU/Linux, aquestes opcions es defineixen en el fitxer /etc/resolv.conf.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Criteri de resolució</p>
<p>
Per defecte, quan cal resoldre un nom de <em>host</em> (i no s’ha especificat la directiva <em>search</em>), el <em>resolver</em> fa el següent: si el nom de <em>host</em> inclou un punt (pc30.inf) mira de resoldre’l tal qual, i si no pot hi aplica el nom de domini (pc30.inf.inf.fpoberta.net.). Si el nom de <em>host</em> no conté cap punt (pc30), primer li afegeix el domini i el mira de resoldre (pc30.inf.fpoberta.net.), i si no el troba el mira de resoldre tal qual (pc30).
</p>
</div></div>
<p>
Les següents són les directives del fitxer /etc/resolv.conf:
</p>
<ul>
<li class="level1"><div class="li"> <strong>domain</strong> (<em>local domain name</em> o nom de domini local) indica el nom de domini del <em>host</em> al qual pertany el <em>resolver</em>. Serveix per completar els noms de domini no qualificats (FQDN).</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> <strong>search</strong> permet modificar el comportament per defecte indicant explícitament la llista de dominis a aplicar. El primer d’aquests és aplicat com el nom del domini local (<em>local domain name</em>) i és per això que la directiva <em>search</em> és excloent de la directiva <em>domain</em>. </div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> <strong>nameserver</strong> permet especificar el servidor de noms a utilitzar. Se’n poden indicar fins a tres per si no hi ha accés al servidor. El <em>resolver</em> intenta connectar amb el primer servidor i si ho aconsegueix realitza les consultes a aquest servidor.</div>
</li>
</ul>
<pre class="code"># Exemple de fitxer de configuració client /etc/resolv.conf
[root@host ~]$ cat /etc/resolv.conf 
search ioc.cat
nameserver 80.58.61.250 
nameserver 80.58.61.254</pre>

<p>
La <span class="figref"><a href="#Figure1.1"><span>figura</span></a></span> mostra una interfície gràfica que permet configurar els servidors <acronym title="Domain Name System">DNS</acronym>. En aquest exemple s’observa que s’han definit dos servidors de noms, un de primari i un de secundari. La directiva <em>search</em> correspon al valor local.lan. Tal com és habitual en sistemes GNU/Linux aquesta miniaplicació gràfica (<em>applet</em>) simplement modifica el fitxer de configuració.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Servidor de noms d&#039;una altra organització</p>
<p>
Es poden configurar els <em>hosts</em> perquè utilitzin el servidor de noms d’una altra organització (perquè és més ràpida, per estalviar-se feina…), però no és una bona pràctica.
</p>
</div></div><div class="iocfigure"><a name="Figure1.1"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Miniaplicació gràfica de configuració del resolver

</figcaption><img src="../media/ic10m08u1_01.png" alt="" /></figure>
</div>
</div>

<h2><a id="funcionalitat_del_sistema_de_noms_jerarquics" >Funcionalitat del sistema de noms jeràrquics</a></h2>
<div class="level2">

<p>
Sabem que tenim la necessitat de poder-nos adreçar als diversos <em>hosts</em>, servidors i dominis que hi ha a les xarxes, i en especial a Internet. Hem d’establir algun mètode per relacionar les adreces IP amb el seu nom corresponent. Un mecanisme és posar noms plans als <em>hosts</em> i als dominis, noms independents els uns dels altres sense cap mena d’estructura ni de jerarquia. Amb tota seguretat aquest mecanisme provocaria noms duplicats i un caos organitzatiu important. 
</p>

<p>

</p>

<p>
El sistema de noms de domini permet identificar qualsevol equip en la xarxa i assegurar-se que no hi ha col·lisions, és a dir, noms duplicats. Es basa en una estructura jeràrquica de noms en forma d’arbre on l’arrel és el node o domini arrel del qual deriven tots els altres nodes. Aquest es divideix en altres dominis com, per exemple, .com, .edu, .org, .cat… Al seu torn, cada domini es pot dividir en subdominis i així successivament. Les rutes s’indiquen començant pel subdomini més intern i anant cap al node arrel, com per exemple mail.ioc.cat.
</p>

</div>

<h3><a id="el_sistema_de_noms_jerarquic" >El sistema de noms jeràrquic</a></h3>
<div class="level3">

<p>
En un sistema de noms jeràrquic cada node de l’arbre s’identifica per un text (el nom de domini) que no es pot repetir en el mateix nivell, però sí en altres llocs de l’arbre de l’espai de noms. El mateix passa amb els fitxers: no hi pot haver dos fitxers amb el mateix nom en el mateix directori, però sí en ubicacions diferents. Un <strong>domini</strong> està format pel propi node i la resta de l’arbre que penja d’aquest node. Penseu en l’exemple d’un directori: si es vol copiar un directori s’entén que està format pel mateix directori i tots els subdirectoris que conté.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Caràcters en els noms de domini</p>
<p>
L’estàndard <acronym title="Domain Name System">DNS</acronym> indica que els noms de domini han de ser de 64 caràcters com a màxim, i només poden incloure caràcters llatins, dígits del 0 al 9 i el guió. Les majúscules són indiferents.
</p>

<p>
Hi ha mecanismes com l’IDNA (Internationalized Domain Name o noms de domini internacionalitzats) que permeten utilitzar altres alfabets en els noms de domini.
</p>
</div></div>
<p>
Anomenem <strong>espai de noms</strong> al conjunt de tots els dominis que formen l’arbre de noms <acronym title="Domain Name System">DNS</acronym>. Continuant l’analogia amb el sistema de fitxers diríem que l’espai de noms és equivalent a tot el sistema de fitxers i directoris.
</p>

<p>
El sistema de noms de domini d’Internet <acronym title="Domain Name System">DNS</acronym> està format pels elements següents:
</p>
<ul>
<li class="level1"><div class="li"> <strong>Espai de noms</strong>: el conjunt de tots els noms de domini d’Internet (tot l’arbre).</div>
</li>
<li class="level1"><div class="li"> <strong>Domini</strong>: text identificatiu d’un domini (un node i tots els seus descendents).</div>
</li>
<li class="level1"><div class="li"> <strong>FQDN</strong>: nom de domini absolut començant pel node i acabant en l’arrel.</div>
</li>
<li class="level1"><div class="li"> <strong>Domini absolut</strong>: és un sinònim d’FQDN. Es la ruta sencera que va del node a l’arrel. Els dominis absoluts acaben en punt.</div>
</li>
<li class="level1"><div class="li"> <strong>Domini relatiu</strong>: nom de domini sense qualificar (no acaba en punt). S’entén que un nom de domini és relatiu al domini al que pertany.</div>
</li>
<li class="level1"><div class="li"> <strong>Domini arrel</strong>: domini del qual deriven tots els altres. S’indica amb un punt o amb la cadena buida.</div>
</li>
</ul>

<p>

</p>

<p>
Exemples de noms de domini:
</p>
<ul>
<li class="level1"><div class="li"> ioc.cat.: nom de domini absolut que, per exemple, inclou mail.ioc.cat i inf.ioc.cat.</div>
</li>
<li class="level1"><div class="li"> pc01.inf.ioc.cat.: nom de <em>host</em> absolut o FQDN.</div>
</li>
<li class="level1"><div class="li"> pc01: nom de <em>host</em> relatiu al domini on pertanyi.</div>
</li>
<li class="level1"><div class="li"> pc02.inf: nom de domini relatiu al domini on pertany.</div>
</li>
<li class="level1"><div class="li"> com: nom de domini relatiu. Usualment ens hi referim en lloc de com., que és el FQDN apropiat.</div>
</li>
<li class="level1"><div class="li"> .: domini arrel.</div>
</li>
</ul>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">El punt final en els noms de domini</p>
<p>
La majoria de vegades escrivim els dominis com si fossin absoluts, però són relatius al node arrel perquè no posem el punt final. Un altre cop es pot fer l’analogia amb les rutes relatives i les rutes absolutes del sistema de fitxers.
</p>
</div></div>
<p>
L’estructura d’arbre (jeràrquica) de l’espai de noms proporciona un mecanisme d’identificació únic d’un domini. No pot existir cap domini que tingui exactament el mateix nom absolut o <strong>FQDN</strong> (Fully Qualified Domain Name o nom de domini complet). Els dominis es llegeixen des del node a l’arrel. Així, un domini que correspongui al departament d’administració de l’organització IOC dins del domini cat s’identifica, per exemple, com a admin.ioc.cat. Si ens fixem en el domini anterior, veurem que acaba en punt: és una manera d’indicar el domini arrel. El <strong>domini arrel</strong> es defineix com un domini sense etiqueta o, millor dit, amb la cadena buida com a etiqueta. Això provoca que els dominis que s’indiquin de manera absoluta acabin amb el caràcter punt.
</p>

<p>
Un <strong>domini absolut</strong> o FQDN és el que inclou tots els nodes des del domini fins a l’arrel (inclosa en forma de punt final). Un <strong>domini relatiu</strong> no inclou l’arrel i pot ser relatiu al domini actual. Per exemple, dins del domini de l’IOC el domini inf (del departament d’informàtica) és un nom relatiu que fa referència al nom absolut inf.ioc.cat.
</p>

</div>

<h3><a id="els_noms_de_domini_d_internet" >Els noms de domini d&#039;Internet</a></h3>
<div class="level3">

<p>
A Internet els noms de dominis segueixen una estructura basada en els seus inicis però que ha anat evolucionant. El node arrel es va dividir en un conjunt de subdominis anomenats <strong>TLD</strong> (Top Level Domains o dominis d’alt nivell). Aquests dominis eren com, edu, gov, mil, org, net i int. Posteriorment se’n van afegir d’altres com cat, name, biz, info, pro, aero, coop i museum. Es volien organitzar els dominis per funcionalitat posant les empreses en els .com, les organitzacions en els .org…
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Origen dels noms de domini</p>
<p>
Si ens fixem en els primers dominis d’alt nivell, estaven basats en una visió estatunidenca del món (de fet la xarxa Arpanet, base de l’actual Internet, va ser desenvolupada pel Departament de Defensa del govern dels EUA). En estendre’s Internet globalment i aparèixer dominis d’alt nivell geogràfics, moltes organitzacions es van registrar en més d’un domini (per exemple, empresa.com i empresa.cat).
</p>
</div></div>
<p>
Es va veure, però, la necessitat de poder agrupar els dominis de manera geogràfica i van sorgit els famosos identificadors de país. Per a cada país es va generar un TLD de dos caràcters utilitzant el preexistent estàndard internacional ISO 3166 (els famosos .es, .fr, .us…).
</p>

<p>
Degut a aquesta doble nomenclatura, els primers es coneixen com <strong>gTLD</strong> (domini de primer nivell genèric, en anglès <em>generic top-level domain</em>) i els segons corresponents a països com a <strong>ccTLD</strong> (domini de primer nivell territorial, en anglès <em>country-code top-level domain</em>).
</p>

<p>
Els servidors arrel són crucials per al funcionament del <acronym title="Domain Name System">DNS</acronym>, ja que coneixen tots els dominis de primer nivell. Han d’admetre un gran volum de consultes i per això n’hi ha tretze repartits per tot el món. A més a més, d’aquests tretze, alguns tenen rèpliques en diversos continents utilitzant un sistema anomenat <em>anycast</em>.
</p>
<div class="ioctextl"><div class="ioccontent"><p class="ioctitle">Dominis d&#039;alt nivell</p>
<p>
Els següents són exemples de dominis d’alt nivell:
</p>
<ul>
<li class="level1"><div class="li"> cat: Catalunya</div>
</li>
<li class="level1"><div class="li"> ad: Andorra</div>
</li>
<li class="level1"><div class="li"> aq: Antàrtida</div>
</li>
<li class="level1"><div class="li"> gb: Gran Bretanya</div>
</li>
<li class="level1"><div class="li"> im: Illa de Man</div>
</li>
<li class="level1"><div class="li"> ms: Montserrat</div>
</li>
<li class="level1"><div class="li"> pf: Polinèsia Francesa</div>
</li>
<li class="level1"><div class="li"> ps: autoritat palestina</div>
</li>
<li class="level1"><div class="li"> uk: Regne Unit</div>
</li>
</ul>
</div></div>
<p>
Així doncs, hi ha un node arrel del qual deriven múltiples nodes de primer nivell, com per exemple com., cat., es., org. Aquests dominis són gestionats per institucions o empreses amb forts lligams amb la indústria informàtica i Internet. Després hi ha els dominis de segon nivell, com per exemple ioc.cat., gmail.com., rediris.es. o escoladeltreball.org., que corresponen a empreses o institucions que han demanat disposar d’un domini propi de segon nivell. Això es fa demanant donar-se d’alta al gestor apropiat del domini de primer nivell del qual es vol formar part. Aquests serveis són de pagament en la gran majoria dels casos.
</p>

<p>
El model es va repetint de manera que cada gestor d’un domini pot crear (o vendre) subdominis del seu domini. Així, per exemple, si els gestors del domini imaginari <em>jocs.org.</em> permeten fer subdominis, es podria crear el subdomini <em>parxis.jocs.org.</em> des d’on divulgar la nostra afició al parxís.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
A vegades els dominis es classifiquen per nivells, indicant el seu grau de profunditat:
</p>
<ul>
<li class="level1"><div class="li"> <strong>Arrel</strong>: el domini pare de tots els dominis, el punt.</div>
</li>
<li class="level1"><div class="li"> <strong>TLD</strong> o <strong>primer nivell</strong>: domini fill de l’arrel o de primer nivell. En són exemples cat., es., com., org. …</div>
</li>
<li class="level1"><div class="li"> <strong>Segon nivell</strong>: format pels dominis fills dels dominis de primer nivell. Per exemple, ioc.cat., gencat.cat., gmail.com., python.org. …</div>
</li>
<li class="level1"><div class="li"> <strong>Altres</strong>: a partir d’aquí cada domini de segon nivell genera els subdominis que creu apropiats. Alguns són gestionats per ells mateixos i d’altres són delegats a altres entitats. Per exemple, correu.ioc.cat., ensenyament.gencat.cat.</div>
</li>
</ul>
</div></div>
<p>
Els dominis inclouen <em>hosts</em>, impressores, servidors de correu… És a dir, noms d’una màquina. Tot nom de <em>host</em> és també un nom que es podrà identificar i resoldre usant el <acronym title="Domain Name System">DNS</acronym>. Els noms de <em>host</em> pertanyen a un domini, però no són dominis. Sovint els usuaris desconeixen la diferència entre un nom de <em>host</em> (un element) i un nom de domini (una àrea que abasta subdominis i que conté <em>hosts</em>). Veurem més endavant la relació entre els dominis i les zones, que són les bases de dades que descriuen els <em>hosts</em> que formen part del domini.
</p>

<p>
Per exemple, gmail.com. és un domini, però www.gmail.com. és un <em>host</em> (o més d’un en cas de ser <em>multihomed</em>). El mateix passa amb inf.ioc.cat., que fa referència al domini format per tots els <em>hosts</em> del departament d’informàtica de l’IOC i els possibles subdominis que tingui. En canvi, pc01.inf.ioc.cat., printer.inf.ioc.cat. o ftp.inf.ioc.cat. són noms de <em>hosts</em> que pertanyen a aquest domini. 
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Molt sovint a Internet es confon entre un <strong>nom de <em>host</em></strong> com ftp.rediris.es., que identifica la màquina de RedIRIS que proporciona el servei <acronym title="File Transfer Protocol">FTP</acronym>, i el <strong>nom de domini</strong>, que identifica una àrea de l’espai de noms de domini que inclou els seus subdominis.
</p>

<p>
Els <strong>dominis</strong> contenen descripcions dels <em>hosts</em> i la seva organització.
</p>
</div></div>
<p>
Alguns exemples són:<br/>

</p>
<ul>
<li class="level1"><div class="li"> www.gmail.com. és un nom de <em>host</em>.<br/>
</div>
</li>
<li class="level1"><div class="li"> gmail.com. és un nom de domini.<br/>
</div>
</li>
<li class="level1"><div class="li"> www.ioc.cat.   és un nom de <em>host</em>.<br/>
</div>
</li>
<li class="level1"><div class="li"> ioc.cat. és un nom de domini.<br/>
</div>
</li>
</ul>
<pre class="code"># Llistat de l&#039;adreça IP d&#039;un host concret (&quot;eines&quot;) del domini ioc.cat
root@server:~# host eines.ioc.cat
eines.ioc.cat has address 85.192.111.246

# Llistat d&#039;informació global del domini ioc.cat
root@server:~# host ioc.cat
ioc.cat has address 85.192.111.254
ioc.cat mail is handled by 10 aspmx.l.google.com.
ioc.cat mail is handled by 20 alt2.aspmx.l.google.com.
ioc.cat mail is handled by 30 aspmx4.googlemail.com.
ioc.cat mail is handled by 30 aspmx5.googlemail.com.
ioc.cat mail is handled by 20 alt1.aspmx.l.google.com.
ioc.cat mail is handled by 30 aspmx3.googlemail.com.
ioc.cat mail is handled by 30 aspmx2.googlemail.com.</pre>

</div>

<h3><a id="dominis_subdominis_i_zones" >Dominis, subdominis i zones</a></h3>
<div class="level3">

<p>
Sabem que el sistema de noms de domini està basat en una arquitectura client/servidor en què els clients fan preguntes del tipus “Quina IP té aquest domini?” i els servidors miren de contestar-les. Els servidors de noms <acronym title="Domain Name System">DNS</acronym> són els programes que emmagatzemen i gestionen la informació de la base de dades d’una part de l’espai de noms anomenada <em>zona</em>.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Exemple d&#039;administració de subdomini</p>
<p>
El domini .cat és administrat per una entitat que gestiona la zona .cat. Aquest domini conté el subdomini ioc.cat, però ha <strong>delegat</strong> l’administració d’aquest subdomini a l’IOC. Els administradors de l’IOC disposen d’un servidor que gestiona el seu domini com una zona. El domini .cat és l’arbre que inclou tots els dominis que en deriven, inclòs ioc.cat. Però la zona .cat i la zona ioc.cat no són la mateixa zona. Són administrades per entitats diferents.
</p>
</div></div>
<p>
Primerament hem de descriure què és una zona. Una <strong>zona</strong> és la part de l’espai de noms de domini gestionada per un o més servidors <acronym title="Domain Name System">DNS</acronym>. Els servidors que gestionen la zona tenen informació completa sobre ella i es diu que hi tenen <strong>autoritat</strong>. Podríem pensar que un servidor <acronym title="Domain Name System">DNS</acronym> gestiona un domini i que una zona és el mateix que un domini, però això no és necessàriament així. Un domini es divideix en subdominis per facilitar-ne l’administració. Cada part administrada per un o més servidors <acronym title="Domain Name System">DNS</acronym> és una zona. El domini és l’arbre de l’espai de noms (ell i els seus descendents) i la zona és la part de l’arbre administrada per un servidor de noms de domini concret.
</p>

<p>
En la <span class="figref"><a href="#Figure2.1"><span>figura</span></a></span> es pot veure un espai de noms amb quatre zones i catorze dominis. Cada lletra és un domini. El nom de domini corresponent a cada zona (s’anomenen segons el seu node superior) és A, B.A, C.A i I.C.A respectivament. Cada una d’aquestes quatre zones tindrà un o més servidors <acronym title="Domain Name System">DNS</acronym> per gestionar-la.
</p>

<p>
En general, podem dir que una zona conté la informació completa dels equips que formen el domini corresponent a la zona i dels equips dels subdominis que no s’han delegat. Aquesta informació s’emmagatzema en la <strong>base de dades de zona</strong>.
</p>
<div class="iocfigure"><a name="Figure2.1"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Exemple de zones i dominis

</figcaption><img src="../media/ic10m08u1_02.png" alt="" /></figure>
</div><div class="iocimportant"><div class="ioccontent">
<p>
Convé tenir clar en tot moment que domini i zona no són equivalents (tot i que poden coincidir).
</p>
<ul>
<li class="level1"><div class="li"> El <strong>domini</strong> és l’arbre de l’espai de noms que inclou el node i els seus descendents.</div>
</li>
<li class="level1"><div class="li"> La <strong>zona</strong> és la part de l’arbre administrada per un servidor <acronym title="Domain Name System">DNS</acronym> concret.</div>
</li>
<li class="level1"><div class="li"> La <strong>base de dades de zona</strong> la formen els fitxers que emmagatzemen la descripció dels equips que pertanyen a la zona.</div>
</li>
<li class="level1"><div class="li"> La <strong>delegació</strong> consisteix a passar l’autoritat de la gestió d’un subdomini a una altra entitat. Aquesta serà qui s’encarregarà de gestionar-lo.</div>
</li>
</ul>
</div></div>
<p>
<strong>Delegar</strong> l’administració d’un subdomini no és més que traspassar l’autoritat sobre aquest subdomini a una altra entitat (a uns altres servidors <acronym title="Domain Name System">DNS</acronym>). Aquesta entitat és la responsable de l’administració de la zona delegada. Té tota l’autoritat per fer i desfer al seu criteri. La zona pare perd el control administratiu de la zona delegada i simplement apunta als servidors de noms de la zona delegada per obtenir informació quan la requereix.
</p>

<p>
L’estàndard que defineix el <acronym title="Domain Name System">DNS</acronym> estableix que cal configurar dos o més servidors autoritaris per a cada zona, anomenats <em>servidor primari</em> i <em>servidor secundari</em>. El motiu és proporcionar un mecanisme de redundància, robustesa, rendiment i còpia de seguretat. Si el servidor de noms falla i és únic, possiblement la xarxa caurà, serà inoperativa.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Els servidors <strong>primari</strong> (o <em>master</em>) i <strong>secundari/s</strong> (o <em>slave/s</em>) són autoritat. Només el primari té els fitxers de zona amb les dades in situ. Els servidors secundaris obtenen una còpia de les dades per transferència.
</p>
</div></div>
</div>

<h3><a id="el_protocol_dns" >El protocol DNS</a></h3>
<div class="level3">

<p>
El servei de noms de domini utilitza el protocol <acronym title="Domain Name System">DNS</acronym> per fer les consultes i les respostes. Es tracta d’un protocol de capa d’aplicació que pot utilitzar tant UDP (<em>User Datagram Protocol</em>) com TCP (<em>Transmission Control Protocol</em>) en la capa de transport. Usualment, tant les consultes del client com les respostes del servidor es poden encabir en un datagrama (512 <em>bytes</em>) i s’utilitza UDP (de fet, generalment es diu que el <acronym title="Domain Name System">DNS</acronym> usa UDP). Però si la informació a transmetre és àmplia (per exemple, una resposta amb una llista amb molta informació), la comunicació es passa automàticament a TCP. Un altre cas en què la informació usa TCP és quan es realitza la transferència d’informació d’una zona entre servidors primaris i secundaris. El servidor <acronym title="Domain Name System">DNS</acronym> utilitza el port ben conegut (<em>well known</em>) 53.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
El <strong>protocol <acronym title="Domain Name System">DNS</acronym></strong> usu habitualment UDP, però pot usar <strong>TCP i UDP</strong>. Es tracta d’un protocol de capa d’aplicació i utilitza el <strong>port 53</strong>.
</p>
</div></div>
<p>
Els datagrames <acronym title="Domain Name System">DNS</acronym> es componen de diversos apartats, tal com es pot veure en la consulta <em>host</em> següent:
</p>
<pre class="code">root@server:~# host -a uoc.edu
Trying &quot;uoc.edu&quot;
Trying &quot;uoc.edu&quot;
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 39287
;; flags: qr rd ra; QUERY: 1, ANSWER: 16, AUTHORITY: 0, ADDITIONAL: 1

;; QUESTION SECTION:
;uoc.edu.			IN	ANY

;; ANSWER SECTION:
uoc.edu.		3600	IN	TXT	&quot;google-site-verification=GrOoO_KKCaNNqkn4y6c3P_AnaoSczfz_mKBeSo4DKZ8&quot;
uoc.edu.		3600	IN	TXT	&quot;google-site-verification=GxX8kwaNhmRhDUaZrmgdOALPvdor5iFnIorJBGYcEcw&quot;
uoc.edu.		3600	IN	TXT	&quot;v=spf1 ip4:213.73.40.0/24 ip4:13.111.22.169 ip4:83.169.91.142 ip4:83.169.91.143 ip4:83.169.91.144 ip4:83.169.91.145 ip4:83.169.91.146 ip4:83.169.91.147 include:_spf.google.com include:eevid.com ~all&quot;
uoc.edu.		3600	IN	TXT	&quot;adobe-idp-site-verification=f6f2f671-9e0b-4464-9293-5c71951acbc1&quot;
uoc.edu.		86400	IN	NS	nepal.uoc.es.
uoc.edu.		86400	IN	NS	tibet.uoc.es.
uoc.edu.		86400	IN	SOA	tibet.uoc.es. root.tibet.uoc.es. 2020063001 286400 7200 2592000 172800
uoc.edu.		600	IN	A	213.73.40.242
uoc.edu.		300	IN	NAPTR	0 30 &quot;S&quot; &quot;SIP+D2U&quot; &quot;&quot; _sip\._udp\.uoc\.edu.
uoc.edu.		300	IN	MX	5 alt2.aspmx.l.google.com.
uoc.edu.		300	IN	MX	10 aspmx2.googlemail.com.
uoc.edu.		300	IN	MX	10 aspmx3.googlemail.com.
uoc.edu.		300	IN	MX	10 aspmx4.googlemail.com.
uoc.edu.		300	IN	MX	10 aspmx5.googlemail.com.
uoc.edu.		300	IN	MX	1 aspmx.l.google.com.
uoc.edu.		300	IN	MX	5 alt1.aspmx.l.google.com.

;; ADDITIONAL SECTION:
tibet.uoc.es.		86291	IN	A	213.73.40.45

Received 819 bytes from 192.168.1.1#53 in 6438 ms</pre>

<p>
La comunicació <acronym title="Domain Name System">DNS</acronym> és un mecanisme de consulta/resposta entre el client i el servidor. Els datagrames, doncs, seran de <em>query</em> (consulta) o <em>answer</em> (resposta).
</p>

<p>
Els apartats que componen un missatge <acronym title="Domain Name System">DNS</acronym> són:
</p>
<ul>
<li class="level1"><div class="li"> <strong>HEADER</strong>. Capçalera del missatge que indica si és una consulta o una resposta. Conté l’ID (identificador) del missatge, <em>flags</em> i un resum de quines seccions del missatge porten informació i quanta.</div>
</li>
<li class="level1"><div class="li"> <strong>QUESTION</strong>. Aquesta secció conté la consulta que s’ha efectuat. És a dir, quina dada s’ha demanat al servidor. Pot ser una resolució d’adreça IP a un domini, demanar la llista de servidors de correu…</div>
</li>
<li class="level1"><div class="li"> <strong>ANSWER</strong>. Secció que conté la resposta obtinguda del servidor. S’entén que aquesta secció conté la resposta no autoritativa. A vegades en les utilitats de consulta aquesta secció es mostra com a <em>non-authority answer</em>.</div>
</li>
<li class="level1"><div class="li"> <strong>AUTHORITY</strong>. Aquesta secció conté les respostes que són autoritatives per a la consulta efectuada. Evidentment pot estar buida.</div>
</li>
<li class="level1"><div class="li"> <strong>ADDITIONAL</strong>. Conté informació addicional per completar la resposta. En l’exemple s’observa que completa la resolució dels noms de màquina que hi ha a la secció <em>answer</em> tot indicant la seva adreça IP corresponent.</div>
</li>
</ul>

</div>

<h2><a id="instal_lacio_i_configuracio_del_servei_dns" >Instal·lació i configuració del servei DNS</a></h2>
<div class="level2">

<p>
El servei de xarxa <acronym title="Domain Name System">DNS</acronym> està estructurat en forma de servei client/servidor; per tant, caldrà disposar del programari apropiat per adoptar cada un d’aquests rols. El programari que fa la funció de client usualment ja està integrat en el sistema operatiu (la part que gestiona la xarxa) o en les mateixes aplicacions (per exemple, Firefox). És a dir, per disposar de la part client del servei <acronym title="Domain Name System">DNS</acronym> normalment no cal instal·lar res, tot i que sí que cal configurar-la correctament.
</p>

<p>
Així, doncs, quan parlem d’instal·lar un servei <acronym title="Domain Name System">DNS</acronym> fem referència al procés d’instal·lació i configuració del programari del servidor.
</p>

<p>
La instal·lació del programari que proporciona el servei <acronym title="Domain Name System">DNS</acronym> es fa de manera molt similar (per no dir idèntica) a la d’altres serveis de xarxa com el DHCP, l’HTTP o l’<acronym title="File Transfer Protocol">FTP</acronym>. Es tracta d’instal·lar el programari de l’aplicació servidor i fer-ne la configuració apropiada. 
</p>

<p>
Per fer tot això cal fer les reflexions i passos següents:
</p>
<ul>
<li class="level1"><div class="li"> Quin programari proporciona aquest servei? Quines característiques té? Com es pot adquirir?</div>
</li>
<li class="level1"><div class="li"> Obtenir l’aplicació que proporciona el servei <acronym title="Domain Name System">DNS</acronym>.</div>
</li>
<li class="level1"><div class="li"> Observar l’estat de la xarxa actual. Està el servei ja en funcionament? Existeix ja una configuració <acronym title="Domain Name System">DNS</acronym> activa?</div>
</li>
<li class="level1"><div class="li"> Instal·lar l’aplicació servidor.</div>
</li>
<li class="level1"><div class="li"> Comprovar que la instal·lació s’ha efectuat correctament.</div>
</li>
<li class="level1"><div class="li"> Configurar el servei en el servidor i activar els clients perquè la utilitzin.</div>
</li>
<li class="level1"><div class="li"> Comprovar que el servei funciona correctament.</div>
</li>
</ul>

</div>

<h3><a id="aplicacions_servidor_dns" >Aplicacions servidor DNS</a></h3>
<div class="level3">

<p>
Sempre que l’administrador vol posar en funcionament un nou servei de xarxa cal que primerament analitzi quines aplicacions hi ha en el mercat que ofereixen aquest servei. És feina seva estudiar les característiques de les diverses aplicacions, com per exemple avaluar-ne l’eficiència, el cost, el que en diuen els altres… La manera més fàcil de fer això és navegar per Internet, consultar les revistes especialitzades o demanar consell a un dels gurus informàtics coneguts.
</p>

<p>
Usualment, però, l’administrador acaba utilitzant l’aplicació servidor <acronym title="Domain Name System">DNS</acronym> que li proporciona el mateix sistema operatiu. Si utilitzeu Windows, l’empresa Microsoft disposa d’una aplicació pròpia, però també en podeu trobar d’altres a Internet. Igualment, si utilitzeu GNU/Linux, segurament la mateixa distribució ja proporciona un servidor <acronym title="Domain Name System">DNS</acronym> o bé n’existeix algun de clàssic provinent de l’Unix. De totes maneres, també en podeu obtenir d’altres a Internet. En la <span class="figref"><a href="#Figure3.1"><span>figura</span></a></span> es pot veure quin servidor utilitzen els nodes arrels. La llista ha estat extreta de la Wikipedia. S’hi poden observar els 13 servidors o nodes arrel del servei <acronym title="Domain Name System">DNS</acronym>, l’entitat que els gestiona, el tipus  de difusió que fan i el programari que utilitzen.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Cerca de DNS a Internet</p>
<p>
Usualment l’administrador s’informa mitjançant el seu cercador preferit, per exemple Google, i de webs com la Viquipèdia. Proveu a buscar “<acronym title="Domain Name System">DNS</acronym>” o “<acronym title="Domain Name System">DNS</acronym> server” al Google i a la Wikipedia (en anglès).
</p>
</div></div><div class="iocfigure"><a name="Figure3.1"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Llista de servidors arrel <acronym title="Domain Name System">DNS</acronym> i programari que utilitzen

</figcaption><img src="../media/ic10m08u1_03.png" alt="" /></figure>
</div>
</div>

<h3><a id="instal_lacio_de_l_aplicacio_servidor" >Instal·lació de l&#039;aplicació servidor</a></h3>
<div class="level3">

<p>
Els usuaris de GNU/Linux poden buscar fàcilment per Internet paquets del client i del servidor DHCP usant eines com <em>apt-get</em> o <em>yum</em> i els repositoris de paquets apropiats segons quina sigui la distribució que utilitzin. A més, sempre es pot utilitzar algun cercador d’Internet per ajudar a localitzar tot allò que faci falta.
</p>

<p>
Un cop instal·lat el programari caldrà identificar què s’ha instal·lat. Quins paquets i què contenien. A vegades no s’instal·laran paquets sinó fitxers .tar, dels quals també caldrà saber-ne examinar el contingut. És important saber identificar quins dels components instal·lats corresponen a fitxers executables, quins a fitxers de configuració i quins a fitxers de documentació.
</p>

<p>
Tot servei instal·lat s’ha de configurar apropiadament i posar en marxa. Per tant, caldrà saber gestionar l’estat del servei (engegat, aturat…) i definir l’estat que ha de tenir en els diferents <em>runlevels</em> del sistema.
</p>

<p>
En definitiva, el procediment d’instal·lar usualment inclourà:
</p>
<ul>
<li class="level1"><div class="li"> Buscar el programari del servei (sigui en format de paquets .deb, .rpm o .tar) i descarregar-lo utilitzant l’eina apropiada segons quina sigui la distribució.</div>
</li>
<li class="level1"><div class="li"> Examinar el sistema per identificar quin programari i quins paquets relacionats amb el servei hi ha instal·lats.</div>
</li>
<li class="level1"><div class="li"> Identificar els components del servei: quins són els fitxers executables, de configuració i de documentació.</div>
</li>
<li class="level1"><div class="li"> Consultar i establir l’estat del servei (engegar i aturar) i saber establir l’estat per defecte per a cada <em>runlevel</em>.</div>
</li>
</ul>

</div>

<h3><a id="configuracio_per_defecte_del_servei_instal_lat" >Configuració per defecte del servei instal·lat</a></h3>
<div class="level3">

<p>
El servei <acronym title="Domain Name System">DNS</acronym> disposa usualment d’una configuració bàsica per defecte en instal·lar-se que acostuma a ser l’apropiada per a un servidor de noms només cau. A vegades simplement ve amb els fitxers de configuració buits, de manera que cal editar-los apropiadament abans de posar el servei en funcionament. En la configuració d’aquest servei s’usa el programari BIND (<em>Berkeley Internet Name Domain</em>) perquè és un dels més usats a nivell global. Cal identificar cadascun dels conceptes que descrits a continuació:
</p>
<ul>
<li class="level1"><div class="li"> Nom del servei: bind9 (localitzat a /etc/init.d/bind9).</div>
</li>
<li class="level1"><div class="li"> Fitxer de configuració: /etc/bind/named.conf.</div>
</li>
<li class="level1"><div class="li"> Directori dels fitxers de zona: /etc/bind.</div>
</li>
<li class="level1"><div class="li"> Llistat dels fitxers de zona predefinits que conté el directori anterior.</div>
</li>
<li class="level1"><div class="li"> Ubicació de fitxers d’exemple i pàgines de manual d’on poder obtenir una configuració inicial bàsica: /usr/share/doc/bind9 i /usr/share/man.</div>
</li>
</ul>

<p>
En la configuració per defecte es poden analitzar els diversos elements que es configuren:
</p>
<ul>
<li class="level1"><div class="li"> <strong>options</strong>: s’hi defineixen les opcions genèriques del servidor <acronym title="Domain Name System">DNS</acronym>.</div>
</li>
<li class="level1"><div class="li"> <strong>logging</strong>: es defineix com serà el procés d’enregistrament dels <em>logs</em> del servei.</div>
</li>
<li class="level1"><div class="li"> <strong>localhost_resolver</strong>: permet definir el servidor <acronym title="Domain Name System">DNS</acronym> com un servidor només <em>cau</em>. És a dir, no és autoritari de cap domini, no gestiona cap domini, cap zona, no té fitxers de zona; l’única funció que fa és de servidor <acronym title="Domain Name System">DNS</acronym> <em>cau</em>.</div>
</li>
<li class="level1"><div class="li"> <strong>internal</strong>: permet definir les zones i zones delegades que es volen gestionar amb el servidor. Es donarà servei a les xarxes locals internes que es defineixen en aquesta secció.</div>
</li>
<li class="level1"><div class="li"> <strong>external</strong>: defineix el servei a oferir a clients externs al domini. És per oferir serveis <acronym title="Domain Name System">DNS</acronym> a clients exteriors.</div>
</li>
</ul>

<p>
La <span class="figref"><a href="#Figure4.1"><span>figura</span></a></span> mostra una eina gràfica que permet la configuració del servei de noms. En sistemes GNU/Linux és usual que els servidors es gestionin editant directament els fitxers de configuració. Es disposa, però, de miniaplicacins (<em>applets</em>) que permeten fer aquesta mateixa tasca des d’un entorn gràfic. Usualment no fan res de nou, és a dir, simplement serveixen per modificar els fitxers de text de configuració mitjançant un entorn gràfic més amable.
</p>
<div class="iocfigure"><a name="Figure4.1"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Miniaplicació gràfica de gestió del servidor BIND

</figcaption><img src="../media/ic10m08u1_04.png" alt="" /></figure>
</div>
<p>
Podem observar les zones que s’instal·len per defecte llistant el directori de 
treball per defecte del servei. Amb tota seguretat hi trobarem els fitxers corresponents a les zones arrel, localhost i loopback. A més, el paquet del servei segurament disposa de fitxers d’exemple de zona igual que disposava d’un exemple de fitxer de configuració del servei.
</p>
<pre class="code">[root@host ~]# ls -l /etc/bind/
total 56
-rw-r--r-- 1 root root 2761 de juny  21  2019 bind.keys
-rw-r--r-- 1 root root  237 de juny  21  2019 db.0
-rw-r--r-- 1 root root  271 de juny  21  2019 db.127
-rw-r--r-- 1 root root  237 de juny  21  2019 db.255
-rw-r--r-- 1 root root  353 de juny  21  2019 db.empty
-rw-r--r-- 1 root root  270 de juny  21  2019 db.local
-rw-r--r-- 1 root bind  463 de juny  21  2019 named.conf
-rw-r--r-- 1 root bind  498 de juny  21  2019 named.conf.default-zones
-rw-r--r-- 1 root bind  156 de maig  27 20:09 named.conf.local
-rw-r--r-- 1 root bind  888 de maig  28 08:19 named.conf.options
-rw-r----- 1 bind bind   77 de maig  27 11:40 rndc.key
-rw-r--r-- 1 root root 1317 de juny  21  2019 zones.rfc1918</pre>

</div>

<h3><a id="exemple_de_configuracio_basica" >Exemple de configuració bàsica</a></h3>
<div class="level3">

<p>
La configuració bàsica i l’estructura de fitxers un cop s’ha instal·lat el servidor BIND permet familiaritzar-nos amb els seus components. L’estructura dels fitxers de configuració es basa en un fitxer principal, /etc/bind/named.conf, que està organitzat en 3 fitxers més:
</p>
<pre class="code">root@server:~# cat /etc/bind/named.conf
// This is the primary configuration file for the BIND DNS server named.
//
// Please read /usr/share/doc/bind9/README.Debian.gz for information on the 
// structure of BIND configuration files in Debian, *BEFORE* you customize 
// this configuration file.
//
// If you are just adding zones, please do that in /etc/bind/named.conf.local

include &quot;/etc/bind/named.conf.options&quot;;
include &quot;/etc/bind/named.conf.local&quot;;
include &quot;/etc/bind/named.conf.default-zones&quot;;
root@server:~# </pre>

<p>
El contingut de cada un dels tres fitxers és el següent:
</p>
<ul>
<li class="level1"><div class="li"> /etc/bind/named.conf.options: conté les opcions del servei <acronym title="Domain Name System">DNS</acronym>.</div>
</li>
<li class="level1"><div class="li"> /etc/bind/named.conf.local: contindrà les zones noves que es volen afegir.</div>
</li>
<li class="level1"><div class="li"> /etc/bind/named.conf.default-zones: conté la zona arrel i les zones per defecte especificades al <acronym title="Request for Comments">RFC</acronym> 1912.</div>
</li>
</ul>

<p>
El contingut per defecte del <strong>fitxer d’opcions</strong> és el següent:
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Directives</p>
<p>
El llistat de totes les directives es pot consultar amb l’ordre:<br/>

<em>man 5 vsftpdconf</em>.
</p>
</div></div><pre class="code">root@server:~# cat /etc/bind/named.conf.options
options {
	directory &quot;/var/cache/bind&quot;;

	// If there is a firewall between you and nameservers you want
	// to talk to, you may need to fix the firewall to allow multiple
	// ports to talk.  See http://www.kb.cert.org/vuls/id/800113

	// If your ISP provided one or more IP addresses for stable 
	// nameservers, you probably want to use them as forwarders.  
	// Uncomment the following block, and insert the addresses replacing 
	// the all-0&#039;s placeholder.

	// forwarders {
	// 	0.0.0.0;
	// };
	//........................................................................
	// If BIND logs error messages about the root key being expired,
	// you will need to update your keys.  See https://www.isc.org/bind-keys
	//........................................................................
	dnssec-validation auto;

	listen-on-v6 { any; };
};</pre>

<p>
Les opcions que apareixen en aquest fitxer són:
</p>
<ul>
<li class="level1"><div class="li"> Especificació el directori de treball del servei i els diferents fitxers de monitorització a utilitzar. Per exemple, fitxers per a volcats (<em>dump</em>), estadístiques (<em>statistics</em>) i estadístiques de memòria (<em>memstatistics</em>). </div>
</li>
<li class="level1"><div class="li"> Autenticació en les respostes <acronym title="Domain Name System">DNS</acronym>, si és el cas.</div>
</li>
<li class="level1"><div class="li"> Ports d’escolta del servei. En aquest cas també si es vol emetre respostes per a IPv6.</div>
</li>
</ul>

<p>
El contingut per defecte del <strong>fitxer de configuració local</strong> és el següent:
</p>
<pre class="code">root@server:~# cat /etc/bind/named.conf.local 
//
// Do any local configuration here
//

// Consider adding the 1918 zones here, if they are not used in your
// organization
//include &quot;/etc/bind/zones.rfc1918&quot;;</pre>

<p>
Aquest fitxer ve completament buit i és on s’han d’especificar les zones noves que es volen afegir al servidor <acronym title="Domain Name System">DNS</acronym>. Es recomana també afegir l’espai d’adreces privat (<acronym title="Request for Comments">RFC</acronym> 1918) si no s’especifiquen a les noves zones. 
</p>
<div class="ioctextl"><div class="ioccontent"><p class="ioctitle">Espai d’adreces privat</p>
<p>
L’espai d’adreces privat especificat al RFC1918 és el següent:
</p>
<div class="table"><table class="inline">
	<tr class="row0">
		<td class="col0 leftalign"> 10.0.0.0        </td><td class="col1 centeralign">   10.255.255.255  </td><td class="col2"> (10/8 prefix) </td>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign"> 172.16.0.0      </td><td class="col1 centeralign">   172.31.255.255  </td><td class="col2"> (172.16/12 prefix) </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> 192.168.0.0     </td><td class="col1 rightalign">   192.168.255.255 </td><td class="col2"> (192.168/16 prefix) </td>
	</tr>
</table></div>
</div></div>
<p>
El contingut per defecte del <strong>fitxer de configuració de zones per defecte</strong> és el següent:
</p>
<pre class="code">root@server:~# cat /etc/bind/named.conf.default-zones
// prime the server with knowledge of the root servers
zone &quot;.&quot; {
	type hint;
	file &quot;/usr/share/dns/root.hints&quot;;
};

// be authoritative for the localhost forward and reverse zones, and for
// broadcast zones as per RFC 1912

zone &quot;localhost&quot; {
	type master;
	file &quot;/etc/bind/db.local&quot;;
};

zone &quot;127.in-addr.arpa&quot; {
	type master;
	file &quot;/etc/bind/db.127&quot;;
};

zone &quot;0.in-addr.arpa&quot; {
	type master;
	file &quot;/etc/bind/db.0&quot;;
};

zone &quot;255.in-addr.arpa&quot; {
	type master;
	file &quot;/etc/bind/db.255&quot;;
};</pre>

<p>
Aquest fitxer ve emplenat amb les zones per defecte. La més important és la primera, que és la <strong>zona arrel</strong> (fitxer /usr/share/dns/root.hints) i conté les 13 servidor arrels que hi ha a Internet. I les altres zones corresponen als espais d’adreces reservats especificats al RFC1912 i que el mateix document recomana que apareixin (<em>certain zones should always be present in nameserver configurations</em>).
</p>

<p>
El contingut de la zona arrel és el següent:
</p>
<pre class="code">root@server:~# cat /usr/share/dns/root.hints
;       This file holds the information on root name servers needed to 
;       initialize cache of Internet domain name servers
;       (e.g. reference this file in the &quot;cache  .  &lt;file&gt;&quot;
;       configuration file of BIND domain name servers). 
; 
;       This file is made available by InterNIC 
;       under anonymous FTP as
;           file                /domain/named.cache 
;           on server           FTP.INTERNIC.NET
;       -OR-                    RS.INTERNIC.NET
; 
;       last update:     March 13, 2019 
;       related version of root zone:     2019031302
; 
; FORMERLY NS.INTERNIC.NET 
;
.                        3600000      NS    A.ROOT-SERVERS.NET.
A.ROOT-SERVERS.NET.      3600000      A     198.41.0.4
A.ROOT-SERVERS.NET.      3600000      AAAA  2001:503:ba3e::2:30
; 
; FORMERLY NS1.ISI.EDU 
;
.                        3600000      NS    B.ROOT-SERVERS.NET.
B.ROOT-SERVERS.NET.      3600000      A     199.9.14.201
B.ROOT-SERVERS.NET.      3600000      AAAA  2001:500:200::b
...</pre>
<div class="ioctextl"><div class="ioccontent"><p class="ioctitle">Espais d’adreces reservats</p>
<p>
Els espais d’adreces reservats especificats al RFC1912 són els següents:
</p>
<div class="table"><table class="inline">
	<tr class="row0">
		<td class="col0 leftalign"> primary   </td><td class="col1 centeralign">       localhost               </td><td class="col2"> localhost </td>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign"> primary   </td><td class="col1 centeralign">       0.0.127.in-addr.arpa    </td><td class="col2"> 127.0 </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> primary   </td><td class="col1 centeralign">       255.in-addr.arpa        </td><td class="col2"> 255 </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> primary   </td><td class="col1 centeralign">       0.in-addr.arpa          </td><td class="col2"> 0 </td>
	</tr>
</table></div>
</div></div>
</div>

<h2><a id="resolucio_forwarding_i_memoria_cau" >Resolució, &#039;forwarding&#039; i memòria cau</a></h2>
<div class="level2">

<p>
Tot sovint, en les aplicacions d’usuari i de sistema s’accedeix a recursos pel seu nom de domini. Per exemple, un client web requereix una determinada pàgina web, un navegador de fitxers vol accedir a unes carpetes d’una màquina remota que s’identifiquen pel nom de domini, el sistema ha de validar l’usuari en un servidor LDAP remot… En cada un d’aquests casos caldrà respondre una pregunta del tipus “A quina adreça IP correspon aquest domini?”, “Quins són els servidors de noms del domini tal?”, “Quins són els servidors de correus?”. Aquestes preguntes no les responen les aplicacions individualment (el navegador web, el client d’autenticació…), sinó que utilitzen el <em>resolver</em> per fer-ho.
</p>

<p>
El <em>resolver</em> és la part client de l’arquitectura client/servidor del <acronym title="Domain Name System">DNS</acronym>. Ha d’atendre les necessitats de les aplicacions, confeccionar una consulta o <em>query</em>, enviar-la a un servidor <acronym title="Domain Name System">DNS</acronym>, obtenir la resposta i passar-la a l’aplicació pertinent. El <em>resolver</em> no és usualment una aplicació sinó un conjunt de biblioteques de funcions. Les aplicacions client es compilen i enllacen conjuntament amb aquestes biblioteques.
</p>

<p>
Els servidors que reben l’encàrrec de fer la resolució d’una consulta es poden comportar de maneres diferents en funció de com s’han configurat. Poden obtenir la resposta de la seva memòria cau, sol·licitar a un altre servidor de noms que sigui ell qui faci tota la feina de resolució (<em>forwarding</em>) o encarregar-se de fer la resolució pas a pas pel seu compte (<em>recursion</em>), consultant tans servidors de noms externs com faci falta. 
</p>

<p>
En general podem catalogar el funcionament de la resolució en:
</p>
<ul>
<li class="level1"><div class="li"> memòria cau sí/no</div>
</li>
<li class="level1"><div class="li"> recursiu sí/no (recursiu/iteratiu)</div>
</li>
<li class="level1"><div class="li"> <em>forward</em> sí/no, combinat amb <em>forward only</em></div>
</li>
</ul>

<p>
Fem una ullada al funcionament del mecanisme de resolució.
</p>

</div>

<h3><a id="la_resolucio_de_noms" >La resolució de noms</a></h3>
<div class="level3">

<p>
El mecanisme de resolució de noms <acronym title="Domain Name System">DNS</acronym> consta d’un client o <em>resolver</em> que realitzarà consultes (o <em>queries</em>) a uns servidors <acronym title="Domain Name System">DNS</acronym>.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Si el servidor disposa de la informació perquè forma part de la base de dades de la seva zona, emetrà una resposta <strong>autoritativa</strong>. Si disposa de la resposta perquè la té emmagatzemada temporalment (en un procés anomenat <em>cau</em>) també emetrà la resposta, però aquest cop de manera <strong>no autoritativa</strong>. Si no té informació del domini buscat, el servidor pot fer la consulta a altres servidors en un procés que pot ser <strong>recursiu</strong> o <strong>iteratiu</strong>. Sempre existeix un camí per trobar el domini buscat, que és preguntar als <strong>nodes arrel</strong> (<em>root servers</em>) de l’espai de noms de domini. Partint dels nodes arrel i recorrent l’arbre cap avall, es pot arribar al domini buscat, si és que existeix.
</p>
</div></div>
<p>
Sempre hi ha un camí a un domini existent partint del node arrel. Quan un servidor és consultat sobre un domini que desconeix (no és de la seva zona ni té la resposta en la memòria cau) pot escalar la pregunta a un servidor l’arrel (<em>root name server</em>). Això significa que els servidors arrel són crucials per al funcionament del <acronym title="Domain Name System">DNS</acronym>.
</p>
<div class="ioctextl"><div class="ioccontent"><p class="ioctitle">Exemple de resolució de noms DNS</p>
<p>
Quina adreça IP té el <em>host</em> ns1.ioc.cat.? Si un estudiant australià intenta esbrinar això des del seu servidor de noms de Sydney, probablement acabarà preguntant per aquest domini a un dels nodes arrel. El node arrel desconeix el <em>host</em> ns1 del domini de l’IOC, però sí que coneix tots els dominis de primer nivell (TLD). Per tant, l’arrel proporcionarà una llista amb els servidors de noms del domini cat. A continuació, el servidor de Sydney preguntarà a algun dels servidors de noms de la llista (del domini cat.) i obtindrà la llista de servidors <acronym title="Domain Name System">DNS</acronym> del domini ioc.cat. Preguntant als servidors d’aquest domini obtindrà l’adreça IP del <em>host</em> ns1 per al qual el domini ioc.cat. és autoritari (forma part de la seva zona).
</p>
</div></div>
</div>

<h4><a id="recursio_i_iteracio" >Recursió i iteració</a></h4>
<div class="level4">

<p>
Quan el client o <em>resolver</em> emet una consulta al servidor <acronym title="Domain Name System">DNS</acronym> local (el servidor de noms que té configurat), aquest la pot tractar de manera <strong>recursiva</strong> o <strong>iterativa</strong>. De fet, el client <em>resolver</em> ja farà la consulta indicant si exigeix una resposta recursiva o iterativa. La diferència entre un mode i l’altre és com ha d’actuar el servidor <acronym title="Domain Name System">DNS</acronym> per obtenir la resposta quan no la té en la seva base de dades d’informació.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
En el mode <strong>iteratiu</strong>, el servidor retorna la millor resposta possible basada en la seva informació local, sense preguntar a ningú més. En el mode <strong>recursiu</strong>, el servidor intenta trobar la resposta preguntant a tants altres servidors com calgui per obtenir-la.
</p>
</div></div>
<p>

</p>

<p>
Un servidor pot emetre les respostes següents:
</p>
<ol>
<li class="level1"><div class="li"> Respon enviant la dada que li han sol·licitat (un nom de <em>host</em>, una adreça IP, la llista de servidors de noms, de servidors d’autenticació…).</div>
</li>
<li class="level1"><div class="li"> Ha localitzat el domini buscat, però no disposa de la dada sol·licitada. Cal tenir en compte que es poden sol·licitar altres dades a part de l’adreça IP, per exemple, els servidors de correu que té el domini.</div>
</li>
<li class="level1"><div class="li"> Finalment, pot ser que el domini sol·licitat no existeixi.</div>
</li>
</ol>

</div>

<h4><a id="recursio" >Recursió</a></h4>
<div class="level4">

<p>
Quan un servidor rep una consulta del client, mira la base de dades local de la seva zona. Si existeix la informació sol·licitada, la retorna. Si la dada no forma part de la seva zona, però la té emmagatzemada en la memòria cau (perquè ja ha realitzat amb anterioritat un consulta similar i ha emmagatzemat temporalment la resposta), també la retorna. Si la dada no forma part del seu espai de noms ni es troba en la memòria cau, el mode recursiu mana al servidor anar preguntant recursivament a altres servidors, apropant-se més a cada pas al domini sol·licitat. Si el servidor no coneix cap servidor més proper al domini buscat a qui preguntar, acaba preguntant als servidors de l’arrel.
</p>
<div class="ioctextl"><div class="ioccontent"><p class="ioctitle">Exemple de recursió</p>
<p>
Si es consulta el domini www.inf.ioc.cat. i el servidor desconeix aquest domini, intentarà contactar amb un servidor de noms del domini inf.ioc.cat. Si tampoc sap com adreçar-se a aquest domini, intentarà contactar amb un servidor de noms de domini ioc.cat. Si també el desconeix, provarà de localitzar un servidor per al domini .cat. Si tampoc és el cas, es posarà en contacte amb un servidor de noms de l’arrel, . Un cop en l’arrel, sempre és possible accedir al domini buscat descendint per l’arbre de dominis.
</p>
</div></div>
<p>
Si tots els processos recursius acabessin preguntant als nodes arrel, aquests se saturarien. El servidor que ha rebut la consulta del <em>resolver</em> pregunta al node més proper al domini buscat. Si coneix algun servidor de noms més proper, li ho pregunta i evita d’anar a l’arrel.
</p>

<p>
Una altra manera d’evitar la sobrecàrrega dels nodes arrel és l’ús de la informació emmagatzemada de consultes anteriors, que es desa localment en la memòria cau del servidor.
</p>

<p>
Imagineu un alumne de Sydney, estudiant de l’IOC, que genera una consulta al servidor de noms del seu ISP australià per identificar el domini www.int.ioc.cat.. Probablement el servidor desconeix aquest domini i els propers, inf.ioc.cat. i ioc.cat. Però segurament en la memòria cau (per consultes prèvies) té la llista de servidors de noms autoritaris del domini cat. Serà a un d’aquests servidors (i no a un node arrel) a qui farà la consulta que li permetrà accedir de manera descendent al domini buscat.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Consulta d&#039;informació delegada</p>
<p>
Si es consulta l’adreça www.inf.ioc.cat. i el servidor que rep la consulta és el servidor de noms del domini ioc.cat., aquest no pregunta cap amunt (a cat. o a l’arrel .), sinó que obté de la seva pròpia base de dades la llista dels servidors de noms autoritaris de la zona delegada inf.ioc.cat., als quals preguntarà per obtenir una resposta.
</p>
</div></div>
<p>
Per tant, en el procés recursiu, el servidor de noms que rep la consulta del <em>resolver</em> ha de tornar una resposta que pot procedir de la seva base de dades de zona, de la memòria cau o de les respostes finals que ha obtingut preguntant recursivament a altres servidors propers al domini a consultar.
</p>

<p>

</p>

<p>
Fixeu-vos que un servidor que rep una consulta recursiva del <em>resolver</em> té la feina d’esbrinar per si mateix la resposta. Podria repetir la mateixa consulta al servidor més proper fent-la recursiva en lloc d’iterativa. Això exigiria a l’altre servidor fer tota la feina. Aquest plantejament, tot i que possible, es considera abusiu.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Usualment, el <strong>client</strong> consulta el seu <acronym title="Domain Name System">DNS</acronym> de manera <strong>recursiva</strong> i els <strong>servidors</strong> es consulten entre ells de manera <strong>iterativa</strong>.
</p>
</div></div>
</div>

<h4><a id="iteracio" >Iteració</a></h4>
<div class="level4">

<p>
En el mode iteratiu, un servidor dóna la millor resposta possible basant-se en la pròpia informació (base de dades de zones locals i memòria cau). En cap cas no consulta cap altre servidor. Si no disposa de la resposta, lliura una llista amb els servidors més propers al domini que es busca. La llista pot ser d’un o més servidors i és tasca del servidor que ha fet la consulta decidir a quin d’ells tornar a preguntar (en el cas recursiu).
</p>

<p>
Les consultes iteratives són usualment de servidor a servidor, però no del <em>resolver</em> al servidor. Si el <em>resolver</em> fes una consulta iterativa a un servidor, significaria que quan la resposta fos una referència a un altre servidor, el <em>resolver</em> hauria de fer una altra consulta. Generalment els <em>resolver</em> no tenen aquesta capacitat, simplement fan una consulta recursiva al servidor que tenen configurat i és aquest el que ha de fer tota la feina per obtenir la resposta.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
Els nodes arrel no accepten consultes recursives per evitar l’abús i la saturació.
</p>
</div></div><div class="iocimportant"><div class="ioccontent">
<p>
El client <em>resolver</em> fa una consulta <strong>recursiva</strong> al seu servidor <acronym title="Domain Name System">DNS</acronym> local. Si el servidor <acronym title="Domain Name System">DNS</acronym> disposa de la resposta, la torna. Pot ser de la seva zona i serà una resposta <strong>autoritativa</strong> o pot tenir-la en la memòria cau i serà <strong>no autoritativa</strong>.
</p>

<p>
Si no disposa de la resposta, consulta <strong>iterativament</strong> altres servidors apropant-se al domini buscat. Cada servidor que consulta iterativament li pot proporcionar la resposta (autoritativa o no), si la coneix, o una llista de servidors <acronym title="Domain Name System">DNS</acronym> autoritatius per al domini indicat.
</p>

<p>
Finalment, s’obtindrà una resposta que pot ser aquella dada que es buscava o un error si el domini buscat no existeix.
</p>
</div></div>
</div>

<h4><a id="resolucio_inversa" >Resolució inversa</a></h4>
<div class="level4">

<p>
El <acronym title="Domain Name System">DNS</acronym> proporciona un mecanisme per obtenir el nom de domini que correspon a una adreça IP determinada. Aquest mecanisme, anomenat <strong>resolució inversa</strong>, es basa en un domini especial anomenat IN-ADDR.ARPA. Hi ha protocols de xarxa que requereixen una resolució inversa correcta per funcionar bé i sovint s’utilitza com a mesura de seguretat per verificar l’existència de l’adreça IP en un domini.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
Un <em>host</em> amb l’adreça IP 192.168.1.24 correspon al domini 24.1.168.192.IN-ADDR.ARPA.
</p>
</div></div>
<p>
S’ha ideat un domini anomenat IN-ADDR.ARPA que permet representar en forma de nom de domini totes les adreces IP possibles. El format són etiquetes numèriques del 0 al 255 que representen cada octet d’una adreça IP. Les etiquetes dels octets es concatenen en ordre invers i se’ls afegeix el sufix IN-ADDR.ARPA. Un nom de domini amb quatre etiquetes d’octets correspon a un <em>host</em>, un nom de domini amb menys etiquetes correspon a una xarxa.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
La xarxa 172.16.32.0/24 correspon al domini ARPA següent: 32.16.172.IN-ADDR.ARPA.
</p>
</div></div>
<p>
En l’exemple següent es mostren els servidors de noms del domini ioc.cat i es fa una consulta de resolució inversa a cada un:
</p>
<pre class="code">root@server:~# host -vt NS ioc.cat
Trying &quot;ioc.cat&quot;
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 65177
;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 2

;; QUESTION SECTION:
;ioc.cat.			IN	NS

;; ANSWER SECTION:
ioc.cat.		900	IN	NS	dns2.nominalia.com.
ioc.cat.		900	IN	NS	dns1.nominalia.com.

;; ADDITIONAL SECTION:
dns2.nominalia.com.	4800	IN	A	81.88.63.48
dns1.nominalia.com.	254	IN	A	81.88.57.102

Received 108 bytes from 192.168.1.1#53 in 128 ms
root@server:~# host 81.88.57.102
102.57.88.81.in-addr.arpa domain name pointer dns1.nominalia.com.
root@server:~# host 81.88.63.48
48.63.88.81.in-addr.arpa domain name pointer dns2.nominalia.com.
root@server:~# </pre>

</div>

<h4><a id="exemple_de_configuracio_amb_recursio" >Exemple de configuració amb recursió</a></h4>
<div class="level4">

<p>
Vegeu les opcions que permeten configurar un servidor de noms en mode recursiu o en mode iteratiu. De fet, observant el fitxer de configuració podeu veure que és ben senzill:
</p>
<pre class="code"># Fitxer /etc/bind/named.conf.options
options {
        directory &quot;/var/cache/bind&quot;;

        allow-query-cache { any; };
        allow-query { any; };
        recursion yes;

        dnssec-validation auto;

        listen-on-v6 { any; };
};</pre>

<p>
Podeu observar que es tracta simplement d’establir l’opció apropiada:
</p>
<ul>
<li class="level1"><div class="li"> <strong><em>recursion yes;</em></strong> estableix el mode de funcionamet com a recursiu.</div>
</li>
<li class="level1"><div class="li"> <strong><em>recursion no;</em></strong> estableix el mode de funcionament com a iteratiu.</div>
</li>
</ul>

<p>
Com es pot saber si el servidor funciona recursivament o iterativament? És ben senzill: un servidor iteratiu simplement pot resoldre consultes de la zeva zona o consultes prèvies que té emmagatzemades en la memòria cau. Però no pot resoldre consultes externes a la seva zona, ja que la recursió s’ha desactivat. 
</p>

<p>
Per tant, podeu configurar el servidor iterativament (<em>recursion no;</em>) i comprovar que no es resolen consultes externes com gmail.com.. Tot seguit podem activar la recursió, <em>recursion yes;</em>, i fer la mateixa consulta externa. En aquesta ocasió s’ha d’obtenir el resultat buscat.
</p>

</div>

<h3><a id="us_de_servidor_forwarder" >Ús de servidor &#039;forwarder&#039;</a></h3>
<div class="level3">

<p>
Existeix un cas particular de funcionament dels servidors de noms que anomenem <em>forwarders</em>. Són servidors que podem anomenar informalment <em>l’encarregat</em>, o podem dir, encara més informalment, que “li passem el mort a tal” on <em>tal</em> és el <strong><em>forwarder</em></strong>.
</p>

<p>
Imaginem, per exemple, una xarxa local corresponent al departament d’administració d’una empresa i que forma part d’una xarxa més gran, corresponent a l’empresa. En la xarxa d’administració s’ha instal·lat un servidor de noms només cau que no administra cap domini local. Es vol que aquest servidor tampoc generi consultes externes per motius que els administradors de xarxes creuen oportuns: per exemple, per temes de tallafocs, seguretat… Es vol que el servidor faci totes les consultes al servidor de noms de l’empresa, que serà qui farà la tasca de <em>forwarder</em>.
</p>

<p>
És a dir, quan es vol que un servidor de noms no realitzi consultes externes via recursió, sinó que totes les consultes les realitzi a un mateix servidor, és diu que es traspassen les consultes a aquest servidor encarregat. Aquest servidor és un <em>forwarder</em>.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Es diu que un servidor fa <strong><em>forward</em></strong> quan passa totes les consultes externes a un altre servidor, que serà l’encarregat de resoldre-les.
</p>

<p>
El servidor que rep l’encàrrec de fer aquesta feina de resolució s’anomena <strong><em>forwarder</em></strong>.
</p>
</div></div>
<p>
Per configurar una estructura de resolució de noms amb un <em>forwarder</em>:
</p>
<ul>
<li class="level1"><div class="li"> En el servidor de noms que traspassarà les consultes a l’altre cal indicar quin servidor de noms serà el <em>forwarder</em>.</div>
</li>
<li class="level1"><div class="li"> En el que farà la funció de <em>forwarder</em> no cal indicar res. Simplement es trobarà que rep moltes consultes de resolució d’un <em>host</em> determinat, però no s’ha d’indicar res.</div>
</li>
</ul>
<pre class="code">allow-query-cache { any;};   
allow-query { any; };
recursion yes;
forward only;
forwarders { 192.168.122.1; 192.168.122.2}; </pre>

<p>
En el fragment de codi anterior, extret del fitxer de configuració /etc/named.conf, podem observar les dues directives que indiquen al servidor que ha de traspassar totes les consultes a un servidor “encarregat”. Anem a veure el significat de cada opció:
</p>
<ul>
<li class="level1"><div class="li"> <strong><em>forwarders</em></strong>: indica l’adreça o adreces IP dels servidors als quals es farà <em>forward</em> de la consulta, és a dir, als quals s’encomanarà la tasca de resoldre-la. Com que l’especificació del protocol <acronym title="Domain Name System">DNS</acronym> recomana dos servidors de noms per domini, és usual trobar en aquesta opció almenys dues adreces IP. Aquestes corresponen als dos servidors d’un domini, els típicament anomenats <em>primari</em> i <em>secundari</em>.</div>
</li>
<li class="level1"><div class="li"> <strong><em>forward only</em></strong>: si s’activa aquesta opció, el servidor funcionarà exclusivament en mode <em>forward</em>, de manera que qualsevol consulta serà tramesa al <em>forwarder</em>, idependentment de la memòria cau i de les zones pròpies.</div>
</li>
</ul>

</div>

<h3><a id="respostes_de_memoria_cau" >Respostes de memòria cau</a></h3>
<div class="level3">

<p>
Es pot configurar un servidor de noms de domini perquè faci la funció de només cau. No gestiona cap zona, simplement atén les peticions dels <em>resolvers</em> client i les passa a altres servidors de noms. La seva funció és emmagatzemar en la memòria cau les respostes que obté abans de passar-les als clients. Això li permetrà que les futures consultes que siguin repetides les pugui contestar directament en lloc de demanar-les a un altre servidor. Evidentment, aquest tipus de servidor no emet respostes amb autoritat.
</p>

<p>
La funció de memòria cau es pot activar i desactivar segons convingui. A més, es pot combinar amb les altres opcions de resolució per seleccionar el mode de funcionament del servidor. Les combinacions més usuals són:
</p>
<ul>
<li class="level1"><div class="li"> Si únicament es configura la funció de memòria cau es tractarà d’un servidor només cau.</div>
</li>
<li class="level1"><div class="li"> Si es combina la memòria cau i la recursió es farà resolució externa i es disposarà d’un cau local per poder contestar immediatament les consultes fetes amb anterioritat.</div>
</li>
<li class="level1"><div class="li"> El mateix passa si es combina la memòria cau amb el <em>forward</em>. El <em>forward</em> traspassarà la responsabilitat de resoldre les consultes externes a un altre servidor de noms. Disposar de la memòria cau activada permetrà respondre immediatament les consultes repetides.</div>
</li>
<li class="level1"><div class="li"> Desactivar la memòria cau significa que no s’emmagatzemen localment les respostes que es reben. Per tant, si es tornen a fer consultes que ja s’havien realitzat anteriorment caldrà tornar-les a resoldre pel mètode apropiat.</div>
</li>
</ul>

<p>
Si torneu a examinar el bloc d’opcions de configuració del mode de funcionament del servidor, extretes del fitxer /etc/bind/named.conf.options, observareu:
</p>
<pre class="code">allow-query-cache { any;};   
allow-query { any; };
recursion yes;</pre>

<p>
L’opció <em>allow-query-cache</em> permet indicar si s’activa o no la memòria cau i per a quines consultes. Les opcions que pot prendre són:
</p>
<ul>
<li class="level1"><div class="li"> <em>any;</em> indica que s’emmagatzemen en la memòria cau totes les respostes rebudes.</div>
</li>
<li class="level1"><div class="li"> <em>none;</em> no permet el funcionament de la memòria cau.</div>
</li>
<li class="level1"><div class="li"> <em>adreces-ip;</em> indica que les consultes que provinguin d’aquestes adreces-ip s’han d’emmagatzemar en la memòria cau. Les adreces-ip poden ser, de fet, combinacions dels tres conceptes següents: adreces IP, de xarxa o una llista-de-noms. Per exemple, 192.168.4.0/24;.</div>
</li>
</ul>

</div>

<h4><a id="autoritari_no_autoritari_i_informacio_de_memoria_cau" >Autoritari, no autoritari i informació de memòria cau</a></h4>
<div class="level4">

<p>
Cada zona de l’espai dels noms de domini és gestionada per un o més servidors autoritaris per a la zona. Això significa que són els servidors que manen, que tenen l’última paraula respecte de la zona. De fet, significa que són els servidors que administren la zona. Aquests servidors es configurem com a <strong>autoritaris</strong> de la zona. Les respostes que emeten a consultes referents a la seva zona porten un segell indicant que són autoritàries, que provenen de la base de dades distribuïda de l’espai de noms de domini.
</p>

<p>
Els servidors de noms guarden en una memòria cau les respostes que reben d’altres servidors. Aquesta informació també és utilitzada per elaborar respostes a consultes de dominis de fora de la zona de la qual són autoritaris. És a dir, quan un servidor rep d’un altre la llista de servidors autoritaris (en una consulta iterativa) per a una zona, aquesta llista s’emmagatzema a la memòria cau. Quan un servidor rep una resposta a una consulta també es guarda. Quan rep una resposta negativa, indicant que el domini de la consulta o el tipus de dada sol·licitat no existeix, també ho guarda. En aquest cas s’anomena <em>negative caching</em>.
</p>

<p>
Un servidor respon utilitzant la informació disponible en la base de dades de la seva zona (resposta autoritativa) o de la informació emmagatzemada en la seva memòria cau (provinent de consultes a zones externes efectuades anteriorment).
</p>

<p>
Quan rep una consulta a una zona externa que ja s’havia efectuat abans, s’utilitza la resposta de la memòria cau. També s’agafa de la memòria cau la llista de servidors autoritaris per a una zona més propera al domini que es busca, per tal de no preguntar als servidors arrel. Quan un servidor de noms respon utilitzant la informació de la memòria cau, la resposta és <strong>no autoritativa</strong>. No prové del servidor autoritari de la zona, sinó que s’utilitza una informació prèviament obtinguda (i que pot estar desfasada).
</p>

<p>
Per exemple, s’ha fet una consulta per al domini adm.ioc.cat i en el procés de resolució recursiu el servidor ha obtingut la llista de servidors autoritaris per als dominis cat. i ioc.cat. Si ara es demana al mateix servidor pel domini inf.ioc.cat. primerament provarà de resoldre aquest domini, però com que és desconegut, el següent domini més pròxim és ioc.cat. Aquest sí que el coneix, perquè el té emmagatzemat a la memòria cau de la resposta anterior. S’utilitzarà la llista de servidors autoritaris del domini ioc.cat. per obtenir una resposta o per continuar descendint per l’arbre de l’espai de noms.
</p>

<p>
Emmagatzemar informació de les respostes d’altres servidors en la memòria cau ofereix dos grans avantatges:
</p>
<ol>
<li class="level1"><div class="li"> Incrementa la velocitat de resposta. Ja no cal anar a trobar la resposta a la font de dades de la zona, sinó que s’utilitza la informació d’una resposta anterior.</div>
</li>
<li class="level1"><div class="li"> Evita la sobrecàrrega dels servidors arrel.</div>
</li>
</ol>

<p>

No cal anar al node arrel per cada consulta un cop que es disposa en la memòria cau d’informació més propera al domini a cercar. La utilització de la memòria cau té, però, un inconvenient que cal considerar: les dades no necessàriament són actualitzades. El <acronym title="Domain Name System">DNS</acronym> es fonamenta en una base de dades jeràrquica i distribuïda en la qual la informació es troba en els fitxers gestionats per cada servidor de zona. Una dada emmagatzemada en la memòria cau pot no reflectir la dada real, que ha estat modificada en el servidor autoritari de zona però que encara no s’ha propagat perquè es manté en la memòria cau fins que caduca el seu TTL (temps de vida).
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Són servidors <strong>autoritaris</strong> els que administren una zona (tant el servidor primari o mestre com els secundaris o esclaus). Tenen accés a la informació <strong>original</strong> de la base de dades de zona.
</p>

<p>
Són respostes <strong>no autoritàries</strong> les que provenen de la informació desada en la memòria cau.
</p>
</div></div>
<p>
Fixeu-vos que si la informació de la memòria cau es desés indefinidament, els canvis que es fessin en els servidors autoritaris no es propagarien als altres servidors (perquè segurament ja disposarien d’una resposta en la seva memòria cau). Cal un mecanisme perquè la informació de la memòria cau caduqui transcorregut un cert interval de temps. Anomenem <strong>TTL</strong>, <em>Time To Live</em> o <strong>temps de vida</strong>, l’interval de temps que les dades han de perdurar en la memòria cau. Un cop transcorregut aquest temps, les dades s’eliminen. Si fa falta una dada, per obtenir-la caldrà fer una nova consulta.
</p>

</div>

<h4><a id="servidor_nomes_cau" >Servidor només cau</a></h4>
<div class="level4">

<p>
La configuració completa d’un servidor <acronym title="Domain Name System">DNS</acronym> no és difícil, però és entretinguda. Cal crear cada fitxer de zona amb les entrades pertinents de cada <em>host</em> de la zona. Hi ha organitzacions petites que no necessiten configurar el servei <acronym title="Domain Name System">DNS</acronym> completament, en tindrien prou a tenir un servidor <acronym title="Domain Name System">DNS</acronym> local que permetés accelerar les consultes <acronym title="Domain Name System">DNS</acronym> que es fan a l’exterior.
</p>

<p>
Sabem que tota resolució de nom de domini comporta una consulta a un servidor <acronym title="Domain Name System">DNS</acronym>, usualment el del proveïdor de servei d’Internet (ISP). Es pot posar en marxa un servidor només cau en una xarxa local per proporcionar més eficiència a les consultes. El servidor només cau no administra cap zona, no té registres de recurs, simplement rep les consultes dels clients, les tramet al servidor <acronym title="Domain Name System">DNS</acronym> extern, rep les seves respostes, les desa en la memòria cau i les retorna al client.
</p>

<p>
El benefici d’aquest esquema és que el servidor només cau acumula en la memòria les respostes que va obtenint. En les consultes següents, si es demana pels mateixos dominis, ja no li cal passar la consulta a l’exterior, sinó simplement respondre des de la memòria cau. Evidentment, les seves respostes són sempre no autoritàries.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Un servidor <strong>només cau</strong> només emmagatzema les respostes d’altres servidors externs en la memòria, però no gestiona cap zona. No és autoritari, simplement augmenta l’eficiència quan rep consultes de les quals ja en sap la resposta (la té a la memòria cau).
</p>
</div></div>
<p>
Vegeu un exemple de configuració d’un servidor només cau:
</p>
<pre class="code">root@server:~# cat /etc/bind/named.conf.options 
options {
        directory &quot;/var/cache/bind&quot;;

        allow-query-cache { any; };
        allow-query { any; };
        recursion yes;

        dnssec-validation auto;

        listen-on-v6 { any; };
};
root@server:~# cat /etc/bind/named.conf.local
//
// Do any local configuration here
//

// Consider adding the 1918 zones here, if they are not used in your
// organization
//include &quot;/etc/bind/zones.rfc1918&quot;;
root@server:~# </pre>

<p>
En l’exemple anterior es pot observar que no es defineix cap fitxer de zona per ser administrada, excepte el fitxer de resolució directa dels servidors de noms de la zona arrel. Per tant, aquest servidor únicament atén peticions <acronym title="Domain Name System">DNS</acronym> com a intermediari i les desa a la memòria cau. El directori on emmagatzema temporalment la informació és /var/cache/bind.
</p>

</div>

<h2><a id="creacio_de_zones" >Creació de zones</a></h2>
<div class="level2">

<p>
El propòsit principal d’un servei <acronym title="Domain Name System">DNS</acronym> és administrar una zona com per exemple una xarxa local amb tots els equips d’una organització, o un conjunt de zones d’una organització més complexa. Per fer això caldrà definir els fitxers de configuració del servei <acronym title="Domain Name System">DNS</acronym> i definir cada una de les zones de què es compongui la xarxa. També caldrà crear els fitxers corresponents a la resolució inversa de cada xarxa i del <em>loopback</em>.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Per crear una <strong>zona pròpia</strong> caldrà:
</p>
<ul>
<li class="level1"><div class="li"> Definir les zones en el fitxer de configuració del servei.</div>
</li>
<li class="level1"><div class="li"> Crear el fitxer de zona en què es defineix la resolució directa per a cada <em>host</em> de la zona i les característiques de la zona.</div>
</li>
<li class="level1"><div class="li"> Crear el fitxer de resolució inversa de la zona.</div>
</li>
</ul>
</div></div>
<p>
Les zones descriuen els equips que en formen part. És a dir, cada fitxer de zona és una base de dades que descriu els <em>hosts</em> que hi ha en la zona i la mateixa zona. Vegeu dos exemples de fitxers de zona abans d’explicar com descriure cadascun dels elements que hi pertanyen:
</p>
<ul>
<li class="level1"><div class="li"> Zona ioc.cat., corresponent a la resolució directa.</div>
</li>
<li class="level1"><div class="li"> Zona 2.0.10.in-addr.arpa., corresponent a la resolució inversa de la zona. Aquesta zona correspon a la xarxa 10.0.2.0/24.</div>
</li>
</ul>
<pre class="code">;
; Fitxer de configuració del domini ioc.cat
;
$TTL 1D
ioc.cat.  IN SOA    server.ioc.cat. admin.ioc.cat. (1 3M 1M 1W 1D)
ioc.cat.  IN NS     server.ioc.cat.
server    IN A      10.0.2.10
www       IN A      10.0.2.11
ftp       IN CNAME  www
pc1       IN A      10.0.2.101
pc2       IN A      10.0.2.102</pre>
<pre class="code">;
; Fitxer de configuració de la zona inversa ioc.cat
;
$TTL 1D
@    IN SOA server.ioc.cat. admin.ioc.cat. (1 3M 1M 1W 1D)
@    IN NS  server.ioc.cat.
10   IN PTR server.ioc.cat.
11   IN PTR www.ioc.cat.
11   IN PTR ftp.ioc.cat.
101  IN PTR pc1.ioc.cat.
102  IN PTR pc2.ioc.cat.</pre>

</div>

<h3><a id="tipus_de_registres" >Tipus de registres</a></h3>
<div class="level3">

<p>
El sistema de noms de domini és una base de dades jeràrquica i distribuïda en què cada servidor de noms gestiona la informació corresponent a la zona de la qual és autoritari. Cada zona conté informació dels <em>hosts</em> que la formen. La informació de zona s’emmagatzema en forma de <strong>registre de recurs</strong> o <em>resource record</em> (RR). 
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Aprofitar fitxers de zona</p>
<p>
Els fitxers de zona de descripció del <em>loopback</em> i dels nodes arrel són pràcticament iguals per a totes les zones, de manera que usualment es copien d’una zona ja existent en lloc d’escriure’ls de nou.
</p>
</div></div>
<p>
Aquest registre conté la informació que permet identificar cada nom de domini amb l’adreça IP corresponent, anomenat <em>forward mapping</em> o <strong>resolució directa</strong>. També conté la informació per identificar cada adreça IP amb el nom de domini corresponent, anomenat <em>reverse mapping</em> o <strong>resolució inversa</strong>. La informació de zones conté altres dades que permeten identificar els servidors <acronym title="Domain Name System">DNS</acronym> autoritaris per la zona, els servidors de correu…
</p>

<p>
La configuració d’una zona s’emmagatzema en un conjunt de fitxers anomenat <em>fitxers de zona</em>. L’especificació del <acronym title="Domain Name System">DNS</acronym> diu com han de ser aquests fitxers de zona i com s’hi han de descriure els registres de recurs (descripció de cada element que pertany a la zona).
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
El conjunt dels registres de recurs de totes les zones de l’espai de noms formen la <strong>base de dades</strong> distribuïda jeràrquica del sistema <acronym title="Domain Name System">DNS</acronym>.
</p>
</div></div>
<p>
En qualsevol zona hi haurà almenys els <strong>fitxers de zona</strong> següents:
</p>
<ul>
<li class="level1"><div class="li"> Un fitxer amb les associacions dels noms de domini a adreces IP. Aquest fitxer defineix la resolució directa.</div>
</li>
<li class="level1"><div class="li"> Un fitxer per a cada subxarxa amb l’associació de cada adreça IP al seu nom de domini canònic. Defineix la resolució inversa.</div>
</li>
<li class="level1"><div class="li"> Un fitxer amb la definició de la resolució inversa del <em>loopback</em>.</div>
</li>
<li class="level1"><div class="li"> Un fitxer amb la descripció dels nodes arrel d’Internet.</div>
</li>
</ul>

<p>
Un cop que els fitxers de zona contenen tots els registres de recurs necessaris, cal configurar el servidor de noms perquè utilitzi aquests fitxers. Si bé la configuració dels fitxers de zona és estàndard (definida per l’especificació <acronym title="Domain Name System">DNS</acronym>), la configuració del servidor depèn del programa que s’utilitzi.
</p>

</div>

<h3><a id="registres_de_recurs" >Registres de recurs</a></h3>
<div class="level3">

<p>
Cada fitxer de zona conté un conjunt d’entrades cadascuna de les quals defineix un <strong>registre de recurs (RR)</strong>. Els registres més usuals són SOA, NS, A, CNAME, PTR i MX. L’ordre en què apareixen és indiferent, però usualment és el mateix dels exemples. Cada línia té el format:
</p>
<pre class="code">domini classe [ttl] tipus rdata:</pre>
<ul>
<li class="level1"><div class="li"> <strong>domini</strong> és el nom de domini que s’està definint.</div>
</li>
<li class="level1"><div class="li"> <strong>classe</strong> només pren actualment el valor “IN”, per Internet.</div>
</li>
<li class="level1"><div class="li"> <strong>ttl</strong> és un camp opcional que descriu el temps de vida durant el qual cal emmagatzemar aquest registre en la memòria cau.</div>
</li>
<li class="level1"><div class="li"> <strong>tipus</strong> és el tipus d’RR que s’està definint.</div>
</li>
<li class="level1"><div class="li"> <strong>rdata</strong> és el valor que s’associa al nom de domini que es defineix.</div>
</li>
</ul>

<p>
Tot i que es pot definir un TTL en cada registre de recurs, el més usual és definir un TTL genèric per a totes les entrades del fitxer de zona. El servidor BIND 9 utilitza la directiva <em>$ttl</em> (per exemple: <code>$</code>ttl1 1h) per indicar el temps que els altres servidors de noms han de guardar en la seva memòria cau les respostes d’aquest servidor (una hora en l’exemple).
</p>

</div>

<h4><a id="registre_soa" >Registre SOA</a></h4>
<div class="level4">

<p>
El registre de recurs <strong>SOA</strong> (<em>start of authority</em> o <strong>inici de definició de zona amb autoritat</strong>) diu que el fitxer de zona on es troba és la millor font de dades per a la zona, que el servidor de noms és autoritari per a la zona. Acostuma a ser el primer RR que hi ha en el fitxer de zona, tot i que no és obligatori. Per cada fitxer de zona hi ha d’haver només un registre SOA.
</p>
<div class="iocreference"><div class="ioccontent">
<p>
En la secció “Annexos” del web d’aquest mòdul trobareu altres tipus d’RR. També es poden trobar en l’especificació <acronym title="Domain Name System">DNS</acronym>.
</p>
</div></div>
<p>
Un registre SOA té el format:
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Punt final en el nom de domini</p>
<p>
Posar o no el punt al final d’un nom de domini és important. Si acaba amb punt és un nom de domini absolut. Si no du punt és un nom relatiu i s’hi afegirà el domini per defecte al final.
</p>
</div></div><pre class="code">nomDomini. IN SOA nsPrimari. admin.nsPrimari. (opcions-slaves)</pre>

<p>
Un exemple seria el següent:
</p>
<pre class="code">inf.ioc.cat. IN SOA ns1.inf.ioc.cat. admin.ns1.inf.ioc.cat. ( 1 3h 1h 1w 1h )</pre>

<p>
La descripció de cada camp és la següent:
</p>
<ul>
<li class="level1"><div class="li"> <strong>nomDomini.</strong> indica el nom del domini que s’està definint i pel qual el servidor de noms és autoritari. Fixeu-vos en el punt final: és important posar-lo.</div>
</li>
<li class="level1"><div class="li"> <strong>IN</strong> indica que la classe és Internet.</div>
</li>
<li class="level1"><div class="li"> <strong>SOA</strong> informa que és un registre de recurs tipus SOA.</div>
</li>
<li class="level1"><div class="li"> <strong>nsPrimari.</strong> és el nom del <em>host</em> servidor de noms primari per a aquesta zona. Un altre cop pareu atenció al punt final.</div>
</li>
<li class="level1"><div class="li"> <strong>admin.nsPrimari.</strong> és l’adreça de correu electrònic de l’administrador del servidor de noms de domini, amb el format <em>usuari.servidor</em>. El primer punt que separa el nom d’usuari i el nom del servidor cal interpretar-lo com una arrova (<em>usuari@servidor</em>).</div>
</li>
<li class="level1"><div class="li"> <strong>opcions-slaves</strong> són paràmetres que s’indiquen entre parèntesis i que serveixen per definir com ha de ser la comunicació entre el servidor primari (o <em>master</em>) i els servidors secundaris (o <em>slaves</em>). A grans trets s’indiquen els conceptes següents:</div>
</li>
</ul>
<div class="iocimportant"><div class="ioccontent"><ul>
<li class="level1"><div class="li"> <em>Serial</em>: el número de sèrie de la versió de les dades. A cada canvi de les dades de la zona, el número s’incrementa.</div>
</li>
<li class="level1"><div class="li"> <em>Refresh</em>: temps a transcórrer entre cada refresc de dades del servidor secundari.</div>
</li>
<li class="level1"><div class="li"> <em>Retry</em>: temps d’espera per tornar a intentar un refresc quan el servidor secundari ha fallat en l’intent d’actualitzar les seves dades des del servidor primari.</div>
</li>
<li class="level1"><div class="li"> <em>Expire</em>: temps a partir del qual les dades del servidor secundari es consideren sense autoritat si no s’han refrescat abans.</div>
</li>
<li class="level1"><div class="li"> <em>Minimum</em>: valor del TTL dels camps per defecte. Recordeu que a cada camp s’hi pot assignar un TTL específic. Segons la versió del servidor indicarà el TTL de les respostes negatives (<em>negative caching</em>), ja que el temps TTL es defineix per la directiva <em>$ttl</em>.</div>
</li>
</ul>
</div></div><div class="ioctext"><div class="ioccontent"><p class="ioctitle">Formats de temps del BIND</p>
<p>
BIND admet diferents formats per indicar el temps:
</p>
<ul>
<li class="level1"><div class="li"> #s: <em>seconds</em> (per defecte)</div>
</li>
<li class="level1"><div class="li"> #m: <em>minutes</em> </div>
</li>
<li class="level1"><div class="li"> #h: <em>hours</em> </div>
</li>
<li class="level1"><div class="li"> #d: <em>days</em> </div>
</li>
<li class="level1"><div class="li"> #w: <em>weeks</em> </div>
</li>
</ul>

<p>
Admet també combinacions, com per exemple: 3w12h, 2h20m…
</p>
</div></div>
</div>

<h4><a id="registre_ns" >Registre NS</a></h4>
<div class="level4">

<p>
El registre de recurs <strong>NS</strong> (<em>name server</em> o <strong>servidor de nom</strong>) defineix un servidor de noms autoritatiu per a la zona. Hi haurà tantes entrades NS com servidors de noms autoritatius hi hagi en la zona. L’estàndard <acronym title="Domain Name System">DNS</acronym> en recomana almenys dos (un de primari o <em>master</em> i un de seguretat, secundari o <em>slave</em>).
</p>

<p>
Un registre NS consta dels camps:
</p>
<pre class="code">nomDomini. IN NS nameServer.</pre>

<p>
Un exemple seria aquest:
</p>
<pre class="code">inf.ioc.cat. IN NS ns1.inf.ioc.cat.</pre>

<p>
La descripció de cada camp és la següent:
</p>
<ul>
<li class="level1"><div class="li"> <strong>nomDomini.</strong> indica el nom del domini que s’està definint.</div>
</li>
<li class="level1"><div class="li"> <strong>IN</strong> indica que la classe és Internet.</div>
</li>
<li class="level1"><div class="li"> <strong>NS</strong> descriu que es tracta d’un tipus de registre de recurs en què es defineix un servidor de noms.</div>
</li>
<li class="level1"><div class="li"> <strong>nameServer.</strong> és el nom del servidor de noms. Fixeu-vos un altre cop que tant <em>nomDomini.</em> com <em>nameServer.</em> acaben en punt per indicar que són noms de domini absolut o FQDN.</div>
</li>
</ul>

<p>
En la llista següent es pot veure part d’una resposta a una consulta <em>nslookup</em> per observar quins són els servidors de noms de Yahoo:
</p>
<pre class="code">Authoritative answers can be found from: 
yahoo.com       nameserver = ns2.yahoo.com. 
...
ns8.yahoo.com   internet address = 202.165.104.22</pre>

</div>

<h4><a id="registre_a" >Registre A</a></h4>
<div class="level4">

<p>
Un registre de recurs <strong>A</strong> (<em>address</em> o <strong>adreça</strong>) associa un nom de <em>host</em> a una adreça IP (resolució directa). Per cada nom de <em>host</em> de la xarxa caldrà disposar d’una entrada que associï el nom del <em>host</em> a la seva adreça IP.
</p>

<p>
Un registre A consta dels camps:
</p>
<pre class="code">nomHost. IN A IP</pre>

<p>
Un exemple seria aquest:
</p>
<pre class="code">mahatma.inf.ioc.cat. IN A 192.168.0.2
siddhartha           IN A 192.168.0.3</pre>

<p>
La descripció de cada camp és la següent:
</p>
<ul>
<li class="level1"><div class="li"> <strong>nomHost.</strong> indica el nom del <em>host</em> que s’està definint. Pot ser relatiu (sense punt final) o absolut (afegint el domini complert al final).</div>
</li>
<li class="level1"><div class="li"> <strong>IN</strong> indica que la classe és Internet.</div>
</li>
<li class="level1"><div class="li"> <strong>A</strong> informa que es tracta d’un tipus de registre de recurs de definició d’adreça IP.</div>
</li>
<li class="level1"><div class="li"> <strong>IP</strong> és l’adreça IP assignada al <em>host</em>.</div>
</li>
</ul>

<p>
Fixem-nos un altre cop que <em>nomHost.</em> acaba en punt per indicar que és un FQDN. Si no acabés en punt s’interpretaria com un nom relatiu al SOA que s’està definint actualment. Un <em>host</em> pot tenir més d’una IP assignada al mateix nom de <em>host</em>. Quan això passa s’anomena <em>multi-homed</em>. Simplement caldrà que hi hagi un registre A per a cada adreça IP. Constarà del mateix nom de <em>host</em> a l’esquerra de la definició i de la corresponent adreça IP a la dreta. Per exemple:
</p>
<pre class="code">superserver.dom.com. IN A 10.0.0.1 
superserver.dom.com. IN A 10.0.0.2
multihomed.ioc.cat.  IN A 172.12.0.1
                     IN A 172.12.0.2</pre>
<div class="iocimportant"><div class="ioccontent">
<p>
Els noms definits en els registres de tipus A són noms <strong>canònics</strong>. Un <em>host</em> es pot identificar per més d’un nom, però només un és el nom canònic (original), la resta són <strong>àlies</strong>. Els noms canònics es defineixen amb el tipus de registre A. Els àlies es defineixen amb el tipus de registre CNAME.
</p>
</div></div><div class="ioctext"><div class="ioccontent"><p class="ioctitle">A i CNAME</p>
<p>
Compte! No s’han de confondre els registres de recurs A i CNAME: el registre A defineix <em>hosts</em>, mentre que el registre CNAME defineix àlies.
</p>
</div></div>
</div>

<h4><a id="registre_cname" >Registre CNAME</a></h4>
<div class="level4">

<p>
Els registres de recurs <strong>CNAME</strong> (<em>canonical name</em> o <strong>nom canònic</strong>) associen un àlies a un nom canònic.
</p>

<p>
Un registre CNAME consta dels camps:
</p>
<pre class="code">nomHost. IN CNAME hostCanonicalName. | IP</pre>

<p>
Un exemple seria aquest:
</p>
<pre class="code">ftp.inf.ioc.cat. IN CNAME mahatma.inf.ioc.cat.
tftp.inf.ioc.cat IN CNAME 192.168.0.2</pre>

<p>
La descripció de cada camp és la següent:
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Exemple de host multi-homed</p>
<p>
Es vol posar l’àlies <em>super1</em> i <em>super2</em> a cada una de les IP del host superserver.com (un <em>host</em> que té dues adreces IP assignades a aquest nom). Les entrades CNAME serien les següents:
</p>
<ul>
<li class="level1"><div class="li"> super1.dom.com. IN CNAME 10.0.0.1</div>
</li>
<li class="level1"><div class="li"> super2.dom.com. IN CNAME 10.0.0.2</div>
</li>
</ul>
</div></div><ul>
<li class="level1"><div class="li"> <strong>nomHost.</strong> indica el nom de l’àlies que s’està definint.</div>
</li>
<li class="level1"><div class="li"> <strong>IN</strong> indica que la classe és Internet.</div>
</li>
<li class="level1"><div class="li"> <strong>CNAME</strong> informa que es tracta d’un registre de recurs de definició d’un àlies.</div>
</li>
<li class="level1"><div class="li"> <strong>hostCanonicalName | IP</strong> és el nom de <em>host</em> canònic al qual s’assigna l’àlies. Fixeu-vos un altre cop que és un FQDN i que acaba en punt. Generalment, els registres CNAME tenen a la part dreta de la definició un nom canònic, però de vegades caldrà indicar-hi una adreça IP. Penseu en un <em>host</em> <em>multi-homed</em> amb múltiples adreces IP que a més té àlies. Si la definició fos pel nom canònic del <em>host</em>, no se sabria quina de les adreces IP correspon a l’àlies. En aquests casos, el CNAME apunta a una adreça IP.</div>
</li>
</ul>

<p>
La resolució dels àlies s’obté buscant l’entrada de l’àlies en el fitxer de zona. Amb l’entrada CNAME s’obté el nom canònic corresponent a l’àlies. Un altre cop es torna a buscar en el fitxer de zona, ara el nom canònic. Una entrada de tipus A proporcionarà l’adreça IP corresponent (àlies –&gt; CNAME –&gt; nom canònic –&gt; A –&gt; adreça IP).
</p>

</div>

<h4><a id="registre_ptr" >Registre PTR</a></h4>
<div class="level4">

<p>
Un registre de recurs <strong>PTR</strong> (<em>pointer</em> o <strong>punter</strong>) associa una adreça IP al nom de <em>host</em> corresponent (resolució inversa). Cal una entrada PTR per a cada interfície de xarxa de la zona, per a cada adreça IP.
</p>

<p>
Un registre PTR consta dels camps:
</p>
<pre class="code">ipInversa.in-addr.arpa. IN PTR hostName.</pre>

<p>
Un exemple seria aquest:
</p>
<pre class="code">2.20.168.192.in-addr.arpa. IN PTR mahatma.inf.ioc.cat.</pre>

<p>
La descripció de cada camp és la següent:
</p>
<ul>
<li class="level1"><div class="li"> <strong>ipInversa.in-addr.arpa.</strong> indica l’adreça IP escrita en forma de domini in-addr.arpa per poder fer la resolució inversa. Les adreces IP s’escriuen al revés quan formen part del domini in-addr.arpa. Així, una IP 192.168.20.2 s’escriu 2.20.168.192.in-addr.arpa.</div>
</li>
<li class="level1"><div class="li"> <strong>IN</strong> indica que la classe és Internet.</div>
</li>
<li class="level1"><div class="li"> <strong>PTR</strong> informa que es tracta d’un registre de recurs de definició de la resolució inversa d’una adreça IP.</div>
</li>
<li class="level1"><div class="li"> <strong>hostName.</strong> és el nom de <em>host</em> FQDN assignat a l’adreça IP.</div>
</li>
</ul>

</div>

<h4><a id="registre_mx" >Registre MX</a></h4>
<div class="level4">

<p>
Un registre <strong>MX</strong> (<em>mail exchanger</em> o <strong>servidor de correu electrònic</strong>) defineix un servidor de correu. Es pot posar una entrada MX per a cada servidor de correu, però no és obligatori que n’hi hagi cap.
</p>

<p>
Un registre MX consta dels camps:
</p>
<pre class="code">nomDomini. IN MX num mailServer.</pre>

<p>
Un exemple seria aquest:
</p>
<pre class="code">inf.ioc.cat. IN MX 10 mailhost.inf.ioc.cat.</pre>

<p>
La descripció de cada camp és la següent:
</p>
<ul>
<li class="level1"><div class="li"> <strong>nomDomini.</strong> indica el nom del domini que s’està definint.</div>
</li>
<li class="level1"><div class="li"> <strong>IN</strong> indica que la classe és Internet.</div>
</li>
<li class="level1"><div class="li"> <strong>MX</strong> informa que es tracta d’un registre de recurs que defineix un servidor de correu per a aquest domini.</div>
</li>
<li class="level1"><div class="li"> <strong>num</strong> és un valor numèric que expressa el grau de preferència d’aquest servidor de correu respecte a altres servidors de correu del domini. El valor més baix és el que es prefereix. Són valors arbitraris que defineix l’administrador de xarxes.</div>
</li>
<li class="level1"><div class="li"> <strong>mailServer.</strong> correspon al nom FQDN del servidor de correu que s’està definint.</div>
</li>
</ul>

<p>
Observeu la llista de servidors de correu de Google a partir de:
</p>
<pre class="code">root@server:~# host google.com
google.com has address 216.58.201.174
google.com has IPv6 address 2a00:1450:4003:80b::200e
google.com mail is handled by 50 alt4.aspmx.l.google.com.
google.com mail is handled by 30 alt2.aspmx.l.google.com.
google.com mail is handled by 10 aspmx.l.google.com.
google.com mail is handled by 40 alt3.aspmx.l.google.com.
google.com mail is handled by 20 alt1.aspmx.l.google.com.
root@server:~# </pre>

</div>

<h4><a id="exemples_de_registres_de_recurs_rr" >Exemples de registres de recurs (RR)</a></h4>
<div class="level4">

<p>
Les dues llistes següents mostren exemples dels fitxers de configuració per a la resolució directa i la resolució inversa de la zona ioc.cat. En el primer es defineixen dos servidors de nom, un encaminador, una impressora i dos <em>hosts</em>. El primer dels servidors de noms també fa les funcions de servidor de correu, web i <acronym title="File Transfer Protocol">FTP</acronym>.
</p>
<pre class="code">;Exemple de fitxer de zona ioc.cat
$TTL 3D
ioc.cat. IN SOA ns1.ioc.cat. admin.ioc.cat. { 23; 8H; 2H; 4W; 1D; };
      NS ns1.ioc.cat.
      NS ns2.ioc.cat.
      MX 10 correu.ioc.cat.
ns1.ioc.cat. A     192.168.0.5; servidor amb 2 ip
             A     172.16.20.5
ns2.ioc.cat. A     192.168.0.7; servidor dns slave
router       A     192.168.0.1; router. Nom relatiu
correu       CNAME ns1 ; alias correu
www          CNAME ns1 ; alias web
ftp          CNAME ns1 ; alias ftp
hp-7200c     A     192.168.0.2; impressora
pc01         A     192.168.0.50
pc02         A     192.168.0.51</pre>

<p>
En la llista següent es pot veure com es defineix una entrada PTR per a cada nom canònic definit en la resolució directa per a una subxarxa concreta. La subxarxa 192.168.0.0/24 utilitza el fitxer 0.168.192.in-addr.arpa per a la resolució inversa:
</p>
<pre class="code">; Zona 0.168.192.in-addr.arpa.
; Exemple de fitxer de zona inversa ioc.cat
; correspon a la xarxa 192.168.0.0/24
$TTL 3D
ioc.cat. IN SOA ns1.ioc.cat. admin.ioc.cat. { 23; 8H; 2H; 4W; 1D;};
   NS ns1.ioc.cat.

5  PTR ns1.ioc.cat.
7  PTR ns2.ioc.cat.
1  PTR router.ioc.cat. 
2  PTR hp-7200c.ioc.cat. 
50 PTR pc01.ioc.cat. 
51 PTR pc02.ioc.cat.</pre>

</div>

<h3><a id="configuracio_dels_fitxers_de_zona" >Configuració dels fitxers de zona</a></h3>
<div class="level3">

<p>
Els fitxers de zona contenen els registres de recurs que formen la base de dades de la zona. Cal configurar el servidor de noms per indicar-li quins són i on són aquests fitxers. Cada administrador anomena els fitxers com li plau o seguint l’estil marcat per l’aplicació servidor <acronym title="Domain Name System">DNS</acronym> que utilitza. Un exemple és anomenar els fitxers de zona amb el format <em>db.nomDomini</em> per al fitxer de resolució directa i <em>db.ipSubXarxa</em> per a la resolució inversa per a cada xarxa de la zona. En els exemples d’aquesta documentació s’utilitza la sintaxi <em>nomDomini.zona.db</em> per a la resolució directa, <em>nomDomini.rev.zona.db</em> per als de la resolució inversa i <em>ip.rev.zona.db</em> quan cal definir la resolució inversa d’altres xarxes.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Exemple de configuració del servidor de noms</p>
<p>
Per a una zona que es compon d’una única xarxa 192.168.20.0/24 amb el nom de domini inf.ioc.cat caldran els següents fitxers de zona:
</p>
<ul>
<li class="level1"><div class="li"> El fitxer de resolució directa inf.ioc.cat.zona.db.</div>
</li>
<li class="level1"><div class="li"> El fitxer de resolució inversa 192.168.20.zona.db o inf.ioc.cat.rev.zona.db.</div>
</li>
<li class="level1"><div class="li"> El fitxer de resolució inversa del <em>loopback</em>.</div>
</li>
<li class="level1"><div class="li"> El fitxer amb la informació dels nodes arrel del <acronym title="Domain Name System">DNS</acronym>, named.ca.</div>
</li>
</ul>
</div></div>
<p>

</p>

<p>
Independentment de l’aplicació que s’utilitzi com a servidor de noms, caldrà configurar-la per dir-li on són aquests fitxers, com es diuen, si fan la funció de servidor autoritari per a la zona o no, si fan la funció de primari o secundari i altres opcions possibles.
</p>

<p>
Per cada fitxer de zona caldrà definir una entrada al fitxer de configuració global de BIND indicant el nom de la zona, el tipus i el nom del fitxer.
</p>

<p>
La sintaxi és:
</p>
<pre class="code">zone nom_zona in { type master|slave|hint; file &quot;nom_fitxer_zona&quot;; };</pre>

<p>
Un exemple de configuració de zona podria ser:
</p>
<pre class="code">zone inf.ioc.cat in { type master; file &quot;inf.ioc.cat.zona.db;&quot; }.</pre>

<p>
La descripció de cada camp és la següent:
</p>
<ul>
<li class="level1"><div class="li"> <strong>zone nom_zona</strong>: com es pot veure en l’exemple es defineix una zona corresponent al domini inf.ioc.cat.</div>
</li>
<li class="level1"><div class="li"> <strong>type master | slave | hint</strong>: el servidor serà primari (<em>master</em>) per a aquesta zona. Serà el que tindrà els fitxers amb les dades de la zona. El camp tipus pot prendre els valors <em>master</em>, <em>slave</em> i <em>hint</em>, que signifiquen el següent:</div>
</li>
<li class="level1"><div class="li"> <strong>file nom_fitxer_zona</strong>: indica el fitxer amb els registres de recurs de la zona. En l’exemple és el fitxer inf.ioc.cat.zona.db.</div>
</li>
</ul>
<div class="iocimportant"><div class="ioccontent"><ul>
<li class="level1"><div class="li"> <em>master</em>: el servidor té autoritat per a aquesta zona i gestiona els fitxers de zona.</div>
</li>
<li class="level1"><div class="li"> <em>slave</em>: el servidor és autoritari per a la zona, però obté les dades de la zona del servidor primari o <em>master</em>.</div>
</li>
<li class="level1"><div class="li"> <em>hint</em>: indica que es tracta de la informació corresponent als servidors de noms de la zona arrel. Aquesta informació té un tractament especial diferent del de les altres zones.</div>
</li>
</ul>
</div></div>
<p>
Cal parar especial atenció en la definició dels fitxers de zona per a la resolució inversa, utilitzant per exemple la xarxa 192.168.20.0/24. La zona s’anomena 20.168.192.in-addr.arpa, i el fitxer de zona, per exemple, db.192.168.20. El nom del fitxer conté l’adreça de xarxa en l’ordre natural, però el domini té els octets invertits perquè forma part del domini in-addr.arpa.
</p>

<p>
Vegeu l’exemple del fitxer de configuració del servei que inclou la definició de la zona directa ioc.cat. i la definició de la corresponent resolució inversa 2.0.10.in-addr.arpa. Aquestes definicions apunten als fitxers corresponents que descriuen els registres de recurs de cada una d’aquestes dues zones.
</p>
<pre class="code">zone &quot;ioc.cat&quot; {
    type master;
    file &quot;/etc/bind/ioc.cat.zona.db&quot;;
};
zone &quot;2.0.10.in-addr.arpa&quot; {
    type master;
    file &quot;/etc/bind/ioc.cat.rev.zona.db&quot;;
};</pre>

</div>

<h3><a id="delegacio_de_zona" >Delegació de zona</a></h3>
<div class="level3">

<p>
El sistema de noms de domini <acronym title="Domain Name System">DNS</acronym> és una estructura jeràrquica i distribuïda. Hem vist com crear dominis i administrar-los en una zona que pot contenir altres subdominis que no s’hagin delegat. Per fer que l’estructura jeràrquica funcioni apropiadament cal poder delegar subdominis a altres entitats.
</p>

<p>

</p>

<p>
Delegar un subdomini implica transferir tota l’administració del domini delegat a una altra entitat. Un cop delegat, aquesta entitat és la responsable total de la seva gestió. Caldrà establir el lligam entre el domini pare i el domini fill. Segurament caldrà realitzar els passos següents:
</p>

<p>
En el servidor de noms del domini fill:
</p>
<ul>
<li class="level1"><div class="li"> Generar els fitxers de zona directa i inversa i configurar apropiadament el servei.</div>
</li>
<li class="level1"><div class="li"> Verificar-ne el funcionament.</div>
</li>
</ul>

<p>
En el servidor de noms del domini pare:
</p>
<ul>
<li class="level1"><div class="li"> Realitzar la delegació.</div>
</li>
<li class="level1"><div class="li"> Verificar la delegació consultant registres del domini fill.</div>
</li>
</ul>

<p>
Optimitzar la consulta de la zona pare en el domini fill:
</p>
<ul>
<li class="level1"><div class="li"> Observar que des del servidor de noms fills no es disposa d’accés a la informació del domini pare. No hi ha lligam. Bé, sí, de fet, hi ha el mateix lligam que amb qualsevol altre domini. S’hi podrà accedir o no igual que a qualsevol altre domini.</div>
</li>
<li class="level1"><div class="li"> Fer del servidor de noms fill un servidor esclau de la zona pare.</div>
</li>
</ul>

<p>
Com a exemple pràctic creem una zona delegada inf.ioc.cat. corresponent a la xarxa 172.19.0.0/16. Aquests són els fitxers de zona:
</p>
<pre class="code">; Fitxer de configuració dels hosts de la zona:
; inf.ioc.cat  (172.19.0.0/16)
$TTL 3D
@ IN SOA ns.inf.ioc.cat. admin.inf.ioc.cat. 1 3H 15M 1W 1D
          NS    ns
          MX    10 mailhost
ns		    A	    172.19.1.1
mailhost	A	    172.19.1.2
printer 	A	    172.19.2.5
server		A     172.19.2.10
router 		CNAME	server</pre>
<pre class="code">; zona 19.172.in-addr.arpa.
; inf.ioc.org  (reverse)  172.19.0.0/16
$TTL 3D
19.172.in-addr.arpa.  IN SOA ns.inf.ioc.cat. admin.inf.ioc.cat. 1 3M 1M 1W 1D
     NS  ns.inf.ioc.cat.
1.1  PTR ns.inf.ioc.cat.
1.2  PTR mailhost.inf.ioc.cat.
2.5  PTR printer.inf.ioc.cat.
2.10 PTR server.inf.ioc.cat.</pre>

<p>
El servidor de noms del domini inf.ioc.cat. es configura de manera anàloga a com s’han configurat els servidors en els exemples anteriors. Evidentment cal indicar quines són les zones que administra:
</p>
<pre class="code">zone &quot;inf.ioc.cat&quot; {
  notify no;
  type master;
  file &quot;inf.ioc.cat.zona.db&quot;;
};
zone &quot;19.172.in-addr.arpa&quot; {
  notify no;
  type master;
  file &quot;inf.ioc.cat.rev.zona.db&quot;;
};</pre>

<p>
De fet, en el procés de delegació de zona no cal fer res d’especial en el servidor de la zona delegada. Només cal fer la configuració apropiada, posar-lo en funcionament i verificar-lo igual que es fa per a qualsevol altre servidor. On és, doncs, la màgia de la delegació? En el lligam que es fa del domini pare a la zona delegada.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Delegar una zona consisteix a indicar al fitxer de la zona pare quin és el servidor de la zona delegada.
</p>
<ul>
<li class="level1"><div class="li"> Això es fa amb un registre de recurs NS, indicant l’FQDN del servidor de noms de la zona delegada.</div>
</li>
<li class="level1"><div class="li"> Usualment caldrà a més un registre de recurs de tipus A, que indiqui quina és l’adreça IP del servidor de noms descrit en el punt anterior. Aquest és el registre de recurs que fa el <strong>lligam</strong> (<em>glue record</em>) que possibilita la “màgia” de la delegació. </div>
</li>
</ul>
</div></div>
<p>
Finalment, cal veure com es fa en la zona ioc.cat. per delegar. Cal afegir al fitxer de zona els dos registres de recurs que possibiliten la delegació:
</p>
<pre class="code">; Fitxer de configuració dels hosts de la zona:
; ioc.org  (172.17.1.0/24)
$TTL 3D
@ IN SOA ns.ioc.cat. admin.ioc.cat. 1 3H 15M 1W 1D
          NS  ns
          MX  10 mailhost
ns	    	A	  172.17.1.1
mailhost	A	  172.17.1.2
server		A   172.17.1.10
... 
; delegació de zona inf.ioc.cat.
inf.ioc.cat.    NS ns.inf.ioc.cat.
ns.inf.ioc.cat  A  172.19.1.1</pre>

<p>

</p>

<p>
Si analitzeu la primera de les línies de delegació, veureu que es defineix que el domini inf.ioc.cat. està gestionat per un servidor de noms anomenat ns.inf.ioc.cat. En la segona línia es fa el lligam físic que possibilita saber on és aquest servidor de noms del domini delegat. Aquesta segona línia indica que el servidor de noms és el corresponent a l’adreça IP 172.19.1.1.
</p>

<p>

Quan es pregunta al servidor de noms de la zona ioc.cat. pel <em>host</em> printer.inf.ioc.cat., el servidor busca en el seu fitxer de zona i detecta que les consultes que acaben en <em>inf.ioc.cat.</em> han de ser gestionades per un <em>host</em> anomenat ns.inf.ioc.cat. A continuació, intenta resoldre aquest nom consultant un altre cop el fitxer de zona i troba que el servidor de noms anomenat ns.inf.ioc.cat. correspon a l’adreça IP 172.19.1.1. Quan ja sap on localitzar-lo continua la resolució (està fent una consulta recursiva) apropant-se al domini de destinació. Pregunta per <em>printer</em> al servidor ns.inf.ioc.cat. i d’aquest n’obté la resposta autoritativa.
</p>

</div>

<h4><a id="comprovacio_de_delegacio" >Comprovació de delegació</a></h4>
<div class="level4">

<p>
Per comprovar la delegació de zona cal tenir present que primer cal verificar la zona delegada per si mateixa per tal que tot sigui correcte. Un cop és segur que funciona bé, cal verificar el lligam de la zona pare amb la zona fill. Això es pot realitzar fent consultes locals des del servidor pare de registres de la zona delegada.
</p>

</div>

<h4><a id="servidor_delegat_actuant_com_a_esclau_de_la_zona_pare" >Servidor delegat actuant com a esclau de la zona pare</a></h4>
<div class="level4">

<p>
Des del punt de vista de la zona delegada no hi ha cap lligam a la zona pare. És a dir, des del punt de vista d’un client de dins del domini inf.ioc.cat., demanar pel <em>host</em> smtp.gmail.com. o demanar pel <em>host</em> server.ioc.cat. implica el mateix procediment de resolució. Implica fer una consulta externa aplicant els mecanismes generals de resolució que s’han explicat en apartats anteriors. Sembla mentida, però el subdomini inf té tant (des)coneixement del seu domini pare com de qualsevol altre domini d’Internet.
</p>

<p>
Per tal d’implementar el traspàs de coneixement entre la zona pare i la zona delegada, cal fer del servidor de noms delegat un servidor <strong>secundari</strong> de la zona pare. Això és realment útil, ja que hi haurà sovint consultes des del subdomini inf referents a <em>hosts</em> del domini ioc.cat degut a que tots formen part d’una mateixa estructura organitzativa.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Quan es tracta de subdominis dins d’una mateixa estructura organitzativa (una mateixa empresa o institució), és usual que els servidors de noms dels dominis delegats facin també de servidors <strong>esclaus</strong> del domini pare.
</p>

<p>
D’aquesta manera poden respondre per si mateixos les consultes referents a tot el domini.
</p>
</div></div>
</div>

<h2><a id="transferencies_de_zona" >Transferències de zona</a></h2>
<div class="level2">

<p>
Els dominis d’Internet s’administren en zones, cada una gestionada per dos o més servidors de noms. Segons l’estàndard, cada zona té un servidor primari i almenys un servidor secundari. Ambdós són autoritaris per a la zona que administren. Caldrà, doncs, que aquests servidors disposin d’informació tan coherent com sigui possible, que comparteixin la mateixa informació. Això es fa mitjançant les transferències de zona.
</p>

<p>

Sovint, els servidors de noms actuen també com a memòria cau, emmagatzemant les respostes d’altres servidors per tal d’incrementar la seva eficiència. Quan emeten aquestes respostes actuen de forma no autoritària.
</p>

<p>
Sovint es confonen els conceptes relatius a la transferència de zones (servidor primaris i secundaris) amb els conceptes relacionats amb l’autoritat o no de les respostes. El següent destacat intenta aclarir cada un d’aquests termes.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
<strong>Primari/secundari(s)</strong>, també anomenats <strong>master/slave(s)</strong>: una zona és gestionada per un servidor primari (<em>master</em>) i un o més servidors secundaris (<em>slave</em>) o de seguretat.
</p>

<p>
<strong>Autoritari/no autoritari</strong>: els servidors d’una zona (el primari i els secundaris) són autoritat per a aquella zona que administren. Les respostes que emeten basant-se en la informació emmagatzemada en la memòria cau (informació procedent d’altres servidors de noms en lloc de procedir de la pròpia base de dades de zona) són no autoritàries.
</p>

<p>
<strong>Transferència de zona</strong>: la informació de la base de dades de la zona ha de ser coherent entre els servidors primari i secundaris. La transferència de zona és el mecanisme que s’estableix per fer que comparteixin la mateixa informació.
</p>
</div></div>
<p>
El servidor <strong>primari</strong> manté la base de dades de la zona i l’actualitza. Aquesta informació es copia als servidors <strong>secundaris</strong> utilitzant un procés de <strong>transferència</strong>.
</p>

<p>
Establir com i quan s’ha de fer aquesta transferència és important per proporcionar un bon servei <acronym title="Domain Name System">DNS</acronym>. Cal buscar un <strong>compromís</strong> entre <strong>actualitzar</strong> constantment la informació però consumir recursos excessius i no fer-ho però disposar d’informació <strong>caducada</strong>.
</p>

<p>
De fet, un servidor pot ser secundari per a una zona (o més d’una) i primari per a altres zones. Imaginem que el servidor ioc.cat. és primari per a la seva zona i ha delegat el domini alumnes.ioc.cat. a l’associació d’alumnes. El servidor de noms dels alumnes és primari per a la seva zona. Per agilitar les consultes al domini ioc.cat., l’IOC i els alumnes han acordat permetre que el servidor de noms de la zona alumnes.ioc.cat. faci també de secundari de la zona ioc.cat.
</p>

<p>
L’actualització de la informació entre el servidor primari i els secundaris és molt important. Establir correctament aquests <strong>paràmetres</strong> és un art. Un servidor amb informació antiga causa un mal funcionament a la xarxa, mentre que un servidor actualitzat constantment consumeix recursos excessius.
</p>

</div>

<h2><a id="extensions_del_protocol_dns" >Extensions del protocol DNS</a></h2>
<div class="level2">

<p>
El protocol <acronym title="Domain Name System">DNS</acronym> és un protocol bastant antic, que s’ha anat adaptant als canvis que ha sofert Internet. Aquest apartat tracta els més importants, el servei amb adreces IP dinàmiques i la seguretat. El primer és degut a la manca d’adreces IPv4 i a la dificultat d’obtenir adreces IP públiques estàtiques (en la majoria dels casos són de pagament, almenys per a l’usuari final). El segon és la seguretat, on inicialment el protocol havia estat dissenyat sense tenir-la en compte.
</p>

</div>

<h3><a id="servei_amb_adreces_ip_dinamiques" >Servei amb adreces IP dinàmiques</a></h3>
<div class="level3">

<p>

</p>

<p>
El servei de noms permet associar a una adreça IP un nom de domini. Així, per exemple, a l’adreça IP del servidor de l’usuari pere se li assigna el nom de host pere.ioc.cat en el domini de l’IOC. Ara bé, què passa si el <em>host</em> rep una IP dinàmica (de manera que la seva adreça IP pot variar)? Evidentment, en els fitxers de zona que lliguen les adreces IP amb els noms de domini cal saber prèviament l’adreça a usar i això no permetria assignar noms a adreces IP dinàmiques. Però també existeix un mecanisme anomenat DDNS o <strong><acronym title="Domain Name System">DNS</acronym> dinàmic</strong> que permet fer actualitzacions dinàmiques en la base de dades de les zones.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
El procotocol o extensió <strong>DDNS</strong> (Dynamic <acronym title="Domain Name System">DNS</acronym>) permet realitzar <strong>actualitzacions</strong> en una base de dades <acronym title="Domain Name System">DNS</acronym> de manera dinàmica. De fet, es permeten afegir i eliminar registres de recurs dels fitxers de zona.
</p>

<p>
Aquest protocol està descrit a l’<acronym title="Request for Comments">RFC</acronym> 2136 de l’IETF.
</p>
</div></div>
<p>
Utilitzant DDNS es poden afegir i eliminar registres a la base de dades d’una zona de manera que a mesura que assigna adreces dinàmiques als seus clients un servidor DHCP també pot anar realitzant peticions d’actualitzacions al servidor <acronym title="Domain Name System">DNS</acronym> per tal de que aquests clients disposin també de noms de domini.
</p>

</div>

<h3><a id="seguretat" >Seguretat</a></h3>
<div class="level3">

<p>
Un dels principals problemes del protocol <acronym title="Domain Name System">DNS</acronym> és la seguretat, ja que és una cosa que no es va tenir en compte en el disseny inicial, on prevalia més que el disseny fos distribuït i escalable. Això va que aquest protocol es basi en la confiança que qui dona la informació és fiable i que aquesta informació és certa. 
</p>

<p>
Si algú munta un servidor <acronym title="Domain Name System">DNS</acronym> en una xarxa privada juntament amb un servidor DHCP (que dona la configuració de xarxa als equips) al marge dels oficials que hi pugui haver en aquesta organització, i aquest servidor va ementent respostes falses, com per exemple donar unes altres IP per als bancs o el correu electrònic, és molt difícil detectar-ho. Aquest tipus d’atacs s’anomenen <em>Man In The Middle</em> (MITM). També es pot donar en el cas de xarxes WiFi obertes per a aquest propòsit (els coneguts <em>honey pots</em>) que exploten l’avarícia de la gent en obtenir alguna cosa de forma gratuïta. Aquest és un cas del caçador caçat.
</p>

<p>
Un altre cas encara més difícil de detectar és quan algun servidor <acronym title="Domain Name System">DNS</acronym> ha patit un atac i aquestes respostes es van actualitzant en altres servidors, fent que la informació que contenen en la seva memòria cau sigui fraudulenta. Aquest cas es coneix com <strong>enverinament de la memòria cau <acronym title="Domain Name System">DNS</acronym></strong> (<em><acronym title="Domain Name System">DNS</acronym> cache poisoning</em>, en anglès).
</p>

<p>
L’IETF va elaborar un conjunt d’especificacions conegut com a <strong>Domain Name System Security Extensions</strong> (DNSSEC) compatibles amb el protocol <acronym title="Domain Name System">DNS</acronym>. Aquestes especificacions garanteixen l’autenticitat i la integritat de les dades <acronym title="Domain Name System">DNS</acronym>. No obstant, no garanteixen la confidencialitat, que, de fet, no és important ja que la informació que es transmet és de caràcter públic (les IP de cada domini).
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
El protocol o extensió <strong>DNSSEC</strong> permet garantir l’<strong>autenticita</strong>t i la <strong>integritat</strong> en les consultes a servidors <acronym title="Domain Name System">DNS</acronym>. Aquestes extensions estan descrites en el <acronym title="Request for Comments">RFC</acronym> 4033, 4034 i 4035.
</p>
</div></div>
<p>
Aquest sistema utilitza signatures digitals basades en criptografia de clau pública. Cada zona <acronym title="Domain Name System">DNS</acronym> té el seu parell de clau pública-privada amb la qual es van signant les dades de les consultes i respostes <acronym title="Domain Name System">DNS</acronym> a través d’un mecanisme de confiança que arriba fins als servidors arrels (cadena de confiança). La zona arrel del protocol <acronym title="Domain Name System">DNS</acronym> està signada des del 2010, així com la majoria de gTLD i ccTLD.
</p>

</div>

	 </article>
     <div class="pnpage">
      <div class="left-corner"></div>
      <div id="prevpage">Anar a la p&agrave;gina anterior:<br /><a href="../../../WebContent/u1/referencies.html">Més informació</a></div>
      <div id="nextpage">Anar a la p&agrave;gina seg&uuml;ent:<br /><a href="../../../WebContent/u1/a1/activitats.html">Activitats</a></div>
      <div class="right-corner"></div>
     </div>
    </div>
    <footer class="footer">
      <div><small>Aquest document està subjecte a una llicència oberta de Creative Commons, es reserva el dret de reconeixement de l'autoria, d'exigir que no se'n faci cap mena d'ús comercial. Si altereu o transformeu aquesta obra, o en genereu obres derivades, només podeu distribuir l'obra generada amb una llicència idèntica a aquesta.</small></div>
    </footer>
 </div>
 <div id="back_preview" class="hidden"></div>
 <div id="preview" class="hidden">
  <div class="prevcontent"></div>
 </div>
 <div id="help-tooltips">
  <div id="help-toc" class="hidden tooltip"><span>Taula de continguts:</span> Ofereix una vista general de l&#39;estructura del m&ograve;dul, que us facilitar&agrave; la navegaci&oacute; a trav&eacute;s dels seus continguts.<span class="arrow-left"></span></div> 
  <div id="help-settings" class="hidden tooltip"><span>Opcions de format:</span> Permet configurar el format de lectura a partir de les vostres prefer&egrave;ncies, modificant la mida de la lletra, el color del fons, l&#39;amplada de la p&agrave;gina o l&#39;ocultaci&oacute; dels continguts complementaris, entre d&#39;altres.<span class="arrow-left"></span></div>
  <div id="help-printer" class="hidden tooltip"><span>Imprimir:</span>  Envia el contingut seleccionat a la impressora.<span class="arrow-left"></span></div>
  <div id="help-favorites" class="hidden tooltip"><span>Prefereits:</span> Permet desar aquelles parts del contingut a les que us interessi accedir en un moment posterior; us permetr&agrave; anar creant un repositori personalitzat de les seccions que considereu m&eacute;s rellevants. Un cop l&#39;hageu començat a fer servir se us mostrar&agrave; a sota un comptador que us informar&agrave; del nombre de preferits que s&#39;hagin emmagatzemat fins al moment.<span class="arrow-left"></span></div>
  <div id="help-favcounter" class="hidden tooltip"><span>Comptador i llistat de preferits:</span> Indica el nombre de preferits que s&#39;han desat fins el moment; clicant damunt seu accedireu al llistat de preferits, i a trav&eacute;s d&#39;aquest podreu accedir directament als continguts que hageu emmagatzemat.<span class="arrow-left"></span></div>
  <div id="help-help_icon" class="hidden tooltip"><span>Ajuda:</span> Aquesta opci&oacute; activa la informaci&oacute; de les funcionalitats del web tot situant el punter del ratol&iacute; al damunt dels diferents &iacute;tems.<span class="arrow-left"></span></div>
  <div id="help-sidebar-hide" class="hidden tooltip"><span>Mostrar/Ocultar barra lateral:</span>  Deshabilita la barra d&#39;opcions, permetent la seva recuperaci&oacute; quan es desitgi.<span class="arrow-left"></span></div>
  <div id="help-search" class="hidden tooltip"><span>Cerca:</span>  Introdu&iuml;u les paraules clau sobre aquells conceptes que desitgeu localitzar en els continguts del m&ograve;dul. Tamb&eacute; podeu excloure un terme de la cerca tot afegint-hi el signe &#8220;-&#8221; al davant.<span class="arrow-top"></span></div>
  <div id="help-header" class="hidden tooltip"><span>Cap&ccedil;alera:</span>  Indica l&#39;apartat o secci&oacute; que es mostra en pantalla. Tingueu present que les capçaleres de segon, tercer i quart nivell tamb&eacute; es poden desar com a marcadors.<span class="arrow-left"></span></div>
</div> 
</body>
</html>
