<!doctype html>

<!--[if lt IE 7 ]> <html class="ie ie6 no-js" lang="ca"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie ie7 no-js" lang="ca"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie ie8 no-js" lang="ca"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie ie9 no-js" lang="ca"> <![endif]-->
<!--[if gt IE 9]><!--><html class="no-js" lang="ca"><!--<![endif]-->
<!-- the "no-js" class is for Modernizr. -->

<head id="www-sitename-com" data-template-set="html5-reset">

	<meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html">
        
	<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title>Serveis de Xarxa i Internet</title>
	
<!-- <meta name="title" content=""> --> 
	<meta name="description" content="">
	<!-- Google will often use this as its description of your page/site. Make it good. -->
	
	<meta name="google-site-verification" content="">
	<!-- Speaking of Google, don't forget to set your site up: http://google.com/webmasters -->
	
	<meta name="author" content="Institut Obert de Catalunya">
	<meta name="Copyright" content="Copyright Institut Obert de Catalunya 2011. All Rights Reserved.">

	<!-- Dublin Core Metadata : http://dublincore.org/ -->
	<meta name="DC.title" content="Serveis de Xarxa i Internet">
	<meta name="DC.subject" content="Informàtica i comunicacions">
	<meta name="DC.creator" content="Institut Obert de Catalunya">
	
	<!--  Mobile Viewport Fix
	j.mp/mobileviewport & davidbcalhoun.com/2010/viewport-metatag 
	device-width : Occupy full width of the screen in its current orientation
	initial-scale = 1.0 retains dimensions instead of zooming out if page height > device height
	maximum-scale = 1.0 retains dimensions instead of zooming in if page width < device width
	-->
	<!-- Uncomment to use � use thoughtfully!
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
	-->

	<link rel="shortcut icon" href="../../../img/favicon.ico">
	<!-- This is the traditional favicon.
		 - size: 16x16 or 32x32
		 - transparency is OK
		 - see wikipedia for info on browser support: http://mky.be/favicon/ -->
		 
	<link rel="apple-touch-icon" href="../../../img/apple-touch-icon.png">
	<!-- The is the icon for iOS's Web Clip.
		 - size: 57x57 for older iPhones, 72x72 for iPads, 114x114 for iPhone4's retina display (IMHO, just go ahead and use the biggest one)
		 - To prevent iOS from applying its styles to the icon name it thusly: apple-touch-icon-precomposed.png
		 - Transparency is not recommended (iOS will put a black BG behind the icon) -->
	
	<!-- CSS: screen, mobile & print are all in the same file -->
	<link rel="stylesheet" href="../../../_/css/style.css">

	<!-- CSS: jQuery UI -->
	<link rel="stylesheet" href="../../../_/css/jquery-ui.css">
	
	<!-- all our JS is at the bottom of the page, except for Modernizr. -->
	<script src="../../../_/js/modernizr-1.7.min.js"></script>
	<script src="../../../_/js/Hyphenator.js" type="text/javascript"></script>
	<script type="text/javascript">
	   Hyphenator.config({
		minwordlength : 4
	   });
	   Hyphenator.run();
	</script>
    <script src="../../../_/js/build.js" type="text/javascript"></script>
</head>

<body class="style-newspaper">

<div class="wrapper"><!-- not needed? up to you: http://camendesign.com/code/developpeurs_sans_frontieres -->

	<header id="header">
		<div class="head"><a href="http://ioc.gencat.cat"><img src="../../../img/logo.png" alt="Institut Obert de Catalunya"/></a><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/es/deed.ca"><img src="../../../img/license.png" alt="Llic&egrave;ncia" class="license"/></a></div>
		<div class="headdocument"><a href="../../../index.html">Serveis de Xarxa i Internet</a></div>
        <div id="search" class="search" name="search">
         <form id="frmsearch" action="../../../search.html" method="get">
          <input type="text" name="q"/>
        </form>
        </div>
	</header>
   <div id="upbutton" class="upbutton" style="display:none;"><img src="../../../img/uparrow.png" alt="Pujar a l'inici de p&agrave;gina"/></div>
   <aside id="aside">
    <div id="menu">
      <ul>
       <li name="toc"><div><img src="../../../img/toc.png" alt="&Iacute;ndex"/></div></li>
       <li name="settings"><div><img src="../../../img/settings.png" alt="Configuraci&oacute;"/></div></li>
       <li name="printer"><div><img src="../../../img/printer.png" alt="Imprimir"/></div></li>
       <li name="favorites"><div><img src="../../../img/favorites.png" alt="Favorits"/></div></li>
       <li name="help_icon" class="help_icon"><div><img src="../../../img/help_icon.png" alt="Ajuda"/></div></li>
      </ul>
     </div>
   </aside>
   <div id="sidebar-hide" name="sidebar-hide"><img src="../../../img/arrows.png"/></div>
   <section>
     <div id="toc" class="hidden">
      <div class="menucontent">
        <ul>
        <li id="u2" class="parentnode"><p><a class="unit" href="../../../WebContent/u2/introduccio.html">2. Serveis web i de transferència de fitxers</a></p><ul class="expander"><li id="u2introduccio"><a href="../../../WebContent/u2/introduccio.html">Introducció</a></li><li id="u2resum"><a href="../../../WebContent/u2/resum.html">Resum</a></li><li id="u2resultats"><a href="../../../WebContent/u2/resultats.html">Resultats d'aprenentatge</a></li><li id="u2referencies"><a href="../../../WebContent/u2/referencies.html">Referències</a></li><li id="u2a1" class="tocsection"><p id='u2a1continguts'><a class="section" href="../../../WebContent/u2/a1/continguts.html">Instal·lació i administració de servidors web</a><span class="buttonexp"></span></p><ul><li id="u2a1activitats"><a href="../../../WebContent/u2/a1/activitats.html">Activitats</a></li><li id="u2a1exercicis"><a href="../../../WebContent/u2/a1/exercicis.html">Exercicis</a></li><li id="u2a1annexos"><a href="../../../WebContent/u2/a1/annexos.html">Annexos</a></li></ul></li><div data-parent-id='u2a1' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u2/a1/continguts.html#funcionament_del_servei_web">Funcionament del servei web</a></li><li><a href="../../../WebContent/u2/a1/continguts.html#instal_lacio_i_configuracio_de_servidors_web">Instal·lació i configuració de servidors web</a></li><li><a href="../../../WebContent/u2/a1/continguts.html#moduls_dinamics">Mòduls dinàmics</a></li><li><a href="../../../WebContent/u2/a1/continguts.html#creacio_i_configuracio_de_llocs_web_virtuals">Creació i configuració de llocs web virtuals</a></li><li><a href="../../../WebContent/u2/a1/continguts.html#autenticacio">Autenticació</a></li><li><a href="../../../WebContent/u2/a1/continguts.html#comunicacions_segures">Comunicacions segures</a></li><li><a href="../../../WebContent/u2/a1/continguts.html#monitoratge_del_servei">Monitoratge del servei</a></li><li><a href="../../../WebContent/u2/a1/continguts.html#registres_del_servei">Registres del servei</a></li></ul></div></div><li id="u2a2" class="tocsection"><p id='u2a2continguts'><a class="section" href="../../../WebContent/u2/a2/continguts.html">Instal·lació i administració de serveis de transferència de fitxers</a><span class="buttonexp"></span></p><ul><li id="u2a2activitats"><a href="../../../WebContent/u2/a2/activitats.html">Activitats</a></li><li id="u2a2exercicis"><a href="../../../WebContent/u2/a2/exercicis.html">Exercicis</a></li><li id="u2a2annexos"><a href="../../../WebContent/u2/a2/annexos.html">Annexos</a></li></ul></li><div data-parent-id='u2a2' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u2/a2/continguts.html#servei_de_transferencia_de_fitxers">Servei de transferència de fitxers</a></li><li><a href="../../../WebContent/u2/a2/continguts.html#instal_lacio_i_configuracio_del_servidor">Instal·lació i configuració del servidor</a></li><li><a href="../../../WebContent/u2/a2/continguts.html#creacio_d_usuaris_i_grups">Creació d'usuaris i grups</a></li><li><a href="../../../WebContent/u2/a2/continguts.html#configuracio_de_l_acces_anonim">Configuració de l’accés anònim</a></li><li><a href="../../../WebContent/u2/a2/continguts.html#limitacions_d_acces">Limitacions d’accés</a></li><li><a href="../../../WebContent/u2/a2/continguts.html#modes_d_acces_al_servidor">Modes d'accés al servidor</a></li><li><a href="../../../WebContent/u2/a2/continguts.html#comunicacions_segures">Comunicacions segures</a></li><li><a href="../../../WebContent/u2/a2/continguts.html#clients_grafics_i_de_text">Clients gràfics i de text</a></li></ul></div></div></ul></li><li id="" class="indexnode"><p><a href="../../../index.html">Anar a l&#39;&iacute;ndex general</a></p></li>
        </ul>
      </div>
    </div>
   </section>
   <section>
   <div id="settings" class="hidden">
    <div class="menucontent">
     <div class="allsettings">
     <div class="settings">
      <label>Font i Color</label>
		<div class="setting-option">
	        <ul class="fontBackground">
				<li id="style-newspaper" title="Newspaper" class="appearance-style-newspaper"><span>Newspaper</span></li>
                <li id="style-novel" title="Novel" class="appearance-style-novel"><span>Novel</span></li>
                <li id="style-ebook" title="eBook" class="appearance-style-ebook"><span>eBook</span></li>
				<li id="style-inverse" title="Inverse" class="appearance-style-inverse active"><span>Inverse</span></li>
				<li id="style-athelas" title="Athelas" class="appearance-style-athelas"><span>Athelas</span></li>
			</ul>
		</div>
     </div>
	<div class="settings">
      <label>Amplada</label>
		<div class="setting-option">
	        <div id="slider-width"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
		<div class="setting-option">
	        <div id="slider-font"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
	  <div class="setting-option">
       <form action="" class="sett-options">
		<ul>
		    <li><input type="checkbox" id="secondary-content" /><label for="secondary-content">Mostra recursos complementaris</label></li>
		    <li><input type="checkbox" id="main-images" /><label for="main-images">Mostra imatges</label></li>
		    <li><input type="checkbox" id="text-alignment" /><label for="text-alignment">Text justificat</label></li>
			<li><input type="checkbox" id="text-hyphen" /><label for="text-hyphen">Partici&oacute; sil·l&agrave;bica</label></li>
		</ul>
       </form>
	  </div>
     </div>
     </div>
    </div>
   </div>
   </section>
 <section>
 <div id="favorites" class="hidden"></div>
 </section>   
 <div id="bridge" class="hidden"></div>
 <div id="help" class="hidden">
  <div class="helptitle">Dreceres del teclat<hr></div>
  <div class="helpsection"><span>General</span>
   <ul>
    <li><span class="shortcut">g</span>: Anar al men&uacute; de navegaci&oacute;</li>
    <li><span class="shortcut">o</span>: Anar a opcions</li>
    <li><span class="shortcut">s</span>: Guardar la p&agrave;gina actual a favorits</li>
    <li><span class="shortcut">p</span>: Imprimir la p&agrave;gina actual</li>
    <li><span class="shortcut">?</span>: Mostrar/Ocultar l&#39;ajuda</li>
   </ul>
  </div>
  <div class="helpsection"><span>Navegaci&oacute;</span>
   <ul>
    <li><span class="shortcut">i</span>: Anar a l&#39;&iacute;ndex general</li>
    <li><span class="shortcut">t</span>: Anar a l&#39;inici de p&agrave;gina</li>
    <li><span class="shortcut">b</span>: Anar al final de p&agrave;gina</li>
    <li><span class="shortcut">j</span>: Anar cap endavant dintre la p&agrave;gina</li>
    <li><span class="shortcut">k</span>: Anar cap enrere dintre la p&agrave;gina</li>
    <li><span class="shortcut">h</span>: Anar a la p&agrave;gina anterior:</li>
    <li><span class="shortcut">l</span>: Anar a la p&agrave;gina seg&uuml;ent:</li>
   </ul>
   </div>
 </div>
 <div id="favcounter" name="favcounter" class="hidden"><span></span></div>
 <div id="navmenu" class="navmenu"><ul class="webnav"><li><a href="../../../index.html" title="Anar a l&#39;&iacute;ndex general">Inici</a></li><li><a href="../introduccio.html">Serveis web i de transferència de fitxers</a></li><li>Instal·lació i administració de servidors web</li></ul></div>
	<div id="content" lang="ca" class="hyphenate text">
     <article lang="ca" class="sheet">
        <h1><a id="instal_lacio_i_administracio_de_servidors_web"> Instal·lació i administració de servidors web </a></h1>
    	
<p>
L’<strong>HTTP</strong> (<em>Hypertext Transfer Protocol</em> o <strong>protocol de transferència d’hipertext</strong>) és un protocol de capa d’aplicació que proporciona transferència de documents d’hipertext al web. El protocol HTTP és omnipresent: el World Wide Web (WWW) permet baixar hipertext, multimèdia i altres tipus de dades.
</p>

<p>
L’HTTP està basat en un esquema client/servidor en què el client es connecta al port 80 del servidor i fa una sol·licitud (una pàgina web, per exemple), i el servidor emet la resposta corresponent i tanca la connexió. Es tracta, per tant, d’un protocol sense estat. La connexió entre client i servidor sovint s’inicia i es tanca en cada petició/resposta. L’HTTP utilitza habitualment el protocol de transport TCP per obtenir fiabilitat en la comunicació.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
L’HTTP és un protocol sense estat i no orientat a la connexió permanent.
</p>
</div></div><div class="iocimportant"><div class="ioccontent">
<p>
L’<strong>HTTP</strong> és un protocol de capa d’aplicació que proporciona transferència de documents d’hipertext a la web. Utilitza un mecanisme client/servidor al port 80 basat en TCP.
</p>
</div></div>
<p>
L’especificació actual del protocol HTTP és la 2 (HTTP/2), descrita al document <acronym title="Request for Comments">RFC</acronym> 7540, de maig de 2015 (que en descriu l’estàndard), tot i que hi ha l’esborrany de la versió 3 (HTTP/3). Aquesta especificació és un alternativa a l’anterior especificació, la 1.1 (descrita al document <acronym title="Request for Comments">RFC</acronym> 2616, de juny de 1999) i que no deixa obsoleta. L’HTTP sorgeix als anys noranta com a protocol per transferir documents hipermèdia “en cru” per Internet (versió 0.9). La versió HTTP 1.0 (<acronym title="Request for Comments">RFC</acronym> 1945) permet el pas de missatges utilitzant un format tipus MIME (usat en el transport de correu). Originàriament, el contingut dels documents a transferir era text, però amb la popularització del WWW s’ha acabat convertint en un protocol de transport de contingut multimèdia i no únicament hipertext. A més, l’HTTP s’utilitza sovint com a protocol de comunicacions entre clients i altres sistemes d’Internet diferents del WWW, com per exemple NEWS, SMTP, NNTP, <acronym title="File Transfer Protocol">FTP</acronym>, Ghoper, servidors intermediaris (<em>proxies</em>) i d’altres, per accedir a aquests recursos.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">MIME</p>
<p>
El <em>Multipurpose Internet Mail Extension</em>, o extensió de propòsit múltiple per al correu, és el mecanisme utilitzat per descriure el contingut dels fitxers, saber si són una imatge, un full de càlcul, un executable o altres, i permetre al navegador obrir l’aplicació pertinent.
</p>
</div></div>
<p>
En parlar d’HTTP ens venen immediatament al cap els navegadors web (tipus Firefox, Google Chrome, Safari…), que permeten visualitzar des d’entorns gràfics contingut d’hipertext i multimèdia, també anomenat hipermèdia. De fet, però, també existeixen navegadors en mode text (no gràfics) per a contingut únicament de text (per exemple Lynx). Habitualment usem els navegadors per obtenir contingut HTTP, però la majoria d’ells ens permeten accedir a recursos d’altres tipus.
</p>

<p>
Per accedir als documents publicats en el WWW o a documents interns de la xarxa corporativa, cal un mecanisme d’adreçament universal. L’<acronym title="Uniform Resource Identifier">URI</acronym> (Uniform Resource Identifier o identificador uniforme de recursos) és el mecanisme d’identificació de recursos universal i té la sintaxi <em>schema:identifier</em> (esquema:identificador). L’esquema descriu la sintaxi utilitzable per l’identificador i pot ser HTTP, HTTPS, <acronym title="File Transfer Protocol">FTP</acronym> o Ghoper, entre d’altres. L’identificador permet determinar el recurs concret dins d’aquest esquema. Usualment, en HTTP s’utilitza un subconjunt de l’<acronym title="Uniform Resource Identifier">URI</acronym> anomenat <acronym title="Uniform Resource Locator">URL</acronym> (Uniform Resource Locator o localitzador uniforme de recursos) per localitzar un recurs. Així, en les barres de navegació trobem <acronym title="Uniform Resource Locator">URL</acronym> com http://www.uoc.es o ftp://ftp.rediris.es, per exemple.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">URI</p>
<p>
Sovint s’utilitzen indistintament <acronym title="Uniform Resource Identifier">URI</acronym> i <acronym title="Uniform Resource Locator">URL</acronym>, tot i que no són el mateix. Un <acronym title="Uniform Resource Identifier">URI</acronym> es pot classificar com un <acronym title="Uniform Resource Locator">URL</acronym>, un URN o ambdós. L’<acronym title="Uniform Resource Identifier">URI</acronym> permet identificar elements globalment, l’<acronym title="Uniform Resource Locator">URL</acronym> localitzar-los i l’URN proporciona un mecanisme d’assignació de noms únic.
</p>
</div></div><div class="iocimportant"><div class="ioccontent">
<p>
La identificació de recursos es realitza mitjançant <acronym title="Uniform Resource Identifier">URI</acronym>, <acronym title="Uniform Resource Locator">URL</acronym> o URN segons correspongui. La sintaxi és la següent:
</p>

<p>
<strong><acronym title="Uniform Resource Identifier">URI</acronym></strong> = Uniform Resource Identifier (esquema:identificador)<br/>

<strong><acronym title="Uniform Resource Locator">URL</acronym></strong> = Uniform Resource Locator (http://www.escoladeltreball.org)<br/>

<strong>URN</strong> = Uniform Resource Name (ietf:rfc:2616)
</p>
</div></div>
<h2><a id="funcionament_del_servei_web" >Funcionament del servei web</a></h2>
<div class="level2">

<p>
El protocol HTTP estructura el diàleg client/servidor en un esquema molt bàsic de petició/resposta. Fins a la versió HTTP 1.0, cada petició/resposta implicava una connexió que s’obria i es tancava en finalitzar la resposta. Amb les millores introduïdes en la versió HTTP 1.1, s’introdueix un mecanisme de connexions persistents. La connexió establerta es pot mantenir un temps oberta per realitzar més peticions dins de la mateixa connexió (per exemple, baixar altres components de la pàgina). La versió 2 incorpora millores per tal de reduir la latència en la càrrega de pàgines web, a apart de mantenir una alta compatibilitat amb la versió anterior.
</p>

<p>
El protocol HTTP és un protocol sense estat (<em>statless</em>). Ni client ni servidor mantenen un estat de sessió a nivell de protocol. Segurament us heu connectat a un servidor de correu web (<em>webmail</em>) i heu establert una sessió d’usuari mentre consulteu el correu. Aquesta sessió no s’implementa a nivell del protocol HTTP, sinó que és responsabilitat del desenvolupador web mantenir l’estat. Això es fa generalment utilitzant tècniques com l’ús de galetes (<em>cookies</em>), passant paràmetres per l’URL, amb camps ocults (típic dels formularis)…
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Connexions persistents</p>
<p>
Les connexions persistents permeten que els múltiples elements d’una pàgina web (que es troben en fitxers diferents) es puguin baixar sense que calgui una connexió per a cada element.
</p>
</div></div><div class="iocimportant"><div class="ioccontent">
<p>
L’<strong>HTTP</strong> és un protocol sense estat que usualment tanca la connexió per a cada petició/resposta.
</p>
</div></div>
</div>

<h3><a id="descripcio_del_dialeg_peticio_resposta" >Descripció del diàleg petició/resposta</a></h3>
<div class="level3">

<p>

En els diàlegs HTTP el client usualment emet una petició al servidor indicant algun dels mètodes que permet el servidor (no necessita implementar-los tots). El servidor emet una resposta i l’acompanya d’un valor d’estatus que indica el tipus de resposta (OK, error…).
</p>

</div>

<h4><a id="peticio_request" >Petició (&#039;request&#039;)</a></h4>
<div class="level4">

<p>
El diàleg HTTP s’inicia quan un client fa una petició (usualment d’una pàgina web) a un servidor (usualment al port 80). Aquest missatge de petició consta d’una primera línia anomenada <em>línia de petició</em>, seguida de capçaleres, una línia en blanc i el cos de la petició:
</p>
<ul>
<li class="level1"><div class="li"> <strong>Línia de petició</strong>: la primera línia d’una petició sempre té la mateixa estructura, per exemple: GET /docums/fitxa.html HTTP/1.1. El primer camp és el mètode a usar (GET significa “petició”), el camp següent és el document a obtenir i el tercer indica la versió del protocol HTTP que s’utilitza. Aquesta primera línia ha d’acabar sempre amb els caràcters CRLF.</div>
</li>
<li class="level1"><div class="li"> <strong>Capçaleres (<em>headers</em>)</strong>: a continuació es troben les capçaleres de la petició. Les capçaleres permeten descriure opcions del client i opcions preferibles del servidor. Per exemple, el client pot indicar el sistema operatiu i el navegador que utilitza, i el servidor ho pot tenir en compte a l’hora d’efectuar la resposta. Hi ha multitud de capçaleres i es recomana consultar el document <acronym title="Request for Comments">RFC</acronym> 2616 (que descriu l’estàndard HTTP) per ampliar-ne la informació. La capçalera <em>Host:</em> és obligatòria en HTTP 1.1 i indica l’<acronym title="Uniform Resource Locator">URL</acronym> del servidor al qual s’adreça la petició.</div>
</li>
</ul>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Components d&#039;una petició</p>
<p>
Els components d’un missatge de petició HTTP són quatre:
</p>
<ul>
<li class="level1"><div class="li"> Línia de petició</div>
</li>
<li class="level1"><div class="li"> Capçaleres</div>
</li>
<li class="level1"><div class="li"> CRLF</div>
</li>
<li class="level1"><div class="li"> Cos</div>
</li>
</ul>
</div></div><div class="ioctext"><div class="ioccontent"><p class="ioctitle">Diferència entre HTTP1.0 i HTTP1.1</p>
<p>
Una de les diferències entre HTTP/1.0 i HTTP/1.1 és que en HTTP/1.1 hi ha una capçalera obligatòria (Host: &lt;nom_servidor&gt;) i en HTTP/1.0 no. Això li permet al servidor saber si la petició és per a ell, i permet implementar seus virtuals.
</p>
</div></div>
<p>
* <strong>CRLF (línia en blanc)</strong>: una línia en blanc separa la part de capçaleres de la petició de la part del cos. Aquest mecanisme està manllevat del format dels missatges de correu, on també s’utilitza una línia en blanc per separar les capçaleres del cos dels missatges.
</p>
<ul>
<li class="level1"><div class="li"> <strong>Cos (body)</strong>: el cos del missatge és opcional i no s’utilitza usualment en les peticions.</div>
</li>
</ul>

</div>

<h4><a id="metodes_de_les_peticions" >Mètodes de les peticions</a></h4>
<div class="level4">

<p>
Les peticions HTTP contenen un mètode en el primer camp de la primera línia. Aquest acostuma a ser GET o POST en les peticions, però n’hi ha més:
</p>
<ul>
<li class="level1"><div class="li"> <strong>HEAD</strong>: igual que GET però únicament sol·licita la capçalera del document. S’utilitza per comprovar l’existència del document.</div>
</li>
<li class="level1"><div class="li"> <strong>GET</strong>: petició al servidor per obtenir el document sol·licitat.</div>
</li>
<li class="level1"><div class="li"> <strong>POST</strong>: envia al servidor informació que ha d’incorporar al recurs de destinació especificat. Un ús habitual és en els formularis, on les dades es passen per POST perquè el servidor les incorpori en el document de destinació indicat.</div>
</li>
<li class="level1"><div class="li"> <strong>PUT</strong>: permet posar en el servidor el document indicat. En lloc de baixar un document, és un mètode per penjar un document en el servidor.</div>
</li>
<li class="level1"><div class="li"> <strong>DELETE</strong>: elimina el document indicat del servidor. Si es deixa, és clar.</div>
</li>
<li class="level1"><div class="li"> <strong>TRACE</strong>: el servidor retorna com a missatge una còpia del missatge tal com li ha arribat. És molt útil per al monitoratge del servei per part del client, ja que pot veure quines transformacions ha patit la seva petició en creuar passarel·les o <em>gateways</em>, servidors intermediaris…</div>
</li>
<li class="level1"><div class="li"> <strong>OPTIONS</strong>: és una sol·licitud d’informació de les opcions de transferència del servidor. El servidor contesta indicant quines són les seves capacitats.</div>
</li>
</ul>

</div>

<h4><a id="resposta" >Resposta</a></h4>
<div class="level4">

<p>
El servidor respon les peticions del client amb missatges que tenen una estructura similar a les peticions. Consten d’una primera línia, anomenada <em>línia d’estatus</em>, seguida de les capçaleres, una línia en blanc i la resposta, que va al final:
</p>
<ul>
<li class="level1"><div class="li"> <strong>Línia d’estatus</strong>: la primera línia d’una resposta té sempre un format com <em>HTTP/1.1 403 Accés prohibit</em>. El primer camp indica el protocol HTTP usat. El segon camp és un valor numèric de tres dígits que indica el tipus de resposta donada. Hi ha una llista exhaustiva de valors d’estatus i de significats. L’últim camp és un text descriptiu de l’estatus.</div>
</li>
<li class="level1"><div class="li"> <strong>Capçaleres (<em>headers</em>)</strong>: la resposta conté totes les capçaleres que el servidor consideri oportú incloure.</div>
</li>
<li class="level1"><div class="li"> <strong>CRLF</strong>: una línia en blanc separa les capçaleres del cos de la resposta.</div>
</li>
<li class="level1"><div class="li"> <strong>Cos (<em>body</em>)</strong>: aquesta part conté el contingut “real” de la resposta pròpiament dit. Així si per exemple s’ha sol·licitat una pàgina web, el contingut a mostrar es troba aquí (tota la pàgina web, no us confongueu amb les etiquetes HEADER i BODY del llenguatge <acronym title="HyperText Markup Language">HTML</acronym>).</div>
</li>
</ul>

</div>

<h4><a id="estatus_de_les_respostes" >Estatus de les respostes</a></h4>
<div class="level4">

<p>
Les respostes contenen un primer camp amb un valor numèric d’estatus. En el document <acronym title="Request for Comments">RFC</acronym> 2616 se’n pot trobar la llista completa, però segons quin sigui el primer dígit es pot fer la classificació següent:
</p>
<ul>
<li class="level1"><div class="li"> 1xx: informació genèrica</div>
</li>
<li class="level1"><div class="li"> 2xx: acció amb èxit, <em>successful</em></div>
</li>
<li class="level1"><div class="li"> 3xx: redirecció</div>
</li>
<li class="level1"><div class="li"> 4xx: error del client</div>
</li>
<li class="level1"><div class="li"> 5xx: error del servidor</div>
</li>
</ul>

</div>

<h3><a id="exemples_de_connexions_http" >Exemples de connexions HTTP</a></h3>
<div class="level3">

<p>
Tot el diàleg client/servidor té forma d’ordres i respostes, com en l’exemple següent de connexió HTTP 1.0 al servidor local. Vegeu com es realitza una connexió HTTP per mitjà d’un Telnet al port 80 d’un servidor HTTP per fer una petició GET d’una pàgina web:
</p>
<pre class="code">root@server:~# telnet localhost 80
Trying 127.0.0.1...
Connected to localhost.
Escape character is &#039;^]&#039;.
GET /index.html HTTP/1.0

HTTP/1.1 200 OK
Date: Mon, 14 Sep 2020 07:59:09 GMT
Server: Apache/2.4.38 (Debian)
Last-Modified: Mon, 07 Sep 2020 20:01:44 GMT
ETag: &quot;a8-5aebeb015df61&quot;
Accept-Ranges: bytes
Content-Length: 168
Vary: Accept-Encoding
Connection: close
Content-Type: text/html

&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Pàgina principal&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;h1&gt;Pàgina principal&lt;/h1&gt;
        &lt;p&gt;Servidor Apache&lt;/p&gt;
    &lt;/body&gt;
&lt;/html&gt;
Connection closed by foreign host.
root@server:~#</pre>

<p>
En l’exemple es pot fer un seguiment dels elements que intervenen en una comunicació HTTP. La petició client és una petició GET, seguida d’una línia en blanc i sense cos (el GET no en requereix). La resposta del servidor comença amb una primera línia d’estatus (el valor 200 indica “OK”), seguida de vuit capçaleres i finalment el cos. El cos de la resposta és la pàgina web <acronym title="HyperText Markup Language">HTML</acronym> que visualitzarà el navegador.
</p>

<p>
Vegeu ara un exemple on el client demana al servidor quines són les ordres o mètodes que implementa:
</p>
<pre class="code">root@server:~# telnet localhost 80
Trying 127.0.0.1...
Connected to localhost.
Escape character is &#039;^]&#039;.
OPTIONS /index.html HTTP/1.0

HTTP/1.1 200 OK
Date: Mon, 14 Sep 2020 08:01:06 GMT
Server: Apache/2.4.38 (Debian)
Allow: GET,POST,OPTIONS,HEAD
Content-Length: 0
Connection: close
Content-Type: text/html

Connection closed by foreign host.
root@server:~# </pre>

<p>
Finalment vegeu la simulació d’una petició POST. S’ha emplenat un formulari amb uns camps (nom, cognom1 i cognom2) i aquests valors es transfereixen per POST al servidor, segurament a un script tipus CGI, JavaScript o ASP.
</p>
<pre class="code">root@server:~# telnet www.ioc.cat 80
Trying 10.0.0.2... 
Connected to www.ioc.cat. 
Escape character is &#039;^]&#039;. 
POST /cgi-bin/script-06.sh HTTP/1.1 
Host: www.ioc.cat 
Content-Type: text/html
Content-Length: 33 

nom=pere&amp;cognom1=pou&amp;cognom2=prat 
HTTP/1.1 200 OK 
Date: Mon, 14 Sep 2020 08:01:06 GMT
Server: Apache/2.4.38 (Debian)
Connection: close 
Transfer-Encoding: chunked 
Content-Type: text/html; charset=UTF-8 
&lt;h1&gt; Llistat dels arguments rebuts&lt;/h1&gt; 
&lt;h2&gt; POST arguments rebuts per sdtin &lt;h2&gt; 
nom=pere&amp;cognom1=pou&amp;cognom2=prat 

Connection closed by foreign host. </pre>

</div>

<h2><a id="instal_lacio_i_configuracio_de_servidors_web" >Instal·lació i configuració de servidors web</a></h2>
<div class="level2">

<p>
El protocol HTTP està estructurat en forma de servei client/servidor. Per tant, cal disposar del programari apropiat per representar cada un d’aquests rols. El programari que fa la funció de client usualment ja està disponible en el sistema operatiu amb aplicacions com, per exemple, els navegadors gràfics Firefox i Chrome o navegadors d’entorn de text com Lynx. És a dir, per disposar de la part client del servei HTTP normalment no cal instal·lar res, perquè tots els sistemes operatius proporcionen almenys un navegador.
</p>

<p>
Així, quan parlem d’instal·lar el servei HTTP fem referència al procés d’instal·lació i configuració del programari del servidor. La instal·lació del programari que proporciona el servei HTTP es fa de manera molt similar a la d’altres serveis de xarxa (com els serveis DHCP, <acronym title="Domain Name System">DNS</acronym> o <acronym title="File Transfer Protocol">FTP</acronym>). Es tracta d’instal·lar el programari de l’aplicació servidor i fer-ne la configuració apropiada. Senzill, oi?
</p>

<p>
Per fer això cal fer les reflexions i passos següents:
</p>
<ul>
<li class="level1"><div class="li"> Quin programari proporciona aquest servei? Quines característiques té? Com es pot adquirir?</div>
</li>
<li class="level1"><div class="li"> Obtenir l’aplicació que proporciona el servei HTTP.</div>
</li>
<li class="level1"><div class="li"> Observar l’estat de la xarxa actual. El servei està ja en funcionament? Existeix ja un servidor HTTP instal·lat i actiu?</div>
</li>
<li class="level1"><div class="li"> Instal·lar l’aplicació servidor.</div>
</li>
<li class="level1"><div class="li"> Comprovar que la instal·lació s’ha efectuat correctament.</div>
</li>
<li class="level1"><div class="li"> Configurar el servei en el servidor i comprovar que els clients hi poden accedir.</div>
</li>
<li class="level1"><div class="li"> Comprovar que el servei funciona correctament.</div>
</li>
</ul>

</div>

<h3><a id="aplicacions_de_servidor_http" >Aplicacions de servidor HTTP</a></h3>
<div class="level3">

<p>
Sempre que l’administrador vol posar en funcionament un nou servei de xarxa cal que primerament analitzi quines aplicacions hi ha al mercat que ofereixen aquest servei. És feina seva estudiar les característiques de les diverses aplicacions, com per exemple avaluar-ne l’eficiència, el cost, el que en diuen altres usuaris… Això es pot fer navegant per Internet, consultant les revistes especialitzades o demanant consell a un expert.
</p>

<p>
Usualment, però, l’administrador acaba utilitzant l’aplicació de servidor HTTP que li proporciona el mateix sistema operatiu. Si utilitzeu Windows, l’empresa Microsoft ofereix una aplicació pròpia, però també en podeu trobar d’altres a Internet. Igualment, si utilitzeu GNU/Linux, segurament la mateixa distribució ja proporciona un servidor HTTP o bé n’existeix algun de clàssic provinent d’Unix. De totes maneres en podeu obtenir d’altres a Internet. 
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Cerca d&#039;HTTP a Internet</p>
<p>
Usualment, l’administrador s’informa per mitjà del seu cercador preferit (per exemple, Google) i de webs com la Viquipèdia. Proveu de buscar “HTTP” o “HTTP server” en aquests serveis.
</p>
</div></div><div class="iocimportant"><div class="ioccontent">
<p>
L’<strong>Apache Server</strong> és un programari de servidor HTTP omnipresent en tots els sistemes operatius avui en dia. Tot i que està basat en GNU/Linux, també és utilitzat pels sistemes operatius de Mac i Windows.
</p>
</div></div><div class="iocnote"><div class="ioccontent">
<p>
Podeu trobar tota la informació d’aquest servidor a <strong>www.apache.org</strong>.
</p>
</div></div>
</div>

<h3><a id="instal_lacio_de_l_aplicacio_servidor" >Instal·lació de l&#039;aplicació servidor</a></h3>
<div class="level3">

<p>
Els usuaris de GNU/Linux poden buscar fàcilment per Internet paquets de servidor HTTP usant eines com yum o apt-get i els repositoris de paquets apropiats segons la distribució que utilitzin. A més, sempre es pot recórrer als cercadors per localitzar el que faci falta.
</p>

<p>
Un cop instal·lat el programari caldrà identificar què s’ha instal·lat. Quins paquets i què contenen. A vegades no s’instal·laran paquets sinó fitxers .tar, el contingut dels quals també caldrà saber examinar. És important saber identificar quins dels components instal·lats corresponen a fitxers executables, quins a fitxers de configuració i quins a fitxers de documentació.
</p>

<p>
Tot servei instal·lat s’ha de configurar apropiadament i posar en marxa. Per tant, caldrà saber gestionar l’estat del servei (engegar, aturar, recarregar…) i definir l’estat que ha de tenir en els diferents <em>runlevels</em> (nivells d’execució) del sistema.
</p>

<p>
En definitiva, el procediment d’instal·lar inclourà usualment:
</p>
<ul>
<li class="level1"><div class="li"> Buscar el programari del servei (sigui en format de paquets .deb, .rpm o .tar) i descarregar-lo utilitzant l’eina apropiada segons quina sigui la distribució que utilitzem.</div>
</li>
<li class="level1"><div class="li"> Examinar el sistema per identificar quin programari, quins paquets, hi ha instal·lats relacionats amb el servei.</div>
</li>
<li class="level1"><div class="li"> Identificar els components del servei. Quins són els fitxers executables, quins els de configuració i quins els de documentació.</div>
</li>
<li class="level1"><div class="li"> Consultar i establir l’estat del servei (engegar i aturar) i saber establir l’estat per defecte per a cada <em>runlevel</em>.</div>
</li>
</ul>

</div>

<h3><a id="configuracio_per_defecte" >Configuració per defecte</a></h3>
<div class="level3">

<p>
El servei HTTP té, en instal·lar-se, una configuració per defecte que acostuma a ser l’apropiada per a un servidor web bàsic. De vegades té els fitxers de configuració buits, de manera que caldrà editar-los abans de posar el servei en funcionament.
</p>

<p>
En qualsevol cas, cal saber identificar cadascun dels conceptes que es descriuen a continuació (es mostren els valors apropiats per al servidor Apache):
</p>
<ul>
<li class="level1"><div class="li"> Nom del servei: apache2, localitzat a /etc/init.d/apache2.</div>
</li>
<li class="level1"><div class="li"> Fitxer de configuració: /etc/apache2/apache2.conf.</div>
</li>
<li class="level1"><div class="li"> Directori de configuracions particulars de mòduls externs: /etc/apache2/mods-available i /etc/apache2/mods-enabled.</div>
</li>
<li class="level1"><div class="li"> Directori de treball del servidor: /etc/apache2.</div>
</li>
<li class="level1"><div class="li"> Directori de publicació del servidor: /var/www/html.</div>
</li>
<li class="level1"><div class="li"> Ubicació de fitxers d’exemple, documentació i pàgines de manual d’on poder obtenir una configuració inicial bàsica.</div>
</li>
</ul>

<p>
La configuració d’un servidor web pot ser molt senzilla o terriblement complexa, tot depèn dels objectius que ens proposem. Per publicar un senzill web estàtic no cal fer altra cosa que copiar els fitxers al directori indicat i utilitzar la configuració per defecte del servidor. Si volem utilitzar diverses seus webs virtuals amb certificats digitals per permetre connexions segures i amb contingut dinàmic, la configuració del servidor esdevé una mica més entretinguda.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
La configuració del servidor web Apache s’estructura en:
</p>
<ul>
<li class="level1"><div class="li"> Secció 1: configuració global</div>
</li>
<li class="level1"><div class="li"> Secció 2: configuració de la seu web principal</div>
</li>
<li class="level1"><div class="li"> Secció 3: configuració de seus virtuals</div>
</li>
</ul>
</div></div>
</div>

<h4><a id="configuracio_global" >Configuració global</a></h4>
<div class="level4">

<p>
En aquesta secció es descriuen aspectes generals del funcionament del servidor, entès com un servei (com un dimoni) del sistema. S’hi descriuen les característiques següents, entre d’altres:
</p>
<ul>
<li class="level1"><div class="li"> Definir l’arrel on hi ha els fitxers de configuració Apache.</div>
</li>
<li class="level1"><div class="li"> Localitzar i observar on es troba el fitxer del PID.</div>
</li>
<li class="level1"><div class="li"> Definir per quines adreces IP i ports escolta el servidor.</div>
</li>
<li class="level1"><div class="li"> Carregar els mòduls dinàmics.</div>
</li>
<li class="level1"><div class="li"> Definir l’usuari i grup amb el qual s’executa Apache.</div>
</li>
</ul>

<p>
Les principals directives del servidor de configuració global del servei són:
</p>
<ul>
<li class="level1"><div class="li"> <strong>ServerRoot</strong>: descriu el directori de treball del servei. Dins d’aquest directori és on hi ha els fitxers de configuració i on s’han generat enllaços simbòlics que permeten enllaçar amb els mòduls, el PID, els <em>logs</em> i els fitxers de configuració particulars de mòduls externs.</div>
</li>
</ul>
<pre class="code">ServerRoot &quot;/etc/apache2&quot;</pre>
<ul>
<li class="level1"><div class="li"> <strong>Include</strong>: descriu el directori per defecte on hi ha més fitxers de configuració a incloure. En lloc de generar un fitxer de configuració molt gran, es crea un fitxer particular per a cada aspecte addicional que cal configurar. Generalment n’hi ha un per a cada mòdul extra que es carrega, per exemple per al SSL, l’LDAP…</div>
</li>
</ul>
<pre class="code">Include conf-enabled/*.conf</pre>
<ul>
<li class="level1"><div class="li"> <strong>Listen</strong>: indica les adreces IP i els ports pels quals escolta el servidor. Per defecte, el servidor escolta pel port 80, corresponent al protocol HTTP, però també se sol fer pel port 8080, pel port 443 en comunicacions HTTPS i per qualsevol altre port diferent que es vulgui usar. Per defecte, escolta per totes les adreces IP del servidor.</div>
</li>
</ul>
<pre class="code">Listen *:80</pre>

<p>
Es poden indicar plantilles per a les adreces IP i per als ports usant el caràcter <em>*</em>. Així, <em>10.0.0.1:*</em> indica escoltar per qualsevol port per a la IP indicada. En canvi, <em>*:8080</em> significa escoltar pel port 8080 per a totes les adreces IP del servidor. Es poden posar tantes directives <em>Listen</em> com facin falta.
</p>
<pre class="code">Listen *:80              #escoltar pel port 80 per a totes les adreces IP
Listen 10.0.0.1:*        #escoltar per tots els ports per a aquesta IP 
Listen 192.168.1.30:443  #escoltar pel port del protocol HTTPS per a l&#039;adreça IP indicada</pre>
<ul>
<li class="level1"><div class="li"> <strong>User</strong> i <strong>Group</strong>: permeten definir l’usuari i el grup amb els quals s’executa el servidor. En aquest cas s’executa com a usuari Apache i grup Apache.</div>
</li>
</ul>
<pre class="code">User apache
Group apache</pre>

<p>
Vegeu l’estructura dels directoris del servidor amb:
</p>

<p>

</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">oot@server:~# tree /etc/apache2</div></li><li class="li1"><div class="de1">/etc/apache2</div></li><li class="li1"><div class="de1">├── apache2.conf</div></li><li class="li1"><div class="de1">├── conf-available</div></li><li class="li1"><div class="de1">│   ├── charset.conf</div></li><li class="li1"><div class="de1">│   ├── javascript-common.conf</div></li><li class="li1"><div class="de1">│   ├── localized-error-pages.conf</div></li><li class="li1"><div class="de1">│   ├── other-vhosts-access-log.conf</div></li><li class="li1"><div class="de1">│   ├── security.conf</div></li><li class="li1"><div class="de1">│   └── serve-cgi-bin.conf</div></li><li class="li1"><div class="de1">├── conf-enabled</div></li><li class="li1"><div class="de1">│   ├── charset.conf -&gt; ../conf-available/charset.conf</div></li><li class="li1"><div class="de1">│   ├── localized-error-pages.conf -&gt; ../conf-available/localized-error-pages.conf</div></li><li class="li1"><div class="de1">│   ├── other-vhosts-access-log.conf -&gt; ../conf-available/other-vhosts-access-log.conf</div></li><li class="li1"><div class="de1">│   ├── security.conf -&gt; ../conf-available/security.conf</div></li><li class="li1"><div class="de1">│   └── serve-cgi-bin.conf -&gt; ../conf-available/serve-cgi-bin.conf</div></li><li class="li1"><div class="de1">├── envvars</div></li><li class="li1"><div class="de1">├── magic</div></li><li class="li1"><div class="de1">├── mods-available</div></li><li class="li1"><div class="de1">│   ├── access_compat.load</div></li><li class="li1"><div class="de1">│   ├── actions.conf</div></li><li class="li1"><div class="de1">│   ├── actions.load</div></li><li class="li1"><div class="de1">&lt;retallat&gt;</div></li><li class="li1"><div class="de1">├── mods-enabled</div></li><li class="li1"><div class="de1">│   ├── access_compat.load -&gt; ../mods-available/access_compat.load</div></li><li class="li1"><div class="de1">│   ├── alias.conf -&gt; ../mods-available/alias.conf</div></li><li class="li1"><div class="de1">│   ├── alias.load -&gt; ../mods-available/alias.load</div></li><li class="li1"><div class="de1">│   ├── auth_basic.load -&gt; ../mods-available/auth_basic.load</div></li><li class="li1"><div class="de1">&lt;retallat&gt;</div></li><li class="li1"><div class="de1">├── ports.conf</div></li><li class="li1"><div class="de1">├── sites-available</div></li><li class="li1"><div class="de1">│   ├── 000-default.conf</div></li><li class="li1"><div class="de1">│   └── default-ssl.conf</div></li><li class="li1"><div class="de1">├── sites-enabled</div></li><li class="li1"><div class="de1">│   ├── 000-default.conf -&gt; ../sites-available/000-default.conf</div></li><li class="li1"><div class="de1">│   └── default-ssl.conf -&gt; ../sites-available/default-ssl.conf</div></li><li class="li1"><div class="de1">└── ssl</div></li><li class="li1"><div class="de1">    ├── apache.crt</div></li><li class="li1"><div class="de1">    └── apache.key</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">7 directories, 196 files</div></li><li class="li1"><div class="de1">root@server:~#</div></li></ol></pre>

</div>

<h4><a id="configuracio_de_la_seu_web_principal" >Configuració de la seu web principal</a></h4>
<div class="level4">

<p>
La segona secció del fitxer de configuració descriu les opcions de funcionament i de publicació de la seu web per defecte o principal del servidor. Les directives usades aquí afecten al web per defecte i s’hereten per a totes les altres seus web (virtuals) que es defineixin en el servidor. S’ha de tenir clar que el servidor web pot servir múltiples seus webs anomenades seus <strong>virtuals</strong> o <em>vhosts</em>. Existeix sempre una seu que és la seu web <strong>principal</strong> o per defecte, a part de les altres seus virtuals que es puguin definir.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
El servidor web configura sempre almenys una seu web <strong>principal</strong> amb independència del fet que es configurin altres seus <strong>virtuals</strong>.
</p>

<p>
Les opcions definides en aquesta segona secció:
</p>
<ul>
<li class="level1"><div class="li"> Afecten a la seu web principal.</div>
</li>
<li class="level1"><div class="li"> Les hereten per defecte totes les altres seus webs virtuals.</div>
</li>
</ul>
</div></div>
<p>
S’hi descriuen les característiques següents, entre d’altres:
</p>

<p>
<strong>DocumentRoot</strong>: estableix el direcori de publicació de la seu web principal o per defecte. Els clients que es connectin a l’<acronym title="Uniform Resource Locator">URL</acronym> indicat per <em>ServerName</em> podran accedir al contingut de <em>DocumentRoot</em>. És dins d’aquest directori que hi haurà el típic fitxer index.html i la resta de fitxers i directoris que formen el web principal.
</p>
<pre class="code">DocumentRoot &quot;/var/www/html&quot;</pre>

<p>
<strong>Directory</strong>: per a cada directori que calgui configurar es pot definir un bloc d’opcions de configuració agrupades en aquesta directva. Evidentment, les opcions afecten al directori i també s’hereten per als seus subdirectoris. Cal parar atenció en el fet que el directori a indicar és una ruta absoluta de l’arbre de directoris físic del sistema i no una ruta relativa lògica de l’estructura del web.
</p>
<pre class="code xml"><ol><li class="li1"><div class="de1">&lt;Directory /&gt;</div></li><li class="li1"><div class="de1">    Options FollowSymLinks</div></li><li class="li1"><div class="de1">    AllowOverride None</div></li><li class="li1"><div class="de1">    Options +Includes</div></li><li class="li1"><div class="de1">    XBitHack On</div></li><li class="li1"><div class="de1">&lt;/Directory&gt;</div></li><li class="li1"><div class="de1">&lt;Directory &quot;/var/www/html&quot;&gt;</div></li><li class="li1"><div class="de1">    Options Indexes FollowSymLinks</div></li><li class="li1"><div class="de1">    AllowOverride None</div></li><li class="li1"><div class="de1">    Order allow,deny</div></li><li class="li1"><div class="de1">    Allow from all</div></li><li class="li1"><div class="de1">    XBitHack On</div></li><li class="li1"><div class="de1">&lt;/Directory&gt;</div></li><li class="li1"><div class="de1">&lt;IfModule mod_userdir.c&gt;</div></li><li class="li1"><div class="de1">    UserDir disabled</div></li><li class="li1"><div class="de1">&lt;/IfModule&gt;</div></li></ol></pre>

<p>
<strong>DirectoryIndex</strong>: en l’exemple següent es pot veure com es defineixen els documents a mostrar per defecte quan se solicita un <acronym title="Uniform Resource Locator">URL</acronym> i no s’especifica el document.
</p>
<pre class="code">DirectoryIndex index.html index.html.var</pre>

<p>
<strong>htaccess</strong>: a banda de les directives <em>Directory</em> es pot usar un altre mètode per establir opcions de configuració per a un directori determinat i per a tots els seus subdirectoris. Consisteix a posar un fitxer de configuració .htaccess a cada directori a configurar específicament. El fitxer conté les opcions específiques per al directori i els seus subdirectoris. Evidentment, aquest fitxer s’ha de protegir perquè no sigui descarregat pels clients.
</p>
<pre class="code">AccessFileName .htaccess
&lt;Files ~ &quot;^\.ht&quot;&gt;
    Order allow,deny
    Deny from all
&lt;/Files&gt;</pre>

<p>
<strong>mime</strong>: indica com s’identifiquen els tipus MIME.
</p>
<pre class="code">TypesConfig /etc/mime.types
DefaultType text/plain
&lt;IfModule mod_mime_magic.c&gt;
    MIMEMagicFile conf/magic
&lt;/IfModule&gt;</pre>

<p>
<strong>Logs</strong>: defineix el fitxer de registre o <em>logs</em>, el nivell dels <em>logs</em> o <em>loglevel</em> i el format en el qual s’hi han de desar les entrades.
</p>
<pre class="code">ErrorLog logs/error_log
LogLevel warn
LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot;&quot; combined
LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b&quot; common
LogFormat &quot;%{Referer}i -&gt; %U&quot; referer
LogFormat &quot;%{User-agent}i&quot; agent
CustomLog logs/access_log combined</pre>

<p>
<strong>cgi-bin</strong>: defineix el directori que conté els scripts executables CGI i n’especifica les opcions de funcionament.
</p>
<pre class="code">ScriptAlias /cgi-bin/ &quot;/var/www/cgi-bin/&quot;
&lt;Directory &quot;/var/www/cgi-bin&quot;&gt;
    AllowOverride None
    Options None
    Order allow,deny
    Allow from all
&lt;/Directory&gt;</pre>

<p>
<strong>server-status</strong> i <strong>server-info</strong>: activen i defineixen el funcionament del monitoritge integrat en el servidor web Apache. Permeten observar detalladament la configuració del servidor i el seu estat actual. Cal activar aquestes funcionalitats per a cada seu web de la qual es vulgui fer el seguiment.
</p>
<pre class="code">&lt;Location /server-status&gt;
    SetHandler server-status
    Order deny,allow
    Deny from all
    Allow from www.ioc.cat portatil localhost
&lt;/Location&gt;
&lt;Location /server-info&gt;
    SetHandler server-info
    Order deny,allow
    Deny from all
    Allow from www.ioc.cat portatil localhost
&lt;/Location&gt;</pre>

<p>
Depenent de la versió d’Apache i distribució de Linux, ens hem d’assegurar que aquests mòduls estan habilitats. Es pot consultar i habilitar amb la comanda <em>a2enmod</em>.
</p>
<pre class="code">root@server:/etc/apache2# a2enmod info
Enabling module info.
To activate the new configuration, you need to run:
  systemctl restart apache2
root@server:/etc/apache2# a2enmod status
Module status already enabled
root@server:/etc/apache2#</pre>

</div>

<h4><a id="configuracio_de_seus_virtuals" >Configuració de seus virtuals</a></h4>
<div class="level4">

<p>
En aquesta secció es descriuen les seus virtuals que ha d’atendre el servidor. Cal una entrada VirtualHost per a cada web a servir.
</p>
<div class="iocreference"><div class="ioccontent">
<p>
Les seus virtuals o <em>virtualhosts</em> es descriuen àmpliament en l’apartat “Creació i configuració de llocs web virtuals”.
</p>
</div></div>
<p>
<strong>VirtualHost</strong>: descriu una seu web virtual indicant la seva adreça IP i port associats. Es defineix el nom del servei i el directori de publicació per a aquest servei.
</p>
<pre class="code">&lt;VirtualHost www.ioc.cat:80&gt;
    ServerAdmin webmaster@ioc.cat
    DocumentRoot /var/www/html
    ServerName www.ioc.cat
    ErrorLog logs/www.ioc.cat-error_log
    CustomLog logs/www.ioc.cat-access_log common
&lt;/VirtualHost&gt;</pre>

</div>

<h3><a id="exemple_de_configuracio_basica" >Exemple de configuració bàsica</a></h3>
<div class="level3">

<p>
Un cop instal·lat el servidor és molt fàcil posar en funcionament la seu web principal del servidor. Simplement cal:
</p>
<ul>
<li class="level1"><div class="li"> Establir el lligam o <em>bind</em> amb la directiva <em>Listen</em> per indicar les IP i ports per on servir. De fet, es pot deixar el valor per defecte “*:80” si es vol atendre per totes les IP.</div>
</li>
<li class="level1"><div class="li"> Indicar el nom del servei amb la directiva <em>ServerName</em>.</div>
</li>
<li class="level1"><div class="li"> Poblar el directori de publicació amb els continguts del web.</div>
</li>
<li class="level1"><div class="li"> Assegurar-se que la resolució de noms <acronym title="Domain Name System">DNS</acronym> identifica correctament el nom del servei amb alguna de les IP del servidor. </div>
</li>
</ul>

<p>
Per fer proves es pot usar la resolució de noms locals via /etc/hosts:
</p>
<pre class="code">root@server:~# cat /etc/hosts
192.168.1.30	ioc www.ioc.cat
# ping www.ioc.cat</pre>

<p>
Configuració del servidor:
</p>
<pre class="code">Listen *:80
ServerAdmin root@localhost
ServerName www.ioc.cat:80
UseCanonicalName Off
DocumentRoot &quot;/var/www/html&quot;</pre>

<p>
Arrencada del servei:
</p>

<p>

</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">root@server:~# service apache2 start</div></li><li class="li1"><div class="de1">root@server:~# service apache2 status</div></li><li class="li1"><div class="de1">• apache2.service - The Apache HTTP Server</div></li><li class="li1"><div class="de1">   Loaded: loaded (/lib/systemd/system/apache2.service; enabled; vendor preset: enabled)</div></li><li class="li1"><div class="de1">   Active: active (running) since Tue 2020-09-15 08:48:33 CEST; 6s ago</div></li><li class="li1"><div class="de1">     Docs: https://httpd.apache.org/docs/2.4/</div></li><li class="li1"><div class="de1">  Process: 3711 ExecStart=/usr/sbin/apachectl start (code=exited, status=0/SUCCESS)</div></li><li class="li1"><div class="de1"> Main PID: 3715 (apache2)</div></li><li class="li1"><div class="de1">    Tasks: 55 (limit: 1138)</div></li><li class="li1"><div class="de1">   Memory: 10.0M</div></li><li class="li1"><div class="de1">   CGroup: /system.slice/apache2.service</div></li><li class="li1"><div class="de1">           ├─3715 /usr/sbin/apache2 -k start</div></li><li class="li1"><div class="de1">           ├─3716 /usr/sbin/apache2 -k start</div></li><li class="li1"><div class="de1">           └─3717 /usr/sbin/apache2 -k start</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">de set. 15 08:48:32 server.ioc.cat systemd[1]: Starting The Apache HTTP Server...</div></li><li class="li1"><div class="de1">de set. 15 08:48:33 server.ioc.cat apachectl[3711]: AH00557: apache2: apr_sockaddr_info_get() failed for </div></li><li class="li1"><div class="de1">de set. 15 08:48:33 server.ioc.cat apachectl[3711]: AH00558: apache2: Could not reliably determine the se</div></li><li class="li1"><div class="de1">de set. 15 08:48:33 server.ioc.cat systemd[1]: Started The Apache HTTP Server.</div></li><li class="li1"><div class="de1">root@server:/etc/apache2#</div></li></ol></pre>

</div>

<h4><a id="comprovacio_del_funcionament" >Comprovació del funcionament</a></h4>
<div class="level4">

<p>
Per validar el funcionament n’hi ha prou d’utilitzar qualsevol navegador client i connectar-se localment a qualsevol de les adreces IP del servidor o al <em>ServerName</em> definit per al servidor principal (l’únic configurat actualment).
</p>
<pre class="code">[user@host]# telnet www.ioc.cat 80</pre>

<p>
Per defecte, el servidor web Apache mostra una pàgina preparada expressament per quan encara no hi ha contingut web en el directori de publicació. Aquesta pàgina serveix de test per verificar el funcionament del servidor, tal com es pot observar en la <span class="figref"><a href="#Figure1.1"><span>figura</span></a></span>. Aquesta pàgina es mostra quan es contacta el servidor i encara no s’ha definit cap seu web pròpia.
</p>
<div class="iocfigure"><a name="Figure1.1"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Pàgina per defecte del servidor web Apache

</figcaption><img src="../media/apache-pagina-principal.png" alt="" /></figure>
<div class="footfigure"> </div></div>
</div>

<h4><a id="pagina_de_prova_propia" >Pàgina de prova pròpia</a></h4>
<div class="level4">

<p>
Finalment, es pot realitzar una pàgina <acronym title="HyperText Markup Language">HTML</acronym> de prova pròpia per verificar que el servidor accedeix al directori de publicació i la mostra correctament. La pàgina ha de tenir el nom <em>index.html</em> o un dels noms definits com a nom de document per defecte.
</p>

<p>
El llistat de la pàgina i la seva ubicació:
</p>
<pre class="code">[root@host]# cat /var/www/html/index.html
&lt;html&gt;
&lt;head&gt;&lt;title&gt;Prova&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
  &lt;h1&gt;Això és una prova de pàgina web&lt;/h1&gt;
  &lt;p&gt;Aquí es pot escriure un paràgraf molt més interessant que aquest.&lt;p&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</div>

<h2><a id="moduls_dinamics" >Mòduls dinàmics</a></h2>
<div class="level2">

<p>
En fer la instal·lació del servidor s’han identificat els fitxers de configuració i l’executable del servei, httpd.conf i a l’httpd respectivament. Però aquests no són els únics fitxers de configuració i programari executable del servidor web. Sovint la funcionalitat del servidor web s’incrementa afegint-li noves funcions, com per exemple l’autenticació d’usuaris via PAM o LDAP, la incorporació de certificats digitals, comunicacions segures amb SSL… Cada una d’aquestes noves funcionalitats pot requerir programari addicional i noves directives de configuració. 
</p>

<p>
Antigament, els fitxers de configuració creixien i creixien fins a “rebentar”, cosa que dificulta la capacitat de l’administrador per governar-los i sobretot per tenir-los estructurats i fàcilment modificables. Avui en dia la majoria de serveis permeten estendre la seva funcionalitat en mòduls separats i amb fitxers de configuració que es mantenen a part i es carreguen mitjançant un <em>Include</em> en el fitxer de configuració principal.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Els <strong>mòduls</strong> permeten estendre la funcionalitat del servidor web proporcionant noves “peces” de programari. 
</p>

<p>
La configuració del servei per mitjà de mòduls permet:
</p>
<ul>
<li class="level1"><div class="li"> Carregar peces de programari, mòduls encarregats de fer funcions específiques que extenen les funcionalitats del servidor web.</div>
</li>
<li class="level1"><div class="li"> Disposar de fitxers de configuració separats per a cada mòdul, cosa que facilita l’organització estructurada de la configuració.</div>
</li>
</ul>
</div></div>
<p>
S’han d’entendre els mòduls com un mecanisme de bocins de programari (a la manera del joc de construcció Lego) que es poden afegir i treure de la configuració actual per tal de seleccionar les prestacions i funcions que es volen proporcionar pel servidor. Podem dividir els mòduls en dues categories:
</p>
<ul>
<li class="level1"><div class="li"> <strong>Estàtics</strong>: el servidor web Apache que s’ha posat en funcionament ja té diversos mòduls carregats i executant-se des de bon principi. De fet, l’executable del servei, el dimoni httpd, s’ha compilat i se li han incorporat uns determinats mòduls (els responsables de fabricar el paquet per a la distribució que s’estigui utilitzant són qui els han seleccionat). Si es volgués disposar d’altres mòduls caldria compilar de nou l’executable del servidor.</div>
</li>
</ul>
<pre class="code"># Llistat dels mòduls compilats
root@server:~# apache2 -l
Compiled in modules:
  core.c
  mod_so.c
  mod_watchdog.c
  http_core.c
  mod_log_config.c
  mod_logio.c
  mod_version.c
  mod_unixd.c
root@server:~# </pre>
<ul>
<li class="level1"><div class="li"> <strong>Dinàmics</strong>: a part dels mòduls estàtics que incorpora el servidor es poden afegir els mòduls dinàmics o <strong>Dinamyc Shared Objects</strong> que calguin. Des del fitxer de configuració global es poden afegir mòduls i també es poden afegir des del directori de configuracions específiques.</div>
</li>
</ul>
<pre class="code"># Llistat de mòduls carregats: estàtics i dinàmics
root@server:~# source /etc/apache2/envvars 
root@server:/root# apache2 -M
Loaded Modules:
 core_module (static)
 so_module (static)
 watchdog_module (static)
 http_module (static)
 log_config_module (static)
 logio_module (static)
 version_module (static)
 unixd_module (static)
 access_compat_module (shared)
 alias_module (shared)
 auth_basic_module (shared)
 authn_core_module (shared)
 authn_file_module (shared)
 authz_core_module (shared)
 authz_host_module (shared)
 authz_user_module (shared)
 autoindex_module (shared)
 deflate_module (shared)
 dir_module (shared)
 ...</pre>

<p>
És convenient saber usar les eines que proporciona el servei per interrogar-lo. Hem de ser capaços de:
</p>
<ul>
<li class="level1"><div class="li"> Identificar la versió del servidor.</div>
</li>
<li class="level1"><div class="li"> Identificar les opcions amb què s’ha compilat el servidor.</div>
</li>
<li class="level1"><div class="li"> Llistar els mòduls estàtics.</div>
</li>
<li class="level1"><div class="li"> Llistar els mòduls dinàmics.</div>
</li>
<li class="level1"><div class="li"> Llistar les directives actives.</div>
</li>
<li class="level1"><div class="li"> Monitorar tot el servei usant el recurs web propi <em>server-status</em>.</div>
</li>
</ul>
<pre class="code"># Versió d&#039;HTTP
root@server:~# apache2 -v
Server version: Apache/2.4.38 (Debian)
Server built:   2019-10-15T19:53:42

# Llistat de la versió de servidor i les opcions amb les quals s&#039;ha compilat
root@server:~# apache2 -V
[Tue Sep 15 09:17:49.993943 2020] [core:warn] [pid 5272] AH00111: Config variable ${APACHE_RUN_DIR} is not defined
apache2: Syntax error on line 80 of /etc/apache2/apache2.conf: DefaultRuntimeDir must be a valid directory, absolute or relative to ServerRoot
Server version: Apache/2.4.38 (Debian)
Server built:   2019-10-15T19:53:42
Server&#039;s Module Magic Number: 20120211:84
Server loaded:  APR 1.6.5, APR-UTIL 1.6.1
Compiled using: APR 1.6.5, APR-UTIL 1.6.1
Architecture:   64-bit
Server MPM:     
Server compiled with....
 -D APR_HAS_SENDFILE
 -D APR_HAS_MMAP
 -D APR_HAVE_IPV6 (IPv4-mapped addresses enabled)
 -D APR_USE_SYSVSEM_SERIALIZE
 -D APR_USE_PTHREAD_SERIALIZE
 -D SINGLE_LISTEN_UNSERIALIZED_ACCEPT
 -D APR_HAS_OTHER_CHILD
 -D AP_HAVE_RELIABLE_PIPED_LOGS
 -D DYNAMIC_MODULE_LIMIT=256
 -D HTTPD_ROOT=&quot;/etc/apache2&quot;
 -D SUEXEC_BIN=&quot;/usr/lib/apache2/suexec&quot;
 -D DEFAULT_PIDLOG=&quot;/var/run/apache2.pid&quot;
 -D DEFAULT_SCOREBOARD=&quot;logs/apache_runtime_status&quot;
 -D DEFAULT_ERRORLOG=&quot;logs/error_log&quot;
 -D AP_TYPES_CONFIG_FILE=&quot;mime.types&quot;
 -D SERVER_CONFIG_FILE=&quot;apache2.conf&quot;

# Llistat de les directives
root@server:~# source /etc/apache2/envvars 
root@server:/root# apache2 -L
&lt;Directory (core.c)
	Container for directives affecting resources located in the specified directories
	Allowed in *.conf only outside &lt;Directory&gt;, &lt;Files&gt;, &lt;Location&gt;, or &lt;If&gt;
&lt;Location (core.c)
	Container for directives affecting resources accessed through the specified URL paths
	Allowed in *.conf only outside &lt;Directory&gt;, &lt;Files&gt;, &lt;Location&gt;, or &lt;If&gt;
&lt;VirtualHost (core.c)
	Container to map directives to a particular virtual host, takes one or more host addresses
	Allowed in *.conf only outside &lt;Directory&gt;, &lt;Files&gt;, &lt;Location&gt;, or &lt;If&gt;
&lt;Files (core.c)
	Container for directives affecting files matching specified patterns
	Allowed in *.conf anywhere and in .htaccess
	when AllowOverride isn&#039;t None
...</pre>

</div>

<h3><a id="examinar_els_moduls_dinamics" >Examinar els mòduls dinàmics</a></h3>
<div class="level3">

<p>
En instal·lar els paquets del servei s’han instal·lat tot de mòduls en el directori específic de mòduls del servei httpd. Usualment aquest directori és /usr/lib/apache2/modules. Es pot fer un llistat d’aquest directori per observar quins mòduls externs hi ha instal·lats en el sistema.
</p>
<pre class="code">root@server:/# ls -l /usr/lib/apache2/modules | head -5
total 4040
-rw-r--r-- 1 root root  15742 Oct 15  2019 httpd.exp
-rw-r--r-- 1 root root  14384 Oct 15  2019 mod_access_compat.so
-rw-r--r-- 1 root root  14384 Oct 15  2019 mod_actions.so
-rw-r--r-- 1 root root  18480 Oct 15  2019 mod_alias.so
root@server:/#</pre>

<p>
Tots aquests mòduls estan carregats al servidor? No necessàriament. Estan instal·lats, però que estiguin actualment en funcionament en el servidor depèn de si s’han carregat o no des de la configuració del servidor. La directiva <strong>LoadModule</strong> permet carregar mòduls dinàmics des d’algun dels fitxers de configuració del servei.
</p>
<pre class="code">LoadModule auth_basic_module modules/mod_auth_basic.so</pre>

<p>
Aquest és un extracte dels mòduls carregats en el fitxer de configuració principal apache2.conf. Podem observar, per exemple, que es carreguen els mòduls d’autenticació bàsica, <em>digest</em>, <em>file</em>, LDAP…
</p>
<pre class="code">LoadModule auth_basic_module modules/mod_auth_basic.so
LoadModule auth_digest_module modules/mod_auth_digest.so</pre>

<p>
No tots els mòduls que es carreguen s’indiquen en el fitxer de configuració principal apache2.conf. Per facilitar l’administració del servei, el fitxer de configuració es pot repartir en petits fitxers que en configurin aspectes concrets. Dividir la configuració per funcionalitats separades és molt pràctic perquè li permet a l’administrador governar cada aspecte per separat i perquè evita que el fitxer de configuració principal esdevingui un fitxer massa extens per ser manipulat amb facilitat.
</p>

<p>
Tal com s’ha pogut observar en fer la instal·lació, existeixen dos directoris, <strong>apache2/conf-available</strong> i <strong>apache2/conf-enabled</strong>, que contenen els fitxers de configuració de mòduls i de funcionalitats que s’han segregat del fitxer de configuració principal, essent el darrer el de la configuració activa. No només té fitxers de configuració de mòduls, sinó que l’administrador també pot decidir segregar en fitxers a part aquells aspectes que vol governar per separat. Això li permet la flexibilitat d’incorporar-los o no a la configuració en execució simplement incloent-los o no.
</p>

<p>
Apache proporciona un sistema disponible/actiu (available/enabled) que permet tenir diferents configuracions preparades per a configuracions, mòduls i seus virtuals que permet activar i desactivar d’una manera més còmode (en comptes d’esborrar, reanomenar, etc.). al mateix fitxer de configuració principal està explicat com a comentari, i les respectives comandes per activar i desactivar:
</p>
<pre class="code"># * Configuration files in the mods-enabled/, conf-enabled/ and sites-enabled/
#   directories contain particular configuration snippets which manage modules,
#   global configuration fragments, or virtual host configurations,
#   respectively.
#
#   They are activated by symlinking available configuration files from their
#   respective *-available/ counterparts. These should be managed by using our
#   helpers a2enmod/a2dismod, a2ensite/a2dissite and a2enconf/a2disconf. See
#   their respective man pages for detailed information.</pre>

<p>
La directiva <em>Include</em> del fitxer de configuració global és l’encarregada de carregar tots els fitxers de configuració extres que hi ha al directori apache2/conf-enabled. En l’exemple ve amb la directiva <em>IncludeOptional</em> que fa el mateix que <em>Include</em>, però que si hi ha algun error en no trobar els fitxers de configuració, ho ignora.
</p>
<pre class="code"># Include generic snippets of statements
IncludeOptional conf-enabled/*.conf</pre>
<div class="iocimportant"><div class="ioccontent">
<p>
En resum, podem dir que els mòduls <strong>instal·lats</strong> es troben en un directori específic tipus <em>usr/lib/apache2/modules</em>. Que estiguin instal·lats no significa que estiguin carregats i en funcionament.
</p>

<p>
Els mòduls es carreguen directament des del fitxer de configuració apache2.conf mitjançant directives <strong>LoadModule</strong>, indicant el nom del mòdul i la seva ubicació.
</p>

<p>
També es poden carregar des de fitxers de configuració específics, situats típicament en el directori apache2/conf-enabled. Els fitxers que conté poden configurar diversos aspectes de la funcionalitat del servidor i també poden, si cal, carregar mòduls usant la directiva <em>LoadModule</em>.
</p>
</div></div>
<p>
El millor mecanisme per observar els mòduls carregats i la configuració de les directives i opcions que proporcionen és consultar el mateix web de monitoratge que proporciona el servidor web a l’adreça <strong><em>server-status</em></strong>, tal com podeu veure en la <span class="figref"><a href="#Figure2.1"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figure2.1"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Pantalla d’informació de l’estat del servidor

</figcaption><img src="../media/apache-server-status.png" alt="" /></figure>
</div>
</div>

<h2><a id="creacio_i_configuracio_de_llocs_web_virtuals" >Creació i configuració de llocs web virtuals</a></h2>
<div class="level2">

<p>
El servidor web s’ha configurat mitjançant el fitxer de configuració global per escoltar per un conjunt de ports i per a un conjunt d’adreces IP amb la directiva <em>Listen</em> i ha rebut un nom mitjançant la directiva <em>ServerName</em>. Aquest és el nom amb el qual s’identifica el servei principal o per defecte. La majoria de servidors en tenen prou amb una configuració com aquesta, ja que disposen d’una sola seu web. Ara bé, el servidor pot tenir més d’una seu web, ja sigui perquè té múltiples adreces IP o perquè té una adreça IP amb múltiples seus web.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
En la terminologia d’Apache s’anomena <strong><em>virtual host</em></strong> o <em>vhost</em> a cada un dels servidors virtuals que hi ha en funcionament a banda del servidor principal o per defecte.
</p>
<ul>
<li class="level1"><div class="li"> Quan s’assignen servidors virtuals diferents a adreces IP diferents es parla de <strong>servidors virtuals basats en IP</strong> o <em>IP-Based vhosts</em>.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> Quan s’assignen múltiples seus virtuals a una mateixa adreça IP es parla de <strong>servidors virtuals basats en nom</strong> o <em>Name-Based vhosts</em>.</div>
</li>
</ul>
</div></div>
<p>
Per a cada seu virtual que es defineix cal utilitzar un bloc de configuració de la directiva <em>VirtualHost</em>:
</p>
<pre class="code">&lt;VirtualHost www.ioc.cat:80&gt;
    ServerAdmin webmaster@www.ioc.cat
    DocumentRoot /var/www/www.ioc.cat
    ServerName ioc.cat
    ErrorLog logs/ioc.cat-error_log
    CustomLog logs/ioc.cat-access_log common
&lt;/VirtualHost&gt;</pre>

<p>
Cal recordar que a part de les seus virtuals que es defineixin hi ha sempre una seu global o principal. Existeixen mecanismes per desactivar-la, però no els tractarem aquí.
</p>

<p>
Fem una anàlisi detallada de les principals opcions de configuració necessàries per definir una seu virtual:
</p>
<ul>
<li class="level1"><div class="li"> <strong>VirtualHost</strong>: aquesta directiva és la que fa el <em>bind</em>, el lligam amb l’adreça IP i port assignats a la seu virtual. Tot i que, per claredat, en l’exemple s’ha indicat un nom d’amfitrió (<em>host</em>) en lloc d’una adreça IP, Apache recomana usar sempre l’adreça IP.</div>
</li>
<li class="level1"><div class="li"> <strong>ServerAdmin</strong>: indica el nom de l’administrador de la seu virtual. De fet, n’indica el correu electrònic.</div>
</li>
<li class="level1"><div class="li"> <strong>DocumentRoot</strong>: defineix el directori de publicació de la seu web virtual. El directori que s’indica és una ruta absoluta del sistema físic de fitxers, no una ruta relativa del servidor web.</div>
</li>
<li class="level1"><div class="li"> <strong>ServerName</strong>: és el nom virtual amb el qual es reconeix aquest web, el nom que els clients han de referenciar per poder accedir al web.</div>
</li>
<li class="level1"><div class="li"> <strong>errorLog</strong> i <strong>CustomLog</strong>: aquestes dues directives especifiquen la ubicació dels fitxers de registre o <em>logs</em> de monitoratge de l’activitat d’aquesta seu web. Les rutes que s’hi indiquen són relatives i s’utilitza el directori de <em>logs</em> definit en la configuració global.</div>
</li>
</ul>
<div class="ioctextl"><div class="ioccontent"><p class="ioctitle">El problema dels fitxers de registre</p>
<p>
En els exemples es pot observar que per a cada seu web es defineixen dos fitxers de registre (en poden ser tants com calgui). Si el servidor té en funcionament força seus virtuals amb un trànsit de xarxa normal, pot succeir que de tants fitxers de <em>log</em> com té s’acabin esgotant els <em>file descriptors</em> del sistema. 
</p>

<p>
El nombre de fitxers que pot tenir oberts un sistema és limitat. Si se supera, el sistema es bloqueja. És a dir, que realment no és difícil que això acabi provocant un problema.
</p>
</div></div>
<p>
L’exemple següent mostra un llistat de seus web virtuals d’un mateix servidor. Observeu el següent:
</p>
<div class="iocreference"><div class="ioccontent">
<p>
Vegeu a l’apartat “Monitoratge del servei” com gestionar aquestes situacions.
</p>
</div></div><ul>
<li class="level1"><div class="li"> La seu virtual www.ioc.cat està lligada a les adreces  11.0.0.3:80, 11.0.0.2:80, 11.0.0.1:80 i 10.0.0.1:80. </div>
</li>
<li class="level1"><div class="li"> La seu virtual www.inf.ioc.cat està lligada a l’adreça 10.0.0.2:80. </div>
</li>
<li class="level1"><div class="li"> L’adreça IP 10.0.0.3:80 conté diverses seus virtuals <em>Name-Based</em>. Concretament, www.virtual.cat i www.ioc-virtual.cat. La primera actua com a seu per defecte per a aquesta adreça IP.</div>
</li>
<li class="level1"><div class="li"> L’adreça IP 10.0.0.1:80 té també diverses seus virtuals <em>Name-Based</em>. Són www.ioc.cat i www.institut.cat. El servidor sempre utilitza la primera que s’ha definit en el fitxer de configuració com a seu per defecte de l’adreça IP.</div>
</li>
</ul>
<pre class="code">root@server:/# apache2 -S
VirtualHost configuration: 
11.0.0.3:80            www.ioc.cat (/etc/apache2/apache2.conf:1022) 

10.0.0.2:80            www.inf.ioc.cat (/etc/apache2/apache2.conf:1050) 

10.0.0.3:80            is a NameVirtualHost 
         default server www.virtual.cat (/etc/apache2/apache2.conf:1067) 
         port 80 namevhost www.virtual.cat (/etc/apache2/apache2.conf:1067) 
         port 80 namevhost www.ioc-virtual.cat (/etc/apache2/apache2.conf:1075) 

11.0.0.2:80            www.ioc.cat (/etc/apache2/apache2.conf:1022) 

11.0.0.1:80            www.ioc.cat (/etc/apache2/apache2.conf:1022) 

10.0.0.1:80            is a NameVirtualHost 
         default server www.ioc.cat (/etc/apache2/apache2.conf:1022) 
         port 80 namevhost www.ioc.cat (/etc/apache2/apache2.conf:1022) 
         port 80 namevhost www.institut.cat (/etc/apache2/apache2.conf:1031) 
ServerRoot: &quot;/etc/apache2&quot;
Main DocumentRoot: &quot;/var/www/html&quot;
Main ErrorLog: &quot;/var/log/apache2/error.log&quot;
Mutex default: dir=&quot;/var/run/apache2/&quot; mechanism=default 
Mutex watchdog-callback: using_defaults
PidFile: &quot;/var/run/apache2/apache2.pid&quot;
Define: DUMP_VHOSTS
Define: DUMP_RUN_CFG
User: name=&quot;www-data&quot; id=33
Group: name=&quot;www-data&quot; id=33</pre>

</div>

<h3><a id="seus_virtuals_basades_en_ip" >Seus virtuals basades en IP</a></h3>
<div class="level3">

<p>
El servidor web té la capacitat d’oferir serveis webs diferents a adreces IP diferents. De fet, pot oferir serveis diferents per a tantes combinacions IP:port com faci falta. Caldrà un bloc de configuració <em>VirtualHost</em> per a cada seu web. Si a cada una d’aquestes diferents combinacions IP:port s’hi vol accedir amb un nom de seu web caldrà que la resolució <acronym title="Domain Name System">DNS</acronym> es faci apropiadament (globalment amb <acronym title="Domain Name System">DNS</acronym> o localment amb /etc/hosts).
</p>

<p>
Per definir servidors virtuals, <em>vhosts</em> en la terminologia Apache, basats en les adreces IP, cal usar la directiva:
</p>
<pre class="code">&lt;VirtualHost adreça-ip:port&gt;
... configuració de la seu virtual ...
&lt;/VirtualHost&gt;</pre>

<p>
<strong>adreça-IP</strong>: es recomana escriure l’adreça IP i no el nom de la seu web per indicar a quina adreça es lliga aquest <em>vhost</em>. També és vàlid escriure el nom de la seu, però això implica una doble resolució. Es pot usar el metacaràcter asterisc, (*), per indicar que s’escolta per totes les adreces IP, tot i que sembla un contrasentit, ja que precisament s’estan definint <em>IP-Based vhosts</em>. Usar l’asterisc pot tenir sentit si s’utilitza conjuntament amb ports diferents que permetin generar combinacions IP:port diferents.
</p>

<p>
<strong>port</strong>: indica el port associat al servidor virtual per l’adreça IP donada. També es pot usar el metacaràcter <em>*</em> per indicar qualsevol port. En aquest cas les diferents seus virtuals han de diferir d’adreça IP.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Per a cada seu virtual o <strong>vhost</strong> diferent que es vol implementar caldrà una directiva <strong><em>VirtualHost</em></strong>.
</p>

<p>
La combinació <strong>adreça-IP:port</strong> permet establir l’associació de la seu virtual amb una combinació d’adreça IP més port. Es poden especificar múltiples associacions i es pot usar el metacaràcter <em>*</em>. 
</p>
</div></div>
<p>
Es poden combinar múltiples expressions del tipus <em>adreça-IP:port</em> en cada sentència <em>VirtualHost</em>.
</p>

<p>
Alguns exemples de combinacions possibles són:
</p>
<ul>
<li class="level1"><div class="li"> <strong>&lt;VirtualHost 10.0.0.1:*&gt;</strong>: Seu virtual associada (<em>bind</em>) a qualsevol port de l’adreça 10.0.0.1.</div>
</li>
<li class="level1"><div class="li"> <strong>&lt;VirtualHost www.ioc.cat:*&gt;</strong>: Seu virtual associada a qualsevol port de l’adreça IP amb la qual es resolgui el nom www.ioc.cat.</div>
</li>
<li class="level1"><div class="li"> <strong>&lt;VirtualHost 10.0.0.2:80&gt;</strong>: Seu virtual associada exclusivament al port 80 de l’adreça IP 10.0.0.2.</div>
</li>
<li class="level1"><div class="li"> <strong>&lt;VirtualHost 10.0.0.2:443&gt;</strong>: Seu virtual associada al port 443 (el del protocol HTTPS) de l’adreça 10.0.0.2. Examinant aquest exemple i l’anterior es pot observar que es mostren seus virtuals diferents si se sol·licita l’adreça 10.0.0.2 via HTTP o via HTTPS.</div>
</li>
<li class="level1"><div class="li"> <strong>&lt;VirtualHost *:80&gt;</strong>: Seu virtual associada al port 80 de totes les adreces IP del servidor. És a dir, sigui quina sigui la IP, si és pel port 80 es mostrarà aquest <em>vhost</em>. </div>
</li>
<li class="level1"><div class="li"> <strong>&lt;VirtualHost *:443&gt;</strong>: El mateix que en l’exemple anterior, però en aquest cas associat exclusivament al port de l’HTTPS.</div>
</li>
<li class="level1"><div class="li"> <strong>&lt;VirtualHost *:*&gt;</strong>: Aquesta expressió no té sentit, ja que indica qualsevol port per a qualsevol IP. Bé, sí que té sentit, però no cal fer un amfitrió virtual per implementar aquest servei, es pot fer directament des del servei web principal. </div>
</li>
<li class="level1"><div class="li"> <strong>&lt;VirtualHost 10.0.0.3:80 10.0.0.3:8080 192.168.1.30:* 192.168.1.31:443&gt;</strong>: Estableix que aquesta seu web està associada als ports 80 i 8080 de l’adreça IP 10.0.0.3. També està lligada a qualsevol port de l’adreça IP 192.168.1.30, i finalment també està associada al port 443 de l’adreça IP 168.168.1.31.</div>
</li>
<li class="level1"><div class="li"> <strong>&lt;VirtualHost www.ioc.cat:80 www.ioc.cat:8080 www.xtec.cat:8080&gt;</strong>: Aquesta directiva lliga cada una de les adreces IP amb les quals es resolen els noms de seu web indicats i el seu port corresponent. Cal recordar que la documentació recomana usar les adreces IP en lloc dels noms d’amfitrió.</div>
</li>
</ul>

</div>

<h4><a id="exemple_d_implementacio_local_de_seus_virtuals_basades_en_ip" >Exemple d&#039;implementació (local) de seus virtuals basades en IP</a></h4>
<div class="level4">

<p>
Tot seguit implementarem tres seus virtuals “inventades” lligades a tres adreces falses en un servidor (per exemple el nostre mateix PC). Els passos a seguir són:
</p>
<ol>
<li class="level1"><div class="li"> Crear les adreces IP falses. Per facilitar el monitoratge amb eines tipus Wireshark es faran les tres adreces al <em>loopback</em>.</div>
</li>
<li class="level1"><div class="li"> Assignar noms d’amfitrió localment a cada adreça IP imitant noms de domini de seus web.</div>
</li>
<li class="level1"><div class="li"> Crear i omplir de contingut els directoris de publicació de cada seu virtual.</div>
</li>
<li class="level1"><div class="li"> Crear les entrades corresponents a cada <em>VirtualHost</em>.</div>
</li>
<li class="level1"><div class="li"> Comprovar-ne el funcionament.</div>
</li>
</ol>

<p>
Creació les adreces IP falses al <em>loopback</em> i verificar-les:
</p>
<pre class="code"># Creació les IP falses
root@server:/# ip address add 10.0.0.1/24 dev lo
root@server:/# ip address add 10.0.0.2/24 dev lo
root@server:/# ip address add 10.0.0.3/24 dev lo</pre>

<p>
Comprovem que s’han creat i que comuniquen:
</p>
<pre class="code">root@server:/# ip address show lo
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet 10.0.0.1/24 scope global lo
       valid_lft forever preferred_lft forever
    inet 10.0.0.2/24 scope global secondary lo
       valid_lft forever preferred_lft forever
    inet 10.0.0.3/24 scope global secondary lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
root@server:/# ping 10.0.0.1 -c 2
PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.
64 bytes from 10.0.0.1: icmp_seq=1 ttl=64 time=0.019 ms
64 bytes from 10.0.0.1: icmp_seq=2 ttl=64 time=0.059 ms

--- 10.0.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 6ms
rtt min/avg/max/mdev = 0.019/0.039/0.059/0.020 ms
root@server:/# ping 10.0.0.2 -c 2
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.020 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.061 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 21ms
rtt min/avg/max/mdev = 0.020/0.040/0.061/0.021 ms
root@server:/# ping 10.0.0.3 -c 2
PING 10.0.0.3 (10.0.0.3) 56(84) bytes of data.
64 bytes from 10.0.0.3: icmp_seq=1 ttl=64 time=0.021 ms
64 bytes from 10.0.0.3: icmp_seq=2 ttl=64 time=0.058 ms

--- 10.0.0.3 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 22ms
rtt min/avg/max/mdev = 0.021/0.039/0.058/0.019 ms
root@server:/#</pre>

<p>
Cal configurar la resolució de noms local per assignar noms de seu web (falsos) a cada una de les adreces IP creades. Els noms de seu que s’assignen són www.ioc.cat per a la primera adreça IP, www.virtual.cat per a la segona i www.secret.cat per a la tercera.
</p>
<pre class="code">root@server:/# cat /etc/hosts
10.0.0.1  www.ioc.cat
10.0.0.2  www.virtual.org
10.0.0.3  www.secret.cat
root@server:/#</pre>

<p>
Evidentment, si es vol disposar de diverses seus virtuals és per publicar coses diferents a cada una. Cal crear els seus directoris de publicació i posar-hi contingut. Aquest contingut ha de ser <strong>diferent</strong> per poder observar fàcilment amb quina seu es contacta, quina seu mostra el servidor.
</p>

<p>
Els directoris de publicació tindran el mateix nom que la seu web i es trobaran dins del directori global WWW. El contingut de cada seu web pot ser la mateixa pàgina índex amb el títol modificat per mostrar el nom de la seu web.
</p>
<pre class="code"># Creació dels tres directoris de publicació
root@server:/# mkdir /var/www/{www.ioc.cat,www.virtual.cat,www.secret.cat}

# Creació de la pàgina índex per a cada seu web. Per a la primera es pot fer:
root@server:/# cat /var/www/www.ioc.cat/index.html
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Seu virtual basada en IP&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;h1&gt;Seu virtual basada en IP&lt;/h1&gt;
    &lt;/body&gt;
&lt;/html&gt;
root@server:/# </pre>

<p>
Un cop està tot a punt, cal fer la configuració apropiada en el servidor. S’han d’afegir les tres seus virtuals indicant la configuració de cada una. Un cop fet això caldrà reiniciar el servei (o recarregar la configuració). Aquest és l’aspecte del fitxer de configuració apache2.conf:
</p>
<pre class="code"># Seu virtual ip-based &quot;www.ioc.cat&quot; port 80
&lt;VirtualHost 10.0.0.1:80&gt; 
    ServerAdmin webmaster@host 
    DocumentRoot /var/www/www.ioc.cat 
    ServerName www.ioc.cat 
&lt;/VirtualHost&gt; 

# Seu virtual ip-based &quot;www.virtual.cat&quot; qualsevol port
&lt;VirtualHost 10.0.0.2:*&gt; 
    ServerAdmin webmaster@host 
    DocumentRoot /var/www/www.virtual.cat 
    ServerName www.virtual.org 
&lt;/VirtualHost&gt; 

# Seu virtual ip-based &quot;www.secret.cat&quot;
&lt;VirtualHost 10.0.0.3:443&gt; 
    ServerAdmin webmaster@host 
    DocumentRoot /var/www/www.secret.cat 
    ServerName www.secret.cat
    ... configuració SSL ...
&lt;/VirtualHost&gt; </pre>

<p>
Per recarregar el servei sense aturar-lo cal fer:
</p>
<pre class="code">root@server:/# service apache2 reload
</pre>

<p>
Finalment, cal verificar el funcionament de les tres seus virtuals. Evidentment, el sistema més senzill és verificar des d’un navegador cada una de les seus web i observar que es mostra la pàgina inicial que s’ha definit per a cada seu. A continuació es mostra un altre mecanisme de verificació “en text”, usant utilitats de comandes com Telnet per HTTP i Curl o OpenSSL per HTTPS:
</p>
<pre class="code"># Verificar l&#039;accés a la seu web virtual www.ioc.cat pel port 80
root@server:/# telnet 10.0.0.1 80 
Trying 10.0.0.1...
Connected to 10.0.0.1.
Escape character is &#039;^]&#039;.
GET / HTTP/1.0

HTTP/1.1 200 OK
Date: Tue, 15 Sep 2020 13:38:56 GMT
Server: Apache/2.4.38 (Debian)
Last-Modified: Tue, 15 Sep 2020 13:30:16 GMT
ETag: &quot;97-5af5a26d14299&quot;
Accept-Ranges: bytes
Content-Length: 151
Vary: Accept-Encoding
Connection: close
Content-Type: text/html

&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Seu virtual basada en IP&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;h1&gt;Seu virtual basada en IP&lt;/h1&gt;
    &lt;/body&gt;
&lt;/html&gt;
Connection closed by foreign host.
root@server:/# </pre>

<p>
Es pot observar que el Telnet permet connectar al port 80 de l’adreça 10.0.0.1. La petició GET s’ha fet usant el protocol HTTP 1.0, de manera que no cal posar cap capçalera addicional per fer una petició de pàgina web.
</p>

<p>
En l’exemple següent es valida el funcionament de la segona seu virtual. Observeu que la petició GET s’ha fet utilitzant el protocol HTTP 1.1, que requereix obligatòriament la capçalera <em>Host: nomSeu</em>. Aquesta capçalera indica realment quina és la seu virtual a la qual es vol accedir:
</p>
<pre class="code">root@server:/# telnet 10.0.0.2 80
Trying 10.0.0.2...
Connected to 10.0.0.2.
Escape character is &#039;^]&#039;.
GET / HTTP/1.1
host: www.virtual.cat

HTTP/1.1 200 OK
Date: Tue, 15 Sep 2020 13:38:59 GMT
Server: Apache/2.4.38 (Debian)
Last-Modified: Tue, 15 Sep 2020 13:30:46 GMT
ETag: &quot;97-5af5a26d14299&quot;
...</pre>

<p>
Finalment, cal verificar el funcionament de la tercera seu virtual, que s’ha configurat per usar connexions segures HTTPS via SSL. En l’exemple no s’han inclòs totes les directives necessàries ni la gestió dels certificats digitals per tal de poder generar una seu web segura. Tot això serà tractat més endavant. Les eines <strong>OpenSSL</strong> i <strong>Curl</strong> permeten comprovar-ne el funcionament en mode text:
</p>
<pre class="code">root@server:/# openssl s_client -connect www.secret.cat:443 -state -debug
GET / HTTP/1.0
...
HTTP/1.1 200 OK </pre>
<pre class="code">root@server:/# curl https://www.secret.cat -kv
...
HTTP/1.1 200 OK </pre>

</div>

<h3><a id="seus_virtuals_basades_en_nom" >Seus virtuals basades en nom</a></h3>
<div class="level3">

<p>
El servidor web pot oferir serveis webs diferents associats a una mateixa adreça IP. Això vol dir que una adreça IP pot tenir més d’una seu web associada. De fet, en pot tenir tantes com facin falta. Igual que passa amb les seus virtuals basades en nom també caldrà un bloc de configuració <em>VirtualHost</em> per a cada seu web a publicar. Si a cada una d’aquestes <strong>seus virtuals basades en nom</strong> s’hi vol accedir amb un nom de seu web caldrà que la resolució <acronym title="Domain Name System">DNS</acronym> es faci apropiadament (globalment amb <acronym title="Domain Name System">DNS</acronym> o localment amb /etc/hosts).
</p>

<p>
Per tant, cal que la petició HTTP tingui una capçalera <em>Host: nomSeu</em>, que determina quina de les seus associades es demana. Si la petició HTTP no conté aquesta capçalera, el servidor web es veu incapaç de determinar la seu virtual i contacta amb la seu per defecte associada a l’adreça IP:port (el primer dels <em>vhosts</em> definits per a cada ip:port és la seu per defecte).
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
El protocol <strong>HTTP 1.0</strong> no utilitza la capçalera <em>host</em>. Per tant, no permet diferenciar entre diverses seus virtuals d’una combinació IP:port. En aquest cas es contacta amb la seu per defecte.
</p>

<p>
El protocol <strong>HTTP 1.1</strong> requereix obligatòriament la capçalera <strong>Host: nomSeu</strong> per indicar a quina seu s’intenta accedir. Aquesta capçalera és la que determina a quin servei web s’accedirà. Aquest nom ha de coincidir amb un dels <em>ServerName</em> declarats.
</p>
</div></div>
</div>

<h4><a id="exemples_d_implementacio_de_seus_virtuals_basades_en_nom" >Exemples d&#039;implementació de seus virtuals basades en nom</a></h4>
<div class="level4">

<p>
Alguns exemples d’implementació són els següents:
</p>
<ul>
<li class="level1"><div class="li"> Diverses seus web basades en nom sobre una única adreça IP.</div>
</li>
</ul>
<pre class="code"># Apache escolta al port 80
Listen 80

&lt;VirtualHost *:80&gt;
    DocumentRoot &quot;/www/exemple1&quot;
    ServerName www.exemple.com
    # Altres directives...
&lt;/VirtualHost&gt;

&lt;VirtualHost *:80&gt;
    DocumentRoot &quot;/www/exemple2&quot;
    ServerName www.exemple.org
    # Altres directives...
&lt;/VirtualHost&gt;</pre>
<ul>
<li class="level1"><div class="li"> Diverses seus web basades en nom sobre amb més d’una adreça IP.</div>
</li>
</ul>
<pre class="code">Listen 80

# El servidor principal s&#039;executa a 172.20.30.40
ServerName server.exemple.com
DocumentRoot &quot;/www/mainserver&quot;

&lt;VirtualHost 172.20.30.50&gt;
    DocumentRoot &quot;/www/exemple1&quot;
    ServerName www.exemple.com
    # Altres directives...
&lt;/VirtualHost&gt;

&lt;VirtualHost 172.20.30.50&gt;
    DocumentRoot &quot;/www/exemple2&quot;
    ServerName www.exemple.org
    # Altres directives...
&lt;/VirtualHost&gt;</pre>
<ul>
<li class="level1"><div class="li"> Diferents seus web en diferents ports.</div>
</li>
</ul>
<pre class="code">Listen 80
Listen 8080

&lt;VirtualHost 172.20.30.40:80&gt;
    ServerName www.exemple.com
    DocumentRoot &quot;/www/domini-80&quot;
&lt;/VirtualHost&gt;

&lt;VirtualHost 172.20.30.40:8080&gt;
    ServerName www.exemple.com
    DocumentRoot &quot;/www/domini-8080&quot;
&lt;/VirtualHost&gt;

&lt;VirtualHost 172.20.30.40:80&gt;
    ServerName www.exemple.org
    DocumentRoot &quot;/www/domini-80&quot;
&lt;/VirtualHost&gt;

&lt;VirtualHost 172.20.30.40:8080&gt;
    ServerName www.exemple.org
    DocumentRoot &quot;/www/domini-8080&quot;
&lt;/VirtualHost&gt;</pre>
<ul>
<li class="level1"><div class="li"> Combinació de seus web i ports.</div>
</li>
</ul>
<pre class="code">Listen 172.20.30.40:80
Listen 172.20.30.40:8080
Listen 172.20.30.50:80
Listen 172.20.30.50:8080

&lt;VirtualHost 172.20.30.40:80&gt;
    DocumentRoot &quot;/www/exemple1-80&quot;
    ServerName www.exemple.com
&lt;/VirtualHost&gt;

&lt;VirtualHost 172.20.30.40:8080&gt;
    DocumentRoot &quot;/www/exemple1-8080&quot;
    ServerName www.exemple.com
&lt;/VirtualHost&gt;

&lt;VirtualHost 172.20.30.50:80&gt;
    DocumentRoot &quot;/www/exemple2-80&quot;
    ServerName www.exemple.org
&lt;/VirtualHost&gt;

&lt;VirtualHost 172.20.30.50:8080&gt;
    DocumentRoot &quot;/www/exemple2-8080&quot;
    ServerName www.exemple.org
&lt;/VirtualHost&gt;</pre>
<ul>
<li class="level1"><div class="li"> Combinació de seus web basades en nom i en IP.</div>
</li>
</ul>
<pre class="code">Listen 80

&lt;VirtualHost 172.20.30.40&gt;
    DocumentRoot &quot;/www/exemple1&quot;
    ServerName www.exemple.com
&lt;/VirtualHost&gt;

&lt;VirtualHost 172.20.30.40&gt;
    DocumentRoot &quot;/www/exemple2&quot;
    ServerName www.exemple.org
&lt;/VirtualHost&gt;

&lt;VirtualHost 172.20.30.40&gt;
    DocumentRoot &quot;/www/exemple3&quot;
    ServerName www.exemple.net
&lt;/VirtualHost&gt;

# IP-based
&lt;VirtualHost 172.20.30.50&gt;
    DocumentRoot &quot;/www/exemple4&quot;
    ServerName www.exemple.edu
&lt;/VirtualHost&gt;

&lt;VirtualHost 172.20.30.60&gt;
    DocumentRoot &quot;/www/exemple5&quot;
    ServerName www.exemple.gov
&lt;/VirtualHost&gt;</pre>

<p>
Es poden trobar molts més exemples a la documentació oficial d’Apache.
</p>

</div>

<h2><a id="autenticacio" >Autenticació</a></h2>
<div class="level2">

<p>
Fins ara hem vist com crear i configurar diverses seus web accessibles per tothom que tingui accés al servidor. Hi ha ocasions en que es vol restringir l’accés a una part del web o a tot el web però només per a uns usuaris concrets. En aquest apartat es descriuen diverses formes de realitzar-ho.
</p>

<p>
El servei web incorpora mecanismes bàsics per verificar els usuaris que volen accedir a àrees restringides. Però a més a més la flexibilitat dels mòduls fa que es puguin afegir nous mecanismes que puguin sorgir més endavant tot i que no hàgin estat desenvolupats per Apache. Així, per validar l’accés a un directori amb material dels professors en un web d’una escola segurament n’hi ha prou amb el mecanisme bàsic de verificació d’usuaris i grups. En canvi, per accedir a un web ultrasecret d’una agència governamental potser cal incorporar mecanismes addicionals, basats per exemple en l’empremta òptica i el registre de veu.
</p>

<p>
Primerament cal analitzar els mecanismes de validació d’usuaris generals que permet el servidor web:
</p>
<ul>
<li class="level1"><div class="li"> <strong>Autenticació bàsica amb fitxers</strong>: el mecanisme més simple per implementar el control d’accés a recursos d’una seu web és utilitzar fitxers d’<strong>usuaris</strong> i <strong>grups</strong> propis del servidor. Apache proporciona eines per crear-los. L’avantatge principal d’aquest mètode és la facilitat d’administració. L’inconvenient és que comporta una gestió diferenciada dels usuaris del servei web i dels del sistema. De fet, això pot ser un inconvenient o un avantatge, si el que interessa és tenir-los segregats.</div>
</li>
<li class="level1"><div class="li"> <strong>Autenticació mitjançant PAM</strong>: en els sistemes GNU/Linux actuals l’autenticació dels usuaris es realitza via PAM (<em>Pluggable Authentication Module</em>). El PAM comprovarà el directori /etc/passwd, el LDAP, el Kerberos, les empremtes dactilars o el que calgui. Usar el lligam amb el mòdul del PAM és un bon mecanisme per validar els usuaris del servei web igual que es validen els usuaris del sistema.</div>
</li>
<li class="level1"><div class="li"> <strong>Autenticació mitjançant LDAP</strong>: un dels mecanismes més populars actualment per a l’autenticació (i per a altres tasques) és el LDAP. Usar el mòdul del LDAP permet passar la validació dels usuaris a l’encarregat de gestionar l’autenticació LDAP dels usuaris del sistema. També es pot tenir en funcionament un servei LDAP específic per a les validacions del servei web.</div>
</li>
</ul>

<p>
Tot seguit es descriuen alguns conceptes clau relacionats amb el control d’accés al servidor:
</p>
<ul>
<li class="level1"><div class="li"> <strong>Autenticació</strong>: el procés d’autenticació és el que determina si un usuari és qui diu ser. En cap moment governa quins drets té, què pot fer i què no, simplement s’encarrega de comprovar que l’usuari és qui diu que és. Per implementar l’autenticació hi ha innumerables sistemes, des dels fitxers d’usuaris i contrasenyes fins a sofisticats mecanismes d’empremtes dactilars, òptiques, dades biomètriques o llapis USB (sense el llapis l’usuari no es pot identificar).</div>
</li>
<li class="level1"><div class="li"> <strong>Autorització</strong>: un cop s’ha identificat un usuari (és qui diu ser), què pot fer?, a quins recursos pot accedir?, a quins no? Això és l’autorització: determinar els drets d’utilització dels recursos.</div>
</li>
<li class="level1"><div class="li"> <strong>Recurs amb accés restringit</strong>: el control d’accés al servidor busca determinar quins recursos són accessibles per quins usuaris. Pot restringir l’accés a tota una seu web de manera que només els usuaris autoritzats puguin accedir als seus continguts. Sovint es restringeixen àrees concretes de la seu web, per exemple directoris que són accessibles només per un conjunt d’usuaris (els empleats, o els professors, en el web de l’escola). En aquest cas parlem de directoris amb accés restringit.</div>
</li>
<li class="level1"><div class="li"> <strong>Reialme</strong>: en una seu web hi poden haver diverses àrees restringides a perfils d’usuari diferents. Els reialmes permeten definir quines àrees restringides comparteixen el mateix grau d’accés. Tornem a l’exemple d’una seu web d’una escola on hi ha tot de continguts públics accessibles per tothom. El directori Notes és un recurs restringit on només hi poden accedir els alumnes de l’escola. Els directoris Programacions i Registres de Treball són accessibles només pels professors. Un professor que, per exemple, s’autentica per entrar a l’àrea Programacions introduïnt el seu identificador d’usuari i contrasenya, si vol entrar a l’àrea Registres de Treball s’hauria de tornar a identificar entrant de nou l’usuari i la contrasenya. Els reialmes permeten declarar que diversos llocs restringits tenen el mateix nivell d’accés, de manera que si un usuari s’ha autenticat en un està autenticat en tots els recursos que formen part del reialme.</div>
</li>
<li class="level1"><div class="li"> <strong>Web amb inici de nom d’usuari/contrasenya</strong>: un error molt típic és confondre l’autenticació a nivell de servidor amb l’autenticació a nivell de programari que realitzen les seus webs. Quan un usuari es valida en un entorn web com per exemple Yahoo o Google, no està usant l’autenticació amb el servidor web. Està usant un usuari i una contrasenya de l’empresa web a la qual es connecta i la gestió d’aquesta sessió d’usuari per consultar el seu correu es realitza mitjançant la programació en les mateixes pàgines web que visita. Això <strong>no</strong> té res a veure amb el control d’accés al servidor que es tracta en aquest apartat. </div>
</li>
</ul>
<div class="iocimportant"><div class="ioccontent">
<p>
<strong>Autenticar</strong> els usuaris és determinar de forma veraç si un usuari és qui diu ser. <strong>Autoritzar</strong> és indicar quins usuaris tenen dret a accedir a quins recursos. Les seus web i els directoris que limiten l’accés a un conjunt restringit d’usuaris s’anomenen <strong>recursos restringits</strong>. Els recursos restringits que implementen la mateixa política de seguretat es poden agrupar en <strong>reialmes</strong>. 
</p>
</div></div>
</div>

<h3><a id="els_moduls_de_control_d_acces" >Els mòduls de control d&#039;accés</a></h3>
<div class="level3">

<p>
Apache gestiona l’autenticació i el control d’accés al servidor mitjançant mòduls propis (a part que es poden incorporar mòduls externs). Cada mòdul consta d’un conjunt de directives que permeten configurar el funcionament de l’autenticació i control d’accés implementats. Aquests mòduls es poden classificar en tres categories segons la seva funcionalitat:
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Mòduls</p>
<p>
Es pot obtenir la llista de mòduls relacionats amb l’autenticació i el control d’accés consultant la pàgina corresponent de la documentació d’Apache.
</p>
</div></div><ul>
<li class="level1"><div class="li"> <strong>Tipus d’autenticació</strong>: l’autenticació pot ser de tipus <em>basic</em> o <em>digest</em>. En aquests exemples s’utilitzarà autenticació bàsica. L’autenticació <em>digest</em> implica comunicacions xifrades. Aquests mòduls s’implementen amb la directiva <strong><em>AuthType</em></strong>.</div>
</li>
</ul>
<pre class="code">AuthType Basic</pre>

<p>
Podeu observar que els mòduls identifiquen en el seu nom la cadena <strong>auth</strong> d’<em>authentication</em>.
</p>
<pre class="code">mod_auth_basic
mod_auth_digest</pre>
<ul>
<li class="level1"><div class="li"> <strong>Proveïdor d’autenticació</strong>: indica quin és el mecanisme usat per realitzar l’autenticació. Són els mòduls que permeten autenticar usant fitxers de contrasenyes o el mòdul PAM o el de LDAP… Es poden identificar els mòduls d’aquesta família perquè inclouen en el seu nom la cadena <strong>authn</strong> d’<em>authentication</em>.</div>
</li>
</ul>
<pre class="code">mod_authn_file
mod_authn_alias
mod_authnz_ldap
...</pre>
<ul>
<li class="level1"><div class="li"> <strong>Autorització</strong>: els mòduls d’aquesta família proporcionen autorització a nivell d’usuaris, de grups, del LDAP o del que convingui. Aquests mòduls es determinen segons el valor que prengui la directiva <strong><em>Require</em></strong>.</div>
</li>
</ul>
<pre class="code">Require user valid-user</pre>

<p>
Podeu observar que els mòduls identifiquen en el seu nom la cadena <strong>authz</strong> d’<em>authorization</em>.
</p>
<pre class="code">mod_authz_user
mod_authz_group
mod_authz_owner
mod_authz_ldap
...</pre>

</div>

<h3><a id="autenticacio_basica_amb_fitxers" >Autenticació bàsica amb fitxers</a></h3>
<div class="level3">

<p>
El mecanisme més senzill per implementar l’autenticació en el servidor és l’autenticació bàsica amb fitxers d’usuaris i grups específics per al servidor web. Això es pot interpretar com un desavantatge perquè obliga a portar una gestió d’usuaris a més de la gestió d’usuaris del sistema. Però al mateix temps és un avantatge si el que volem és segregar aquets dos conjunts d’usuaris i administrar-los per separat.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Amb l’autenticació bàsica utilitzant fitxers es poden validar els usuaris utilitzant un <strong>fitxer d’usuaris</strong>, que conté els comptes d’usuaris i les seves contrasenyes.
</p>

<p>
També es poden validar grups d’usuaris amb un <strong>fitxer de grups</strong>, que indica quins usuaris formen part de cada grup.
</p>
</div></div>
<p>
El procés més simplificat per implementar la verificació d’usuaris i grups mitjançant fitxers de text pla amb contrasenyes requereix els passos següents:
</p>
<ol>
<li class="level1"><div class="li"> Crear el fitxer d’usuaris en què s’indica la contrasenya corresponent a cada usuari.</div>
</li>
<li class="level1"><div class="li"> Crear el fitxer de grups assignant a cada grup els usuaris que en formen part.</div>
</li>
<li class="level1"><div class="li"> Identificar (o crear) el recurs que ha de tenir l’accés restringit.</div>
</li>
<li class="level1"><div class="li"> Definir les directives apropiades per restringir l’accés al recurs als usuaris autoritzats.</div>
</li>
</ol>

<p>
L’exemple següent crearà un directori anomenat <em>privat</em> en la nostra web, al qual només hi podran accedir els usuaris autoritzats.
</p>

<p>
Primer cal crear el fitxer d’usuaris. Es tracta d’un fitxer de text pla en el qual s’emmagatzemen l’identificador i la contrasenya, que pot ser en text pla o xifrada, de cada usuari. Per crear el fitxer i cada nou usuari s’utilitza l’ordre <strong><em>htpasswd</em></strong>, proporcionada pel paquet del servidor. En el primer exemple s’utilitza l’opció <em>-c</em>, que crea el fitxer de nou.
</p>
<pre class="code">root@server:/# htpasswd -c /var/www/passwd usuari
New password: usuari 
Re-type new password: usuari
Adding password for user usuari 
root@server:/# htpasswd /var/www/passwd usuari2
root@server:/# htpasswd /var/www/passwd usuari3
root@server:/# htpasswd /var/www/passwd usuari4
usuari:DeSaz54k9YRJU 
usuari2:N0OF27Bcygc.. 
usuari3:okdHbmg.0G.Xo 
...</pre>

<p>
A continuació cal posar en cada grup (de moment no n’hi ha cap) els usuaris que n’han de formar part. De fet, és tan senzill com crear un fitxer de text pla cada línia del qual consta del nom del grup, el delimitador dos punts (:) i la llista d’usuaris separats per espais.
</p>
<pre class="code">root@server:/# vim /var/www/group
usuaris: usuari usuari2 usuari3 usuari4</pre>

<p>
Ara cal generar el <strong>recurs restringit</strong>, l’accés al qual només es permetrà als usuaris autoritzats. En aquest cas serà un directori anomenat <em>privat</em> a la nostra web.
</p>
<pre class="code">root@server:/# mkdir /var/www/html/privat
root@server:/# vim /var/www/html/privat/index.html 
... creació de la pàgina ....</pre>

<p>
Finalment s’assignen al directori local les directives apropiades per convertir-lo en un recurs d’accés restringit. Cal modificar el fitxer de configuració global apache2.conf (o el fitxer corresponent si es fa com a seu virtual) i definir un bloc de configuració usant la directiva <strong><em>Directory</em></strong>. En aquesta directiva cal indicar la ruta absoluta corresponent al sistema de fitxers real del servidor (no es possible usar rutes relatives al servei web).
</p>
<pre class="code">&lt;Directori path-absolut-filesystem&gt;
... opcions de configuració ...
&lt;/Directory&gt;</pre>

<p>
Un exemple complet de configuració és el que es mostra a continuació, en el qual únicament es permet accedir al recurs a usuaris del grup anomenar <em>usuaris</em>:
</p>
<pre class="code">&lt;Directory /var/www/html/privat&gt;
    AuthType Basic
    AuthName &quot;Fitxers restringits&quot;
    AuthBasicProvider file
    AuthUserFile /var/www/passwd
    AuthGroupFile /var/www/group 
    Require group usuaris
&lt;/Directory&gt; </pre>

<p>
Vegeu les directives que s’utilitzen:
</p>
<ul>
<li class="level1"><div class="li"> <strong><em>AuthType</em></strong>: indica que el tipus d’autenticació és bàsica (en lloc de <em>digest</em>).</div>
</li>
<li class="level1"><div class="li"> <strong><em>AythName</em></strong>: declara el reialme al qual pertany el recurs restringit. Això permet que si hi ha altres recursos restringits associats a aquest reialme l’usuari que ja s’ha autenticat en un d’ells no ho hagi de fer en els altres. El nom del reialme el posa l’administrador web.</div>
</li>
<li class="level1"><div class="li"> <strong><em>AuthBasicProvider</em></strong>: indica el mètode d’autenticació a usar. Pot prendre valors tipus <em>ldap</em>, <em>pam</em>, <em>dbm</em>, <em>bdb</em>, <em>file</em> i d’altres. El valor <em>file</em> significa que s’utilitzarà un fitxer d’usuaris i opcionalment un de grups.</div>
</li>
<li class="level1"><div class="li"> <strong><em>AuthUserFile</em></strong>: indica quin és el fitxer que conté els comptes dels usuaris locals del servidor Apache. És el fitxer que s’ha creat en l’exemple anterior.</div>
</li>
<li class="level1"><div class="li"> <strong><em>AuthGroupFile</em></strong>: indica quin és el fitxer de grups en el qual consta quins grups d’usuaris hi ha i quins usuaris pertanyen a cada grup.</div>
</li>
<li class="level1"><div class="li"> <strong><em>Require</em></strong>: aquesta directiva és la que determina quina és la autorització a realitzar. En l’exemple es permet que qualsevol usuari del grup <em>usuaris</em> tingui accés al recurs.</div>
</li>
</ul>

<p>
Finalment, cal verificar que l’accés al directori local és concedit únicament als membres del grup profes. Evidentment el mecanisme més senzill és verificar des d’un navegador l’accés al recurs privat i observar que es demana l’autenticació. En la <span class="figref"><a href="#Figure3.1"><span>figura</span></a></span> es pot observar una petició d’autenticació d’usuari realitzada des d’un navegador Firefox.
</p>
<div class="iocfigure"><a name="Figure3.1"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Petició d’autenticació d’usuari

</figcaption><img src="../media/apache-auth1.png" alt="" /></figure>
</div><div class="iocexample"><div class="ioccontent"><p class="ioctitle">Exemples de mecanismes d&#039;autorització</p>
<p>
La directiva <em>Require</em> és la que defineix l’autorització d’accés al recurs, és a dir, qui pot accedir-hi. Aquests en són alguns exemples d’ús:
</p>
<ul>
<li class="level1"><div class="li"> <em>Require user valid-user</em>: permet l’accés a qualsevol usuari autenticat.</div>
</li>
<li class="level1"><div class="li"> <em>Require user usuari usuari2</em>: permet l’accés als usuaris indicats (usuari i usuari2).</div>
</li>
<li class="level1"><div class="li"> <em>Require group usuaris</em>: permet l’accés als usuaris que són membres d’algun dels grups indicats.</div>
</li>
</ul>
</div></div>
</div>

<h2><a id="comunicacions_segures" >Comunicacions segures</a></h2>
<div class="level2">

<p>
El protocol HTTP pateix els mateixos problemes de seguretat que els seus companys dels inicis d’Internet (<acronym title="File Transfer Protocol">FTP</acronym>, TFTP, SMTP…). Tota la informació viatja en text net i és fàcilment monitorable per altres. Quan un usuari es connecta a un web i indica l’usuari i la contrasenya, aquestes dades viatgen sense cap mena de protecció i qualsevol les pot capturar. Si el que es transmet són dades bancàries, llistes d’amistats íntimes o qualsevol tipus de dada privada, és desaconsellable fer-ho per HTTP.
</p>

<p>
El primer mecanisme de seguretat que es va implementar per a HTTP va ser el protocol SSL (Secure Socket Layer o capa de sòcol segur), desenvolupat per Netscape. L’SSL proporciona una capa entre la capa de transport TCP i la capa d’aplicació HTTP en què les dades viatgen xifrades. L’HTTPS solament és un esquema <acronym title="Uniform Resource Identifier">URI</acronym> que indica la utilització d’<acronym title="HyperText Markup Language">HTML</acronym> més algun mecanisme de transport xifrat, com SSL o TLS.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Quan s’utilitza HTTP amb un protocol xifrat com SSL o TCL s’anomena HTTPS (secure HTTP). Utilitza el port 443.
</p>
</div></div>
<p>
El protocol SSL es va enviar a l’IETF (Internet Engineering Task Force o Equip d’Enginyeria d’Internet, l’òrgan rector d’Internet) per a l’estandardització i després de diversos canvis va sorgir el protocol TLS (Transport Layer Security, Seguretat de capa de transport). El TLS proporciona les mateixes condicions de confidencialitat i autenticació en les transmissions HTTP que SSL.
</p>

<p>
Un dels avantatges de l’HTTPS és que permet la confidencialitat entre tots dos extrems de la comunicació encara que només sigui un dels extrems el que s’ha autenticat. Aquest model és molt pràctic quan, per exemple, un client anònim compra en un web autenticat. Quan es volen pagar els bitllets d’avió, interessa que les dades de la targeta de crèdit viatgin xifrades i que el receptor sigui la companyia aèria i no un web fals.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
L’HTTPS garanteix el trànsit de dades xifrat i el certificat del servidor. “En principi”, autentica el web, però veurem que això depèn de si es confia o no amb el certificat usat.
</p>
</div></div>
<p>
L’ús dels certificats no és exclusiu per autenticar el servidor. Si cal, els clients poden ser autenticats. Per exemple, un web pot requerir que els clients disposin del certificat que els atorga dret a accedir-hi (expedit, per exemple, per la mateixa entitat).
</p>

<p>
Els passos necessaris per implementar comunicacions segures que permeten a un navegador client (o a un client, sigui qui sigui) connectar-se via HTTPS a una seu web són:
</p>

<p>

</p>
<ul>
<li class="level1"><div class="li"> <strong>Certificats digitals</strong>: el servidor web ha de disposar d’una clau privada i d’un certificat digital.</div>
</li>
<li class="level1"><div class="li"> <strong>Mòdul <em>mod_ssl</em></strong>: cal tenir instal·lat el paquet de programari que proporciona les prestacions SSL al servidor i que la configuració activa en carregui els mòduls pertinents.</div>
</li>
<li class="level1"><div class="li"> <strong>Configurar la seu web segura</strong>: finalment cal establir les directives SSL apropiades a la seu web que es vol configurar per fer-la accessible via SSL.</div>
</li>
</ul>

<p>
L’objectiu de les explicacions següents és implementar connexions segures HTTPS a la seu web www.ioc.cat utilitzant SSL com a mecanisme de transport xifrat.
</p>

</div>

<h3><a id="els_certificats_del_servidor" >Els certificats del servidor</a></h3>
<div class="level3">

<p>
Suposarem que el servidor disposa ja d’una clau privada i d’un certificat, amb independència de com s’hagin obtingut. En concret, en el subdirectori certs del directori base del servei web hi ha:
</p>
<ul>
<li class="level1"><div class="li"> <strong>server.crt</strong>: el fitxer corresponent al certificat o clau pública del servidor. Aquest fitxer assegura als clients que es connecten a la seu web que el servidor és qui realment diu ser.</div>
</li>
<li class="level1"><div class="li"> <strong>server.key</strong>: és el fitxer amb la clau privada del servidor. Aquest fitxer s’ha codificat amb una <em>passphrase</em> o frase de pas de manera que cada vegada que s’inicialitzi el servidor web caldrà entrar aquesta frase.</div>
</li>
</ul>

<p>
La <span class="figref"><a href="#Figure4.1"><span>figura</span></a></span> mostra la pantalla típica de gestió de certificats de Firefox. En aquesta pantalla es poden llistar els certificats preinstal·lats en el navegador, observar-ne les seves propietats i també es poden afegir i eliminar certificats.
</p>
<div class="iocfigure"><a name="Figure4.1"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Pantalla de gestió de certificats de Firefox

</figcaption><img src="../media/ic10m08u2_04.png" alt="" /></figure>
</div>
<p>
Cal recordar que els navegadors clients validaran la confiança que els mereix el certificat contrastant el seu emissor amb la llista d’entitats certificadores que tenen carregada. Si l’emissor del certificat no hi és, caldrà fer passos per incorporar el certificat al navegador. Aquests passos poden ser:
</p>
<ul>
<li class="level1"><div class="li"> Admetre el certificat com a vàlid quan el navegador presenta “l’excepció de seguretat”.</div>
</li>
<li class="level1"><div class="li"> Obtenir el certificat de l’entitat CA (Certification Authority o autoritat de certificació) que l’ha generat i incorporar l’entitat al llistat d’entitats en què el navegador confia.</div>
</li>
</ul>
<div class="ioctextl"><div class="ioccontent"><p class="ioctitle">Generar un certificat autosignat</p>
<p>
A mode de recordatori ràpid, es pot generar una clau privada i un certificat autosignat fent:
</p>
<pre class="code"># openssl req -new -x509 -nodes -out server.crt -keyout server.key </pre>
</div></div>
</div>

<h3><a id="configuracio_d_apache_per_usar_ssl" >Configuració d&#039;Apache per usar SSL</a></h3>
<div class="level3">

<p>
El servidor web podrà usar SSL si disposa dels mòduls que en proporcionen la capacitat. En cas de no tenir-los, cal buscar en els repositoris de programari habitual un paquet que proporcioni el mòdul apropiat, instal·lar-lo i examinar-ne el contingut. Usualment, tant el paquet com el mòdul que proporcionen les prestacions de trànsit segur SSL s’anomenen <strong>mod_ssl</strong>.
</p>

<p>
Per habilitar-lo a Apache:
</p>
<pre class="code">root@server:~# a2enmod ssl
Considering dependency setenvif for ssl:
Module setenvif already enabled
Considering dependency mime for ssl:
Module mime already enabled
Considering dependency socache_shmcb for ssl:
Enabling module socache_shmcb.
Enabling module ssl.
See /usr/share/doc/apache2/README.Debian.gz on how to configure SSL and create self-signed certificates.
To activate the new configuration, you need to run:
  systemctl restart apache2
root@server:~# </pre>

<p>
A la carpeta <code>/etc/apache2/mods-available</code> hi ha els diferents mòduls que es poden activar, entre els quals es troba el mòdul SSL. Es poden distingir dos fitxers, un que s’encarrega de la configuració i l’altre de la càrrega del mòdul:
</p>
<pre class="code">root@server:/# ls /etc/apache2/mods-available/ssl.*    
/etc/apache2/mods-available/ssl.conf  /etc/apache2/mods-available/ssl.load
root@server:/# cat /etc/apache2/mods-available/ssl.load
# Depends: setenvif mime socache_shmcb
LoadModule ssl_module /usr/lib/apache2/modules/mod_ssl.so
root@server:/# cat /etc/apache2/mods-available/ssl.conf
&lt;IfModule mod_ssl.c&gt;

	# Pseudo Random Number Generator (PRNG):
	# Configure one or more sources to seed the PRNG of the SSL library.
	# The seed data should be of good random quality.
	# WARNING! On some platforms /dev/random blocks if not enough entropy
	# is available. This means you then cannot use the /dev/random device
	# because it would lead to very long connection times (as long as
	# it requires to make more entropy available). But usually those
	# platforms additionally provide a /dev/urandom device which doesn&#039;t
	# block. So, if available, use this one instead. Read the mod_ssl User
	# Manual for more details.
	#
	SSLRandomSeed startup builtin
...</pre>

<p>
En executar la comanda <em>a2enmod</em>, hem fet que es crei un enllaç simbòlic des de la carpeta <code>/etc/apache2/mods-enabled</code> a la carpeta <code>/etc/apache2/mods-available</code> per a aquest mòdul. Aquest és el mecanisme que fa servir Apache per activar i desactivar els mòduls. En cas que es vulgui desactivar, cal fer servir la comanda <em>a2dismod</em>. També es poden fer servir sense paràmetres, i indicaran quins mòduls volem activar o desactivar dels que estan desactivats o activats respectivament:
</p>
<pre class="code">root@server:/# a2enmod
Your choices are: access_compat actions alias allowmethods asis auth_basic auth_digest auth_form authn_anon authn_core authn_dbd authn_dbm authn_file authn_socache authnz_fcgi authnz_ldap authz_core authz_dbd authz_dbm authz_groupfile authz_host authz_owner authz_user autoindex brotli buffer cache cache_disk cache_socache cern_meta cgi cgid charset_lite data dav dav_fs dav_lock dbd deflate dialup dir dump_io echo env expires ext_filter file_cache filter headers heartbeat heartmonitor http2 ident imagemap include info lbmethod_bybusyness lbmethod_byrequests lbmethod_bytraffic lbmethod_heartbeat ldap log_debug log_forensic lua macro md mime mime_magic mpm_event mpm_prefork mpm_worker negotiation proxy proxy_ajp proxy_balancer proxy_connect proxy_express proxy_fcgi proxy_fdpass proxy_ftp proxy_hcheck proxy_html proxy_http proxy_http2 proxy_scgi proxy_uwsgi proxy_wstunnel ratelimit reflector remoteip reqtimeout request rewrite sed session session_cookie session_crypto session_dbd setenvif slotmem_plain slotmem_shm socache_dbm socache_memcache socache_shmcb speling ssl status substitute suexec unique_id userdir usertrack vhost_alias xml2enc
Which module(s) do you want to enable (wildcards ok)?
^C
root@server:/# a2dismod
Your choices are: access_compat alias auth_basic authn_core authn_file authz_core authz_host authz_user autoindex deflate dir env filter mime mpm_event negotiation reqtimeout setenvif status
Which module(s) do you want to disable (wildcards ok)?
^C
root@server:/#</pre>

</div>

<h3><a id="configuracio_de_la_seu_web_amb_ssl" >Configuració de la seu web amb SSL</a></h3>
<div class="level3">

<p>
Cal aplicar a la nostra seu web les directives SSL apropiades per fer possible l’accés a aquesta seu web per HTTPS. El llistat de la directiva <em>VirtualHost</em> és:
</p>
<pre class="code">&lt;VirtualHost www.ioc.cat:443&gt; 
    ServerAdmin webmaster@ioc.cat 
    DocumentRoot /var/www/www.ioc.cat 
    SSLEngine On 
    SSLProtocol all -SSLv3
    SSLCertificateKeyFile /var/www/certs/server.key 
    SSLCertificateFile /var/www/certs/server.crt 
&lt;/VirtualHost&gt; </pre>

<p>
Vegeu les directives usades:
</p>
<ul>
<li class="level1"><div class="li"> <strong>Port 443</strong>: aquest és el port usual per a les connexions segures HTTP. Si la seu web només escolta per aquest port, només es podrà accedir al seu contingut per HTTPS. Si es volen seus diferents per al trànsit xifrat i per al no xifrat, n’hi ha prou de crear una altra seu virtual amb un altre port.</div>
</li>
<li class="level1"><div class="li"> <strong><em>SSLEngine On</em></strong>: aquesta directiva indica que cal activar el trànsit SSL per a aquesta seu web.</div>
</li>
<li class="level1"><div class="li"> <strong><em>SSLProtocol all -SSLv3</em></strong>: en aquesta directiva s’indiquen quins protocols es poden usar per generar el trànsit xifrat. Les opcions <em>all</em> i <em>-SSLv3</em> indiquen que s’accepten tots els protocols vàlids excepte el protocol SSLv3.</div>
</li>
<li class="level1"><div class="li"> <strong><em>SSLCertificateKeyFile</em> &lt;clau privada del servidor&gt;</strong>: aquesta directiva indica el fitxer amb la clau privada del servidor.</div>
</li>
<li class="level1"><div class="li"> <strong><em>SSLCertificateFile</em> &lt;certificat&gt;</strong>: indica el fitxer que conté el certificat del servidor. Aquest és el certificat que els navegadors clients veuran i del qual hauran de decidir si hi confien o no.</div>
</li>
<li class="level1"><div class="li"> <strong><em>SSLCACertificateFile</em> &lt;certificat-CA&gt;</strong>: aquesta directiva és opcional i permet indicar quin és el fitxer que conté el certificat públic que ha emès l’entitat de certificació CA.</div>
</li>
</ul>

<p>
Un cop configurada apropiadament la seu virtual, cal reiniciar el servei. Des de qualsevol navegador s’ha de poder accedir a la seu usant HTTPS. Ara bé, es generarà una excepció de seguretat perquè el navegador desconeix la procedència del certificat. Si l’usuari accepta confiar en la seu web, el certificat s’incorporarà al navegador i accedirà de forma xifrada a la seu web.
</p>

<p>
No obstant, Apache porta ja una seu web predeterminada (en forma de plantilla) per activar la seu web amb SSL. Aquest fitxer és el <code>/etc/apache2/sites-available/default-ssl.conf</code>.
</p>

</div>

<h3><a id="verificacio_de_les_connexions_ssl" >Verificació de les connexions SSL</a></h3>
<div class="level3">

<p>
Els problemes principals que es poden trobar els navegadors en connectar amb seus web amb certificats són els següents:
</p>
<ul>
<li class="level1"><div class="li"> Amb un certificat autosignat no cal definir cap CA. El navegador client mostrarà la típica pantalla d’excepció de seguretat i caldrà indicar que s’accepta el certificat de servidor per a la nostra entitat. És un certificat emès per la mateixa entitat.</div>
</li>
<li class="level1"><div class="li"> Amb un certificat generat per una CA local cal incorporar manualment el certificat al navegador. Un cop fet això el navegador serà capaç de validar el certificat del servidor amb la CA que l’ha expedit (<em>issuer</em>).</div>
</li>
</ul>

<p>
A més dels navegadors, existeixen eines d’entorn de text per verificar connexions SSL, de la mateixa manera que s’utilitza <em>telnet host 80</em> per verificar connexions HTTP. D’una banda, es pot usar el mateix <strong>OpenSSL</strong> i, de l’altra, es pot instal·lar la utilitat <strong>Curl</strong>, que permet fer un ampli seguiment del diàleg SSL.
</p>
<pre class="code">root@server:/# openssl s_client -connect www.ioc.org:cat 
root@server:/# curl https://www.ioc.cat -kv </pre>

</div>

<h2><a id="monitoratge_del_servei" >Monitoratge del servei</a></h2>
<div class="level2">

<p>
El servei web incorpora diverses eines per monitorar el funcionament del servei, algunes de configurades per defecte i d’altres que s’hi poden afegir. Les dues utilitats tractades en aquest apartat són <em>server-status</em> i <em>server-info</em>. Cal afegir el codi corresponent per tal d’indicar a quines seus web es vol fer el monitoratge per tal d’activar-los. A més a més, cal assegurar que aquests mòduls estan habilitats, ja que depenent de la versió d’Apache i distribució de Linux no sempre és així.
</p>
<pre class="code">root@server:/etc/apache2# a2enmod info
Enabling module info.
To activate the new configuration, you need to run:
  systemctl restart apache2
root@server:/etc/apache2# a2enmod status
Module status already enabled
root@server:/etc/apache2#</pre>

<p>
El fragment de codi següent mostra la configuració que permet monitorar les seus corresponents al nom de host <em>server</em> (la seu principal o per defecte) i la seu www.ioc.cat.
</p>
<pre class="code">&lt;Location /server-status&gt;
    SetHandler server-status
    Order deny,allow
    Deny from all
    Allow from www.ioc.cat server
&lt;/Location&gt;
&lt;Location /server-info&gt;
    SetHandler server-info
    Order deny,allow
    Deny from all
    Allow from www.ioc.cat server
&lt;/Location&gt;</pre>

<p>
Per accedir als continguts del monitoratge simplement cal indicar des d’un navegador client els <acronym title="Uniform Resource Locator">URL</acronym> apropiats:
</p>
<pre class="code">www.ioc.cat/server-info
www.ioc.cat/server-status</pre>

</div>

<h3><a id="utilitat_de_server-status" >Utilitat de server-status</a></h3>
<div class="level3">

<p>
La informació bàsica que es mostra en consultar el <em>server-status</em> de la seu web www.ioc.cat és la següent:
</p>
<pre class="code">Apache Server Status for www.ioc.cat (via 10.0.2.15)

Server Version: Apache/2.4.38 (Debian)
Server MPM: event
Server Built: 2019-10-15T19:53:42

Current Time: Monday, 21-Sep-2020 19:50:49 CEST
Restart Time: Monday, 21-Sep-2020 19:49:40 CEST
Parent Server Config. Generation: 1
Parent Server MPM Generation: 0
Server uptime: 1 minute 9 seconds
Server load: 0.00 0.03 0.06
Total accesses: 2 - Total Traffic: 14 kB - Total Duration: 15
CPU Usage: u0 s0 cu0 cs0
.029 requests/sec - 207 B/second - 7.0 kB/request - 7.5 ms/request
1 requests currently being processed, 49 idle workers

Slot	PID	Stopping	Connections 	Threads	Async connections
total	accepting	busy	idle	writing	keep-alive	closing
0	7866	no	1	yes	1	24	0	0	0
1	7867	no	0	yes	0	25	0	0	0
Sum	2	0	1	 	1	49	0	0	0

_______________W__________________________________..............
................................................................
......................

Scoreboard Key:
&quot;_&quot; Waiting for Connection, &quot;S&quot; Starting up, &quot;R&quot; Reading Request,
&quot;W&quot; Sending Reply, &quot;K&quot; Keepalive (read), &quot;D&quot; DNS Lookup,
&quot;C&quot; Closing connection, &quot;L&quot; Logging, &quot;G&quot; Gracefully finishing,
&quot;I&quot; Idle cleanup of worker, &quot;.&quot; Open slot with no current process
Srv	PID	Acc	M	CPU 	SS	Req	Dur	Conn	Child	Slot	Client	Protocol	VHost	Request
0-0	7866	0/1/1	_ 	0.00	12	15	15	0.0	0.01	0.01 	server	http/1.1	server.ioc.cat:80	GET /server-info HTTP/1.1
0-0	7866	0/1/1	_ 	0.00	12	0	0	0.0	0.00	0.00 	server	http/1.1	server.ioc.cat:80	GET /favicon.ico HTTP/1.1
0-0	7866	0/0/0	W 	0.00	0	0	0	0.0	0.00	0.00 	10.0.2.15	http/1.1	server.ioc.cat:80	GET /server-status HTTP/1.1
Srv	Child Server number - generation
PID	OS process ID
Acc	Number of accesses this connection / this child / this slot
M	Mode of operation
CPU	CPU usage, number of seconds
SS	Seconds since beginning of most recent request
Req	Milliseconds required to process most recent request
Dur	Sum of milliseconds required to process all requests
Conn	Kilobytes transferred this connection
Child	Megabytes transferred this child
Slot	Total megabytes transferred this slot
Apache/2.4.38 (Debian) Server at www.ioc.cat Port 80</pre>

<p>
Els elements més destacats de la informació d’estatus són:
</p>
<ul>
<li class="level1"><div class="li"> Versió del servidor i data de compilació.</div>
</li>
<li class="level1"><div class="li"> Últims cops que s’ha engegat el servei i temps que fa que està actiu.</div>
</li>
<li class="level1"><div class="li"> Ús de CPU, detalls del trànsit i estadístiques sobre les peticions realitzades.</div>
</li>
</ul>

</div>

<h3><a id="utilitat_de_server-info" >Utilitat de server-info</a></h3>
<div class="level3">

<p>
El servei de monitoratge <em>server-info</em> proporciona informació detallada de la configuració del dimoni del servidor, els valors obtinguts de processar cada un dels fitxers de configuració, els mòduls carregats i les configuracions de cada mòdul.
</p>
<ul>
<li class="level1"><div class="li"> <strong>server settings</strong>: descriu la versió del servidor i les opcions amb què s’ha compilat. En particular, podeu observar els valors que descriuen l’arrel de l’estructura de fitxers del servidor i el fitxer de configuració a usar.</div>
</li>
</ul>
<pre class="code">Server Root: /etc/apache2
Config File: /etc/apache2/apache2.conf</pre>
<ul>
<li class="level1"><div class="li"> <strong>configuration files</strong>: descriu detalladament tots els valors de configuració, obtinguts dels diferents fitxers de configuració. Mostra el número de línia, la directiva i el valor que pren. Es pot observar que s’analitzen tots els fitxers actualment carregats en la configuració, el fitxer global apache2.conf i els inclosos en el directori <code>/etc/apache2</code>.</div>
</li>
</ul>
<pre class="code">Configuration:
    In file: /etc/apache2/apache2.conf
      87: PidFile /var/run/apache2/apache2.pid
      92: Timeout 300
      98: KeepAlive On
     105: MaxKeepAliveRequests 100
     111: KeepAliveTimeout 5
     115: User www-data
     116: Group www-data
     126: HostnameLookups Off
     134: ErrorLog /var/log/apache2/error.log
     143: LogLevel warn
    In file: /etc/apache2/mods-enabled/alias.conf
      14: Alias /icons/ &quot;/usr/share/apache2/icons/&quot;
      16: &lt;Directory &quot;/usr/share/apache2/icons&quot;&gt;
      17:   Options FollowSymlinks
      18:   AllowOverride None
      19:   Require all granted
        : &lt;/Directory&gt;
    In file: /etc/apache2/mods-enabled/autoindex.conf
      ...</pre>
<ul>
<li class="level1"><div class="li"> <strong>Llistat dels mòduls</strong>: fa un llistat de tots els mòduls carregats actualment en la memòria. Es poden observar quins mòduls estan carregats estàticament i quins dinàmicament.</div>
</li>
</ul>
<pre class="code">Server Module List
    core.c
    event.c
    http_core.c
...</pre>
<ul>
<li class="level1"><div class="li"> <strong>Informació detallada de cada mòdul</strong>: segurament aquesta és una de les opcions més interessants, perquè permet observar les directives proporcionades per un mòdul i els valors que té assignats. D’aquesta manera, es pot validar fàcilment si el mòdul adopta els valors apropiats o si s’ha comès alguna errada en la configuració.</div>
</li>
</ul>

</div>

<h2><a id="registres_del_servei" >Registres del servei</a></h2>
<div class="level2">

<p>
Els fitxers de <em>logs</em> enregistren tots els successos que es produeixen en el servei web i que s’ha declarat que s’han d’enregistrar. El seu funcionament és idèntic al dels <em>logs</em> del sistema. El servidor web Apache utilitza un fitxer que enregistra els errors que es produeixen i un altre que enregistra els accessos al servidor web. Aquests fitxers enregistren el servei web global o per defecte. Per a cada seu web virtual o <em>virtual host</em> es poden definir els fitxers de <em>log</em> que es considerin oportuns. El contingut que s’enregistra per a cada succés és configurable, de manera que l’administrador pot personalitzar al seu gust quina informació s’emmagatzema i en quin format.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Els fitxers de <strong><em>log</em></strong> enregistren els successos del servidor web. S’anoten aquells successos que s’han <strong>declarat</strong> per ser enregistrats i en un <strong>format</strong> de missatge configurable.
</p>

<p>
El servei web principal utilitza un fitxer d’<strong>errors</strong> i un de <strong>accés</strong> en la configuració predeterminada. Cada una de les diferents seus virtuals defineix els seus propis fitxers de <em>log</em>.
</p>
</div></div>
<p>
El següent és un recull de les directives relacionades amb la gestió de <em>logs</em> que hi ha al fitxer de configuració global apache2.conf:
</p>
<pre class="code">ErrorLog ${APACHE_LOG_DIR}/error.log
LogLevel warn
LogFormat &quot;%v:%p %h %l %u %t \&quot;%r\&quot; %&gt;s %O \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot;&quot; vhost_combined
LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %O \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot;&quot; combined
LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %O&quot; common
LogFormat &quot;%{Referer}i -&gt; %U&quot; referer
LogFormat &quot;%{User-agent}i&quot; agent</pre>

<p>
Els conceptes principals que descriuen aquestes directives són:
</p>
<ul>
<li class="level1"><div class="li"> <strong><em>ErrorLog</em></strong>: defineix quin és el fitxer en què s’han d’enregistrar els successos d’error. </div>
</li>
<li class="level1"><div class="li"> <strong><em>LogLevel</em></strong>: defineix quin és el nivell (<em>verbosity</em>) dels successos que s’han d’enregistrar. Aquest poden ser: emerg, alert, crit, error, warn, notice, info, debug, trace1… trace8. Estan ordenats de menys informació a més, doncs cal tenir en compte d’ajustar bé aquest paràmetre si no volem tenir fitxers de <em>log</em> molt grans i que alenteixin el servei web, sobretot en entorns de producció (un cop ja testejats).</div>
</li>
<li class="level1"><div class="li"> <strong><em>CustomLog</em></strong>: defineix el fitxer en què s’han de desar els accessos al servei web. Aquest fitxer contindrà el registre de totes les sol·licituds i respostes gestionades pel servidor. El format dels missatges de <em>log</em> que s’enregistraran per defecte és <em>combined</em>. Aquesta directiva es pot usar per definir tants fitxers de <em>log</em> com es cregui pertinent, cal una directiva per a cada fitxer a generar.</div>
</li>
<li class="level1"><div class="li"> <strong>LogFormat</strong>: cada una d’aquestes directives defineix un format de missatge de <em>log</em>. En l’exemple es defineixen cinc formats: <em>vhost_combined</em>, <em>combined</em>, <em>common</em>, <em>referer</em> i <em>agent</em>. Amb aquesta directiva l’administrador pot personalitzar el format que han de tenir els missatges de <em>log</em> al seu gust.</div>
</li>
<li class="level1"><div class="li"> <strong>Directori de logs</strong>: no es mostra explícitament en cap de les directives, però es pot veure que està definit en la variable d’entorn APACHE_LOG_DIR definida al fitxer <code>/etc/apache2/envvars</code>. </div>
</li>
</ul>
<pre class="code">root@server:/# cat /etc/apache2/envvars | grep APACHE_LOG_DIR
export APACHE_LOG_DIR=/var/log/apache2$SUFFIX
root@server:/# </pre>

<p>
Aquesta, al seu torn, també està formada per una altra variable d’entorn (SUFFIX), que s’afegeix en el cas que s’hagi de tenir múltiples instàncies del servidor Apache:
</p>
<pre class="code"># for supporting multiple apache2 instances
if [ &quot;${APACHE_CONFDIR##/etc/apache2-}&quot; != &quot;${APACHE_CONFDIR}&quot; ] ; then
        SUFFIX=&quot;-${APACHE_CONFDIR##/etc/apache2-}&quot;
else
        SUFFIX=
fi</pre>
<ul>
<li class="level1"><div class="li"> <strong>Seus virtuals</strong>: cada una de les seus virtuals defineix els seus propis fitxers de <em>log</em>. És usual assignar a aquests fitxers el nom de la seu virtual, tal com es pot veure en l’exemple següent. Si una seu virtual no declara fitxers de <em>log</em> propis amb les directives <em>ErrorLog</em> i <em>CustomLog</em>, s’utilitzen els fitxers globals.</div>
</li>
</ul>
<pre class="code">&lt;VirtualHost www.ioc.cat:80&gt;
    ServerAdmin webmaster@ioc.cat
    DocumentRoot /var/www/www.ioc.cat
    ServerName www.ioc.cat
    ErrorLog logs/www.ioc-error_log
    CustomLog logs/www.ioc-access_log common
&lt;/VirtualHost&gt;</pre>

<p>
Així, seguint les indicacions estàndard, el directori de <em>logs</em> contindrà una parella de fitxers anomenats <strong>error_log</strong> i <strong>access_log</strong> per a cada seu virtual i per a la seu global. A més, altres mòduls, com per exemple SSL, poden generar els seus propis fitxers de <em>log</em>. També es mantenen històrics dels registres, de manera que es poden trobar múltiples versions del mateix fitxer corresponents a períodes de temps diferents (tasca duta a terme per <em>log-rotate</em>).
</p>

</div>

	 </article>
     <div class="pnpage">
      <div class="left-corner"></div>
      <div id="prevpage">Anar a la p&agrave;gina anterior:<br /><a href="../../../WebContent/u2/referencies.html">Referències</a></div>
      <div id="nextpage">Anar a la p&agrave;gina seg&uuml;ent:<br /><a href="../../../WebContent/u2/a1/activitats.html">Activitats</a></div>
      <div class="right-corner"></div>
     </div>
    </div>
    <footer class="footer">
      <div><small>Aquest document està subjecte a una llicència oberta de Creative Commons, es reserva el dret de reconeixement de l'autoria, d'exigir que no se'n faci cap mena d'ús comercial. Si altereu o transformeu aquesta obra, o en genereu obres derivades, només podeu distribuir l'obra generada amb una llicència idèntica a aquesta.</small></div>
    </footer>
 </div>
 <div id="back_preview" class="hidden"></div>
 <div id="preview" class="hidden">
  <div class="prevcontent"></div>
 </div>
 <div id="help-tooltips">
  <div id="help-toc" class="hidden tooltip"><span>Taula de continguts:</span> Ofereix una vista general de l&#39;estructura del m&ograve;dul, que us facilitar&agrave; la navegaci&oacute; a trav&eacute;s dels seus continguts.<span class="arrow-left"></span></div> 
  <div id="help-settings" class="hidden tooltip"><span>Opcions de format:</span> Permet configurar el format de lectura a partir de les vostres prefer&egrave;ncies, modificant la mida de la lletra, el color del fons, l&#39;amplada de la p&agrave;gina o l&#39;ocultaci&oacute; dels continguts complementaris, entre d&#39;altres.<span class="arrow-left"></span></div>
  <div id="help-printer" class="hidden tooltip"><span>Imprimir:</span>  Envia el contingut seleccionat a la impressora.<span class="arrow-left"></span></div>
  <div id="help-favorites" class="hidden tooltip"><span>Prefereits:</span> Permet desar aquelles parts del contingut a les que us interessi accedir en un moment posterior; us permetr&agrave; anar creant un repositori personalitzat de les seccions que considereu m&eacute;s rellevants. Un cop l&#39;hageu començat a fer servir se us mostrar&agrave; a sota un comptador que us informar&agrave; del nombre de preferits que s&#39;hagin emmagatzemat fins al moment.<span class="arrow-left"></span></div>
  <div id="help-favcounter" class="hidden tooltip"><span>Comptador i llistat de preferits:</span> Indica el nombre de preferits que s&#39;han desat fins el moment; clicant damunt seu accedireu al llistat de preferits, i a trav&eacute;s d&#39;aquest podreu accedir directament als continguts que hageu emmagatzemat.<span class="arrow-left"></span></div>
  <div id="help-help_icon" class="hidden tooltip"><span>Ajuda:</span> Aquesta opci&oacute; activa la informaci&oacute; de les funcionalitats del web tot situant el punter del ratol&iacute; al damunt dels diferents &iacute;tems.<span class="arrow-left"></span></div>
  <div id="help-sidebar-hide" class="hidden tooltip"><span>Mostrar/Ocultar barra lateral:</span>  Deshabilita la barra d&#39;opcions, permetent la seva recuperaci&oacute; quan es desitgi.<span class="arrow-left"></span></div>
  <div id="help-search" class="hidden tooltip"><span>Cerca:</span>  Introdu&iuml;u les paraules clau sobre aquells conceptes que desitgeu localitzar en els continguts del m&ograve;dul. Tamb&eacute; podeu excloure un terme de la cerca tot afegint-hi el signe &#8220;-&#8221; al davant.<span class="arrow-top"></span></div>
  <div id="help-header" class="hidden tooltip"><span>Cap&ccedil;alera:</span>  Indica l&#39;apartat o secci&oacute; que es mostra en pantalla. Tingueu present que les capçaleres de segon, tercer i quart nivell tamb&eacute; es poden desar com a marcadors.<span class="arrow-left"></span></div>
</div> 
</body>
</html>
