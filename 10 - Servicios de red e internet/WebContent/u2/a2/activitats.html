<!doctype html>

<!--[if lt IE 7 ]> <html class="ie ie6 no-js" lang="ca"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie ie7 no-js" lang="ca"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie ie8 no-js" lang="ca"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie ie9 no-js" lang="ca"> <![endif]-->
<!--[if gt IE 9]><!--><html class="no-js" lang="ca"><!--<![endif]-->
<!-- the "no-js" class is for Modernizr. -->

<head id="www-sitename-com" data-template-set="html5-reset">

	<meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html">
        
	<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title>Serveis de Xarxa i Internet</title>
	
<!-- <meta name="title" content=""> --> 
	<meta name="description" content="">
	<!-- Google will often use this as its description of your page/site. Make it good. -->
	
	<meta name="google-site-verification" content="">
	<!-- Speaking of Google, don't forget to set your site up: http://google.com/webmasters -->
	
	<meta name="author" content="Institut Obert de Catalunya">
	<meta name="Copyright" content="Copyright Institut Obert de Catalunya 2011. All Rights Reserved.">

	<!-- Dublin Core Metadata : http://dublincore.org/ -->
	<meta name="DC.title" content="Serveis de Xarxa i Internet">
	<meta name="DC.subject" content="Informàtica i comunicacions">
	<meta name="DC.creator" content="Institut Obert de Catalunya">
	
	<!--  Mobile Viewport Fix
	j.mp/mobileviewport & davidbcalhoun.com/2010/viewport-metatag 
	device-width : Occupy full width of the screen in its current orientation
	initial-scale = 1.0 retains dimensions instead of zooming out if page height > device height
	maximum-scale = 1.0 retains dimensions instead of zooming in if page width < device width
	-->
	<!-- Uncomment to use � use thoughtfully!
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
	-->

	<link rel="shortcut icon" href="../../../img/favicon.ico">
	<!-- This is the traditional favicon.
		 - size: 16x16 or 32x32
		 - transparency is OK
		 - see wikipedia for info on browser support: http://mky.be/favicon/ -->
		 
	<link rel="apple-touch-icon" href="../../../img/apple-touch-icon.png">
	<!-- The is the icon for iOS's Web Clip.
		 - size: 57x57 for older iPhones, 72x72 for iPads, 114x114 for iPhone4's retina display (IMHO, just go ahead and use the biggest one)
		 - To prevent iOS from applying its styles to the icon name it thusly: apple-touch-icon-precomposed.png
		 - Transparency is not recommended (iOS will put a black BG behind the icon) -->
	
	<!-- CSS: screen, mobile & print are all in the same file -->
	<link rel="stylesheet" href="../../../_/css/style.css">

	<!-- CSS: jQuery UI -->
	<link rel="stylesheet" href="../../../_/css/jquery-ui.css">
	
	<!-- all our JS is at the bottom of the page, except for Modernizr. -->
	<script src="../../../_/js/modernizr-1.7.min.js"></script>
	<script src="../../../_/js/Hyphenator.js" type="text/javascript"></script>
	<script type="text/javascript">
	   Hyphenator.config({
		minwordlength : 4
	   });
	   Hyphenator.run();
	</script>
    <script src="../../../_/js/build.js" type="text/javascript"></script>
</head>

<body class="style-newspaper">

<div class="wrapper"><!-- not needed? up to you: http://camendesign.com/code/developpeurs_sans_frontieres -->

	<header id="header">
		<div class="head"><a href="http://ioc.gencat.cat"><img src="../../../img/logo.png" alt="Institut Obert de Catalunya"/></a><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/es/deed.ca"><img src="../../../img/license.png" alt="Llic&egrave;ncia" class="license"/></a></div>
		<div class="headdocument"><a href="../../../index.html">Serveis de Xarxa i Internet</a></div>
        <div id="search" class="search" name="search">
         <form id="frmsearch" action="../../../search.html" method="get">
          <input type="text" name="q"/>
        </form>
        </div>
	</header>
   <div id="upbutton" class="upbutton" style="display:none;"><img src="../../../img/uparrow.png" alt="Pujar a l'inici de p&agrave;gina"/></div>
   <aside id="aside">
    <div id="menu">
      <ul>
       <li name="toc"><div><img src="../../../img/toc.png" alt="&Iacute;ndex"/></div></li>
       <li name="settings"><div><img src="../../../img/settings.png" alt="Configuraci&oacute;"/></div></li>
       <li name="printer"><div><img src="../../../img/printer.png" alt="Imprimir"/></div></li>
       <li name="favorites"><div><img src="../../../img/favorites.png" alt="Favorits"/></div></li>
       <li name="help_icon" class="help_icon"><div><img src="../../../img/help_icon.png" alt="Ajuda"/></div></li>
      </ul>
     </div>
   </aside>
   <div id="sidebar-hide" name="sidebar-hide"><img src="../../../img/arrows.png"/></div>
   <section>
     <div id="toc" class="hidden">
      <div class="menucontent">
        <ul>
        <li id="u2" class="parentnode"><p><a class="unit" href="../../../WebContent/u2/introduccio.html">2. Serveis web i de transferència de fitxers</a></p><ul class="expander"><li id="u2introduccio"><a href="../../../WebContent/u2/introduccio.html">Introducció</a></li><li id="u2resum"><a href="../../../WebContent/u2/resum.html">Resum</a></li><li id="u2resultats"><a href="../../../WebContent/u2/resultats.html">Resultats d'aprenentatge</a></li><li id="u2referencies"><a href="../../../WebContent/u2/referencies.html">Referències</a></li><li id="u2a1" class="tocsection"><p id='u2a1continguts'><a class="section" href="../../../WebContent/u2/a1/continguts.html">Instal·lació i administració de servidors web</a><span class="buttonexp"></span></p><ul><li id="u2a1activitats"><a href="../../../WebContent/u2/a1/activitats.html">Activitats</a></li><li id="u2a1exercicis"><a href="../../../WebContent/u2/a1/exercicis.html">Exercicis</a></li><li id="u2a1annexos"><a href="../../../WebContent/u2/a1/annexos.html">Annexos</a></li></ul></li><div data-parent-id='u2a1' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u2/a1/continguts.html#funcionament_del_servei_web">Funcionament del servei web</a></li><li><a href="../../../WebContent/u2/a1/continguts.html#instal_lacio_i_configuracio_de_servidors_web">Instal·lació i configuració de servidors web</a></li><li><a href="../../../WebContent/u2/a1/continguts.html#moduls_dinamics">Mòduls dinàmics</a></li><li><a href="../../../WebContent/u2/a1/continguts.html#creacio_i_configuracio_de_llocs_web_virtuals">Creació i configuració de llocs web virtuals</a></li><li><a href="../../../WebContent/u2/a1/continguts.html#autenticacio">Autenticació</a></li><li><a href="../../../WebContent/u2/a1/continguts.html#comunicacions_segures">Comunicacions segures</a></li><li><a href="../../../WebContent/u2/a1/continguts.html#monitoratge_del_servei">Monitoratge del servei</a></li><li><a href="../../../WebContent/u2/a1/continguts.html#registres_del_servei">Registres del servei</a></li></ul></div></div><li id="u2a2" class="tocsection"><p id='u2a2continguts'><a class="section" href="../../../WebContent/u2/a2/continguts.html">Instal·lació i administració de serveis de transferència de fitxers</a><span class="buttonexp"></span></p><ul><li id="u2a2activitats"><a href="../../../WebContent/u2/a2/activitats.html">Activitats</a></li><li id="u2a2exercicis"><a href="../../../WebContent/u2/a2/exercicis.html">Exercicis</a></li><li id="u2a2annexos"><a href="../../../WebContent/u2/a2/annexos.html">Annexos</a></li></ul></li><div data-parent-id='u2a2' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u2/a2/continguts.html#servei_de_transferencia_de_fitxers">Servei de transferència de fitxers</a></li><li><a href="../../../WebContent/u2/a2/continguts.html#instal_lacio_i_configuracio_del_servidor">Instal·lació i configuració del servidor</a></li><li><a href="../../../WebContent/u2/a2/continguts.html#creacio_d_usuaris_i_grups">Creació d'usuaris i grups</a></li><li><a href="../../../WebContent/u2/a2/continguts.html#configuracio_de_l_acces_anonim">Configuració de l’accés anònim</a></li><li><a href="../../../WebContent/u2/a2/continguts.html#limitacions_d_acces">Limitacions d’accés</a></li><li><a href="../../../WebContent/u2/a2/continguts.html#modes_d_acces_al_servidor">Modes d'accés al servidor</a></li><li><a href="../../../WebContent/u2/a2/continguts.html#comunicacions_segures">Comunicacions segures</a></li><li><a href="../../../WebContent/u2/a2/continguts.html#clients_grafics_i_de_text">Clients gràfics i de text</a></li></ul></div></div></ul></li><li id="" class="indexnode"><p><a href="../../../index.html">Anar a l&#39;&iacute;ndex general</a></p></li>
        </ul>
      </div>
    </div>
   </section>
   <section>
   <div id="settings" class="hidden">
    <div class="menucontent">
     <div class="allsettings">
     <div class="settings">
      <label>Font i Color</label>
		<div class="setting-option">
	        <ul class="fontBackground">
				<li id="style-newspaper" title="Newspaper" class="appearance-style-newspaper"><span>Newspaper</span></li>
                <li id="style-novel" title="Novel" class="appearance-style-novel"><span>Novel</span></li>
                <li id="style-ebook" title="eBook" class="appearance-style-ebook"><span>eBook</span></li>
				<li id="style-inverse" title="Inverse" class="appearance-style-inverse active"><span>Inverse</span></li>
				<li id="style-athelas" title="Athelas" class="appearance-style-athelas"><span>Athelas</span></li>
			</ul>
		</div>
     </div>
	<div class="settings">
      <label>Amplada</label>
		<div class="setting-option">
	        <div id="slider-width"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
		<div class="setting-option">
	        <div id="slider-font"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
	  <div class="setting-option">
       <form action="" class="sett-options">
		<ul>
		    <li><input type="checkbox" id="secondary-content" /><label for="secondary-content">Mostra recursos complementaris</label></li>
		    <li><input type="checkbox" id="main-images" /><label for="main-images">Mostra imatges</label></li>
		    <li><input type="checkbox" id="text-alignment" /><label for="text-alignment">Text justificat</label></li>
			<li><input type="checkbox" id="text-hyphen" /><label for="text-hyphen">Partici&oacute; sil·l&agrave;bica</label></li>
		</ul>
       </form>
	  </div>
     </div>
     </div>
    </div>
   </div>
   </section>
 <section>
 <div id="favorites" class="hidden"></div>
 </section>   
 <div id="bridge" class="hidden"></div>
 <div id="help" class="hidden">
  <div class="helptitle">Dreceres del teclat<hr></div>
  <div class="helpsection"><span>General</span>
   <ul>
    <li><span class="shortcut">g</span>: Anar al men&uacute; de navegaci&oacute;</li>
    <li><span class="shortcut">o</span>: Anar a opcions</li>
    <li><span class="shortcut">s</span>: Guardar la p&agrave;gina actual a favorits</li>
    <li><span class="shortcut">p</span>: Imprimir la p&agrave;gina actual</li>
    <li><span class="shortcut">?</span>: Mostrar/Ocultar l&#39;ajuda</li>
   </ul>
  </div>
  <div class="helpsection"><span>Navegaci&oacute;</span>
   <ul>
    <li><span class="shortcut">i</span>: Anar a l&#39;&iacute;ndex general</li>
    <li><span class="shortcut">t</span>: Anar a l&#39;inici de p&agrave;gina</li>
    <li><span class="shortcut">b</span>: Anar al final de p&agrave;gina</li>
    <li><span class="shortcut">j</span>: Anar cap endavant dintre la p&agrave;gina</li>
    <li><span class="shortcut">k</span>: Anar cap enrere dintre la p&agrave;gina</li>
    <li><span class="shortcut">h</span>: Anar a la p&agrave;gina anterior:</li>
    <li><span class="shortcut">l</span>: Anar a la p&agrave;gina seg&uuml;ent:</li>
   </ul>
   </div>
 </div>
 <div id="favcounter" name="favcounter" class="hidden"><span></span></div>
 <div id="navmenu" class="navmenu"><ul class="webnav"><li><a href="../../../index.html" title="Anar a l&#39;&iacute;ndex general">Inici</a></li><li><a href="../introduccio.html">Serveis web i de transferència de fitxers</a></li><li><a href="continguts.html">Instal·lació i administració de serveis de transferència de fitxers...</a></li><li>Activitats</li></ul></div>
	<div id="content" lang="ca" class="hyphenate text">
     <article lang="ca" class="sheet">
        <h1><a id="activitats"> Activitats </a></h1>
    	
<h2><a id="protocol_ftp" >Protocol FTP</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és comprendre el funcionament general del protocol <acronym title="File Transfer Protocol">FTP</acronym>.
</p>

<p>
Realitzeu el següent:
</p>
<ol>
<li class="level1"><div class="li"> Llisteu els ports usats pel protocol <acronym title="File Transfer Protocol">FTP</acronym> en un sistema Linux (usualment <code>/etc/services</code>).</div>
</li>
<li class="level1"><div class="li"> Useu les ordres de monitoratge del trànsit TCP (usualment, <code>nmap</code>, <code>netstat</code>, <code>ss</code> i <code>IPTraf</code>, entre altres) per observar els ports oberts en el client i el servidor.</div>
</li>
</ol>

<p>
<form action=""><div class="solution ioccontent">
<p>
<strong>1.</strong> Llistar ports 
</p>

<p>
Llistat dels ports que inclouen alguna referència <acronym title="File Transfer Protocol">FTP</acronym>:
</p>
<pre class="code">[root@portatil ~]# cat /etc/services | grep ftp
ftp-data    20/tcp
ftp		      21/tcp
tftp		    69/udp
sftp		    115/tcp
ftps-data	  989/tcp				# FTP over SSL (data)
ftps		    990/tcp
venus-se	  2431/udp			# udp sftp side effect
codasrv-se	2433/udp			# udp sftp side effect
gsiftp		  2811/tcp
gsiftp	  	2811/udp
frox		    2121/tcp			# frox: caching ftp proxy
zope-ftp  	8021/tcp			# zope management by ftp</pre>

<p>
Llistat dels ports exclusius del protocol <acronym title="File Transfer Protocol">FTP</acronym> i FTPS:
</p>
<pre class="code">root@debian:/var# cat /etc/services | grep &quot;^ftp&quot;
ftp-data  20/tcp
ftp		    21/tcp
ftps-data	989/tcp				# FTP over SSL (data)
ftps		  990/tcp</pre>

<p>
<strong>2.</strong> Monitoritzar tràfic 
</p>
<ul>
<li class="level1"><div class="li"> Sessió ftp. Per fer les captures i el monitoratge de les comunicacions i els ports hem fet sempre la mateixa sessió ftp (però cada vegada s’utilitzen ports diferents). La sessió identifica l’usuari pere, fa l’ordre <code>pwd</code>, <code>ls</code> i <code>get pere.info</code>.</div>
</li>
<li class="level1"><div class="li"> <code>Iptraf</code>. Activar la monitorització de totes les interfícies o de la interfície corresponent. Si ataquem el propi <em>host</em> utilitzant el <em>loopback</em> només cal seleccionar-lo. Com es pot veure en la imatge següent.</div>
</li>
<li class="level1"><div class="li"> Element de llista de pics. El tràfic del canal de control va del port 47158 del client al port 21 del servidor (la mateixa màquina).</div>
</li>
<li class="level1"><div class="li"> El canal de dades per a la transferència del llistat s’ha establert entre dos ports dinàmics del client i el servidor. <em>vsftpd</em> treballa per defecte en <em>passive mode</em>, de manera que el client estableix la connexió de dades al port que el servidor li indica. Del port 5268 del client al port 33667 del servidor. Un cop transferit el llistat, aquesta connexió TCP finalitza.</div>
</li>
<li class="level1"><div class="li"> La transferència del fitxer s’ha fet per una nova connexió TCP entre el client i el servidor, usant els ports 27456 del client i el 53335 del servidor.</div>
</li>
</ul>

<p>
<div class="imgelem">
<img src="../media/m8u2a2_ftp_iptraf.png" alt="" /></div>

</p>
<ul>
<li class="level1"><div class="li"> Ordre <code>ss</code>. Llistar els ports utilitzats amb l’ordre <code>ss</code>. S’ha descarregat un fitxer gran (un kernel de <code>/boot/vmlinuz</code>…) per tenir temps d’executar l’ordre en una altra sessió mentre es fa la descàrrega del fitxer.</div>
</li>
</ul>

<p>
En aquesta sessió <acronym title="File Transfer Protocol">FTP</acronym> el client utilitza el port 32770 pel canal de control, i el servidor lògicament el port 21 (etiquetat com a ftp).  
</p>

<p>
La transferència del fitxer del kernel es fa per una connexió TCP entre el port 60175 del client al port 489890 del servidor. 
</p>
<pre class="code">[root@portatil ~]# ss
State       Recv-Q Send-Q Local Address:Port Peer Address:Port

ESTAB       0      0      127.0.0.1:ftp            127.0.0.1:32770
ESTAB       0      16384  127.0.0.1:60175          127.0.0.1:49890
ESTAB       0      0      127.0.0.1:32770          127.0.0.1:ftp
ESTAB 0 0 127.0.0.1:49890 127.0.0.1:60175 </pre>
<ul>
<li class="level1"><div class="li"> <code>Netstat</code>. L’ordre <code>netstat</code> mostra les connexions actives. Es pot usar l’opció <code>-t</code> per filtrar només el tràfic tcp, <code>-n</code> per mostrar els números de port (en lloc dels noms ben coneguts), <code>-v</code> perquè sigui <em>verbose</em> i <code>-c</code> perquè faci el reconeixement sistemàtic contínuament. </div>
</li>
</ul>
<pre class="code">[root@portatil ~]# netstat -tnvc
Active Internet connections (w/o servers)
Proto Recv-Q Send-Q Local Address       Foreign Address   State
tcp   0      0      127.0.0.1:21        127.0.0.1:44449   ESTABLISHED
tcp   0      0      127.0.0.1:44449     127.0.0.1:21      ESTABLISHED

Active Internet connections (w/o servers)
Proto Recv-Q Send-Q Local Address       Foreign Address   State
tcp   0      0      127.0.0.1:44902     127.0.0.1:43686   TIME_WAIT
tcp   0      0      127.0.0.1:21        127.0.0.1:44449   ESTABLISHED
tcp   0      0      127.0.0.1:44449     127.0.0.1:21      ESTABLISHED

Active Internet connections (w/o servers)
Proto Recv-Q Send-Q Local Address       Foreign Address   State
tcp   0      0      127.0.0.1:44902     127.0.0.1:43686   TIME_WAIT
tcp   0      0      127.0.0.1:37909     127.0.0.1:48589   TIME_WAIT
tcp   0      0      127.0.0.1:21        127.0.0.1:44449   ESTABLISHED
tcp   0      0      127.0.0.1:44449     127.0.0.1:21      ESTABLISHED

...
Active Internet connections (w/o servers)
Proto Recv-Q Send-Q Local Address       Foreign Address   State
tcp   15     0      127.0.0.1:44449     127.0.0.1:21      CLOSE_WAIT
</pre>

<p>
Com es pot observar del llistat, la sessió <acronym title="File Transfer Protocol">FTP</acronym> ha realitzat tres connexions: 
</p>
<ul>
<li class="level1"><div class="li"> La primera d’elles és la connexió de control entre el port 44449 del client i el port 21 del servidor. Fixeu-vos que l’estat és <code>ESTABLISHED</code> perquè és una connexió establerta i que es manté oberta.</div>
</li>
<li class="level1"><div class="li"> La segona connexió es la que realitza el llistat del directori. Es produeix entre el port 44902 del client i el port 43686 del servidor. L’estat és <code>TIME_WAIT</code> perquè la connexió ja ha finalitzat, però el <em>socket</em> triga un temps a tancar-se. Un cop es tanca apareix en l’estat <code>CLOSE_WAIT</code> i quan ha passat un cert temps ja no apareix.</div>
</li>
<li class="level1"><div class="li"> La tercera connexió correspon a la descàrrega del fitxer. El client usa el port 37909 per connectar-se al port de dades 48589 del servidor.</div>
</li>
<li class="level1"><div class="li"> Finalment, podem veure que si passa un temps sense que la sessió ftp faci res s’acaba tancant automàticament. Observeu que un cop el <em>socket</em> s’ha tancat apareix com a <code>CLOSE_WAIT</code> per un cert període de temps. </div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> <code>Nmap</code>. Aquesta ordre permet fer un revisió de l’estat dels ports d’una màquina, entre moltes altres coses. S’utilitza sovint com una eina d’intrusió (o de xafardeig). Per tant, és una excel·lent eina de l’administrador per comprovar l’estat del servidor:</div>
</li>
</ul>
<pre class="code">[root@portatil ~]# nmap localhost
Starting Nmap 4.20 ( http://insecure.org ) at 2008-06-01 21:21 CEST
Interesting ports on localhost (127.0.0.1):
Not shown: 1693 closed ports 

PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
111/tcp  open  rpcbind
8000/tcp open http-alt </pre>

<p>
Podeu consultar també altres fonts d’informació, com els webs següents:
</p>

<p>
<a href="https://sites.google.com/site/asxm08edt" class="urlextern" title="https://sites.google.com/site/asxm08edt"  rel="nofollow">M08-SXI Serveis de xarxa i internet</a>
</p>

<p>
<a href="http://tldp.org" class="urlextern" title="http://tldp.org"  rel="nofollow">The Linux Documentation Project</a>
</p>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

<h2><a id="client_ftp" >Client FTP</a></h2>
<div class="level2">

<p>
En aquesta activitat treballareu com a client <acronym title="File Transfer Protocol">FTP</acronym>. Cal que feu el següent:
</p>
<ol>
<li class="level1"><div class="li"> Obteniu d’Internet una llista de clients <acronym title="File Transfer Protocol">FTP</acronym> en mode text i en mode gràfic i descriviu-ne les característiques.</div>
</li>
<li class="level1"><div class="li"> Obteniu d’Internet una llista de repositoris <acronym title="File Transfer Protocol">FTP</acronym> de programari públic des d’on descarregar-vos aplicacions interessants.</div>
</li>
<li class="level1"><div class="li"> Utilitzeu un navegador web per accedir al servei <acronym title="File Transfer Protocol">FTP</acronym> de RedIRIS (ftp.rediris.es) i observeu els continguts disponibles.</div>
</li>
<li class="level1"><div class="li"> Realitzeu en una sessió client d’<acronym title="File Transfer Protocol">FTP</acronym> totes aquestes accions: connectar-vos, llistar, descarregar un fitxer, descarregar a un directori local diferent, descarregar un conjunt de fitxers o directoris, modificar el mode de transferència, reprendre una descàrrega interrompuda, tancar la sessió i obrir una nova sessió en un altre servidor.</div>
</li>
</ol>

<p>
<form action=""><div class="solution ioccontent">
<p>
Buscar per Internet, per exemple a Google, clients <acronym title="File Transfer Protocol">FTP</acronym>.
<div class="imgelem">
<img src="../media/m8u2a2_ftp_google1.png" alt="" /></div>

</p>

<p>
Obtenir una llista de repositoris públics:
<div class="imgelem">
<img src="../media/m8u2a2_ftp_google2.png" alt="" /></div>

</p>

<p>
Utilitzant el navegador, accedir a la seu ftp de rediris <a href="ftp://ftp.rediris.es" class="urlextern" title="ftp://ftp.rediris.es"  rel="nofollow">ftp.rediris.es</a>. Evidentment, cal usar el protocol ftp i no l’hhtp, per tant la <acronym title="Uniform Resource Identifier">URI</acronym> quedarà amb l’esquema ftp i la direcció de rediris: <a href="ftp://ftp.rediris.es" class="urlextern" title="ftp://ftp.rediris.es"  rel="nofollow">ftp://ftp.rediris.es</a> .
</p>

<p>
<div class="imgelem">
<img src="../media/m8u2a2_ftp_google3.png" alt="" /></div>

</p>
<ul>
<li class="level1"><div class="li"> Sessió client <acronym title="File Transfer Protocol">FTP</acronym>. Cal realitzar una sessió de client <acronym title="File Transfer Protocol">FTP</acronym> i descarregar i carregar fitxers i directoris. Modificar el mode de la transmissió i canviar de servidor. </div>
</li>
</ul>
<pre class="code">[root@portatil tmp]# ftp 
ftp&gt; open ftp.rediris.es
Connected to zeppo.rediris.es.
220---------- Welcome to Pure-FTPd [privsep] [TLS] ----------
220-You are user number 16 of 3000 allowed.
220-&lt;&lt;
220-  Bienvenido al FTP anónimo de RedIRIS.
220-Welcome to the RedIRIS anonymous FTP server.
220-&gt;&gt;
220-Local time is now 12:38. Server port: 21.
220-Only anonymous FTP is allowed here
220-IPv6 connections are also welcome on this server.
220 You will be disconnected after 5 minutes of inactivity.
Name (ftp.rediris.es:professor): anonymous
331-            RedIRIS - Red Académica y de Investigación Española
331-                RedIRIS - Spanish National Research Network
331-
331-           ftp://ftp.rediris.es  -=-  http://ftp.rediris.es
331-
331 Any password will work
Password:
230 Any password will work
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls
227 Entering Passive Mode (130,206,1,5,117,92)
150 Accepted data connection
drwxr-xr-x    2 55       55            512 Jul 18 2005 .
drwxr-xr-x    2 55       55            512 Jul 18 2005 ..
-rw-r--r--    1 55       55            619 Jul 24 2006 .banner
lrwxrwxrwx    1 55       55            43 Jul 21 2005 debian -&gt;

  volumes/vol2/syncproxy.eu.debian.org/debian
lrwxrwxrwx    1 55       55            50 Aug 1 2005 debian-non-US -&gt;
  volumes/vol2/syncproxy.eu.debian.org/debian-non-US
d-wx------    2 104      55            512 Jul 19 2005 incoming
-rw-r--r--    1 55       55      508725926 Jun 1 15:41 ls-lR
-rw-r--r--    1 55       55       93445864 Jun 1 15:45 ls-lR.Z
-rw-r--r--    1 55       55       65284937 Jun 1 15:43 ls-lR.gz
drwxrwxr-x    2 55       55           2560 May 12 15:37 mirror
d--x--x--x   21 55       55            512 May 14 17:38 outgoing
drwxr-xr-x    5 55       55            512 May 12 15:37 pub
lrwxrwxrwx    1 55       55             20 Aug 3 2005 rediris -&gt;
  volumes/vol1/rediris
drwxr-xr-x    2 55       55           2560 Apr 12 2007 sites
drwxr-xr-x    9 55       55            512 May 7 2007 volumes
-rw-r--r--    1 55       55             88 Oct 18 2005 welcome.msg
226-Options: -a -l
226 16 matches total 
ftp&gt; get ls-lR
local: ls-lR remote: ls-lR
227 Entering Passive Mode (130,206,1,5,152,52)
150-Accepted data connection
150 496802.7 kbytes to download

receive aborted
waiting for remote to finish abort
426 Transfer aborted
226 Transfer aborted
8119120 bytes received in 9,17 secs (8,6e+02 Kbytes/sec) 
ftp&gt; close
221-Goodbye. You uploaded 0 and downloaded 0 kbytes.
221 Logout. 
ftp&gt; open localhost
Connected to localhost.
220 (vsFTPd 2.3.2)
Name (localhost:professor): professor
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; trace
Packet tracing on.
ftp&gt; verbose
Verbose mode off.
ftp&gt; status
Connected to localhost.
No proxy connection.
Mode: stream; Type: binary; Form: non-print; Structure: file
Verbose: off; Bell: off; Prompting: on; Globbing: on
Store unique: off; Receive unique: off
Case: off; CR stripping: on
Quote control characters: on
Ntrans: off
Nmap: off
Hash mark printing: off; Use of PORT cmds: on
Tick counter printing: off
ftp&gt; ls
drwxr-xr-x    2 1000     1000         4096 May 03 13:16 Descargas
drwxr-xr-x    2 1000     1000         4096 Nov 06  2012 Documentos
drwx------    3 1000     1000         4096 May 02 13:23 Downloads
drwxr-xr-x    2 1000     1000         4096 Jul 04 12:30 Escritorio
drwxr-xr-x    2 1000     1000         4096 Nov 06  2012 Im??genes
drwxr-xr-x    2 1000     1000         4096 Nov 06  2012 M??sica
drwxr-xr-x    2 1000     1000         4096 Nov 06  2012 Plantillas
drwxr-xr-x    2 1000     1000         4096 Nov 06  2012 P??blico
drwxr-xr-x    2 1000     1000         4096 Nov 06  2012 V??deos
drwxr-xr-x    2 1000     1000         4096 May 21 12:49 entrants1213
-rw-r--r--    1 1000     1000          334 Jul 01 11:20 fitxer1.txt
-rw-r--r--    1 0        0            3110 Apr 29  2009 linuxmint-keyring_2009.04.29_all.deb
ftp&gt; get text.txt
local: text.txt remote: text.txt
227 Entering Passive Mode (127,0,0,1,234,45)
150 Opening BINARY mode data connection for text.txt (105 bytes).
WARNING! 3 bare linefeeds received in ASCII mode
File may not have transferred correctly.
226 File send OK.
105 bytes received in 0,000105 secs (9,8e+02 Kbytes/sec 
ftp&gt; !mkdir pub
ftp&gt; mget pub/* pub
mget pub/llistat? y
227 Entering Passive Mode (127,0,0,1,192,150)
150 Opening BINARY mode data connection for pub/llistat (110 bytes).
WARNING! 3 bare linefeeds received in ASCII mode
File may not have transferred correctly. 
226 File send OK.
110 bytes received in 0,000123 secs (8,7e+02 Kbytes/sec) 
mget pub/services? y
227 Entering Passive Mode (127,0,0,1,224,244)
150 Opening BINARY mode data connection for pub/services (362047 bytes).
WARNING! 9249 bare linefeeds received inASCII mode
File may not have transferred correctly.
226 File send OK.
362047 bytes received in 0,0279 secs (1,3e+04 Kbytes/sec)
mget pub/llistat? y
227 Entering Passive Mode (127,0,0,1,100,74)
150 Opening BINARY mode data connection for pub/llistat (110 bytes).
WARNING! 3 bare linefeeds received in ASCII mode
File may not have transferred correctly.
226 File send OK.
110 bytes received in 0,000104 secs (1e+03 Kbytes/sec)
mget pub/services? y
227 Entering Passive Mode (127,0,0,1,109,96)
150 Opening BINARY mode data connection for pub/services (362047 bytes).
WARNING! 9249 bare linefeeds received in ASCII mode
File may not have transferred correctly.
226 File send OK.
362047 bytes received in 0,0288 secs (1,2e+04 Kbytes/sec) </pre>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

<h2><a id="instal_lacio_i_configuracio_del_servidor_vsftpd_en_el_sistema_operatiu_linux" >Instal·lació i configuració del servidor vsftpd en el sistema operatiu Linux</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és practicar la instal·lació i configuració d’un servidor <acronym title="File Transfer Protocol">FTP</acronym>:
</p>

<p>
Feu les tasques següents:
</p>
<ol>
<li class="level1"><div class="li"> Instal·leu el servidor <acronym title="File Transfer Protocol">FTP</acronym> <strong>vsftpd</strong> (<em>very secure <acronym title="File Transfer Protocol">FTP</acronym> daemon</em>). Observeu els seus components: fitxers executables, fitxers de configuració, de documentació i de monitoratge.</div>
</li>
<li class="level1"><div class="li"> Comproveu l’estat del servei <acronym title="File Transfer Protocol">FTP</acronym>.</div>
</li>
<li class="level1"><div class="li"> Permeteu l’accés al servei <acronym title="File Transfer Protocol">FTP</acronym> d’usuaris autenticats.</div>
</li>
<li class="level1"><div class="li"> Monitoreu el trànsit que genera el servidor <acronym title="File Transfer Protocol">FTP</acronym> utilitzant Wireshark.</div>
</li>
</ol>

<p>
<form action=""><div class="solution ioccontent">
<p>
<strong>1. Instal·lació i components del servidor <acronym title="File Transfer Protocol">FTP</acronym></strong>
</p>

<p>
Val a dir que l’elecció d’aquest tipus de servidor radica en la seva facilitat d’instal·lació i configuració i el seu ús estès com a servidor anònim.
</p>

<p>
Per tant, atès que instal·lem el programari en el sistema operatiu Linux, podem procedir a instal·lar-lo mitjançant el terminal d’ordres. En aquest cas, per fer l’operació haurem de treballar mitjançant l’ordre <code>sudo</code> amb un usuari amb privilegis de <code>sudo</code> o, directament, essent <code>root</code>.
</p>
<pre class="code">root@server:~# apt install vsftpd
S&#039;està llegint la llista de paquets… Fet 
S&#039;està construint l&#039;arbre de dependències       
S&#039;està llegint la informació de l&#039;estat… Fet
S&#039;instal·laran els paquets NOUS següents:
  vsftpd
0 actualitzats, 1 nous a instal·lar, 0 a suprimir i 164 no actualitzats.
S&#039;ha d&#039;obtenir 153 kB d&#039;arxius.
Després d&#039;aquesta operació s&#039;empraran 357 kB d&#039;espai en disc addicional.
Bai:1 http://deb.debian.org/debian buster/main amd64 vsftpd amd64 3.0.3-12 [153 kB]
S&#039;ha baixat 153 kB en 0s (335 kB/s)
S&#039;estan preconfigurant els paquets...
S&#039;està seleccionant el paquet vsftpd prèviament no seleccionat.
(S&#039;està llegint la base de dades… hi ha 121463 fitxers i directoris instal·lats actualment.)
S&#039;està preparant per a desempaquetar …/vsftpd_3.0.3-12_amd64.deb…
S&#039;està desempaquetant vsftpd (3.0.3-12)…
S&#039;està configurant vsftpd (3.0.3-12)…</pre>

<p>
L’execució d’aquesta ordre facilitarà la instal·lació del servidor i, a més, la creació d’un nou usuari anomenat <em>ftp</em> en el nostre sistema operatiu, que serà inclòs dins del grup <em>nogroup</em>.
</p>

<p>
El directori <em>home</em> de l’usuari és propietat de <em>root</em> i el grup propietari és <em>nogroup</em>. Val a dir que en aquest directori s’allotjaran els arxius que desitgem compartir mitjançant el servidor <acronym title="File Transfer Protocol">FTP</acronym> per als usuaris anònims.
</p>

<p>
Arribats en aquest punt, és important destacar els diferents arxius de configuració presents dins del nostre sistema en el moment de la instal·lació del servidor vsftp:
</p>
<ul>
<li class="level1"><div class="li"> <code>/etc/init.d/vsftpd</code>: arxiu per arrencar el servidor <acronym title="File Transfer Protocol">FTP</acronym>.</div>
</li>
<li class="level1"><div class="li"> <code>/etc/vsftpd.conf</code>: arxiu de configuració del servidor vsftpd.</div>
</li>
<li class="level1"><div class="li"> <code>/etc/ftpusers</code>: arxiu on es troba una llista dels usuaris que <strong>no</strong> es podran connectar al servidor (root, bin, nobody, etc.).</div>
</li>
<li class="level1"><div class="li"> <code>/srv/ftp</code>: directori que conté els arxius que comparteixen el servidor.</div>
</li>
<li class="level1"><div class="li"> <code>/usr/sbin/vsftpd</code>: arxiu executable del servei <acronym title="File Transfer Protocol">FTP</acronym>.</div>
</li>
</ul>

<p>
Després de la instal·lació del servidor, cal configurar el servidor. Per fer-ho, hem d’adreçar-nos a l’arxiu que conté la configuració, això és, <code>/etc/vsftpd.conf</code>.
</p>
<pre class="code">root@server:~# head /etc/vsftpd.conf
# Example config file /etc/vsftpd.conf
#
# The default compiled in settings are fairly paranoid. This sample file
# loosens things up a bit, to make the ftp daemon more usable.
# Please see vsftpd.conf.5 for all compiled in defaults.
#
# READ THIS: This example file is NOT an exhaustive list of vsftpd options.
# Please read the vsftpd.conf.5 manual page to get a full idea of vsftpd&#039;s
# capabilities.
#
root@server:~# </pre>

<p>
L’estructura de les línies de l’arxiu <code>/etc/vsftpd.conf</code> segueix el següent patró:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">directiva=valor</div></li></ol></pre>

<p>
on directriu és el nom de la propietat que volem configurar i valor serà el valor que voldrem assignar a aquesta directriu. En aquest cas, si volem habilitar una directriu haurem de treure el caràcter de comentari (#).
</p>

<p>
Cal destacar que, entre les diferents opcions presents dins de l’arxiu <code>/etc/vsftpd.conf</code>, hi ha algunes que són booleanes, unes altres són numèriques i la resta són igual a cadenes de caràcters.
</p>

<p>
Cal destacar que algunes de les directrius que hi apareixen són força rellevants com, per exemple, servidor <em>standalone</em>. De fet, el servidor pot executar-se com un procés independent (<em>standalone</em>). Ara bé, per aconseguir-ho, la directriu <code>listen=YES</code> haurà d’estar activada (sense el caràcter de comentari).
</p>

<p>
Des del punt de vista de la gestió dels usuaris és important destacar que, per defecte, els usuaris que poden utilitzar el servidor són els anònims i tots aquells que disposin d’un compte en el sistema. En aquest cas, per activar-ne les funcions haurem d’activar les línies <code>anonymous_enable=YES</code> i <code>local_enable=YES</code>.
</p>

<p>
Respecte de la descàrrega d’arxius, quan un usuari anònim (<em>anomymous</em>) es connecta al servidor <acronym title="File Transfer Protocol">FTP</acronym> accedirà al directori home de l’usuari <em>anonymous</em> (<code>/srv/ftp</code>, per defecte). Val a dir que aquest usuari es trobarà en una mena de gàbia o entorn d’engabiament, això és, el seu directori arrel (directori <code>/</code>).
</p>

<p>
Els usuaris poden descarregar arxius que es trobin en el directori <code>/srv/ftp</code> i en els seus subdirectoris.
</p>

<p>
D’altra banda, quan un usuari local es connecti tindrem dues opcions de configuració del seu inici, això és, no engabiar-lo i permetre que interaccioni amb el sistema en funció dels seus permisos i privilegis, o bé engabiar-lo en el seu directori d’inici per motius de seguretat. En aquest cas, per activar la segona opció haurem d’activar la directriu <code>chroot_local_user=YES</code>.
</p>

<p>
Ara bé, en el cas que volguessin que algun dels usuaris no fos engabiat podríem establir els nous paràmetres mitjançant les directrius <code>chroot_list_enable=YES</code> i <code>chroot_list_file=/etc/vsftpd.chroot_lista</code>. La primera directriu indica que hi ha una llista d’usuaris que, en el moment de la connexió, no han de ser engabiats i, per contra, la segona directriu informa del nom del fitxer on es troben aquests usuaris.
</p>

<p>
Si volem permetre que els usuaris locals pugin arxius al servidor <acronym title="File Transfer Protocol">FTP</acronym> haurem d’habilitar la directriu <code>write_enable=YES</code>. De fet, hem de tenir en compte que per establir els permisos per defecte per als usuaris que carreguen arxius al servidor, podrem utilitzar la directriu <code>local_umask=022</code>.
</p>

<p>
En el cas de la càrrega d’arxius per part d’usuaris anònims, la càrrega per defecte està desactivada. De fet, per activar-la haurem d’incloure la directriu <code>anon_upload_enable=YES</code>; a més, haurem de crear un directori en el qual els permisos permetin escriure-hi.
</p>

<p>
De fet, com en el cas dels usuaris locals, haurem de posar una màscara per establir els permisos dels arxius que carreguen els usuaris anònims.
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">anon_umask=022</div></li></ol></pre>

<p>
D’altra banda, en el cas que volguéssim que els usuaris anònims modifiquessin arxius d’altres usuaris anònims i que, a més, poguessin crear directoris, haurem d’incloure les directrius següents:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">anon_other_write_enable=YES</div></li><li class="li1"><div class="de1">anon_mkdir_write_enable=YES</div></li></ol></pre>

<p>
Quan ens connectem al servidor <acronym title="File Transfer Protocol">FTP</acronym> i fem un canvi de directori podem habilitar la visualització de missatges emmagatzemant el text del missatge en un arxiu que anomenarem amb un altre nom. Per fer-ho, haurem de seguir els passos següents:
</p>
<ol>
<li class="level1"><div class="li"> Crear un arxiu i incloure-hi el text escollit.</div>
</li>
<li class="level1"><div class="li"> Incloure les directrius següents:</div>
</li>
</ol>
<pre class="code bash"><ol><li class="li1"><div class="de1">dirmessage_enable=YES</div></li><li class="li1"><div class="de1">message_file=.missatge</div></li></ol></pre>

<p>
Mitjançant el registre d’activitat podrem realitzar un control de l’activitat desenvolupada en el nostre servidor <acronym title="File Transfer Protocol">FTP</acronym>. Aquest registre es realitzarà mitjançant l’arxiu <code>/var/log/vsftpd.log</code> i les directrius <code>xferlog_enable=YES</code> i <code>xferlog_file=/var/log/vsftpd.log</code>.
</p>

<p>
Des del punt de vista del temps de connexió, amb la intenció d’identificar alguns dels temps que fan referència a configuracions del nostre servidor tenim les directrius següents:
</p>
<ul>
<li class="level1"><div class="li"> <code>accept_timeout</code>: temps per establir una connexió en mode passiu d’un usuari remot.</div>
</li>
<li class="level1"><div class="li"> <code>data_connection_timeout</code>: temps màxim que el servidor espera quan una transferència no progressa.</div>
</li>
<li class="level1"><div class="li"> <code>idle_session_timeout</code>: temps màxim que es concedeix a un usuari remot que no està actiu, això és, executant ordres.</div>
</li>
</ul>

<p>
<strong>2. Estat del servei.</strong>
</p>

<p>
Es pot saber l’estat del servei amb l’opció <em>status</em> de les ordres: 
</p>
<pre class="code">root@server:~# service vsftpd status
● vsftpd.service - vsftpd FTP server
   Loaded: loaded (/lib/systemd/system/vsftpd.service; enabled; vendor preset: enabled)
   Active: active (running) since Wed 2020-09-09 11:09:51 CEST; 14min ago
 Main PID: 2540 (vsftpd)
    Tasks: 1 (limit: 1138)
   Memory: 592.0K
   CGroup: /system.slice/vsftpd.service
           └─2540 /usr/sbin/vsftpd /etc/vsftpd.conf

de set. 09 11:09:51 server.ioc.cat systemd[1]: Starting vsftpd FTP server...
de set. 09 11:09:51 server.ioc.cat systemd[1]: Started vsftpd FTP server.
root@server:~# </pre>

<p>
Finalment, un cop haguem configurat el nostre servidor <acronym title="File Transfer Protocol">FTP</acronym>, només ens quedarà llançar-lo. Aquesta acció la realitzarem mitjançant l’execució de l’ordre:
</p>
<pre class="code">root@server:~# service vsftpd start</pre>

<p>
Paral·lelament, altres opcions de les quals disposem són:
</p>
<ul>
<li class="level1"><div class="li"> stop: per aturar el servidor.</div>
</li>
<li class="level1"><div class="li"> reload: per recarregar els paràmetres de configuració.</div>
</li>
<li class="level1"><div class="li"> restart: per aturar i tornar a arrencar el servidor.</div>
</li>
</ul>

<p>
<strong>3. Accés al servei <acronym title="File Transfer Protocol">FTP</acronym> d’usuaris autenticats.</strong>
</p>

<p>
Per defecte, els usuaris autenticats ja poden identificar al servidor <acronym title="File Transfer Protocol">FTP</acronym> i fer-ne ús. Es controla amb la directiva:
</p>
<pre class="code">local_enable=yes</pre>

<p>
Comprovem que és possible identificar-se:
</p>
<pre class="code">root@server:~# ftp localhost
Connected to localhost.
220 (vsFTPd 3.0.3)
Name (localhost:pere): pere
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; pwd
257 &quot;/home/pere&quot; is the current directory
ftp&gt; ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
-rw-r--r--    1 0        0               0 Sep 09 11:56 pere.info
226 Directory send OK.
ftp&gt; get pere.info
local: pere.info remote: pere.info
200 PORT command successful. Consider using PASV.
150 Opening BINARY mode data connection for pere.info (0 bytes).
226 Transfer complete.
ftp&gt; quit
221 Goodbye.
root@server:~#</pre>

<p>
<strong>4.</strong> Monitoritzar el tràfic amb Wireshark
</p>

<p>
Activem un <em>sniffer</em> de xarxa, com per exemple Wireshark, i iniciem una sessió <acronym title="File Transfer Protocol">FTP</acronym> (l’anterior) per monitoritzar tota la sessió.
</p>

<p>
<div class="imgelem">
<img src="../media/m8u2a2_wireshark1.png" alt="" /></div>

</p>

<p>
<div class="imgelem">
<img src="../media/m8u2a2_wireshark2.png" alt="" /></div>

</p>

<p>
<div class="imgelem">
<img src="../media/m8u2a2_wireshark3.png" alt="" /></div>

</p>

<p>
<div class="imgelem">
<img src="../media/m8u2a2_wireshark4.png" alt="" /></div>

</p>

<p>
<div class="imgelem">
<img src="../media/m8u2a2_wireshark5.png" alt="" /></div>

</p>

<p>
Observem que en una connexió TCP es pot aplicar l’opció <em>follow tcp stream</em> que mostra en text tot el diàleg TCP, si se selecciona el canal de control. Aquí veiem que tota la transferència de la informació es fa en text pla (<em>plaintext</em>) i evidentment es pot visualitzar informació sensible (contrasenya, …). El protocol <acronym title="File Transfer Protocol">FTP</acronym> és un protocol no segur i cal afegir-li una capa de seguretat per tal de permetre el xifrat de les dades.
</p>

<p>
<div class="imgelem">
<img src="../media/m8u2a2_wireshark6.png" alt="" /></div>

</p>

<p>
Podem constatar que cada transferència de dades és una connexió TCP pròpia. A part dels ports i de poder observar la connexió de tres bandes TCP, podem seguir cada conversa a part. La del llistat <code>ls</code>: 
</p>

<p>
<div class="imgelem">
<img src="../media/m8u2a2_wireshark7.png" alt="" /></div>

</p>

<p>
I en la connexió de dades de la transferència del fitxer pere.info, podem veure què conté el fitxer:
</p>

<p>
<div class="imgelem">
<img src="../media/m8u2a2_wireshark8.png" alt="" /></div>

</p>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

<h2><a id="configuracio_del_servidor_vsftpd_com_a_servidor_anonim" >Configuració del servidor vsftpd com a servidor anònim</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és aprendre a configurar el servidor <strong>vsftpd</strong> com a servidor anònim. 
</p>

<p>
Aquest tipus de servidor és molt útil quan es vol distribuir programari, actualitzacions, etc. Per exemple: ftp://ftp.ubuntu.com/.
</p>

<p>
Per facilitar la comprensió, deshabiliteu els usuaris registrats, és a dir, que només es pugi autenticar l’usuari anònim.
</p>

<p>
<form action=""><div class="solution ioccontent">
<p>
Cal fer les següents modificacions al fitxer <code>/etc/vsftpd.conf</code> i reiniciar el servei:
</p>
<pre class="code">anonymous_enable=yes 
local_enable=no</pre>

<p>
Comprovem que no es pot accedir amb els usuaris del SO:
</p>
<pre class="code">root@server:~# ftp server.ioc.cat
Connected to server.ioc.cat.
220 (vsFTPd 3.0.3)
Name (server.ioc.cat:usuari): usuari
530 This FTP server is anonymous only.
Login failed.
ftp&gt; </pre>

<p>
Per realitzar una prova, creem el fitxer ftp.txt a la carpeta <em>home</em> de l’usuari anònim: <code>/srv/ftp</code>.
</p>
<pre class="code">echo Hola &gt; /srv/ftp/ftp.txt</pre>

<p>
Comprovem que ens poden autenticar com a usuari anònim i ens podem descarregar el fitxer:
</p>
<pre class="code">root@server:~# ftp server.ioc.cat
Connected to server.ioc.cat.
220 (vsFTPd 3.0.3)
Name (server.ioc.cat:usuari): ftp
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; get ftp.txt
local: ftp.txt remote: ftp.txt
200 PORT command successful. Consider using PASV.
150 Opening BINARY mode data connection for ftp.txt (5 bytes).
226 Transfer complete.
5 bytes received in 0.00 secs (116.2574 kB/s)
ftp&gt; quit
221 Goodbye.
root@server:~# ls
ftp.txt
root@server:~# </pre>

<p>
Finalment, realitzem la mateixa operació amb la comanda <em>wget</em> que ens dóna més flexibilitat:
</p>
<pre class="code">root@server:~# wget ftp://server.ioc.cat/ftp.txt
--2020-09-28 20:00:03--  ftp://server.ioc.cat/ftp.txt
           =&gt; «ftp.txt»
S&#039;està resolent server.ioc.cat (server.ioc.cat)… 10.0.2.9
S&#039;està connectant a server.ioc.cat (server.ioc.cat)|10.0.2.9|:21… connectat.
S&#039;està entrant com a «anonymous» … S&#039;ha entrat amb èxit!
==&gt; SYST ... fet.     ==&gt; PWD ... fet.
==&gt; TYPE I ... fet.   ==&gt; CWD innecessari.
==&gt; SIZE ftp.txt ... 5
==&gt; PASV ... fet.     ==&gt; RETR ftp.txt ... fet.
Mida: 5 (no autoritatiu)

ftp.txt                         100%[===========================================================&gt;]       5  --.-KB/s    in 0s      

2020-09-28 20:00:03 (76,3 KB/s) - s&#039;ha desat «ftp.txt» [5]

root@server:~#</pre>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

<h2><a id="xifrat_amb_vsftpd" >Xifrat amb vsftpd</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és aprendre a configurar el servidor <strong>vsftpd</strong> per tal que les comunicacions siguin segures amb el protocol FTPS.
</p>

<p>
Realitzeu les tasques següents:
</p>
<ol>
<li class="level1"><div class="li"> Habiliteu el servidor <acronym title="File Transfer Protocol">FTP</acronym> per tal de proveir seguretat a les comunicacions amb FTPS. Es poden usar els certificats que venen per defecte. </div>
</li>
<li class="level1"><div class="li"> Connecteu-vos des del client amb la consola <acronym title="File Transfer Protocol">FTP</acronym>.</div>
</li>
<li class="level1"><div class="li"> Poseu el Wireshark a escoltar i connecteu-vos des del Filezilla. No cal descarregar res, només autenticar-se.</div>
</li>
<li class="level1"><div class="li"> Comproveu amb el Wireshark que les comunicacions estan encriptades.</div>
</li>
</ol>

<p>
<form action=""><div class="solution ioccontent">
<p>
<strong>1. Habilitació dels certificats</strong>
</p>

<p>
Es pot habilitar el servidor <acronym title="File Transfer Protocol">FTP</acronym> amb els certificats que venen per defecte, descomentant les línies afectades al fitxer <code>/etc/vsftpd.conf</code>. Després reiniciem el servei.
</p>
<pre class="code">rsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem
rsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key
ssl_enable=yes</pre>

<p>
<strong>2. Connexió des del client</strong>
</p>

<p>
Ens connectem des del client, i aquest no suporta SSL.
</p>
<pre class="code">usuari@client:~# ftp 192.168.0.1
Connected to 192.168.0.1.
220 Benvinguts al servidor FTP
Name (192.168.0.1:usuari): usuari
530 Non-anonymous sessions must use encryption.
Login failed.
421 Service not available, remote server has closed connection
ftp&gt; </pre>

<p>
Podem usar la comanda ftp-ssl (s’ha d’instal·lar).
</p>
<pre class="code">usuari@client:~# ftp-ssl 192.168.0.1
Connected to 192.168.0.1.
220 Benvinguts al servidor FTP
Name (192.168.0.1:root): usuari
234 Proceed with negotiation.
[SSL Cipher ECDHE-RSA-AES256-GCM-SHA384]
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; </pre>

<p>
<strong>3. Connexió amb el client gràfic Filezilla</strong>
</p>

<p>
Posem el Wireshark a escoltar i ens connectem des del Filezilla amb aquests paràmetres.
</p>

<p>
<div class="imgelem">
<img src="../media/ftp-filezilla.png" alt="" /></div>

</p>

<p>
<strong>4. Captures amb el Wireshark</strong>
</p>

<p>
Comprovem amb el Wireshark que les comunicacions estan encriptades. Podem veure el missatge de benvinguda, el paquet del client que requereix autenticació TLS i la resposta del servidor que es procedeix amb la negociació. A partir d’aquí, les dades estan encriptades.
</p>

<p>
<div class="imgelem">
<img src="../media/ftp-wireshark.png" alt="" /></div>

</p>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

<h2><a id="dialeg_ftp_amb_telnet" >Diàleg FTP amb Telnet</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és comprendre el funcionament intern del protocol <acronym title="File Transfer Protocol">FTP</acronym> a través d’un diàleg <acronym title="File Transfer Protocol">FTP</acronym> amb la comanda Telnet.
</p>

<p>
Realitzeu les tasques següents:
</p>
<ol>
<li class="level1"><div class="li"> Realitzeu des del client una transferència <acronym title="File Transfer Protocol">FTP</acronym> en mode passiu <acronym title="File Transfer Protocol">FTP</acronym> amb la comanda Telnet.</div>
</li>
<li class="level1"><div class="li"> Comenteu el significat dels números utilitzats.</div>
</li>
</ol>

<p>
<form action=""><div class="solution ioccontent">
<p>
<strong>1. Transferència <acronym title="File Transfer Protocol">FTP</acronym> en mode passiu <acronym title="File Transfer Protocol">FTP</acronym></strong>
</p>

<p>
Realitzem el diàleg des del client mitjançant 2 terminals. A cada <em>pasv</em> ens indica el port i des d’un altre terminal s’ha de fer la connexió al port indicat per obtenir les dades.
</p>
<pre class="code">usuari@client:~# telnet server.ioc.cat 21
Trying 192.168.0.1...
Connected to server.ioc.cat.
Escape character is &#039;^]&#039;.
220 Benvinguts al servidor FTP
user usuari
331 Please specify the password.
pass usuari
230 Login successful.
pwd
257 &quot;/home/usuari&quot; is the current directory
pasv
227 Entering Passive Mode (192,168,0,1,174,154).
list
150 Here comes the directory listing.
226 Directory send OK.
pasv
227 Entering Passive Mode (192,168,0,1,62,121).
retr arxiu.txt
150 Opening BINARY mode data connection for arxiu.txt (34 bytes).
226 Transfer complete.
quit
221 Goodbye.
Connection closed by foreign host.
usuari@client:~# </pre>

<p>
La resposta es pot anar veient al segon terminal, on es veu el contingut del fitxer (la paraula ‘hola’).
</p>
<pre class="code">usuari@client:~$ telnet server.ioc.cat 44698
Trying 192.168.0.1...
Connected to server.ioc.cat.
Escape character is &#039;^]&#039;.
drwxr-xr-x    2 1000     1000         4096 Mar 07  2020 Baixades
drwxr-xr-x    2 1000     1000         4096 Sep 09 11:08 Desktop
drwxr-xr-x    2 1000     1000         4096 Mar 07  2020 Documents
drwxr-xr-x    2 1000     1000         4096 Jun 01 12:15 Imatges
drwxr-xr-x    2 1000     1000         4096 Mar 07  2020 Música
drwxr-xr-x    2 1000     1000         4096 Mar 07  2020 Plantilles
drwxr-xr-x    2 1000     1000         4096 Mar 07  2020 Públic
drwxr-xr-x    2 1000     1000         4096 Mar 07  2020 Vídeos
-rw-r--r--    1 1000     1000         4096 Mar 07  2020 arxiu.txt
Connection closed by foreign host.

usuari@client:~$ telnet server.ioc.cat 15993
Trying 192.168.0.1...
Connected to server.ioc.cat.
Escape character is &#039;^]&#039;.
hola
Connection closed by foreign host.
usuari@client:~$ </pre>

<p>
<strong>2. Significat dels números</strong>
</p>

<p>
El valor (192, 168, 0, 1, 174, 154) és el <em>socket</em> (adreça de transport) que està format per la IP i el port. El <em>socket</em> és un número de 48 bits, doncs la IP és un número de 32 bits i el port un de 16. La representació (192, 168, 0, 1, 174, 154) és en forma de bytes. Per tant els 2 últims nombres representen el port. Si és vol saber el número del port cal fer la següent operació: 
</p>

<p>
<span class="blocklatex"><img src="../media/img5be601713cf47a4edbc55d252d80fff6.png" /></span>
</p>

<p>
La fórmula matemàtica (en base 10) de desplaçar un número 8 posicions cap a la dreta és multiplicar-lo per: 
</p>

<p>
<span class="blocklatex"><img src="../media/img95285968db36a243a2e015041e70446c.png" /></span>
</p>

<p>
Per tant:
</p>
<pre class="code">174*256+154=44698
62*256+121=15993</pre>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

<h2><a id="copies_de_seguretat_remotes" >Còpies de seguretat remotes</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és aprendre amb l’ajuda d’un servidor <acronym title="File Transfer Protocol">FTP</acronym> a realitzar còpies de seguretat remotes a Internet.
</p>

<p>
Realitzeu les tasques següents:
</p>
<ol>
<li class="level1"><div class="li"> Automatitzeu el procés d’enviar un fitxer a un servidor <acronym title="File Transfer Protocol">FTP</acronym> amb un <em>script</em>. </div>
</li>
<li class="level1"><div class="li"> Programeu aquesta operació cada dia de forma automàtica.</div>
</li>
</ol>

<p>
<form action=""><div class="solution ioccontent">
<p>
<strong>1. Automatització del procés</strong>
</p>

<p>
La idea és que les comandes que usaríem per fer una transferència les posem en un fitxer i el redireccionem a l’entrada de la comanda <em>ftp</em>. Hi ha diferents alternatives. Una d’elles pot ser el següent fitxer, que anomenem <code>script_ftp.sh</code>:
</p>
<pre class="code">#!/bin/bash
HOST=&#039;192.168.0.1&#039;
USER=&#039;usuari&#039;
PASSWD=&#039;usuari&#039;

ftp -n -v $HOST &lt;&lt; EOT
bin
user $USER $PASSWD
prompt
cd BACKUP
mdelete *
mput prova_script.txt
bye
EOT</pre>

<p>
Realitzem la comprovació. Executem l’<em>script</em> des del client per pujar un fitxer, ens connectem al mateix servidor amb SSH i comprovem que ha pujat.
</p>
<pre class="code">usuari@client:~$ echo &quot;Prova script&quot; &gt; prova_script.txt
usuari@client:~$ chmod 755 script_ftp.sh
usuari@client:~$ ./script_ftp.sh
Connected to 192.168.0.1.
220 Benvinguts al servidor FTP
530 Please login with USER and PASS.
331 Please specify the password.
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
Interactive mode off.
250 Directory successfully changed.
local: prova_script.txt remote: prova_script.txt
200 PORT command successful. Consider using PASV.
150 Ok to send data.
226 Transfer complete.
13 bytes sent in 0.00 secs (264.4857 kB/s)
221 Goodbye.

jciberta@jciberta-client:~$ ssh usuari@192.168.0.1
The authenticity of host &#039;192.168.0.1 (192.168.0.1)&#039; can&#039;t be established.
ECDSA key fingerprint is SHA256:2cqYKzks+fFtaQutgx8jLfvy8X08lEzxgPdkXYg2DKw.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added &#039;192.168.0.1&#039; (ECDSA) to the list of known hosts.
usuari@192.168.0.1&#039;s password: 
Linux server.ioc.cat 4.19.0-8-amd64 #1 SMP Debian 4.19.98-1 (2020-01-26) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
usuari@server:~$ ls BACKUP
prova_script.txt
usuari@server:~$</pre>

<p>
<strong>2. Programació del procés</strong>
</p>

<p>
L’eina <em>crontab</em> es pot utilitzar de diferents maneres. Existeix una automatització de tasques per al sistema operatiu a través del fitxer <code>/etc/crontab</code>.
</p>
<pre class="code">usuari@server:~$ more /etc/crontab
# /etc/crontab: system-wide crontab
# Unlike any other crontab you don&#039;t have to run the `crontab&#039;
# command to install the new version when you edit this file
# and files in /etc/cron.d. These files also have username fields,
# that none of the other crontabs do.

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# Example of job definition:
# .---------------- minute (0 - 59)
# |  .------------- hour (0 - 23)
# |  |  .---------- day of month (1 - 31)
# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...
# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat
# |  |  |  |  |
# *  *  *  *  * user-name command to be executed
17 *	* * *	root    cd / &amp;&amp; run-parts --report /etc/cron.hourly
25 6	* * *	root	test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily )
47 6	* * 7	root	test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly )
52 6	1 * *	root	test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly )
#</pre>

<p>
Cada usuari pot també automatitzar les seves tasques de manera automàtica (amb la comanda <em>crontab -e</em>). En aquest cas, el fitxer de configuració ens explica els paràmetres.
</p>
<pre class="code"># Edit this file to introduce tasks to be run by cron.
#
# Each task to run has to be defined through a single line
# indicating with different fields when the task will be run
# and what command to run for the task
#
# To define the time you can provide concrete values for
# minute (m), hour (h), day of month (dom), month (mon),
# and day of week (dow) or use &#039;*&#039; in these fields (for &#039;any&#039;).#
# Notice that tasks will be started based on the cron&#039;s system
# daemon&#039;s notion of time and timezones.
#
# Output of the crontab jobs (including errors) is sent through
# email to the user the crontab file belongs to (unless redirected).
#
# For example, you can run a backup of all your user accounts
# at 5 a.m every week with:
# 0 5 * * 1 tar -zcf /var/backups/home.tgz /home/
#
# For more information see the manual pages of crontab(5) and cron(8)
#
# m h  dom mon dow   command</pre>

<p>
El servei (dimoni) que realitza aquestes tasques és el <em>cron</em>. Per defecte, aquest és un servei que ja ve actiu.
</p>
<pre class="code">root@client:~# /etc/init.d/cron status
● cron.service - Regular background program processing daemon
   Loaded: loaded (/lib/systemd/system/cron.service; enabled; vendor preset: enabled)
   Active: active (running) since dc 2019-02-13 09:31:19 CET; 1 years 7 months ago
     Docs: man:cron(8)
 Main PID: 1646 (cron)
   CGroup: /system.slice/cron.service
           └─ 1646 /usr/sbin/cron -f

set 29 09:45:01 jciberta-client CRON[3966]: pam_unix(cron:session): session closed for user root
set 29 09:50:01 jciberta-client CRON[4016]: pam_unix(cron:session): session opened for user root by (uid=0)
set 29 09:50:01 jciberta-client CRON[4017]: (root) CMD (/root/script_ftp.sh)
set 29 09:50:01 jciberta-client CRON[4016]: pam_unix(cron:session): session closed for user root
set 29 09:55:01 jciberta-client CRON[4081]: pam_unix(cron:session): session opened for user root by (uid=0)
set 29 09:55:01 jciberta-client CRON[4082]: (root) CMD (/root/script_ftp.sh)
set 29 09:55:02 jciberta-client CRON[4081]: pam_unix(cron:session): session closed for user root
set 29 10:00:01 jciberta-client CRON[4120]: pam_unix(cron:session): session opened for user root by (uid=0)
set 29 10:00:01 jciberta-client CRON[4121]: (root) CMD (/root/script_ftp.sh)
set 29 10:00:01 jciberta-client CRON[4120]: pam_unix(cron:session): session closed for user root</pre>

<p>
Fem una prova des del client que executi l’<em>script</em> cada 5 minuts. Afegim la línia corresponent al fitxer i esperem un cert temps i comprovem que s’ha pujat el fitxer (fent una connexió SSH al servidor).
</p>
<pre class="code">root@client:~# date
dc set 30 05:43:47 CEST 2020
root@client:~# echo &quot;*/5 * * * *     root /home/usuari/script_ftp.sh&quot; &gt;&gt; /etc/crontab
root@client:~# # Esperem una mica
root@client:~# date
dc set 30 05:46:15 CEST 2020
root@client:~# ssh usuari@192.168.0.1
The authenticity of host &#039;192.168.0.1 (192.168.0.1)&#039; can&#039;t be established.
ECDSA key fingerprint is SHA256:2cqYKzks+fFtaQutgx8jLfvy8X08lEzxgPdkXYg2DKw.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added &#039;192.168.0.1&#039; (ECDSA) to the list of known hosts.
usuari@192.168.0.1&#039;s password: 
Linux server.ioc.cat 4.19.0-8-amd64 #1 SMP Debian 4.19.98-1 (2020-01-26) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Tue Sep 29 09:51:34 2020 from 192.168.0.2
usuari@server:~$ ls /home/usuari/BACKUP -lsh
total 4,0K
4,0K -rw------- 1 usuari usuari 13 de set.  30 05:45 prova_script.txt
usuari@server:~$ exit
desconnectat
Connection to 192.168.0.1 closed.
root@client:~# </pre>

<p>
Podem veure al fitxer de <em>log</em> com ha quedat registrat (s’ha retallat les informacions d’altres registres):
</p>
<pre class="code">root@client:~# tail /var/log/syslog
...
Sep 30 05:45:01 client CRON[4828]: (root) CMD (/home/usuari/script_ftp.sh)
...
root@client:~# </pre>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

<h2><a id="instal_lacio_i_configuracio_del_servidor_ftp_en_el_sistema_operatiu_windows_server" >Instal·lació i configuració del servidor FTP en el sistema operatiu Windows Server</a></h2>
<div class="level2">

<p>
L’objectiu d’aquesta activitat és practicar la instal·lació i configuració del servidor <acronym title="File Transfer Protocol">FTP</acronym> en un Windows Server. Aquest servei ve inclòs dins la suite IIS (<em>Internet Information Server</em>) conjuntament amb el servei web i altres serveis.
</p>

<p>
Realitzeu les tasques següents:
</p>
<ol>
<li class="level1"><div class="li"> Instal·leu el servidor <acronym title="File Transfer Protocol">FTP</acronym>.</div>
</li>
<li class="level1"><div class="li"> Descriviu l’estructura del servidor <acronym title="File Transfer Protocol">FTP</acronym>. </div>
</li>
<li class="level1"><div class="li"> Creeu un lloc <acronym title="File Transfer Protocol">FTP</acronym>.</div>
</li>
<li class="level1"><div class="li"> Comproveu el servei.</div>
</li>
</ol>

<p>
<form action=""><div class="solution ioccontent">
<p>
<strong>1. Instal·lació del servidor <acronym title="File Transfer Protocol">FTP</acronym></strong>
</p>

<p>
El procés d’instal·lació pot variar depenent de la versió del servidor.
</p>

<p>
Primer de tot, cal anar al <em>Dashboard</em> de l’administrador del servidor i escollir l’opció d’afegir noves característiques o rols.
</p>

<p>
<div class="imgelem">
<img src="../media/iis1.png" alt="" /></div>

</p>

<p>
Seleccionem:
</p>
<ul>
<li class="level1"><div class="li"> <em>Role-based or featured-based installation</em></div>
</li>
<li class="level1"><div class="li"> El propi servidor</div>
</li>
</ul>

<p>
En aquest punt cal activar el servidor <acronym title="File Transfer Protocol">FTP</acronym> de les opcions de l’IIS ja que no ve per defecte.
</p>

<p>
<div class="imgelem">
<img src="../media/iss-ftp2.png" alt="" /></div>

</p>
<ul>
<li class="level1"><div class="li"> <em>Add features</em></div>
</li>
<li class="level1"><div class="li"> Opcions per defecte…</div>
</li>
<li class="level1"><div class="li"> <em>Install</em></div>
</li>
</ul>

<p>
Comprovem que s’ha instal·lat. Apareix a sota del menú principal de configuració.
</p>

<p>
<div class="imgelem">
<img src="../media/iis3.png" alt="" /></div>

</p>

<p>
<strong>2. Estructura del servidor web</strong>
</p>

<p>
Des de l’administrador del servidor, i dins del IIS, anem a l’apartat de <em>Servers</em>, i clicant el botó dret en el servidor actual obrim l’administrador del servidor IIS:
</p>

<p>
<div class="imgelem">
<img src="../media/iis5.png" alt="" /></div>

</p>

<p>
El servei <acronym title="File Transfer Protocol">FTP</acronym> està integrat amb el servei web. Per afegir un lloc <acronym title="File Transfer Protocol">FTP</acronym> es fa de la mateixa manera que per crear un lloc web:
</p>

<p>
<div class="imgelem">
<img src="../media/iis-ftp2.png" alt="" /></div>

</p>

<p>
<strong>3. Creació d’un lloc <acronym title="File Transfer Protocol">FTP</acronym></strong>
</p>

<p>
La primera cosa que ens demana és identificar el lloc i la ruta per defecte del servidor <acronym title="File Transfer Protocol">FTP</acronym>.
</p>

<p>
<div class="imgelem">
<img src="../media/iis-ftp3.png" alt="" /></div>

</p>

<p>
Seguidament demana la IP, el port i si volem activar SSL (haurem de seleccionar un certificat).
</p>

<p>
<div class="imgelem">
<img src="../media/iis-ftp4.png" alt="" /></div>

</p>

<p>
Finalment podem seleccionar l’autenticació (<acronym title="File Transfer Protocol">FTP</acronym> anònim i/o usuaris registrats) i els permisos.
</p>

<p>
<div class="imgelem">
<img src="../media/iis-ftp5.png" alt="" /></div>

</p>

<p>
Un cop creat el lloc <acronym title="File Transfer Protocol">FTP</acronym>, disposem de tota una sèrie d’opcions que ens permeten canviar les opcions triades al crear el lloc, a més d’altres característiques com definir els missatges de benvinguda, veure els logs, etc.
</p>

<p>
<div class="imgelem">
<img src="../media/iis-ftp6.png" alt="" /></div>

</p>

<p>
<strong>4. Comprovació del servei <acronym title="File Transfer Protocol">FTP</acronym></strong>
</p>

<p>
Fem una prova des d’un client de text per comprovar que ens podem connectar amb l’usuari anònim:
</p>
<pre class="code">C:\Users\Administrador&gt;ftp localhost
Conectado a WIN-3FAP1KIE1HD.
220 Microsoft FTP Service
200 OPTS UTF8 command successful - UTF8 encoding now ON.
Usuario (WIN-3FAP1KIE1HD:(none)): ftp
331 Anonymous access allowed, send identity (e-mail name) as password.
Contraseña:
230-Benviguts al FTP de l&#039;IOC
230 User logged in.
ftp&gt; ls
200 EPRT command successful.
125 Data connection already open; Transfer starting.
Anònim.txt
226 Transfer complete.
ftp: 20 bytes recibidos en 0.00segundos 6.67a KB/s.
ftp&gt;</pre>

<p>
I amb un usuari autenticat:
</p>
<pre class="code">C:\Users\Administrador&gt;ftp localhost
Conectado a WIN-3FAP1KIE1HD.
220 Microsoft FTP Service
200 OPTS UTF8 command successful - UTF8 encoding now ON.
Usuario (WIN-3FAP1KIE1HD:(none)): Administrador
331 Password required
Contraseña:
230-Benviguts al FTP de l&#039;IOC
230 User logged in.
ftp&gt; ls
200 EPRT command successful.
125 Data connection already open; Transfer starting.
Anònim.txt
226 Transfer complete.
ftp: 20 bytes recibidos en 0.00segundos 6.67a KB/s.
ftp&gt;</pre>

<p>
Veiem que tots els usuaris apunten a la mateixa carpeta. Aquest és el comportament per defecte. Si es vol canviar, cal anar a <em>Aislamiento de usuario <acronym title="File Transfer Protocol">FTP</acronym></em>, on hi ha les següents opcions:
</p>

<p>
<div class="imgelem">
<img src="../media/iis-ftp7.png" alt="" /></div>

</p>
</div><input class="btn_solution3" type="button" value="Mostra"></input></form>
</p>

</div>

	 </article>
     <div class="pnpage">
      <div class="left-corner"></div>
      <div id="prevpage">Anar a la p&agrave;gina anterior:<br /><a href="../../../WebContent/u2/a2/continguts.html">Instal·lació i administració de serveis de transferència de fitxers</a></div>
      <div id="nextpage">Anar a la p&agrave;gina seg&uuml;ent:<br /><a href="../../../WebContent/u2/a2/exercicis.html">Exercicis</a></div>
      <div class="right-corner"></div>
     </div>
    </div>
    <footer class="footer">
      <div><small>Aquest document està subjecte a una llicència oberta de Creative Commons, es reserva el dret de reconeixement de l'autoria, d'exigir que no se'n faci cap mena d'ús comercial. Si altereu o transformeu aquesta obra, o en genereu obres derivades, només podeu distribuir l'obra generada amb una llicència idèntica a aquesta.</small></div>
    </footer>
 </div>
 <div id="back_preview" class="hidden"></div>
 <div id="preview" class="hidden">
  <div class="prevcontent"></div>
 </div>
 <div id="help-tooltips">
  <div id="help-toc" class="hidden tooltip"><span>Taula de continguts:</span> Ofereix una vista general de l&#39;estructura del m&ograve;dul, que us facilitar&agrave; la navegaci&oacute; a trav&eacute;s dels seus continguts.<span class="arrow-left"></span></div> 
  <div id="help-settings" class="hidden tooltip"><span>Opcions de format:</span> Permet configurar el format de lectura a partir de les vostres prefer&egrave;ncies, modificant la mida de la lletra, el color del fons, l&#39;amplada de la p&agrave;gina o l&#39;ocultaci&oacute; dels continguts complementaris, entre d&#39;altres.<span class="arrow-left"></span></div>
  <div id="help-printer" class="hidden tooltip"><span>Imprimir:</span>  Envia el contingut seleccionat a la impressora.<span class="arrow-left"></span></div>
  <div id="help-favorites" class="hidden tooltip"><span>Prefereits:</span> Permet desar aquelles parts del contingut a les que us interessi accedir en un moment posterior; us permetr&agrave; anar creant un repositori personalitzat de les seccions que considereu m&eacute;s rellevants. Un cop l&#39;hageu començat a fer servir se us mostrar&agrave; a sota un comptador que us informar&agrave; del nombre de preferits que s&#39;hagin emmagatzemat fins al moment.<span class="arrow-left"></span></div>
  <div id="help-favcounter" class="hidden tooltip"><span>Comptador i llistat de preferits:</span> Indica el nombre de preferits que s&#39;han desat fins el moment; clicant damunt seu accedireu al llistat de preferits, i a trav&eacute;s d&#39;aquest podreu accedir directament als continguts que hageu emmagatzemat.<span class="arrow-left"></span></div>
  <div id="help-help_icon" class="hidden tooltip"><span>Ajuda:</span> Aquesta opci&oacute; activa la informaci&oacute; de les funcionalitats del web tot situant el punter del ratol&iacute; al damunt dels diferents &iacute;tems.<span class="arrow-left"></span></div>
  <div id="help-sidebar-hide" class="hidden tooltip"><span>Mostrar/Ocultar barra lateral:</span>  Deshabilita la barra d&#39;opcions, permetent la seva recuperaci&oacute; quan es desitgi.<span class="arrow-left"></span></div>
  <div id="help-search" class="hidden tooltip"><span>Cerca:</span>  Introdu&iuml;u les paraules clau sobre aquells conceptes que desitgeu localitzar en els continguts del m&ograve;dul. Tamb&eacute; podeu excloure un terme de la cerca tot afegint-hi el signe &#8220;-&#8221; al davant.<span class="arrow-top"></span></div>
  <div id="help-header" class="hidden tooltip"><span>Cap&ccedil;alera:</span>  Indica l&#39;apartat o secci&oacute; que es mostra en pantalla. Tingueu present que les capçaleres de segon, tercer i quart nivell tamb&eacute; es poden desar com a marcadors.<span class="arrow-left"></span></div>
</div> 
</body>
</html>
