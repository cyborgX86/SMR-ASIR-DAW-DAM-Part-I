<!doctype html>

<!--[if lt IE 7 ]> <html class="ie ie6 no-js" lang="ca"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie ie7 no-js" lang="ca"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie ie8 no-js" lang="ca"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie ie9 no-js" lang="ca"> <![endif]-->
<!--[if gt IE 9]><!--><html class="no-js" lang="ca"><!--<![endif]-->
<!-- the "no-js" class is for Modernizr. -->

<head id="www-sitename-com" data-template-set="html5-reset">

	<meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html">
        
	<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title>Xarxes d'àrea local</title>
	
<!-- <meta name="title" content=""> --> 
	<meta name="description" content="">
	<!-- Google will often use this as its description of your page/site. Make it good. -->
	
	<meta name="google-site-verification" content="">
	<!-- Speaking of Google, don't forget to set your site up: http://google.com/webmasters -->
	
	<meta name="author" content="Institut Obert de Catalunya">
	<meta name="Copyright" content="Copyright Institut Obert de Catalunya 2011. All Rights Reserved.">

	<!-- Dublin Core Metadata : http://dublincore.org/ -->
	<meta name="DC.title" content="Xarxes d'àrea local">
	<meta name="DC.subject" content="Informàtica i comunicacions">
	<meta name="DC.creator" content="Institut Obert de Catalunya">
	
	<!--  Mobile Viewport Fix
	j.mp/mobileviewport & davidbcalhoun.com/2010/viewport-metatag 
	device-width : Occupy full width of the screen in its current orientation
	initial-scale = 1.0 retains dimensions instead of zooming out if page height > device height
	maximum-scale = 1.0 retains dimensions instead of zooming in if page width < device width
	-->
	<!-- Uncomment to use � use thoughtfully!
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
	-->

	<link rel="shortcut icon" href="../../../img/favicon.ico">
	<!-- This is the traditional favicon.
		 - size: 16x16 or 32x32
		 - transparency is OK
		 - see wikipedia for info on browser support: http://mky.be/favicon/ -->
		 
	<link rel="apple-touch-icon" href="../../../img/apple-touch-icon.png">
	<!-- The is the icon for iOS's Web Clip.
		 - size: 57x57 for older iPhones, 72x72 for iPads, 114x114 for iPhone4's retina display (IMHO, just go ahead and use the biggest one)
		 - To prevent iOS from applying its styles to the icon name it thusly: apple-touch-icon-precomposed.png
		 - Transparency is not recommended (iOS will put a black BG behind the icon) -->
	
	<!-- CSS: screen, mobile & print are all in the same file -->
	<link rel="stylesheet" href="../../../_/css/style.css">

	<!-- CSS: jQuery UI -->
	<link rel="stylesheet" href="../../../_/css/jquery-ui.css">
	
	<!-- all our JS is at the bottom of the page, except for Modernizr. -->
	<script src="../../../_/js/modernizr-1.7.min.js"></script>
	<script src="../../../_/js/Hyphenator.js" type="text/javascript"></script>
	<script type="text/javascript">
	   Hyphenator.config({
		minwordlength : 4
	   });
	   Hyphenator.run();
	</script>
    <script src="../../../_/js/build.js" type="text/javascript"></script>
</head>

<body class="style-newspaper">

<div class="wrapper"><!-- not needed? up to you: http://camendesign.com/code/developpeurs_sans_frontieres -->

	<header id="header">
		<div class="head"><a href="http://ioc.gencat.cat"><img src="../../../img/logo.png" alt="Institut Obert de Catalunya"/></a><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/es/deed.ca"><img src="../../../img/license.png" alt="Llic&egrave;ncia" class="license"/></a></div>
		<div class="headdocument"><a href="../../../index.html">Xarxes d'àrea local</a></div>
        <div id="search" class="search" name="search">
         <form id="frmsearch" action="../../../search.html" method="get">
          <input type="text" name="q"/>
        </form>
        </div>
	</header>
   <div id="upbutton" class="upbutton" style="display:none;"><img src="../../../img/uparrow.png" alt="Pujar a l'inici de p&agrave;gina"/></div>
   <aside id="aside">
    <div id="menu">
      <ul>
       <li name="toc"><div><img src="../../../img/toc.png" alt="&Iacute;ndex"/></div></li>
       <li name="settings"><div><img src="../../../img/settings.png" alt="Configuraci&oacute;"/></div></li>
       <li name="printer"><div><img src="../../../img/printer.png" alt="Imprimir"/></div></li>
       <li name="favorites"><div><img src="../../../img/favorites.png" alt="Favorits"/></div></li>
       <li name="help_icon" class="help_icon"><div><img src="../../../img/help_icon.png" alt="Ajuda"/></div></li>
      </ul>
     </div>
   </aside>
   <div id="sidebar-hide" name="sidebar-hide"><img src="../../../img/arrows.png"/></div>
   <section>
     <div id="toc" class="hidden">
      <div class="menucontent">
        <ul>
        <li id="u4" class="parentnode"><p><a class="unit" href="../../../WebContent/u4/introduccio.html">4. Configuració de dispositius de xarxes</a></p><ul class="expander"><li id="u4introduccio"><a href="../../../WebContent/u4/introduccio.html">Introducció</a></li><li id="u4objectius"><a href="../../../WebContent/u4/objectius.html">Resultats d'aprenentatge</a></li><li id="u4referencies"><a href="../../../WebContent/u4/referencies.html">Referències</a></li><li id="u4resum"><a href="../../../WebContent/u4/resum.html">Resum</a></li><li id="u4a1" class="tocsection"><p id='u4a1continguts'><a class="section" href="../../../WebContent/u4/a1/continguts.html">Configuració de commutadors</a><span class="buttonexp"></span></p><ul><li id="u4a1activitats"><a href="../../../WebContent/u4/a1/activitats.html">Activitats</a></li><li id="u4a1annexos"><a href="../../../WebContent/u4/a1/annexos.html">Annexos</a></li><li id="u4a1exercicis"><a href="../../../WebContent/u4/a1/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><div data-parent-id='u4a1' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u4/a1/continguts.html#funcionament_dels_commutadors">Funcionament dels commutadors</a></li><li><a href="../../../WebContent/u4/a1/continguts.html#configuracio_basica">Configuració bàsica</a></li><li><a href="../../../WebContent/u4/a1/continguts.html#definicio_i_configuracio_de_vlan">Definició i configuració de VLAN</a></li></ul></div></div><li id="u4a2" class="tocsection"><p id='u4a2continguts'><a class="section" href="../../../WebContent/u4/a2/continguts.html">Configuració d'encaminadors</a><span class="buttonexp"></span></p><ul><li id="u4a2activitats"><a href="../../../WebContent/u4/a2/activitats.html">Activitats</a></li><li id="u4a2exercicis"><a href="../../../WebContent/u4/a2/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><div data-parent-id='u4a2' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u4/a2/continguts.html#funcionament">Funcionament</a></li><li><a href="../../../WebContent/u4/a2/continguts.html#configuracio_basica">Configuració bàsica</a></li><li><a href="../../../WebContent/u4/a2/continguts.html#manteniment_i_configuracio_de_xarxes_amb_encaminadors">Manteniment i configuració de xarxes amb encaminadors</a></li></ul></div></div><li id="u4a3" class="tocsection"><p id='u4a3continguts'><a class="section" href="../../../WebContent/u4/a3/continguts.html">Xarxes sense fil: conceptes bàsics i configuració</a><span class="buttonexp"></span></p><ul><li id="u4a3activitats"><a href="../../../WebContent/u4/a3/activitats.html">Activitats</a></li><li id="u4a3exercicis"><a href="../../../WebContent/u4/a3/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><div data-parent-id='u4a3' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u4/a3/continguts.html#les_xarxes_locals_sense_fil">Les xarxes locals sense fil</a></li><li><a href="../../../WebContent/u4/a3/continguts.html#seguretat">Seguretat</a></li><li><a href="../../../WebContent/u4/a3/continguts.html#instal_lacio_i_configuracio_d_un_punt_d_acces_sense_fil">Instal·lació i configuració d'un punt d'accés sense fil</a></li><li><a href="../../../WebContent/u4/a3/continguts.html#resolucio_de_problemes">Resolució de problemes</a></li></ul></div></div><li id="u4a4" class="tocsection"><p id='u4a4continguts'><a class="section" href="../../../WebContent/u4/a4/continguts.html">Documentació dels procediments de configuració</a><span class="buttonexp"></span></p><ul><li id="u4a4activitats"><a href="../../../WebContent/u4/a4/activitats.html">Activitats</a></li></ul></li><div data-parent-id='u4a4' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u4/a4/continguts.html#fases_preliminars_per_la_configuracio_d_una_xarxa">Fases preliminars per la configuració d'una xarxa</a></li><li><a href="../../../WebContent/u4/a4/continguts.html#fases_de_la_configuracio">Fases de la configuració</a></li><li><a href="../../../WebContent/u4/a4/continguts.html#documents_de_la_configuracio_d_una_xarxa">Documents de la configuració d'una xarxa</a></li><li><a href="../../../WebContent/u4/a4/continguts.html#planificacio_estructurada_del_cablatge">Planificació estructurada del cablatge</a></li><li><a href="../../../WebContent/u4/a4/continguts.html#estructura_del_sistema_de_cablatge_horitzontal">Estructura del sistema de cablatge horitzontal</a></li><li><a href="../../../WebContent/u4/a4/continguts.html#subministrament_electric_de_la_xarxa">Subministrament elèctric de la xarxa</a></li><li><a href="../../../WebContent/u4/a4/continguts.html#documentant_la_xarxa">Documentant la xarxa</a></li></ul></div></div></ul></li><li id="" class="indexnode"><p><a href="../../../index.html">Anar a l&#39;&iacute;ndex general</a></p></li>
        </ul>
      </div>
    </div>
   </section>
   <section>
   <div id="settings" class="hidden">
    <div class="menucontent">
     <div class="allsettings">
     <div class="settings">
      <label>Font i Color</label>
		<div class="setting-option">
	        <ul class="fontBackground">
				<li id="style-newspaper" title="Newspaper" class="appearance-style-newspaper"><span>Newspaper</span></li>
                <li id="style-novel" title="Novel" class="appearance-style-novel"><span>Novel</span></li>
                <li id="style-ebook" title="eBook" class="appearance-style-ebook"><span>eBook</span></li>
				<li id="style-inverse" title="Inverse" class="appearance-style-inverse active"><span>Inverse</span></li>
				<li id="style-athelas" title="Athelas" class="appearance-style-athelas"><span>Athelas</span></li>
			</ul>
		</div>
     </div>
	<div class="settings">
      <label>Amplada</label>
		<div class="setting-option">
	        <div id="slider-width"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
		<div class="setting-option">
	        <div id="slider-font"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
	  <div class="setting-option">
       <form action="" class="sett-options">
		<ul>
		    <li><input type="checkbox" id="secondary-content" /><label for="secondary-content">Mostra recursos complementaris</label></li>
		    <li><input type="checkbox" id="main-images" /><label for="main-images">Mostra imatges</label></li>
		    <li><input type="checkbox" id="text-alignment" /><label for="text-alignment">Text justificat</label></li>
			<li><input type="checkbox" id="text-hyphen" /><label for="text-hyphen">Partici&oacute; sil·l&agrave;bica</label></li>
		</ul>
       </form>
	  </div>
     </div>
     </div>
    </div>
   </div>
   </section>
 <section>
 <div id="favorites" class="hidden"></div>
 </section>   
 <div id="bridge" class="hidden"></div>
 <div id="help" class="hidden">
  <div class="helptitle">Dreceres del teclat<hr></div>
  <div class="helpsection"><span>General</span>
   <ul>
    <li><span class="shortcut">g</span>: Anar al men&uacute; de navegaci&oacute;</li>
    <li><span class="shortcut">o</span>: Anar a opcions</li>
    <li><span class="shortcut">s</span>: Guardar la p&agrave;gina actual a favorits</li>
    <li><span class="shortcut">p</span>: Imprimir la p&agrave;gina actual</li>
    <li><span class="shortcut">?</span>: Mostrar/Ocultar l&#39;ajuda</li>
   </ul>
  </div>
  <div class="helpsection"><span>Navegaci&oacute;</span>
   <ul>
    <li><span class="shortcut">i</span>: Anar a l&#39;&iacute;ndex general</li>
    <li><span class="shortcut">t</span>: Anar a l&#39;inici de p&agrave;gina</li>
    <li><span class="shortcut">b</span>: Anar al final de p&agrave;gina</li>
    <li><span class="shortcut">j</span>: Anar cap endavant dintre la p&agrave;gina</li>
    <li><span class="shortcut">k</span>: Anar cap enrere dintre la p&agrave;gina</li>
    <li><span class="shortcut">h</span>: Anar a la p&agrave;gina anterior:</li>
    <li><span class="shortcut">l</span>: Anar a la p&agrave;gina seg&uuml;ent:</li>
   </ul>
   </div>
 </div>
 <div id="favcounter" name="favcounter" class="hidden"><span></span></div>
 <div id="navmenu" class="navmenu"><ul class="webnav"><li><a href="../../../index.html" title="Anar a l&#39;&iacute;ndex general">Inici</a></li><li><a href="../introduccio.html">Configuració de dispositius de xarxes</a></li><li>Configuració de commutadors</li></ul></div>
	<div id="content" lang="ca" class="hyphenate text">
     <article lang="ca" class="sheet">
        <h1><a id="configuracio_de_commutadors"> Configuració de commutadors </a></h1>
    	
<p>
Un commutador o <em>switch</em> és un aparell per fa
cilitar la comunicació en una xarxa d’àrea local. És un dispositiu de capa 2 capaç de prendre decisions que fa que la xarxa d’àrea local sigui molt més eficient. Els commutadors realitzen aquesta tasca commutant les dades cap al port on està connectat l’ordinador de destinació del paquet.
</p>

<p>
La tasca del commutador es concentrà en les connexions, fent que la transmissió de dades sigui més eficient. Aquest dispositiu commuta paquets des dels ports (interfícies) entrants fins als ports de sortida, subministrant a cada port l’amplada de banda total. El fet que només hagi de commutar dóna al dispositiu una gran velocitat.
</p>

<h2><a id="funcionament_dels_commutadors" >Funcionament dels commutadors</a></h2>
<div class="level2">

<p>
Un commutador transmet els paquets cap al port adequat gràcies al fet que coneix totes les MAC que hi ha connectades a cadascun dels seus ports. Quan un commutador rep un paquet, l’analitza per comprovar-ne la destinació; quan identifica la MAC de destinació, decideix per quin dels seus ports s’ha de transmetre aquest paquet. Un cop identificat, el commutador lliura tota l’amplada de banda de què disposa per a aquesta comunicació.
</p>

<p>
<div class="iocfigurec">
<ul>
<li>
<img src="../media/ic10m5u4_01.png" class="imgB" title="Imatge d&#039;un commutador amb totes les seves connexions, i amb la majoria de ports ocupats./-30" alt="Imatge d&#039;un commutador amb totes les seves connexions, i amb la majoria de ports ocupats./-30" /></li><li><small>Imatge d&#039;un commutador amb totes les seves connexions, i amb la majoria de ports ocupats.</small></li>
</ul></div>

</p>

<p>
En el cas que veurem tot seguit, es disposa d’una xarxa amb les característiques següents: un commutador realitza les distribucions i a l’encaminador d’entrada a aquesta xarxa hi arriben paquets destinats a l’ordinador F i paquets destinats a l’ordinador D.
</p>

<p>
<div class="iocfigurec">
<ul>
<li>
<img src="../media/ic10m5u4_02.png" class="imgB" title="Paquet per a l&#039;ordinador F./-10" alt="Paquet per a l&#039;ordinador F./-10" /></li><li><small>Paquet per a l&#039;ordinador F.</small></li>
</ul></div>

</p>

<p>
En la xarxa de la <span class="figref"><a href="#Figure1"><span>figura</span></a></span> s’ha representat l’arribada de tres paquets: el primer i el tercer estan destinats a la màquina F i el segon està destinat a la màquina D.
</p>

<p>
<div class="iocfigurec">
<ul>
<li>
<img src="../media/ic10m5u4_04.png" class="imgB" title="Paquet per a l&#039;ordinador D" alt="Paquet per a l&#039;ordinador D" /></li><li><small>Paquet per a l&#039;ordinador D</small></li>
</ul></div>

</p>

<p>
El commutador rep el primer paquet de l’encaminador d’entrada (<span class="figref"><a href="#Figure2"><span>figura</span></a></span>), fa una comprovació, desmunta l’encapçalament del paquet i llegeix el contingut per tal de comprovar quina és la màquina de destinació de les dades. Un cop localitzada l’adreça de destinació, comprova a la seva taula interna cap a quin port ha d’enviar aquest paquet i realitza la commutació a gran velocitat. És preferible utilitzar aquest dispositiu en comptes d’un encaminador, ja que és més lent a l’hora de fer la transmissió.
</p>
<div class="iocfigure"><a name="Figure1"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Funcionament del commutador

</figcaption><img src="../media/ic10m5u4_03.png" alt="" /></figure>
</div><div class="iocfigure"><a name="Figure2"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Primer paquet

</figcaption><img src="../media/ic10m5u4_05.png" alt="" /></figure>
</div><div class="iocfigure"><a name="Figure3"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Tramesa del primer paquet

</figcaption><img src="../media/ic10m5u4_06.png" alt="" /></figure>
</div>
<p>
Un cop realitzada la comprovació, el commutador transmet el paquet pel port corresponent (<span class="figref"><a href="#Figure3"><span>figura</span></a></span>), utilitzant sempre tota l’amplada de banda de què disposa.
</p>

<p>
 Després d’haver fet la transmissió, el commutador ja es pot dedicar al paquet de dades següent (<span class="figref"><a href="#Figure4"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figure4"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Segon paquet de dades

</figcaption><img src="../media/ic10m5u4_07.png" alt="" /></figure>
</div>
<p>
Quan el commutador rep el segon paquet, executa els mateixos passos que ha realitzat amb el primer: busca a l’encapçalament del paquet l’adreça de destinació i, un cop localitzada, l’envia pel port més adient (<span class="figref"><a href="#Figure5"><span>figura</span></a></span>), que troba indicat a la seva taula interna.
</p>
<div class="iocfigure"><a name="Figure5"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Tramesa del segon paquet de dades

</figcaption><img src="../media/ic10m5u4_08.png" alt="" /></figure>
</div>
<p>
Per transmetre el segon paquet, el commutador proporciona a aquesta transmissió tota l’amplada de banda de què disposa. Un cop finalitzada aquesta transmissió, el commutador ja es pot dedicar a un nou paquet (<span class="figref"><a href="#Figure6"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figure6"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Tercer paquet de dades

</figcaption><img src="../media/ic10m5u4_09.png" alt="" /></figure>
</div>
<p>
Quan arriba el tercer paquet al commutador (<span class="figref"><a href="#Figure7"><span>figura</span></a></span>), els passos es tornen a repetir: la comprovació de la destinació, l’elecció del port pel qual transmetrà les dades i finalment la transmissió.
</p>
<div class="iocfigure"><a name="Figure7"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Tramesa del tercer paquet de dades

</figcaption><img src="../media/ic10m5u4_10.png" alt="" /></figure>
</div><div class="iocimportant"><div class="ioccontent">
<p>
El <strong>commutador</strong> és un element d’interconnexió amb capacitat per prendre decisions: comprova l’adreça final d’un paquet i el transmet pel port més adient -és a dir, per aquell on és l’ordinador de destinació.
</p>
</div></div>
</div>

<h2><a id="configuracio_basica" >Configuració bàsica</a></h2>
<div class="level2">

<p>
Perquè el commutador funcioni correctament, cal programar-lo de la manera adient. Aquesta programació es realitzarà des d’un ordinador connectat al commutador per una interfície especial dedicada a aquesta tasca.
</p>

<p>
<div class="iocfigurec">
<ul>
<li>
<img src="../media/ic10m5u4_11.png" class="imgB" title="Logotip de Windows" alt="Logotip de Windows" /></li><li><small>Logotip de Windows</small></li>
</ul></div>

</p>

<p>
La connexió al commutador per configurar-lo es farà amb una aplicació adequada.
</p>

<p>
Si el sistema operatiu que utilitzeu és un de la família Windows, l’aplicació per realitzar aquesta connexió pot ser l’Hyperterminal (<span class="figref"><a href="#Figure8"><span>figura</span></a></span>). A la versió XP el mateix sistema operatiu incorpora aquesta aplicació.
</p>
<div class="iocfigure"><a name="Figure8"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Hyperterminal 

</figcaption><img src="../media/ic10m5u4_12.png" alt="" /></figure>
</div><div class="iocimportant"><div class="ioccontent">
<p>
Durant el curs utilitzarem un simulador de xarxes per realitzar les configuracions. Per aquest motiu, no serà imprescindible utilitzar el programa HyperTerminal ni cap de similar. No obstant això, és molt recomanable almenys llegir el que es diu d’aquests programes per saber com funcionen. Són els que caldrà utilitzar a la realitat.
</p>
</div></div>
<p>
Un cop l’aplicació està en marxa, només cal introduir-hi un nom adequat per guardar el tipus de connexió i configurar el port (<span class="figref"><a href="#Figure9"><span>figura</span></a></span>) amb el qual s’ha fet la connexió entre el commutador i la vostra màquina.
</p>
<div class="iocfigure"><a name="Figure9"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Elecció del port

</figcaption><img src="../media/ic10m5u4_13.png" alt="" /></figure>
</div>
<p>
Un cop seleccionat correctament el port al qual teniu el commutador connectat, cal configurar el programa (<span class="figref"><a href="#Figure10"><span>figura</span></a></span>) per tenir una comunicació correcta entre el commutador i la vostra màquina. Penseu que una configuració incorrecta provocaria que les dues màquines no es pugessin entendre i, per tant, no veuríeu la pantalla de configuració del commutador, sinó només una pantalla en blanc en la qual no podríeu fer res. Si això passés, hauríeu d’aturar la connexió, tornar a configurar el programa adequadament i tornar a provar de fer la connexió.
</p>
<div class="iocfigure"><a name="Figure10"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Configuració de l’Hyperterminal 

</figcaption><img src="../media/ic10m5u4_14.png" alt="" /></figure>
</div>
<p>
La pantalla que veieu en la <span class="figref"><a href="#Figure10"><span>figura</span></a></span> mostra les dades adequades per a la transmissió entre el vostre ordinador i el commutador: una velocitat de transferència de 9.600 bps, 8 bits de dades a cada trama transmesa, cap bit de paritat o control d’errors, un bit d’aturada i cap mena de control de flux.
</p>

<p>
Després d’haver fet la configuració correctament, ja es pot començar la configuració del commutador.
</p>

<p>
En cas que feu servir un sistema operatiu de codi obert -és a dir, un Linux-, es pot configurar el commutador amb l’aplicació gtkterm (<span class="figref"><a href="#Figure11"><span>figura</span></a></span>), una aplicació molt similar a l’Hyperterminal que utilitza Windows. Si no disposeu d’aquesta aplicació, caldrà que us baixeu d’Internet el paquet rpm adient i us l’instal·leu.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Observació</p>
<p>
A les versions de Windows posteriors a XP ha desaparegut l’aplicació <strong>Hyperterminal</strong>. Podeu utilitzar al seu lloc l’aplicació <strong>PuTTY</strong> (<a href="http://www.putty.org/" class="urlextern" title="http://www.putty.org/"  rel="nofollow">www.putty.org</a>). Els paràmetres de la connexió seran els mateixos que al cas d’Hyperterminal.
</p>
</div></div>
<p>
<div class="iocfigurec">
<ul>
<li>
<img src="../media/ic10m5u4_15.png" class="imgB" title="Logotip de Linux" alt="Logotip de Linux" /></li><li><small>Logotip de Linux</small></li>
</ul></div>

</p>

<p>
L’aplicació de Linux també necessita una configuració per adaptar les dades a la velocitat del commutador. Per configurar-la, cal anar a Configuració i en el menú que es desplega seleccionar Port. Un cop seleccionat, s’obrirà la finestra de configuració de la <span class="figref"><a href="#Figure12"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figure11"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Gtkterm

</figcaption><img src="../media/ic10m5u4_16.png" alt="" /></figure>
</div><div class="iocfigure"><a name="Figure12"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Configuració de l’aplicació gtkterm

</figcaption><img src="../media/ic10m5u4_17.png" alt="" /></figure>
</div>
<p>
Cal seleccionar el port adient. Recordeu que utilitzeu Linux i el port COM 1 en Linux és el dispositiu /dev/ttyS0. La configuració ha de ser la mateixa que si utilitzéssiu Windows, ja que el commutador no té en compte el sistema operatiu de l’ordinador amb el qual es fa la connexió perquè disposa d’un sistema operatiu propi.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Configuració...</p>
<p>
… de l’aplicació gtkterm per a la connexió entre l’ordinador i el commutador per transmetre la configuració. Si algun d’aquests paràmetres no coincideixen, la connexió no serà possible.
</p>
</div></div>
<p>
Un cop realitzades les configuracions oportunes, ja esteu en disposició de configurar un commutador. Com que segurament no disposareu de cap commutador o si en teniu algun no el voldreu utilitzar per no malmetre la configuració existent, farem servir un simulador per aprendre a configurar un commutador.
</p>

<p>
Utilitzarem el simulador <strong>Packet Tracer</strong> de <strong>Cisco Systems</strong> (<span class="figref"><a href="#Figure13"><span>figura</span></a></span>), que permet simular qualsevol configuració de la xarxa. Cal recordar que només és un simulador i, per tant, pot haver-hi ordres correctes que no accepti.
</p>
<div class="iocfigure"><a name="Figure13"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Pantalla inicial del simulador Packet Tracer de Cisco Systems

</figcaption><img src="../media/ic10m5u4_201.png" alt="" /></figure>
</div>
<p>
Per afegir dispositius a la xarxa que simulem cal fer els següents clics:
</p>
<ol>
<li class="level1"><div class="li"> Al tipus de dispositiu que volem situar (part inferior esquerra de la finestra).</div>
</li>
<li class="level1"><div class="li"> Al dispositiu concret que volem afegir (part inferior esquerra de la finestra).</div>
</li>
<li class="level1"><div class="li"> Al lloc on el volem posar (requadre blanc gran).</div>
</li>
</ol>

<p>
A la figura <span class="figref"><a href="#Figure203"><span>figura</span></a></span> es mostren aquestes zones.
</p>
<div class="iocfigure"><a name="Figure203"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Passos per afegir un dispositiu a la xarxa simulada

</figcaption><img src="../media/ic10m5u4_203.png" alt="" /></figure>
</div>
<p>
Per connectar dispositius de la xarxa que simulem cal fer els següents clics:
</p>
<ol>
<li class="level1"><div class="li"> A la icona “raig” (part inferior esquerra de la finestra).</div>
</li>
<li class="level1"><div class="li"> Al tipus de cable que utilitzarem (part inferior esquerra de la finestra).</div>
</li>
<li class="level1"><div class="li"> Al primer dispositiu a connectar (dins del requadre blanc gran). Surt un desplegable per triar la interfície associada al cable.</div>
</li>
<li class="level1"><div class="li"> Al segon dispositiu a connectar (exactament igual que al pas anterior).</div>
</li>
</ol>

<p>
A la figura <span class="figref"><a href="#Figure204"><span>figura</span></a></span> es mostra on cal fer aquests clics per unir dos commutadors.
</p>
<div class="iocfigure"><a name="Figure204"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Passos per afegir un dispositiu a la xarxa simulada

</figcaption><img src="../media/ic10m5u4_204.png" alt="" /></figure>
</div>
<p>
Amb aquest simulador, quan feu clic a sobre d’un dispositiu i, a la finestra que apareix, seleccioneu la pestanya CLI, veureu una pantalla com la de la <span class="figref"><a href="#Figure14"><span>figura</span></a></span>, que seria la mateixa que veuríeu si empréssiu les aplicacions comentades abans (<strong>Hyperterminal</strong> i <strong>gtkterm</strong>) per configurar un commutador físicament.
</p>
<div class="iocfigure"><a name="Figure14"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Pantalla de configuració del commutador

</figcaption><img src="../media/ic10m5u4_202.png" alt="" /></figure>
</div>
<p>
Un cop en aquesta pantalla, si premeu la tecla de retorn o Enter començareu la configuració del commutador. Heu de tenir en compte que hi ha diferents modes de treballar tant en un commutador com en un encaminador.
</p>
<ul>
<li class="level1"><div class="li"> <strong>Mode d’usuari</strong>: tindreu un accés limitat a l’encaminador. Per saber que esteu treballant en aquest mode, heu de mirar si l’aspecte de l’indicador (<em>prompt</em>) és <strong>Switch</strong>.</div>
</li>
<li class="level1"><div class="li"> <strong>Mode privilegiat</strong>: tindreu més accés al commutador; així doncs, podreu fer una anàlisi detallada de l’estat del commutador i podreu manipular els arxius de configuració. Per saber que esteu en mode privilegiat, també heu de mirar si l’indicador té la forma <strong>Switch#</strong>, on Switch és el nom que s’ha donat al commutador.</div>
</li>
<li class="level1"><div class="li"> <strong>Mode de configuració global</strong>: podeu utilitzar ordres de configuració simples. Per saber que esteu en aquest mode, l’aspecte de l’indicador ha de ser <strong>Switch(config)#</strong>.</div>
</li>
<li class="level1"><div class="li"> <strong>Altres modes de configuració</strong>: permet configuracions més detallades. Per saber que esteu en aquest mode també heu d’observar l’indicador; en aquest cas tindrà un aspecte similar a <strong>Switch(config - mode)#</strong>, on el mode indica quina configuració feu:</div>
<ul>
<li class="level2"><div class="li"> <strong>Switch(config - if)#</strong> configuració d’una interfície</div>
</li>
<li class="level2"><div class="li"> <strong>Switch(config - line)#</strong> configuració d’una línia de terminal</div>
</li>
</ul>
</li>
</ul>

<p>
Tingueu en compte que quan tindreu més problemes és quan treballeu amb els diferents modes, ja que intentareu configurar-ne alguna des d’un mode equivocat amb les ordres correctes i no trobareu on és l’error.
</p>

<p>
Cada mode accepta unes ordres determinades. A continuació us presentem una llista de les ordres que es poden utilitzar des dels diferents modes. Més endavant es veuran amb més detall les ordres que utilitzarem:
</p>

<p>
<strong>Mode d’usuari:</strong>
</p>
<ul>
<li class="level1"><div class="li"> enable: canvia a mode privilegiat.</div>
</li>
<li class="level1"><div class="li"> exit: surt del mode d’execució.</div>
</li>
<li class="level1"><div class="li"> ? : ajuda.</div>
</li>
<li class="level1"><div class="li"> ping: comprova les connexions.</div>
</li>
<li class="level1"><div class="li"> show: mostra la informació en execució.</div>
</li>
<li class="level1"><div class="li"> traceroute: mostra la ruta des de l’origen fins a la destinació.</div>
</li>
</ul>

<p>
<strong>Mode privilegiat:</strong>
</p>
<ul>
<li class="level1"><div class="li"> clear: reinicialitza (<em>reset</em>) les funcions.</div>
</li>
<li class="level1"><div class="li"> configure: entra al mode de configuració.</div>
</li>
<li class="level1"><div class="li"> copy: copia la configuració al microprogramari o <em>firmware</em>.</div>
</li>
<li class="level1"><div class="li"> delete: reinicialitza la configuració.</div>
</li>
<li class="level1"><div class="li"> disable: surt del mode privilegiat.</div>
</li>
<li class="level1"><div class="li"> enable: entra al mode privilegiat.</div>
</li>
<li class="level1"><div class="li"> exit: surt del mode d’execució.</div>
</li>
<li class="level1"><div class="li"> ? : ajuda.</div>
</li>
<li class="level1"><div class="li"> ping: comprova les connexions.</div>
</li>
<li class="level1"><div class="li"> reload: atura i reinicialitza el commutador.</div>
</li>
<li class="level1"><div class="li"> show: mostra la informació en execució.</div>
</li>
<li class="level1"><div class="li"> tracerute: mostra la ruta des de l’origen fins a la destinació.</div>
</li>
</ul>

<p>
<strong>Mode de configuració global</strong>:
</p>
<ul>
<li class="level1"><div class="li"> banner: defineix un text d’inici.</div>
</li>
<li class="level1"><div class="li"> cdp: configura subordres.</div>
</li>
<li class="level1"><div class="li"> enable: modifica paràmetres de les contrasenyes.</div>
</li>
<li class="level1"><div class="li"> end: surt del mode de configuració.</div>
</li>
<li class="level1"><div class="li"> exit: surt del mode de configuració.</div>
</li>
<li class="level1"><div class="li"> hostname: canvia el nom del commutador.</div>
</li>
<li class="level1"><div class="li"> interface: selecciona una interfície per configurar-la.</div>
</li>
<li class="level1"><div class="li"> ip: ordres de configuració d’adreça IP global.</div>
</li>
<li class="level1"><div class="li"> line: configura una línia de terminal.</div>
</li>
<li class="level1"><div class="li"> mac-address-table: configura la taula d’adreces MAC.</div>
</li>
<li class="level1"><div class="li"> service: ordres de configuració.</div>
</li>
<li class="level1"><div class="li"> switching-mode: canvia els modes del commutador.</div>
</li>
<li class="level1"><div class="li"> uplink-fast: activa la unió ràpida.</div>
</li>
<li class="level1"><div class="li"> vlan: configura el servidor vlan.</div>
</li>
<li class="level1"><div class="li"> vlan-membership: configura els membres del servidor vlan.</div>
</li>
<li class="level1"><div class="li"> vtp: ordres de configuració vtp.</div>
</li>
</ul>

<p>
<strong>Mode de configuració d’interfície</strong>:
</p>
<ul>
<li class="level1"><div class="li"> cdp: subordres d’interfície cdp.</div>
</li>
<li class="level1"><div class="li"> description: descriu específicament una interfície.</div>
</li>
<li class="level1"><div class="li"> duplex: configura una operació dúplex.</div>
</li>
<li class="level1"><div class="li"> exit: surt del mode de configuració de la interfície.</div>
</li>
<li class="level1"><div class="li"> port: configura els ports del commutador.</div>
</li>
<li class="level1"><div class="li"> shutdown: desactiva la interfície.</div>
</li>
<li class="level1"><div class="li"> vlan-membership: configura els membres del servidor vlan.</div>
</li>
</ul>

<p>
Després de comentar algunes de les ordres utilitzades per configurar commutadors, en podeu provar algunes al simulador d’encaminadors i commutadors.
</p>

<p>
L’ordre <strong>enable</strong> s’utilitza per canviar de mode d’usuari a mode privilegiat: com es pot veure en la <span class="figref"><a href="#Figure15"><span>figura</span></a></span>, l’indicador ha canviat després d’executar l’ordre <strong>enable</strong> en passar de ser <strong>&gt;</strong> a ser <strong>#</strong>.
</p>
<div class="iocfigure"><a name="Figure15"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Ordre enable

</figcaption><img src="../media/ic10m5u4_205.png" alt="" /></figure>
</div>
<p>
Per passar a mode de configuració global i poder començar la configuració del commutador, es fa servir l’ordre <strong>configure terminal</strong>. Com es pot veure en la <span class="figref"><a href="#Figure16"><span>figura</span></a></span>, l’indicador ha tornat a canviar. Cal estar molt atent al que mostra l’indicador, ja que ens diu en cada moment en quin mode es treballa. Si no ho tenim en compte, podem desconfigurar l’encaminador totalment.
</p>
<div class="iocfigure"><a name="Figure16"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Ordre configure terminal

</figcaption><img src="../media/ic10m5u4_206.png" alt="" /></figure>
</div>
<p>
Un cop s’ha passat al mode de configuració, es pot començar la configuració amb un canvi que no afecti gaire les condicions del commutador: per exemple, es proposa canviar-li el nom.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
Les ordres i els paràmetres poden abreujar-se tant com es vulgui mentre no es produeixi cap ambigüitat amb una altra ordre o un altre paràmetre que comenci igual. Així, per exemple, <em>enable</em> pot escriure’s <em>ena</em> i <em>configure terminal</em> pot escriure’s <em>conf t</em>.
</p>
</div></div>
<p>

</p>

<p>
Per canviar-li el nom s’ha d’aplicar l’ordre <strong>hostname</strong> nom_de_commutador (<span class="figref"><a href="#Figure17"><span>figura</span></a></span>) des del mode de configuració global.
</p>
<div class="iocfigure"><a name="Figure17"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Ordre hostname

</figcaption><img src="../media/ic10m5u4_207.png" alt="" /></figure>
</div>
<p>
Una altra configuració seria assignar una descripció a la interfície FastEthernet 0/1; per a això s’ha d’entrar a mode de configuració de la interfície (<span class="figref"><a href="#Figure18"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figure18"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Canvi a mode de configuració de la interfície

</figcaption><img src="../media/ic10m5u4_208.png" alt="" /></figure>
</div>
<p>
Es canviarà de mode aplicant l’ordre <strong>interface</strong> FastEthernet 0/1. Una vegada en mode de configuració de la interfície, podem assignar-li una descripció (<span class="figref"><a href="#Figure19"><span>figura</span></a></span>).
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Canvi</p>
<p>
El canvi de mode de configuració global a configuració d’interfície es realitza per poder introduir les configuracions adients a la interfície seleccionada.
</p>
</div></div>
<p>
Per introduir una descripció a la interfície FastEthernet 0/1 cal aplicar l’ordre <strong>description</strong> (descripció), on <em>descripció</em> és la descripció que vulguem donar-li.
</p>
<div class="iocfigure"><a name="Figure19"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Assignar una descripció a una interfície

</figcaption><img src="../media/ic10m5u4_209.png" alt="" /></figure>
</div>
<p>
Amb la interfície FastEthernet 0/1 configurada, es pot comprovar aquesta interfície amb l’ordre <strong>show interface</strong> FastEthernet 0/1. Aquesta ordre s’ha d’executar des del mode privilegiat; per tant, primer caldrà sortir del mode de configuració global amb l’ordre <strong>end</strong>.
</p>

<p>
Un cop aplicada l’ordre <strong>show interface</strong> FastEthernet 0/1 (<span class="figref"><a href="#Figure21"><span>figura</span></a></span>) es pot observar diferent informació sobre aquesta interfície del commutador: el tipus de cable utilitzat en la connexió, l’adreça en format hexadecimal i l’amplada de banda disponible. Cal tenir en compte que el commutador lliura a cada connexió tota l’amplada de banda disponible i, per tant, cal estar informat de la quantitat d’aquesta. També es pot veure una taula d’estadístiques tant de dades transmeses com de dades rebudes.
</p>
<div class="iocfigure"><a name="Figure21"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Ordre show interface

</figcaption><img src="../media/ic10m5u4_210.png" alt="" /></figure>
</div>
<p>
Una altra qüestió que s’ha de tenir en compte a l’hora de configurar un commutador és la taula d’adreces MAC. Aquesta taula es configurarà utilitzant l’ordre <strong>mac-address-table</strong>.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
Cal poder comprovar en tot moment la configuració de les interfícies.
</p>
</div></div>
<p>
Per comprovar la configuració de la taula d’adreces MAC (<span class="figref"><a href="#Figure23"><span>figura</span></a></span>) n’hi ha prou de mostrar-la amb l’ordre <strong>show mac-address-table</strong> des del mode privilegiat.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
La taula d’adreces MAC és una part important per al funcionament correcte del commutador.
</p>
</div></div><div class="iocfigure"><a name="Figure23"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Exemple de taula d’adreces MAC

</figcaption><img src="../media/ic10m5u4_211.png" alt="" /></figure>
</div>
<p>
Una vegada s’han realitzat totes les configuracions, es pot provar si s’ha configurat adequadament, és a dir, si hi ha connexió amb totes les màquines que hi ha connectades als ports del commutador. Per comprovar-ho, s’utilitzarà la mateixa ordre que es fa servir quan es comprova des d’un ordinador normal, l’ordre <strong>ping</strong> IP.
</p>

<p>
Finalitzada la configuració del commutador, s’ha de guardar una còpia de l’arxiu de configuració per si fos necessari tornar-lo a enviar al commutador. Per copiar la configuració, s’utilitzarà l’ordre <strong>copy running-config tftp</strong>. S’ha de tenir en compte que per poder-la fer, cal tenir una aplicació de transmissió de dades que utilitzi el protocol TFTP.
</p>

<p>
Quan utilitzeu aquesta ordre per guardar una còpia de l’arxiu de configuració, el programa us farà un seguit de preguntes del tipus nom del fitxer o destinació del fitxer, etc.
</p>

<p>
Un cop indicat com es dirà l’arxiu de configuració i on s’emmagatzemarà, es transmetran les dades. Cal guardar-les en un lloc segur, perquè si fos necessari tornar a configurar el commutador, aquest arxiu estalviarà molta feina.
</p>

<p>
Com podeu comprovar, en executar l’ordre <strong>copy running-config tftp</strong> (<span class="figref"><a href="#Figure24"><span>figura</span></a></span>), el commutador us demana l’adreça o nom de l’ordinador on voleu guardar la configuració i el nom amb què voleu emmagatzemar l’arxiu de configuració.
</p>
<div class="iocfigure"><a name="Figure24"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Ordre copy running-config tftp

</figcaption><img src="../media/ic10m5u4_212.png" alt="" /></figure>
</div>
<p>
Perquè funcioni correctament l’ordre <strong>copy running-config tftp</strong> cal haver configurat prèviament una adreça IP d’administració al commutador. Podeu trobar com es fa a l’apartat “VLAN d’administració”.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
Sempre cal tenir una còpia de l’arxiu de configuració guardada.
</p>
</div></div><div class="iocimportant"><div class="ioccontent">
<p>
Aquesta adreça IP no intervé a la gestió de l’encaminador. Només s’utilitza per administrar remotament el dispositiu.
</p>
</div></div>
<p>
El dispositiu té la configuració a la memòria RAM (encara que haguem fet una còpia sobre un servidor). Si ens interessa que la configuració es mantingui encara que apaguem el commutador i el tornem a posar en marxa, cal gravar aquesta configuració a una memòria permanent (nvram en aquest cas). Així, en posar en marxa el commutador, treballarà amb aquesta configuració. Per aconseguir-ho, s’ha d’executar l’ordre
<em>copy running-config start-config</em>.
</p>

<p>
Una ordre de molta utilitat és l’ordre <strong>?</strong> (<span class="figref"><a href="#Figure25"><span>figura</span></a></span>), ja que es pot utilitzar en qualsevol moment perquè ens mostri totes les ordres que es poden fer servir en cada mode.
</p>

<p>
En la <span class="figref"><a href="#Figure25"><span>figura</span></a></span> s’ha utilitzat l’ordre <strong>?</strong> en el mode de configuració global: el resultat ens mostra totes les ordres que es poden emprar des d’aquest mode, cosa que resulta de gran ajuda.
</p>
<div class="iocfigure"><a name="Figure25"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Ordre ? en mode de configuració global

</figcaption><img src="../media/ic10m5u4_255.png" alt="" /></figure>
</div>
<p>
Si s’executa aquesta ordre en mode privilegiat, s’obté la llista d’ordres de la <span class="figref"><a href="#Figure26"><span>figura</span></a></span>.
</p>
<div class="iocfigure"><a name="Figure26"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Ordre ? en mode privilegiat

</figcaption><img src="../media/ic10m5u4_256.png" alt="" /></figure>
</div>
<p>
L’ordre <strong>?</strong> també serveix quan es configura la IP i no se sap el que s’ha de posar; s’escriu a continuació de l’ordre que s’utilitzava i ens mostrarà les possibilitats.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
La configuració del commutador és molt important per a un funcionament correcte de la xarxa. Recordeu que hi ha quatres modes de configuració:
</p>
<ul>
<li class="level1"><div class="li"> Mode d’usuari</div>
</li>
<li class="level1"><div class="li"> Mode privilegiat</div>
</li>
<li class="level1"><div class="li"> Mode de configuració global</div>
</li>
<li class="level1"><div class="li"> Altres modes de configuració</div>
</li>
</ul>

<p>
L’estat de l’indicador mostra en tot moment en quin mode de configuració us trobeu.
</p>
</div></div>
</div>

<h2><a id="definicio_i_configuracio_de_vlan" >Definició i configuració de VLAN</a></h2>
<div class="level2">

<p>
Les <em>virtual <acronym title="Local Area Network">LAN</acronym></em> (xarxes d’àrea local virtuals, VLAN) són una manera de crear xarxes lògiques dins d’una mateixa xarxa física. Per tant, hi poden haver diverses xarxes dins d’un mateix medi físic o bé, mitjançant un enllaç troncal, hi poden haver en una mateixa xarxa certs ports de diversos commutadors.
</p>

<p>
Gràcies a les VLAN podem fer més petits els dominis de difusió i permetre així una gestió millor dels segments de la xarxa. Per exemple, podem agrupar mitjançant VLAN els departaments d’una empresa per tal que transfereixin dades entre si directament i en cas que necessitin traspassar dades amb un altre departament ho puguin continuar fent mitjançant encaminament.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
El domini de difusió o domini de <em>broadcast</em> és el conjunt de dispositius que poden rebre els paquets multidifusió del segment.
</p>
</div></div>
<p>
Mitjançant les VLAN també es millora la seguretat, ja que podem aplicar filtres entre les VLAN per evitar trànsit no volgut.
</p>

<p>
Hi ha diversos protocols que permeten crear aquestes xarxes virtuals, però el més estès és IEEE 802.1Q.
</p>

</div>

<h3><a id="presentacio_de_les_vlan" >Presentació de les VLAN</a></h3>
<div class="level3">

<p>
Per a entendre per què s’utilitzen tant avui dia les VLAN, considereu una petita comunitat amb dormitoris d’estudiants i oficines per al cos docent, tot en un únic edifici. La <span class="figref"><a href="#Figure27"><span>figura</span></a></span> mostra els equips dels estudiants en una xarxa i els equips dels docents en una altra. Com que tots els departaments estan físicament junts, el sistema funciona correctament i és prou senzill proporcionar a tots els usuaris els serveis de la xarxa.
</p>

<p>
Després d’un any, el centre ha crescut i ara té tres edificis (<span class="figref"><a href="#Figure28"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figure27"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Xarxa de la comunitat

</figcaption><img src="../media/ic10m5u4_32.png" alt="" /></figure>
</div>
<p>
En la <span class="figref"><a href="#Figure29"><span>figura</span></a></span>, la xarxa original és la mateixa però els equips dels estudiants i dels docents estan distribuïts en tres edificis. Ara, el departament de sistemes de la informació (SI) es vol assegurar que tots els equips comparteixen les mateixes característiques de seguretat, controls d’amplada de banda, etc. Com s’han d’implementar les necessitats compartides dels departaments, separats geogràficament?, cal crear una gran <acronym title="Local Area Network">LAN</acronym> i connectar per cable tots els departaments junts?, és gaire costós fer canvis en aquesta xarxa?, etc. És ideal agrupar els usuaris amb els recursos que utilitzen, sense tenir en compte la seva situació geogràfica, i a més s’aconseguiria una administració més senzilla de la seguretat específica i les necessitats d’amplada de banda.
</p>
<div class="iocfigure"><a name="Figure28"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Nova xarxa de la comunitat, en tres edificis

</figcaption><img src="../media/ic10m5u4_33.png" alt="" /></figure>
</div>
<p>
En el cas del centre educatiu, cal utilitzar una tecnologia de xarxa anomenada <em>virtual <acronym title="Local Area Network">LAN</acronym></em> (VLAN). Una VLAN permet que un administrador de xarxa creï grups de dispositius connectats a la xarxa de manera lògica i que actuïn com si fossin en una xarxa independent. Mitjançant les VLAN, es poden segmentar de manera lògica les xarxes commutades basades en departaments, funcions professionals, projectes, etc.
</p>
<div class="iocfigure"><a name="Figure29"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Exemple de segmentació lògica

</figcaption><img src="../media/ic10m5u4_34.png" alt="" /></figure>
</div>
<p>
Una VLAN és una subxarxa IP, separada de manera lògica. Les VLAN permeten que xarxes i subxarxes IP coexisteixin en la mateixa xarxa commutada. La <span class="figref"><a href="#Figure30"><span>figura</span></a></span> mostra una xarxa amb tres PC. Perquè els equips es comuniquin en la mateixa VLAN, cadascun d’aquests equips ha de tenir una adreça IP i una màscara de subxarxa coherent amb la VLAN a què pertanyen. En el commutador (<em>switch</em>) s’han de donar d’alta les VLAN i assignar a cada port la VLAN corresponent. Recordeu que si dos ordinadors estan connectats físicament al mateix commutador, no significa que es puguin comunicar. Els dispositius en dues xarxes o subxarxes separades s’han de comunicar mitjançant un encaminador (capa 3), tant si s’utilitzen les VLAN com si no. No es necessiten les VLAN per a tenir diferents xarxes i subxarxes en una xarxa commutada, però hi ha avantatges reals utilitzant VLAN.
</p>
<div class="iocfigure"><a name="Figure30"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Esquema de tres PC en VLAN

</figcaption><img src="../media/ic10m5u4_35v2.png" alt="" /></figure>
</div>
</div>

<h3><a id="tipus_de_vlan" >Tipus de VLAN</a></h3>
<div class="level3">

<p>
Hi ha varietat de termes per a les VLAN. Alguns termes defineixen el tipus de trànsit de xarxa que envia i d’altres defineixen la funció específica que desenvolupa la VLAN. A continuació descrivim la terminologia comuna per a VLAN.
</p>

</div>

<h4><a id="vlan_de_dades" >VLAN de dades</a></h4>
<div class="level4">

<p>
Una VLAN de dades és una VLAN configurada per enviar únicament trànsit de dades generat per l’usuari. Una VLAN pot enviar trànsit basat en veu o trànsit utilitzat per administrar el commutador, però aquest trànsit no és part d’una VLAN de dades. És una pràctica comuna separar el trànsit de veu i administració del trànsit de dades. Això fa identificar les VLAN que només poden enviar dades d’usuari: VLAN de dades o VLAN d’usuari.
</p>

</div>

<h4><a id="vlan_predeterminada" >VLAN predeterminada</a></h4>
<div class="level4">

<p>
Per defecte, tots els ports del commutador són a la VLAN predeterminada; per tant, són dins del mateix domini de multidifusió. Normalment, la VLAN 1 és la VLAN predeterminada a tots els commutadors. Aquesta VLAN predeterminada és com qualsevol VLAN, tret que no es pot reanomenar i no es pot eliminar.
</p>

<p>
Pel que fa a la seguretat, és convenient modificar la VLAN predeterminada a una VLAN que no sigui la VLAN 1; això implica configurar tots els ports en el commutador perquè s’associïn amb una VLAN predeterminada que no sigui la VLAN 1.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">VLAN predeterminada</p>
<p>
Alguns administradors de xarxa utilitzen el terme <em>VLAN predeterminada</em> per referir-se a una VLAN que no sigui la VLAN 1, que l’administrador va definir com la VLAN on s’assignen tots els ports que no estan en ús. En aquest cas, l’única funció que compleix la VLAN 1 és la d’utilitzar el trànsit de capa 2 per la xarxa.
</p>
</div></div>
</div>

<h4><a id="vlan_nativa" >VLAN nativa</a></h4>
<div class="level4">

<p>
S’assigna una VLAN nativa a un port troncal. Un port d’enllaç troncal admet el trànsit que arriba de moltes VLAN (trànsit etiquetat) i també el trànsit que no arriba d’una VLAN (trànsit sense etiquetar). El port d’enllaç troncal deixa el trànsit no etiquetat en la VLAN nativa. La finalitat de les VLAN natives és mantenir la compatibilitat amb les LANs antigues, que no suporten VLANs.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
Els enllaços troncals admeten la transmissió de trànsit des de més d’una VLAN.
</p>
</div></div>
</div>

<h4><a id="vlan_d_administracio" >VLAN d&#039;administració</a></h4>
<div class="level4">

<p>
Una VLAN d’administració és qualsevol VLAN que es configura per accedir remotament a les capacitats administratives d’un commutador. S’assigna una adreça IP i una màscara de subxarxa a la VLAN d’administració i, mitjançant  HTTP, Telnet o SSH, es pot accedir al commutador. Generalment els commutadors tenen la VLAN 1 com a VLAN predeterminada; per tant, designar aquesta VLAN com a VLAN d’administració no és una bona decisió sota el punt de vista de la seguretat.
</p>

<p>
Per assignar una adreça IP a la VLAN administrativa cal introduir aquestes ordres:
</p>

<p>
<code>Switch(config)#interface vlan <em>nroVlan</em></code>
</p>

<p>
<code>Switch(config-if)#ip address <em>adreçaIP</em> <em>màscara</em></code>
</p>

<p>
Per configurar la seva passarel·la (a fi que tingui connectivitat amb xarxes remotes):
</p>

<p>
<code>Switch(config)#ip default-gateway <em>adreçaPassarel·la</em></code>
</p>

<p>
Per veure la configuració de la VLAN:
</p>

<p>
<code>Switch#show interface vlan <em>nroVlan</em></code>
</p>

<p>
Per exemple (el pas del mode <em>config-if</em> a <em>config</em> es fa automàticament):
</p>
<pre class="code">  Switch(config)#interface vlan 20
  Switch(config-if)#ip address 192.168.0.2 255.255.255.0
  Switch(config-if)#ip default-gateway 192.168.0.1
  Switch(config)#exit
  Switch#show interface vlan 20</pre>

</div>

<h4><a id="els_ports_de_commutador" >Els ports de commutador</a></h4>
<div class="level4">

<p>
Els ports de commutador són interfícies de capa 2 associats únicament a un port físic. Els ports de commutació no fan encaminament de capa 3 i poden pertànyer a una VLAN o a més d’una.
</p>

<p>
Quan es configura una VLAN s’ha d’assignar un nombre d’ID i també es pot assignar, si es vol, un nom. L’usuari pot configurar un port per a pertànyer a una VLAN, assignant el mode de port que especifiqui el tipus de trànsit que envia el port i les VLAN a què pertany. Es pot configurar un port per a admetre aquests tipus de VLAN:
</p>
<ul>
<li class="level1"><div class="li"> <strong>VLAN estàtica</strong>. Les VLAN estàtiques es configuren manualment d’una a una i els ports s’assignen també manualment a una VLAN. Vegeu el manual de configuració del fabricant del commutador per a veure com s’han de fer aquestes configuracions. En el cas de Cisco, mitjançant una connexió de consola:</div>
</li>
</ul>
<pre class="code">Switch#configure terminal
Enter configuration commands, one per line.  End with CNTL/Z.
Switch(config)#interface fastEthernet 0/18
Switch(config-if)#switchport access vlan 20
Switch(config-if)#end
Switch#</pre>
<ul>
<li class="level1"><div class="li"> <strong>VLAN dinàmica</strong>. Aquest mode s’utilitza molt en xarxes de gran producció i no es treballa en aquest mòdul. Tot i això, és útil saber què és una VLAN dinàmica. La filiació d’una VLAN de port dinàmic es configura utilitzant un servidor especial, anomenat <em>servidor de política de filiació d’una VLAN</em> (VMPS). Amb el VMPS, s’assignen ports de commutació a les VLAN basades en l’adreça MAC d’origen del dispositiu connectat al port. El benefici és que, quan es trasllada un amfitrió o <em>host</em> des d’un port en un commutador cap a un port d’un altre commutador, aquest commutador assigna de manera dinàmica el nou port a la VLAN adequada per a l’amfitrió.</div>
</li>
</ul>

<p>
A la <span class="figref"><a href="#Figure35"><span>figura</span></a></span> podeu veure, de forma gràfica, els diferents modes de port:
</p>
<div class="iocfigure"><a name="Figure35"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Modes de filiació del port de commutador

</figcaption><img src="../media/ic10m5u4_40.png" alt="" /></figure>
</div>
</div>

<h4><a id="control_dels_dominis_de_difusio_amb_les_vlan" >Control dels dominis de difusió amb les VLAN</a></h4>
<div class="level4">

<p>
En condicions de funcionament normal, quan un commutador rep una trama de multidifusió per un dels ports, reenvia la trama per tots els altres ports. En la <span class="figref"><a href="#Figure36"><span>figura</span></a></span>, tota la xarxa està configurada en la mateixa subxarxa (172.17.40.0/24), i com a resultat d’això, quan el PC1 envia una trama de multidifusió, el commutador S2 envia aquesta trama a tots els seus ports, i tota la xarxa la rep. La xarxa és un domini de multidifusió.
</p>
<div class="iocfigure"><a name="Figure36"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Diagrama de la xarxa sense VLAN

</figcaption><img src="../media/ic10m5u4_41.png" alt="" /></figure>
</div>
<p>
<strong>1. Xarxa amb VLAN</strong>
</p>

<p>
En la <span class="figref"><a href="#Figure37"><span>figura</span></a></span>, s’ha dividit la xarxa en dues VLAN: VLAN 10, per als docents, i VLAN 20, per als estudiants. Quan s’envia la trama de multidifusió des del PC1 cap al commutador S2, aquest commutador envia la trama només als ports del commutador configurats a la VLAN 20.
</p>
<div class="iocfigure"><a name="Figure37"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Diagrama de la xarxa amb VLAN

</figcaption><img src="../media/ic10m5u4_42.png" alt="" /></figure>
</div>
<p>
En la <span class="figref"><a href="#Figure37"><span>figura</span></a></span>, els ports que comuniquen els commutadors S2 i S1 (ports F0/1) i entre S1 i S3 (ports F0/3) han sigut configurats per a admetre totes les VLAN de la xarxa. Aquesta connexió s’anomena <em>enllaç troncal</em>. Més endavant parlarem d’aquests tipus d’enllaç.
</p>

<p>
Quan S1 rep la trama de multidifusió pel port F0/1, l’envia per l’únic port configurat per a admetre trànsit de la VLAN 10, el port F0/3. Quan S3 rep la trama de multidifusió pel port F0/3, l’envia per l’únic port configurat per a admetre trànsit de la VLAN 10, el port F0/11. La trama arriba a l’únic PC en la VLAN 10, el PC4 dels docents.
</p>

<p>
<strong>2. Comunicació intra-VLAN</strong>
</p>

<p>
En la <span class="figref"><a href="#Figure38"><span>figura</span></a></span>, el PC1 es vol comunicar amb el PC4. Tots dos són a la mateixa VLAN, la VLAN 10. La comunicació amb un dispositiu de la mateixa VLAN s’anomena <em>comunicació intra-VLAN</em>.
</p>
<div class="iocfigure"><a name="Figure38"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Diagrama de la xarxa amb VLAN

</figcaption><img src="../media/ic10m5u4_43.png" alt="" /></figure>
</div>
<p>
A continuació descrivim com es fa aquest procés de comunicació:
</p>
<ol>
<li class="level1"><div class="li"> El PC1 de la VLAN 10 envia la trama de sol·licitud ARP (multidifusió<em>/broadcast</em>) al commutador S2. Els commutadors S2 i S1 envien la trama ARP a tots els ports de la VLAN 10. El commutador S3 envia la trama al port F0/11 per al PC4 en la VLAN 10.</div>
</li>
<li class="level1"><div class="li"> Els commutadors envien la trama de resposta ARP (difusió<em>/unicast</em>) al PC1, que rep la resposta que conté l’adreça MAC del PC4.</div>
</li>
<li class="level1"><div class="li"> El PC1 ja té l’adreça MAC de destí de PC4 i la utilitza per a crear una trama de difusió amb aquesta adreça MAC, com a destí. Els commutadors S2, S1 i S3 envien la trama al PC4.</div>
</li>
</ol>

<p>
<strong>3. Comunicació entre VLAN</strong>
</p>
<div class="iocnote"><div class="ioccontent">
<p>
Hi ha dues connexions des de S1 fins a l’encaminador: una per a treballar en la VLAN 10 i una altra per a enviar les transmissions de la VLAN 20 cap a l’encaminador.
</p>
</div></div>
<p>
En la <span class="figref"><a href="#Figure38"><span>figura</span></a></span>, el PC1 és a la VLAN 10 i es vol comunicar amb el PC5 de la VLAN 20. La comunicació amb un dispositiu d’una altra VLAN s’anomena <em>comunicació entre VLAN</em>. 
</p>

<p>
A continuació descrivim el procés de comunicació:
</p>
<ol>
<li class="level1"><div class="li"> El PC1 (VLAN 10) es vol comunicar amb el PC5 en la VLAN 20. El PC1 envia una trama de sol·licitud d’ARP per la direcció MAC de la passarel·la o <em>gateway</em> predeterminada, R1.</div>
</li>
<li class="level1"><div class="li"> L’encaminador R1 respon amb una trama de resposta ARP des de la interfície configurada en la VLAN 20. Tots els commutadors envien la trama de resposta ARP, i el PC la rep. La resposta ARP conté l’adreça MAC de la passarel·la predeterminada.</div>
</li>
<li class="level1"><div class="li"> Llavors, el PC1 crea una trama Ethernet amb l’adreça MAC de la passarel·la predeterminada. La trama s’envia d’S2 a S1.</div>
</li>
<li class="level1"><div class="li"> L’encaminador R1 envia una trama de sol·licitud d’ARP en la VLAN 20 per determinar l’adreça MAC del PC5. Els commutadors S1, S2 i S3 envien la trama de sol·licitud d’ARP als ports de la VLAN 20. El PC5, en la VLAN 20, rep la trama de sol·licitud de l’encaminador R1.</div>
</li>
<li class="level1"><div class="li"> El PC5 envia la trama de resposta al commutador S3. Els commutadors S3 i S1 envien la trama a l’encaminador R1 amb l’adreça MAC de destí de la interfície F0/2 a l’encaminador R1.</div>
</li>
<li class="level1"><div class="li"> L’R1 envia la trama rebuda del PC1 pels commutadors S1 i S3 al PC5 (en la VLAN 20).</div>
</li>
</ol>

</div>

<h3><a id="configuracio_de_les_vlan" >Configuració de les VLAN</a></h3>
<div class="level3">

<p>
Independentment que les VLAN siguin estàtiques o dinàmiques, la quantitat màxima de VLAN depèn del tipus de commutador i de l’IOS (sistema operatiu). De manera predeterminada, la VLAN 1 és la VLAN d’administració.
</p>

<p>
L’administrador utilitza l’adreça IP de la VLAN d’administració per a configurar el commutador en remot. Com que té accés remot al commutador, l’administrador pot configurar i mantenir totes les configuracions de la VLAN (<span class="figref"><a href="#Figure39"><span>figura</span></a></span>).
</p>
<div class="iocnote"><div class="ioccontent">
<p>
L’adreça IP de la VLAN 1 s’utilitza per a tenir accés remot al commutador i configurar-lo. També es fa servir per a intercanviar informació amb altres dispositius de xarxa.
</p>
</div></div><div class="iocfigure"><a name="Figure39"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Configurar diverses VLAN

</figcaption><img src="../media/ic10m5u4_44.png" alt="" /></figure>
</div>
<p>
Com ja hem comentat, en crear una VLAN, s’assigna un nom i un número. El número de la VLAN pot ser qualsevol número del rang disponible del commutador, excepte la VLAN 1. Mireu el manual del fabricant per a saber el nombre màxim de VLAN que admet el dispositiu. 
</p>

<p>
En el cas de commutadors Cisco, utilitzeu les ordres següents per a crear una VLAN segons el mode de configuració global:
</p>
<pre class="code">Switch(config)#vlan vlan_number
Switch(config-vlan)#name vlan_name
Switch(config-vlan)#exit</pre>

<p>
De manera predeterminada, tots els ports són membres de la VLAN 1. Els ports s’assignen a les VLAN de manera individual o per rangs:
</p>
<pre class="code">Switch(config)#interface fa0/port_number
Switch(config-if)#switchport access vlan vlan_number
Switch(config-if)#exit</pre>

<p>
Per a assignar un rang de ports a una VLAN:
</p>
<pre class="code">Switch(config)#interface range fa0/start_of_range - end_of_range
Switch(config-if)#switchport access vlan vlan_number
Switch(config-if)#exit</pre>

<p>
Exemple de configuració d’una VLAN:
</p>
<pre class="code">Switch#config terminal 
Enter configuration commands, one per line.  End with CNTL/Z.
Switch(config)#vlan 27
Switch(config-vlan)#name vendes
Switch(config-vlan)#exit
Switch(config)#interface fa0/13
Switch(config-if)#switchport access vlan 27
Switch(config-if)#exit
Switch(config)#vlan 28
Switch(config-vlan)#name sistemes
Switch(config-vlan)#exit
Switch(config)#interface rang fa0/6-12
Switch(config-if-range)#switchport access vlan 28
Switch(config-if-range)#exit  
Switch(config)#end
Switch#show vlan
  
VLAN Name                             Status    Ports
---- -------------------------------- --------- -------------------------------
1    default                          active    Fa0/1, Fa0/2, Fa0/3, Fa0/4
                                                Fa0/5, Fa0/14, Fa0/15, Fa0/16
                                                Fa0/17, Fa0/18, Fa0/19, Fa0/20
                                                Fa0/21, Fa0/22, Fa0/23, Fa0/24
27   vendes                           active    Fa0/13
28   sistemes                         active    Fa0/6, Fa0/7, Fa0/8, Fa0/9
                                                Fa0/10, Fa0/11, Fa0/12
1002 fddi-default                     act/unsup 
1003 token-ring-default               act/unsup 
1004 fddinet-default                  act/unsup 
1005 trnet-default                    act/unsup 

VLAN Type  SAID       MTU   Parent RingNo BridgeNo Stp  BrdgMode Trans1 Trans2
---- ----- ---------- ----- ------ ------ -------- ---- -------- ------ ------
1    enet  100001     1500  -      -      -        -    -        0      0
27   enet  100027     1500  -      -      -        -    -        0      0
28   enet  100028     1500  -      -      -        -    -        0      0
1002 fddi  101002     1500  -      -      -        -    -        0      0   
1003 tr    101003     1500  -      -      -        -    -        0      0   
1004 fdnet 101004     1500  -      -      -        ieee -        0      0   
1005 trnet 101005     1500  -      -      -        ibm  -        0      0   

Remote SPAN VLANs
------------------------------------------------------------------------------

Primary Secondary Type              Ports
------- --------- ----------------- ------------------------------------------
Switch#</pre>

<p>
Per a verificar i fer tasques de manteniment i diagnòstic de fallades en les VLAN, és important l’IOS i les ordres clau de l’IOS. En el cas del Cisco IOS, l’ordre <strong>show</strong> és una de les ordres importants per a obtenir informació de les VLAN del dispositiu.
</p>

<p>
<strong>show vlan</strong>
</p>

<p>
Mostra la llista detallada de tots els números i noms de les VLAN, actius al commutador, i els ports associats. També mostra estadístiques d’STP si està configurat en les VLAN.
</p>
<pre class="code">   
VLAN Name                             Status    Ports
---- -------------------------------- --------- -------------------------------
1    default                          active    Fa0/1, Fa0/2, Fa0/3, Fa0/4
                                                Fa0/5, Fa0/14, Fa0/15, Fa0/16
                                                Fa0/17, Fa0/18, Fa0/19, Fa0/20
                                                Fa0/21, Fa0/22, Fa0/23, Fa0/24
27   vendes                           active    Fa0/13
28   sistemes                         active    Fa0/6, Fa0/7, Fa0/8, Fa0/9
                                                Fa0/10, Fa0/11, Fa0/12
1002 fddi-default                     act/unsup 
1003 token-ring-default               act/unsup 
1004 fddinet-default                  act/unsup 
1005 trnet-default                    act/unsup 

VLAN Type  SAID       MTU   Parent RingNo BridgeNo Stp  BrdgMode Trans1 Trans2
---- ----- ---------- ----- ------ ------ -------- ---- -------- ------ ------
1    enet  100001     1500  -      -      -        -    -        0      0
27   enet  100027     1500  -      -      -        -    -        0      0
28   enet  100028     1500  -      -      -        -    -        0      0
1002 fddi  101002     1500  -      -      -        -    -        0      0   
1003 tr    101003     1500  -      -      -        -    -        0      0   
1004 fdnet 101004     1500  -      -      -        ieee -        0      0   
1005 trnet 101005     1500  -      -      -        ibm  -        0      0   

Remote SPAN VLANs
------------------------------------------------------------------------------

Primary Secondary Type              Ports
------- --------- ----------------- ------------------------------------------</pre>

<p>
<strong>show vlan brief</strong>
</p>

<p>
Mostra una llista abreujada, només de les VLAN actives i els ports associats a cadascuna d’aquestes VLAN.
</p>
<pre class="code">Switch#show vlan brief

VLAN Name                             Status    Ports
---- -------------------------------- --------- -------------------------------
1    default                          active    Fa0/1, Fa0/2, Fa0/3, Fa0/4
                                                Fa0/5, Fa0/14, Fa0/15, Fa0/16
                                                Fa0/17, Fa0/18, Fa0/19, Fa0/20
                                                Fa0/21, Fa0/22, Fa0/23, Fa0/24
27   vendes                           active    Fa0/13
28   sistemes                         active    Fa0/6, Fa0/7, Fa0/8, Fa0/9
                                                Fa0/10, Fa0/11, Fa0/12
1002 fddi-default                     active    
1003 token-ring-default               active    
1004 fddinet-default                  active    
1005 trnet-default                    active    </pre>

<p>
<strong>show vlan id</strong> <em>id_number</em>
</p>

<p>
Mostra informació d’una VLAN específica, segons el número d’ID.
</p>
<pre class="code">Switch#show vlan id 28
  
VLAN Name                             Status    Ports
---- -------------------------------- --------- -------------------------------
28   sistemes                         active    Fa0/6, Fa0/7, Fa0/8, Fa0/9
                                                Fa0/10, Fa0/11, Fa0/12

VLAN Type  SAID       MTU   Parent RingNo BridgeNo Stp  BrdgMode Trans1 Trans2
---- ----- ---------- ----- ------ ------ -------- ---- -------- ------ ------
28   enet  100028     1500  -      -      -        -    -        0      0</pre>

<p>
<strong>show vlan name</strong> <em>vlan_name</em>
</p>

<p>
Mostra informació d’una VLAN específica, segons el nom.
</p>
<pre class="code">
  Switch#show vlan name sistemes
  
  VLAN Name                             Status    Ports
  ---- -------------------------------- --------- -------------------------------
  28   sistemes                         active    Fa0/6, Fa0/7, Fa0/8, Fa0/9
                                                  Fa0/10, Fa0/11, Fa0/12
  
  VLAN Type  SAID       MTU   Parent RingNo BridgeNo Stp  BrdgMode Trans1 Trans2
  ---- ----- ---------- ----- ------ ------ -------- ---- -------- ------ ------
  28   enet  100028     1500  -      -      -        -    -        0      0</pre>

<p>

</p>

<p>
En les organitzacions és molt comú que s’afegeixin, es traslladin o s’eliminin els empleats de departaments o projectes. Aquests canvis requereixen tasques de manteniment a la VLAN, que inclouen l’eliminació o la reassignació a diferents VLAN.
</p>

<p>
Quan un port es desvincula d’una VLAN específica, torna a formar part de la VLAN 1. Quan s’elimina una VLAN, es desactiven tots els ports que hi estaven associats, perquè la VLAN ja no hi és.
</p>

<p>
Per a eliminar una VLAN:
</p>

<p>
Switch(config)#<strong>no vlan</strong> <em>vlan_number</em>
</p>

<p>
Per a desvincular un port d’una VLAN específica:
</p>

<p>
Switch(config)#<strong>interface fa0/</strong><em>port_number</em>
</p>

<p>
Switch(config-if)#<strong>no switchport access vlan</strong> <em>vlan_number</em>
</p>

<p>
Exemple d’eliminació de la VLAN 27 desassociant el port 8 de la VLAN 28:
</p>
<pre class="code">Switch(config)#interface fa0/8
Switch(config-if)#no switchport access vlan 28
Switch(config-if)#exit
Switch(config)#no vlan 27
Switch(config)#end 
Switch#show vlan

VLAN Name                             Status    Ports
---- -------------------------------- --------- -------------------------------
1    default                          active    Fa0/1, Fa0/2, Fa0/3, Fa0/4
                                                Fa0/5, Fa0/8, Fa0/14, Fa0/15
                                                Fa0/16, Fa0/17, Fa0/18, Fa0/19
                                                Fa0/20, Fa0/21, Fa0/22, Fa0/23
                                                Fa0/24
28   sistemes                         active    Fa0/6, Fa0/7, Fa0/9, Fa0/10
                                                Fa0/11, Fa0/12
1002 fddi-default                     act/unsup 
1003 token-ring-default               act/unsup 
1004 fddinet-default                  act/unsup 
1005 trnet-default                    act/unsup 

VLAN Type  SAID       MTU   Parent RingNo BridgeNo Stp  BrdgMode Trans1 Trans2
---- ----- ---------- ----- ------ ------ -------- ---- -------- ------ ------
1    enet  100001     1500  -      -      -        -    -        0      0
28   enet  100028     1500  -      -      -        -    -        0      0
1002 fddi  101002     1500  -      -      -        -    -        0      0   
1003 tr    101003     1500  -      -      -        -    -        0      0   
1004 fdnet 101004     1500  -      -      -        ieee -        0      0   
1005 trnet 101005     1500  -      -      -        ibm  -        0      0   </pre>

</div>

<h3><a id="identificacio_de_les_vlan" >Identificació de les VLAN</a></h3>
<div class="level3">

<p>
Els dispositius connectats a una VLAN només es comuniquen amb altres dispositius de la mateixa VLAN, independentment que siguin en el mateix commutador o en commutadors diferents.
</p>

<p>
Un commutador associa cada port amb un nombre de VLAN específic. Quan una trama entra en aquest port, el commutador afegeix l’ID de la VLAN a la trama Ethernet. Aquest procés s’anomena <strong>etiquetatge de trama</strong>. L’estàndard d’etiquetatge de trama més freqüent és l’IEEE 802.1Q.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
L’IEEE 802.1Q és l’estàndard de l’IEEE dissenyat per a permetre el trànsit entre <acronym title="Local Area Network">LAN</acronym> virtuals.
</p>
</div></div>
<p>
Les trames Ethernet tenen una grandària mínima de 64 <em>bytes</em> i un màxim de 1.518 <em>bytes</em>. Una trama Ethernet etiquetada pot tenir una grandària de fins a 1.522 <em>bytes</em> (<span class="figref"><a href="#Figure40"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figure40"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Camps d’etiquetatge de l’estàndard 802.11Q

</figcaption><img src="../media/ic10m5u4_45.png" alt="" /></figure>
</div>
<p>
Les trames contenen camps com:
</p>
<ul>
<li class="level1"><div class="li"> Les adreces MAC d’origen i destí.</div>
</li>
<li class="level1"><div class="li"> La longitud de la trama.</div>
</li>
<li class="level1"><div class="li"> Les dades de càrrega. </div>
</li>
<li class="level1"><div class="li"> La seqüència de verificació de trama (FCS).</div>
</li>
</ul>

<p>
Quan es connecta un port compatible amb 802.1Q a un altre port compatible amb 802.1Q, la informació d’etiquetatge VLAN es transmet entre aquests ports. En cas que el port no sigui compatible amb 802.1Q, s’elimina l’etiqueta VLAN abans de trametre la trama. 
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Unitat màxima de transferència (MTU)</p>
<p>
La unitat màxima de transferència és un terme que expressa la grandària, en <em>bytes</em>, de la unitat de dades més gran que es pot enviar utilitzant un protocol d’Internet (IP). En el cas d’Ethernet, 1.518 <em>bytes</em>. 
</p>
</div></div>
<p>
Si un dispositiu no habilitat per 802.1Q o un port d’accés rep una trama 802.1Q, s’ignoren les dades de l’etiqueta i la trama es commuta en la capa 2 com a trama Ethernet estàndard. Això permet instal·lar dispositius intermedis de capa 2, com altres commutadors o ponts, juntament amb dispositius 802.1Q. Per a processar una trama etiquetada, el dispositiu ha d’admetre una MTU de 1.522 o superior.
</p>

</div>

<h3><a id="enllacos_troncals" >Enllaços troncals</a></h3>
<div class="level3">

<p>
Una VLAN té tres funcions principals:
</p>
<ul>
<li class="level1"><div class="li"> Limitar la grandària de dominis de multidifusió.</div>
</li>
<li class="level1"><div class="li"> Millorar el rendiment de la xarxa.</div>
</li>
<li class="level1"><div class="li"> Proporcionar un nivell de seguretat.</div>
</li>
</ul>

<p>
Per a aprofitar aquests beneficis, les VLAN s’estenen pels commutadors.
</p>

<p>
Els ports de commutació es poden configurar per a dues funcions diferents:
</p>
<ul>
<li class="level1"><div class="li"> Port d’accés.</div>
</li>
<li class="level1"><div class="li"> Port d’enllaç troncal.</div>
</li>
</ul>

<p>
Cada funció té les seves característiques:
</p>
<ul>
<li class="level1"><div class="li"> <strong>Port d’accés</strong>. Un port d’accés pertany a una única VLAN. Generalment, els dispositius individuals, com els PC o els servidors, es connecten a aquest tipus de port. Si un concentrador connecta diversos PC a un únic port d’accés, tots els dispositius connectats al concentrador són membres de la mateixa VLAN.</div>
</li>
<li class="level1"><div class="li"> <strong>Port d’enllaç troncal</strong>. Un port d’enllaç troncal és un enllaç punt a punt entre el concentrador i un altre dispositiu de xarxa. Aquests enllaços transmeten el trànsit de VLAN diferents mitjançant un únic enllaç, i permeten que les VLAN s’estenguin per tota la xarxa. Els ports d’enllaç troncal són necessaris per a transmetre el trànsit de diferents VLAN entre dispositius, ja que connecten dos commutadors entre si (un commutador a un encaminador o un amfitrió compatible amb enllaços troncals 802.1Q).</div>
</li>
</ul>
<div class="iocfigure"><a name="Figure41"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Esquema amb diferents ports VLAN

</figcaption><img src="../media/ic10m5u4_46.png" alt="" /></figure>
</div>
<p>
A la <span class="figref"><a href="#Figure41"><span>figura</span></a></span> podeu veure un esquema amb diferents ports VLAN.
</p>

<p>
Sense aquests ports, cada VLAN necessita una connexió separada entre commutadors (<span class="figref"><a href="#Figure42"><span>figura</span></a></span>). Per exemple, una empresa amb 100 VLAN necessita 100 enllaços de connexió. Aquest tipus de topologia no és fàcil d’escalar i resulta molt costosa. Els enllaços troncals ofereixen una solució a aquest problema ja que permeten transmetre trànsit de diferents VLAN mitjançant el mateix enllaç (<span class="figref"><a href="#Figure43"><span>figura</span></a></span>). 
</p>

<p>
Quan es transmeten diferents VLAN pel mateix enllaç, aquestes VLAN s’han d’identificar. Els ports d’enllaç troncal són compatibles amb l’etiquetatge de trama. L’etiquetatge de trama afegeix informació sobre les VLAN a la trama.
</p>
<div class="iocfigure"><a name="Figure42"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Esquema sense port troncal

</figcaption><img src="../media/ic10m5u4_47.png" alt="" /></figure>
</div><div class="iocfigure"><a name="Figure43"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Esquema amb port troncal

</figcaption><img src="../media/ic10m5u4_48.png" alt="" /></figure>
</div>
<p>
Els ports dels commutadors, de manera predeterminada, són ports d’accés. Per a configurar un port en mode port d’enllaç troncal, en el cas dels commutadors Cisco, s’han d’utilitzar les ordres següents:
</p>
<ul>
<li class="level1"><div class="li"> Switch(config)#<strong>interface fa0</strong><em>/port_number</em></div>
</li>
<li class="level1"><div class="li"> Switch(config-if)#<strong>switchport mode trunk </strong></div>
</li>
<li class="level1"><div class="li"> Switch(config-if)#s<strong>witchport trunk encapsulation</strong> <em>{dot1q | isl | negotiate}</em></div>
</li>
</ul>

<p>
Els commutadors que són compatibles amb 802.1Q i ISL necessiten l’últim fragment de configuració, <em>{dot1q | isl | negotiate}</em>. En molts d’aquests commutadors, <em>negotiate</em> és el mode predeterminat; detecta automàticament el tipus d’encapsulament del commutador veí.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
L’ISL és un protocol propietat de Cisco per a l’etiquetatge de trames en una xarxa IEEE 802.11Q.
</p>
</div></div>
<p>
Els models actuals, però, ja no suporten l’encapsulament ISL i, per aquest motiu, no admeten la darrera ordre de la llista. Cap dels models que apareixen al simulador admeten aquesta instrucció (<em>encapsulation {dot1q | isl | negotiate})</em>.
</p>

<p>
Exemple de les ordres anteriors:
</p>
<pre class="code">Switch(config)#interface fa0/24
Switch(config-if)#switchport mode trunk</pre>

<p>
Els commutadors més moderns tenen la capacitat de detectar el tipus d’enllaç configurat a l’altre extrem. Segons el servei connectat, l’enllaç es configura com a port d’enllaç troncal o com a port d’accés.
</p>

<p>
Això es configura així:
</p>

<p>
Switch(config-if)#<strong>switchport mode dynamic</strong> <em>{desirable | auto}</em>
</p>

<p>
Així, si connectem ports de dos commutadors, tots dos es converteix en enllaç <strong>troncal</strong> a tots els casos, excepte a les següents combinacions:
</p>
<ul>
<li class="level1"><div class="li"> Almenys un dels dos extrems és en mode <strong>access</strong>.</div>
</li>
<li class="level1"><div class="li"> Tots dos extrems són en mode <strong>dynamic auto</strong>.</div>
</li>
</ul>

<p>
A continuació teniu un exemple de configuració amb el mode <em>dynamic</em>:
</p>
<pre class="code">Switch(config)#interface fa0/1
Switch(config-if)#switchport mode dynamic desirable</pre>

<p>
Per tornar a establir un port d’enllaç troncal després que s’hagi establert com a port d’enllaç d’accés, es poden utilitzar les ordres següents:
</p>

<p>
Switch(config)#<strong>interface fa0/</strong><em>port_number</em>
</p>

<p>
Switch(config-if)#<strong>no switchport mode trunk</strong>
</p>

<p>
O també: 
</p>

<p>
Switch(config-if)#<strong>switchport mode access</strong>
</p>

</div>

<h4><a id="extensions_de_vlan_als_commutadors" >Extensions de VLAN als commutadors</a></h4>
<div class="level4">

<p>
Els enllaços troncals permeten enviar trànsit entre commutadors mitjançant un únic port.
</p>

<p>
Un enllaç troncal configurat amb 802.1Q en tots dos extrems permet transmetre trànsit amb un camp d’etiquetatge de 4 <em>bytes</em>, que s’afegeix a la trama. Aquesta etiqueta conté l’ID de la VLAN.
</p>

<p>
Quan un commutador rep una trama etiquetada per un port d’enllaç troncal, elimina l’etiqueta abans d’enviar-la a un port d’accés. El commutador només envia la trama si el port d’accés és de la mateixa VLAN que la trama etiquetada. 
</p>

<p>
Tanmateix, és necessari que hi hagi cert trànsit que es trameti per l’enllaç configurat segons 802.1Q, sense un ID de VLAN. El trànsit sense ID de VLAN s’anomena <em>sense etiquetar</em>. Entre els exemples de trànsit sense etiquetar hi ha el protocol de descobriment de Cisco (CDP), VTP i certs tipus de trànsit de veu. El trànsit sense etiquetar minimitza els retards associats amb la inspecció de l’etiqueta d’ID de la VLAN.
</p>

<p>
Per a processar el trànsit sense etiquetar, hi ha la <strong>VLAN nativa</strong> (<span class="figref"><a href="#Figure44"><span>figura</span></a></span>). Les trames sense etiquetar rebudes en el port d’enllaç troncal pertanyen a la VLAN nativa. Generalment, la VLAN 1 és la VLAN nativa predeterminada.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
<strong>CDP</strong> és un protocol de comunicació entre els encaminadors Cisco.
</p>

<p>
<strong>VTP</strong> és un protocol d’administració de VLANs en commutadors Cisco.
</p>
</div></div>
<p>
En un enllaç troncal amb 802.1Q, utilitzeu l’ordre següent per a assignar l’ID de la VLAN nativa a una interfície física: 
</p>

<p>
Switch(config-if)#<strong>dot1q native vlan</strong> <em>vlan-id</em>
</p>
<div class="iocfigure"><a name="Figure44"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Esquema amb VLAN nativa

</figcaption><img src="../media/ic10m5u4_49.png" alt="" /></figure>
</div>
<p>
Switch(config-if)#dot1q native vlan 3
</p>

</div>

<h4><a id="encaminament_entre_vlan" >Encaminament entre VLAN</a></h4>
<div class="level4">

<p>
Tot i que les VLAN s’estenen per a agrupar diversos commutadors, només es poden comunicar els membres de la mateixa VLAN.
</p>

<p>
Un dispositiu de capa 3 proporciona connectivitat entre diferents VLAN. Aquesta configuració permet que l’administrador de xarxa controli estrictament el tipus de trànsit que es transmet d’una VLAN a una altra (<span class="figref"><a href="#Figure45"><span>figura</span></a></span>).
</p>

<p>
Un mètode per a fer l’adreçament entre VLAN requereix una connexió separada del dispositiu de capa 3 de cada VLAN.
</p>
<div class="iocfigure"><a name="Figure45"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Exemple d’encaminament en VLAN

</figcaption><img src="../media/ic10m5u4_50.png" alt="" /></figure>
</div>
<p>
Un altre mètode per a proporcionar connectivitat entre diferents VLAN requereix una funció anomenada <em>subinterfície</em> (<span class="figref"><a href="#Figure46"><span>figura</span></a></span>). Les subinterfícies divideixen de manera lògica una interfície física en diferents rutes lògiques. És possible configurar una ruta o subinterfície per a cada VLAN.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
La VLAN 1 es pot comunicar amb la VLAN 200 si cadascuna té una connexió dedicada a l’encaminador.
</p>
</div></div><div class="iocfigure"><a name="Figure46"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Esquema amb subinterfícies

</figcaption><img src="../media/ic10m5u4_51.png" alt="" /></figure>
</div>
<p>
La compatibilitat amb la comunicació inter-VLAN mitjançant subinterfícies requereix configuració, tant en el commutador com en l’encaminador.
</p>
<ul>
<li class="level1"><div class="li"> <strong>Commutador</strong> </div>
<ul>
<li class="level2"><div class="li"> Configurar la interfície del commutador com un enllaç troncal 802.1Q.</div>
</li>
</ul>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> <strong>Encaminador</strong></div>
<ul>
<li class="level2"><div class="li"> Seleccionar una interfície amb un mínim de 100 Mbps FastEthernet.</div>
</li>
<li class="level2"><div class="li"> Configurar subinterfícies compatibles amb l’encapsulament 802.1Q.</div>
</li>
<li class="level2"><div class="li"> Configurar una subinterfície per a cada VLAN.</div>
</li>
</ul>
</li>
</ul>

<p>
Una subinterfície permet que cada VLAN tingui la seva pròpia ruta lògica i una passarel·la predeterminada a l’encaminador (<span class="figref"><a href="#Figure47"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figure47"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Esquema amb subinterfícies

</figcaption><img src="../media/ic10m5u4_52.png" alt="" /></figure>
</div>
<p>
L’amfitrió de la VLAN d’origen reenvia el trànsit a l’encaminador, mitjançant la passarel·la predeterminada. L’encaminador localitza l’adreça IP de destí i porta a terme una cerca en la taula d’encaminament.
</p>

<p>
Si la VLAN de destí és en el mateix commutador que la VLAN d’origen, l’encaminador torna a enviar el trànsit a l’origen mitjançant els paràmetres de la subinterfície de l’ID de la VLAN d’origen.
</p>

<p>
Si la interfície de sortida de l’encaminador és compatible amb 802.1Q, la trama conserva l’etiqueta de VLAN de 4 <em>bytes</em>. Si la interfície de sortida no és compatible amb 802.1Q, l’encaminador elimina l’etiqueta de la trama i retorna el format d’Ethernet original.
</p>

<p>
Per a configurar l’encaminament entre VLAN, feu els passos següents:
</p>

<p>
<strong>1.</strong> Configureu un port d’enllaç troncal al commutador.
</p>
<pre class="code">Switch(config)#interface fa0/2
Switch(config-if)#switchport mode trunk</pre>

<p>
<strong>2.</strong> A l’encaminador: configureu una interfície FastEthernet, sense adreça IP ni màscara de xarxa.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
Només cal posar <em>no ip address</em> si la interfície té assignada una adreça prèvia.
</p>
</div></div><pre class="code">Router(config)#interface fa0/1
Router(config-if)#no ip address
Router(config-if)#no shutdown</pre>

<p>
<strong>3.</strong> A l’encaminador, configureu una subinterfície amb una adreça IP i una màscara de xarxa per a cada VLAN. Cada subinterfície té un encapsulament 802.1Q.
</p>
<pre class="code">Router(config)#interface fa0/0.10
Router(config-subif)#encapsulation dot1q 10
Router(config-subif)#ip address 192.168.10.1 255.255.255.0</pre>

<p>
<strong>4.</strong> Utilitzeu les ordres següents per a verificar la configuració i el funcionament de l’encaminament entre VLAN:
</p>
<pre class="code">Switch#show trunk
Router#show ip interfaces
Router#show ip interfaces brief
Router#show ip route</pre>

</div>

<h3><a id="compatibilitat_amb_vlan_per_a_telefonia_ip_i_transit_sense_fil" >Compatibilitat amb VLAN per a telefonia IP i trànsit sense fil</a></h3>
<div class="level3">

<p>
El propòsit principal de les VLAN és separar el trànsit en grups lògics. El trànsit d’una VLAN no afecta el trànsit de l’altra. Un entorn de VLAN és idoni per al trànsit sensible als retards, com el trànsit de veu.
</p>

<p>
El trànsit de veu ha de tenir prioritat sobre el trànsit de dades normal, per a evitar conversacions mig tallades. Tenir una VLAN dedicada al trànsit de veu evita que aquest trànsit hagi de competir amb les altres dades per l’amplada de banda disponible.
</p>

<p>
Un telèfon per IP generalment té dos ports: un per a veu i un altre per a dades. Els paquets que s’envien entre l’equip i el telèfon per IP comparteixen el mateix enllaç físic i el mateix port, en el commutador. Per a segmentar el trànsit de veu, és necessari activar una VLAN separada, dedicada a aquest propòsit en el commutador (<span class="figref"><a href="#Figure48"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figure48"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Esquema amb telefonia IP i equips sense fil

</figcaption><img src="../media/ic10m5u4_53.png" alt="" /></figure>
</div>
<p>
El trànsit sense fil també es beneficia del treball de les VLAN. El trànsit sense fil és, per naturalesa, molt poc segur i susceptible d’atacs externs. Un problema en la integritat de la VLAN sense fil no té efecte en les altres VLAN de l’organització.
</p>

<p>
En la majoria dels dissenys sense fil situen l’usuari d’una VLAN fora del tallafoc, per a proporcionar més seguretat. Els usuaris s’han d’autentificar per a utilitzar els serveis de la xarxa interna des de la xarxa sense fil.
</p>

<p>
A més, hi ha moltes organitzacions que ofereixen accés a convidats a la seva xarxa sense fils. Els comptes per a convidats proporcionen a qualsevol persona, dins del rang limitat, serveis temporals com accés al web, correu electrònic, <acronym title="File Transfer Protocol">FTP</acronym> i SSH. Els comptes per a convidats estan inclosos en la VLAN sense fil o tenen una VLAN pròpia.
</p>

</div>

<h3><a id="consideracions_en_el_disseny_de_les_vlan" >Consideracions en el disseny de les VLAN</a></h3>
<div class="level3">

<p>
Quan es planeja i es dissenya amb cura, les VLAN proporcionen seguretat, conserven l’amplada de banda i localitzen el trànsit en la xarxa. Totes aquestes funcions es combinen per a millorar el rendiment de la xarxa.
</p>

<p>
Algunes de les consideracions importants per a configurar VLAN en una xarxa són les següents:
</p>
<ul>
<li class="level1"><div class="li"> Organitzar la ubicació del servidor</div>
<ul>
<li class="level2"><div class="li"> Assegureu-vos que tots els servidors necessaris per a cada grup són membres de la mateixa VLAN.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> Deshabilitar els ports que no s’utilitzen</div>
<ul>
<li class="level2"><div class="li"> Desactiveu els ports que no s’utilitzaran.</div>
</li>
<li class="level2"><div class="li"> Fiqueu els ports en un VLAN no s’utilitzi.</div>
</li>
<li class="level2"><div class="li"> Per a no tenir accessos no autoritzats, no doneu connectivitat ni fiqueu cap dispositiu en una VLAN no utilitzada.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> Configurar les VLAN d’administració en un nombre que no sigui 1.</div>
</li>
<li class="level1"><div class="li"> Utilitzar el protocol d’enllaç troncal de VLAN.</div>
</li>
<li class="level1"><div class="li"> Reiniciar qualsevol commutador que es connecti a la xarxa.</div>
</li>
</ul>

<p>
No obstant això, les VLAN no són la resposta a tots els problemes. Si no s’implementen correctament, poden complicar la xarxa i provocar-hi connectivitat inconsistent i un baix rendiment.
</p>

</div>

<h3><a id="vlan_en_gnu_linux" >VLAN en GNU/Linux</a></h3>
<div class="level3">

<p>
Fa temps que el nucli de Linux inclou suport per a 802.1Q. De fet, si utilitzeu el nucli precompilat de qualsevol distribució GNU/Linux, molt probablement, aquest suport ja hi està inclòs.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
Si no teniu instal·lat el paquet vlan, ho podeu fer des de la consola:
</p>

<p>
apt-get install vlan
</p>
</div></div>
<p>
L’eina d’administració de VLAN és <strong>vconfig</strong> i és al paquet <strong>vlan</strong> en el cas d’Ubuntu, Debian i derivats. Un cop instal·lat el paquet i, si és necessari, carregat el mòdul 8021Q, és possible utilitzar <strong>vconfig</strong> per a crear adaptadors de xarxa virtuals connectats a diferents VLAN.
</p>

<p>
Així, per exemple, podeu crear un adaptador de xarxa virtual per a <em>eth0</em> que estigui connectat a la VLAN2:
</p>
<pre class="code">[root@localhost network-scripts]# modprobe 8021q
[root@localhost network-scripts]# vconfig
Expecting argc to be 3-5, inclusive.  Was: 1

Usage: add             [interface-name] [vlan_id]
       rem             [vlan-name]
       set_flag        [interface-name] [flag-num]       [0 | 1]
       set_egress_map  [vlan-name]      [skb_priority]   [vlan_qos]
       set_ingress_map [vlan-name]      [skb_priority]   [vlan_qos]
       set_name_type   [name-type]

* The [interface-name] is the name of the ethernet card that hosts the VLAN you are talking 
  about.
* The vlan_id is the identifier (0-4095) of the VLAN you are operating on.
* skb_priority is the priority in the socket buffer (sk_buff).
* vlan_qos is the 3 bit priority in the VLAN header
* name-type:  VLAN_PLUS_VID (vlan0005), VLAN_PLUS_VID_NO_PAD (vlan5), 
              DEV_PLUS_VID (eth0.0005), DEV_PLUS_VID_NO_PAD (eth0.5)
* bind-type:  PER_DEVICE  # Allows vlan 5 on eth0 and eth1 to be unique.
              PER_KERNEL  # Forces vlan 5 to be unique across all devices.
* FLAGS:  1 REORDER_HDR  When this is set, the VLAN device will move the
            ethernet header around to make it look exactly like a real
            ethernet device.  This may help programs such as DHCPd which
            read the raw ethernet packet and make assumptions about the
            location of bytes.  If you don&#039;t need it, don&#039;t turn it on, because
            there will be at least a small performance degradation.  Default
            is OFF.
  
[root@localhost network-scripts]# vconfig add eth0 2
 Added VLAN with VID == to IF -:eth0:-
[root@localhost network-scripts]# ifconfig eth0.2 192.168.20.20 up
[root@localhost network-scripts]# ifconfig eth0.2
  
eth0.2    Link encap:Ethernet  HWaddr 00:C0:26:27:0B:D8
          inet addr:192.168.20.20  Bcast:192.168.20.255  Mask:255.255.255.0
          inet6 addr: fe80::2c0:26ff:fe27:bd8/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:9 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 b)  TX bytes:1494 (1.4 KiB)
  
[root@localhost network-scripts]#</pre>

<p>
La notació per defecte implica que l’adaptador de xarxa virtual té el nom de l’adaptador de xarxa físic, amb sufix <em>.id_vlan</em> (per exemple, <strong>eth0.2</strong> és l’adaptador virtual d’<em>eth0</em>, que és en la VLAN 2). A partir d’aquest punt, l’adaptador de xarxa virtual es pot utilitzar com qualsevol altre interfície de xarxa.
</p>
<div class="iocnote"><div class="ioccontent">
<p>
Podeu configurar l’adreça de xarxa amb l’ordre <strong>ifconfig</strong>.
</p>
</div></div>
<p>
Fins i tot és possible definir <em>alias</em> sobre la interfície virtual:
</p>
<pre class="code">[root@localhost network-scripts]# ifconfig eth0.2:0 192.168.20.21 up
[root@localhost network-scripts]# ifconfig
  
eth0      Link encap:Ethernet  HWaddr 00:C0:26:27:0B:D8
          inet addr:192.168.100.101  Bcast:192.168.100.255  Mask:255.255.255.0
          inet6 addr: fe80::2c0:26ff:fe27:bd8/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:4805 errors:0 dropped:0 overruns:0 frame:0
          TX packets:9140 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:3171548 (3.0 MiB)  TX bytes:1196180 (1.1 MiB)
          Interrupt:11 Base address:0xc000

eth0.2    Link encap:Ethernet  HWaddr 00:C0:26:27:0B:D8
          inet addr:192.168.20.20  Bcast:192.168.20.255  Mask:255.255.255.0
          inet6 addr: fe80::2c0:26ff:fe27:bd8/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:25 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 b)  TX bytes:3995 (3.9 KiB)
  
eth0.2:0  Link encap:Ethernet  HWaddr 00:C0:26:27:0B:D8
          inet addr:192.168.20.21  Bcast:192.168.20.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
.../..

[root@localhost network-scripts]# </pre>

</div>

<h4><a id="problemes_amb_l_mtu" >Problemes amb l&#039;MTU</a></h4>
<div class="level4">

<p>
Pràcticament, l’única qüestió que pot causar problemes en utilitzar VLAN és l’<strong>MTU</strong>. Com que els paquets etiquetats creixen en 4 <em>bytes</em>, és possible que amb alguns controladors (<em>drivers</em>) amb errors (<em>bugs</em>) la fragmentació del trànsit no funcioni de la manera esperada. Això pot crear connexions que no tinguin problemes amb paquets petits, però que no siguin capaces d’enviar paquets grans.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Unitat màxima de transferència (MTU)</p>
<p>
La unitat màxima de transferència és un terme que expressa la grandària, en <em>bytes</em>, de la unitat de dades més gran que es pot enviar utilitzant un protocol de Internet (IP). En el cas d’Ethernet, 1.518 <em>bytes</em>.
</p>
</div></div>
<p>
Per a detectar aquest problema és possible utilitzar l’ordre <strong>ping</strong> amb l’opció <strong>-s</strong>, que permet definir la grandària del paquet que s’ha de transmetre. S’ha de comprovar la comunicació en tots dos sentits, i si s’observa que, per exemple, no hi ha cap problema amb paquets petits però que amb paquets de 1.700 <em>bytes</em> o més sí que n’hi ha, s’ha de reduir l’MTU de la interfície. 
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Una grandària raonable d’MTU són 1.400 <em>bytes</em>.
</p>
</div></div>
</div>

<h4><a id="configurar_les_vlan_en_cada_arrancada_del_sistema" >Configurar les VLAN en cada arrancada del sistema</a></h4>
<div class="level4">

<p>
Es vol que en un servidor les VLAN es configurin automàticament cada cop que es reinicien les interfícies de xarxa. Per això, és necessari fer ús dels <em>scripts</em> d’arrancada que utilitza la seva distribució. Per exemple, en el cas de Debian, en el directori <em>/etc/sysconfig/network-scripts</em> s’inclouen els <em>scripts</em> que controlen els diferents adaptadors de xarxa, tant si són físics com virtuals.
</p>

<p>
Llista de <strong>/etc/sysconfig/network-scripts</strong> al servidor Valinor:
</p>
<pre class="code"> ,           ,
 /             \     Welcome to Valinor
((__-^^-,-^^-__))
 `-_---&#039; `---_-&#039;     Free software for a free society
  `--|o` &#039;o|--&#039;      do you want to be free ?
     \  `  /
      ): :(          valinor.iespuigcastellar.xeill.net
      :o_o:
       &quot;-&quot;
[usuari@valinor ~]$ cd /etc/sysconfig/network-scripts/
[usuari@valinor network-scripts]$ ls 
hostname.d/    ifcfg-lo@       ifdown.d/       ifdown-sit*    
ifup.d/        ifup-plusb*     ifup-sit*       network-functions
ifcfg-eth0*    ifcfg-sit0*     ifdown-ipv6*    ifdown-sl*     
ifup-ipv6*     ifup-post*      ifup-sl*   network-functions-ipv6
ifcfg-eth0.1*  ifdown@         ifdown-post*    ifup@          
ifup-ipx*      ifup-ppp*       ifup-wireless*  wireless.d/
ifcfg-eth0.14* ifdown-aliases* ifdown-ppp*     ifup-aliases*  
ifup-plip*     ifup-routes*    init.ipv6-global*
 
[usuari@valinor network-scripts]$</pre>

<p>
A la <span class="tabref"><a href="#Table1"><span>taula</span></a></span> podeu veure el contingut dels fitxers que configuren <strong>eth0.1</strong> i <strong>eth0.14</strong>:
</p>
<div class="ioctable ">
<div class="titletable"><a name="Table1"><span>Taula: </span></a>Fitxers de configuració d’eth0.1 i eth0.14</div>
<div class="table"><table class="inline">
	<tr class="row0">
		<th class="col0"> ifcfg-eth0.1 </th><th class="col1"> ifcfg-eth0.14 </th>
	</tr>
	<tr class="row1">
		<td class="col0"> DEVICE=eth0.1 <br/>
BOOTPROTO=static <br/>
IPADDR=192.168.0.6 <br/>
NETMASK=255.255.255.0 <br/>
NETWORK=192.168.0.0 <br/>
BROADCAST=192.168.0.255 <br/>
ONBOOT=yes <br/>
METRIC=10 <br/>
MII_NOT_SUPPORTED=no <br/>
USERCTL=no <br/>
IPV6INIT=no <br/>
IPV6TO4INIT=no <br/>
PEERDNS=yes </td><td class="col1"> DEVICE=eth0.14 <br/>
BOOTPROTO=static <br/>
IPADDR=192.168.14.6 <br/>
NETMASK=255.255.255.0 <br/>
NETWORK=192.168.14.0 <br/>
BROADCAST=192.168.14.255 <br/>
ONBOOT=yes <br/>
MII_NOT_SUPPORTED=yes <br/>
PEERDNS=y </td>
	</tr>
</table></div>
</div>
</div>

	 </article>
     <div class="pnpage">
      <div class="left-corner"></div>
      <div id="prevpage">Anar a la p&agrave;gina anterior:<br /><a href="../../../WebContent/u4/resum.html">Resum</a></div>
      <div id="nextpage">Anar a la p&agrave;gina seg&uuml;ent:<br /><a href="../../../WebContent/u4/a1/activitats.html">Activitats</a></div>
      <div class="right-corner"></div>
     </div>
    </div>
    <footer class="footer">
      <div><small>Aquest document està subjecte a una llicència oberta de Creative Commons, es reserva el dret de reconeixement de l'autoria, d'exigir que no se'n faci cap mena d'ús comercial. Si altereu o transformeu aquesta obra, o en genereu obres derivades, només podeu distribuir l'obra generada amb una llicència idèntica a aquesta.</small></div>
    </footer>
 </div>
 <div id="back_preview" class="hidden"></div>
 <div id="preview" class="hidden">
  <div class="prevcontent"></div>
 </div>
 <div id="help-tooltips">
  <div id="help-toc" class="hidden tooltip"><span>Taula de continguts:</span> Ofereix una vista general de l&#39;estructura del m&ograve;dul, que us facilitar&agrave; la navegaci&oacute; a trav&eacute;s dels seus continguts.<span class="arrow-left"></span></div> 
  <div id="help-settings" class="hidden tooltip"><span>Opcions de format:</span> Permet configurar el format de lectura a partir de les vostres prefer&egrave;ncies, modificant la mida de la lletra, el color del fons, l&#39;amplada de la p&agrave;gina o l&#39;ocultaci&oacute; dels continguts complementaris, entre d&#39;altres.<span class="arrow-left"></span></div>
  <div id="help-printer" class="hidden tooltip"><span>Imprimir:</span>  Envia el contingut seleccionat a la impressora.<span class="arrow-left"></span></div>
  <div id="help-favorites" class="hidden tooltip"><span>Prefereits:</span> Permet desar aquelles parts del contingut a les que us interessi accedir en un moment posterior; us permetr&agrave; anar creant un repositori personalitzat de les seccions que considereu m&eacute;s rellevants. Un cop l&#39;hageu començat a fer servir se us mostrar&agrave; a sota un comptador que us informar&agrave; del nombre de preferits que s&#39;hagin emmagatzemat fins al moment.<span class="arrow-left"></span></div>
  <div id="help-favcounter" class="hidden tooltip"><span>Comptador i llistat de preferits:</span> Indica el nombre de preferits que s&#39;han desat fins el moment; clicant damunt seu accedireu al llistat de preferits, i a trav&eacute;s d&#39;aquest podreu accedir directament als continguts que hageu emmagatzemat.<span class="arrow-left"></span></div>
  <div id="help-help_icon" class="hidden tooltip"><span>Ajuda:</span> Aquesta opci&oacute; activa la informaci&oacute; de les funcionalitats del web tot situant el punter del ratol&iacute; al damunt dels diferents &iacute;tems.<span class="arrow-left"></span></div>
  <div id="help-sidebar-hide" class="hidden tooltip"><span>Mostrar/Ocultar barra lateral:</span>  Deshabilita la barra d&#39;opcions, permetent la seva recuperaci&oacute; quan es desitgi.<span class="arrow-left"></span></div>
  <div id="help-search" class="hidden tooltip"><span>Cerca:</span>  Introdu&iuml;u les paraules clau sobre aquells conceptes que desitgeu localitzar en els continguts del m&ograve;dul. Tamb&eacute; podeu excloure un terme de la cerca tot afegint-hi el signe &#8220;-&#8221; al davant.<span class="arrow-top"></span></div>
  <div id="help-header" class="hidden tooltip"><span>Cap&ccedil;alera:</span>  Indica l&#39;apartat o secci&oacute; que es mostra en pantalla. Tingueu present que les capçaleres de segon, tercer i quart nivell tamb&eacute; es poden desar com a marcadors.<span class="arrow-left"></span></div>
</div> 
</body>
</html>
