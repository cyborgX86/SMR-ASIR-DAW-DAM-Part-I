<!doctype html>

<!--[if lt IE 7 ]> <html class="ie ie6 no-js" lang="ca"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie ie7 no-js" lang="ca"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie ie8 no-js" lang="ca"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie ie9 no-js" lang="ca"> <![endif]-->
<!--[if gt IE 9]><!--><html class="no-js" lang="ca"><!--<![endif]-->
<!-- the "no-js" class is for Modernizr. -->

<head id="www-sitename-com" data-template-set="html5-reset">

	<meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html">
        
	<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title>Serveis de xarxa</title>
	
<!-- <meta name="title" content=""> --> 
	<meta name="description" content="">
	<!-- Google will often use this as its description of your page/site. Make it good. -->
	
	<meta name="google-site-verification" content="">
	<!-- Speaking of Google, don't forget to set your site up: http://google.com/webmasters -->
	
	<meta name="author" content="Institut Obert de Catalunya">
	<meta name="Copyright" content="Copyright Institut Obert de Catalunya 2011. All Rights Reserved.">

	<!-- Dublin Core Metadata : http://dublincore.org/ -->
	<meta name="DC.title" content="Serveis de xarxa">
	<meta name="DC.subject" content="Informàtica i comunicacions">
	<meta name="DC.creator" content="Institut Obert de Catalunya">
	
	<!--  Mobile Viewport Fix
	j.mp/mobileviewport & davidbcalhoun.com/2010/viewport-metatag 
	device-width : Occupy full width of the screen in its current orientation
	initial-scale = 1.0 retains dimensions instead of zooming out if page height > device height
	maximum-scale = 1.0 retains dimensions instead of zooming in if page width < device width
	-->
	<!-- Uncomment to use � use thoughtfully!
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
	-->

	<link rel="shortcut icon" href="../../../img/favicon.ico">
	<!-- This is the traditional favicon.
		 - size: 16x16 or 32x32
		 - transparency is OK
		 - see wikipedia for info on browser support: http://mky.be/favicon/ -->
		 
	<link rel="apple-touch-icon" href="../../../img/apple-touch-icon.png">
	<!-- The is the icon for iOS's Web Clip.
		 - size: 57x57 for older iPhones, 72x72 for iPads, 114x114 for iPhone4's retina display (IMHO, just go ahead and use the biggest one)
		 - To prevent iOS from applying its styles to the icon name it thusly: apple-touch-icon-precomposed.png
		 - Transparency is not recommended (iOS will put a black BG behind the icon) -->
	
	<!-- CSS: screen, mobile & print are all in the same file -->
	<link rel="stylesheet" href="../../../_/css/style.css">

	<!-- CSS: jQuery UI -->
	<link rel="stylesheet" href="../../../_/css/jquery-ui.css">
	
	<!-- all our JS is at the bottom of the page, except for Modernizr. -->
	<script src="../../../_/js/modernizr-1.7.min.js"></script>
	<script src="../../../_/js/Hyphenator.js" type="text/javascript"></script>
	<script type="text/javascript">
	   Hyphenator.config({
		minwordlength : 4
	   });
	   Hyphenator.run();
	</script>
    <script src="../../../_/js/build.js" type="text/javascript"></script>
</head>

<body class="style-newspaper">

<div class="wrapper"><!-- not needed? up to you: http://camendesign.com/code/developpeurs_sans_frontieres -->

	<header id="header">
		<div class="head"><a href="http://ioc.gencat.cat"><img src="../../../img/logo.png" alt="Institut Obert de Catalunya"/></a><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/es/deed.ca"><img src="../../../img/license.png" alt="Llic&egrave;ncia" class="license"/></a></div>
		<div class="headdocument"><a href="../../../index.html">Serveis de xarxa</a></div>
        <div id="search" class="search" name="search">
         <form id="frmsearch" action="../../../search.html" method="get">
          <input type="text" name="q"/>
        </form>
        </div>
	</header>
   <div id="upbutton" class="upbutton" style="display:none;"><img src="../../../img/uparrow.png" alt="Pujar a l'inici de p&agrave;gina"/></div>
   <aside id="aside">
    <div id="menu">
      <ul>
       <li name="toc"><div><img src="../../../img/toc.png" alt="&Iacute;ndex"/></div></li>
       <li name="settings"><div><img src="../../../img/settings.png" alt="Configuraci&oacute;"/></div></li>
       <li name="printer"><div><img src="../../../img/printer.png" alt="Imprimir"/></div></li>
       <li name="favorites"><div><img src="../../../img/favorites.png" alt="Favorits"/></div></li>
       <li name="help_icon" class="help_icon"><div><img src="../../../img/help_icon.png" alt="Ajuda"/></div></li>
      </ul>
     </div>
   </aside>
   <div id="sidebar-hide" name="sidebar-hide"><img src="../../../img/arrows.png"/></div>
   <section>
     <div id="toc" class="hidden">
      <div class="menucontent">
        <ul>
        <li id="u4" class="parentnode"><p><a class="unit" href="../../../WebContent/u4/introduccio.html">4. Accés a sistemes remots</a></p><ul class="expander"><li id="u4introduccio"><a href="../../../WebContent/u4/introduccio.html">Introducció</a></li><li id="u4mapa"><a href="../../../WebContent/u4/mapa.html">Mapa conceptual</a></li><li id="u4referencies"><a href="../../../WebContent/u4/referencies.html">Més informació</a></li><li id="u4resultats"><a href="../../../WebContent/u4/resultats.html">Resultats d'aprenentatge</a></li><li id="u4resum"><a href="../../../WebContent/u4/resum.html">Resum</a></li><li id="u4a1" class="tocsection"><p id='u4a1continguts'><a class="section" href="../../../WebContent/u4/a1/continguts.html">Introducció a l'accés remot a equips</a><span class="buttonexp"></span></p><ul><li id="u4a1activitats"><a href="../../../WebContent/u4/a1/activitats.html">Activitats</a></li><li id="u4a1exercicis"><a href="../../../WebContent/u4/a1/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><div data-parent-id='u4a1' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u4/a1/continguts.html#usos_mes_frequeents_de_l_acces_remot_a_ordinadors">Usos més freqüents de l'accés remot a ordinadors</a></li><li><a href="../../../WebContent/u4/a1/continguts.html#diferents_tipus_d_acces_remot">Diferents tipus d'accés remot</a></li></ul></div></div><li id="u4a2" class="tocsection"><p id='u4a2continguts'><a class="section" href="../../../WebContent/u4/a2/continguts.html">Administració remota basada en la línea d'ordres</a><span class="buttonexp"></span></p><ul><li id="u4a2activitats"><a href="../../../WebContent/u4/a2/activitats.html">Activitats</a></li><li id="u4a2annexos"><a href="../../../WebContent/u4/a2/annexos.html">Annexos</a></li><li id="u4a2exercicis"><a href="../../../WebContent/u4/a2/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><div data-parent-id='u4a2' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u4/a2/continguts.html#telnet">Telnet</a></li><li><a href="../../../WebContent/u4/a2/continguts.html#introduccio_a_ssh">Introducció a SSH</a></li></ul></div></div><li id="u4a3" class="tocsection"><p id='u4a3continguts'><a class="section" href="../../../WebContent/u4/a3/continguts.html">Administració remota amb interfície gràfica</a><span class="buttonexp"></span></p><ul><li id="u4a3activitats"><a href="../../../WebContent/u4/a3/activitats.html">Activitats</a></li><li id="u4a3annexos"><a href="../../../WebContent/u4/a3/annexos.html">Annexos</a></li><li id="u4a3exercicis"><a href="../../../WebContent/u4/a3/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><div data-parent-id='u4a3' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u4/a3/continguts.html#la_transparencia_de_xarxa_del_sistema_x_window">La transparència de xarxa del sistema X Window</a></li><li><a href="../../../WebContent/u4/a3/continguts.html#vnc_virtual_network_computing">VNC Virtual Network Computing</a></li></ul></div></div><li id="u4a4" class="tocsection"><p id='u4a4continguts'><a class="section" href="../../../WebContent/u4/a4/continguts.html">Gestió remota mitjançant una aplicació local</a><span class="buttonexp"></span></p><ul><li id="u4a4activitats"><a href="../../../WebContent/u4/a4/activitats.html">Activitats</a></li><li id="u4a4exercicis"><a href="../../../WebContent/u4/a4/exercicis.html">Exercicis d'autoavaluació</a></li></ul></li><div data-parent-id='u4a4' class='tocssection hidden'><div class="toc"><ul><li><a href="../../../WebContent/u4/a4/continguts.html#introduccio_a_webmin">Introducció a Webmin</a></li></ul></div></div></ul></li><li id="" class="indexnode"><p><a href="../../../index.html">Anar a l&#39;&iacute;ndex general</a></p></li>
        </ul>
      </div>
    </div>
   </section>
   <section>
   <div id="settings" class="hidden">
    <div class="menucontent">
     <div class="allsettings">
     <div class="settings">
      <label>Font i Color</label>
		<div class="setting-option">
	        <ul class="fontBackground">
				<li id="style-newspaper" title="Newspaper" class="appearance-style-newspaper"><span>Newspaper</span></li>
                <li id="style-novel" title="Novel" class="appearance-style-novel"><span>Novel</span></li>
                <li id="style-ebook" title="eBook" class="appearance-style-ebook"><span>eBook</span></li>
				<li id="style-inverse" title="Inverse" class="appearance-style-inverse active"><span>Inverse</span></li>
				<li id="style-athelas" title="Athelas" class="appearance-style-athelas"><span>Athelas</span></li>
			</ul>
		</div>
     </div>
	<div class="settings">
      <label>Amplada</label>
		<div class="setting-option">
	        <div id="slider-width"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
		<div class="setting-option">
	        <div id="slider-font"></div>
		</div>
     </div>
     <div class="settings">
      <label>Mida de la font</label>
	  <div class="setting-option">
       <form action="" class="sett-options">
		<ul>
		    <li><input type="checkbox" id="secondary-content" /><label for="secondary-content">Mostra recursos complementaris</label></li>
		    <li><input type="checkbox" id="main-images" /><label for="main-images">Mostra imatges</label></li>
		    <li><input type="checkbox" id="text-alignment" /><label for="text-alignment">Text justificat</label></li>
			<li><input type="checkbox" id="text-hyphen" /><label for="text-hyphen">Partici&oacute; sil·l&agrave;bica</label></li>
		</ul>
       </form>
	  </div>
     </div>
     </div>
    </div>
   </div>
   </section>
 <section>
 <div id="favorites" class="hidden"></div>
 </section>   
 <div id="bridge" class="hidden"></div>
 <div id="help" class="hidden">
  <div class="helptitle">Dreceres del teclat<hr></div>
  <div class="helpsection"><span>General</span>
   <ul>
    <li><span class="shortcut">g</span>: Anar al men&uacute; de navegaci&oacute;</li>
    <li><span class="shortcut">o</span>: Anar a opcions</li>
    <li><span class="shortcut">s</span>: Guardar la p&agrave;gina actual a favorits</li>
    <li><span class="shortcut">p</span>: Imprimir la p&agrave;gina actual</li>
    <li><span class="shortcut">?</span>: Mostrar/Ocultar l&#39;ajuda</li>
   </ul>
  </div>
  <div class="helpsection"><span>Navegaci&oacute;</span>
   <ul>
    <li><span class="shortcut">i</span>: Anar a l&#39;&iacute;ndex general</li>
    <li><span class="shortcut">t</span>: Anar a l&#39;inici de p&agrave;gina</li>
    <li><span class="shortcut">b</span>: Anar al final de p&agrave;gina</li>
    <li><span class="shortcut">j</span>: Anar cap endavant dintre la p&agrave;gina</li>
    <li><span class="shortcut">k</span>: Anar cap enrere dintre la p&agrave;gina</li>
    <li><span class="shortcut">h</span>: Anar a la p&agrave;gina anterior:</li>
    <li><span class="shortcut">l</span>: Anar a la p&agrave;gina seg&uuml;ent:</li>
   </ul>
   </div>
 </div>
 <div id="favcounter" name="favcounter" class="hidden"><span></span></div>
 <div id="navmenu" class="navmenu"><ul class="webnav"><li><a href="../../../index.html" title="Anar a l&#39;&iacute;ndex general">Inici</a></li><li><a href="../introduccio.html">Servidors web i intermediaris</a></li><li>Interconnexió de xarxes privades amb xarxes públiques</li></ul></div>
	<div id="content" lang="ca" class="hyphenate text">
     <article lang="ca" class="sheet">
        <h1><a id="interconnexio_de_xarxes_privades_amb_xarxes_publiques"> Interconnexió de xarxes privades amb xarxes públiques </a></h1>
    	
<p>
El riu Chicago és un curs d’aigua de 251 km de llarg que flueix per Chicago (Illinois) i travessa el centre de la popular ciutat nord-americana. Històricament, tot i que el primer pont sobre el riu Chicago es va construir l’any 1832, el primer pont mòbil fou construït l’any 1834. Actualment, el riu Chicago és creuat per 38 ponts mòbils d’un total de 52 ponts que creuen el riu i uneixen el centre de Chicago amb la resta de la ciutat pel nord i per l’oest. Tal com mostra la <span class="figref"><a href="#Figura14"><span>figura</span></a></span>, aquests ponts mòbils són, majoritàriament, de bàscula (<em>bascule bridges</em>) tot i que també podem trobar-ne d’elevació vertical (<em>vertical lift bridges</em>).
</p>
<div class="iocfigure"><a name="Figura14"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Pont de la ciutat de Chicago

</figcaption><img src="../media/smx_m07u3-40_1.png" alt="" /></figure>
</div>
<p>
Quasi cada carrer de Chicago té un pont llevadís. Aquests ponts, construïts en diferents èpoques i amb formes i dissenys variats, compleixen una mateixa funció: unir el centre de la ciutat de Chicago amb la resta de la ciutat i facilitar la comunicació entre tots dos punts i, alhora, la navegació pel riu.
</p>

<p>
Si bé actualment els ponts llevadissos tenen una funció bàsica d’agilitzar o permetre les comunicacions entre diferents punts distanciats geogràficament, el seu origen històric rau en la seguretat perimetral dels castells. De fet, es van començar a utilitzar durant l’edat mitjana quan els senyors feudals posseïen castells amb grans torres des d’on vigilaven possibles atacs a les seves fortaleses.
</p>

<p>
Aquestes mesures de seguretat perimetral es veien reforçades amb la inclusió de fossats profunds que aïllaven les fortificacions i un pont llevadís com a única via d’accés. Si considerem quin impacte tindrien les mesures de seguretat perimetral aplicades segles enrere en els nostres dies podríem afirmar, per exemple, que el tallafocs actua com el fossat i els ponts llevadissos.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
Un tallafocs (<em>firewall</em>) és un element de maquinari o programari utilitzat en una xarxa informàtica per controlar les comunicacions, permetent-les o prohibint-les en funció de les polítiques de seguretat definides de la xarxa.
</p>
</div></div>
<p>
La ubicació habitual d’un tallafocs és el punt de connexió de la xarxa interna de l’organització amb la xarxa exterior que, normalment, és Internet. Val a dir que, tal com mostra la <span class="figref"><a href="#Figura15"><span>figura</span></a></span>, és freqüent connectar al tallafocs una tercera xarxa, anomenada <em>zona desmilitaritzada</em> (DMZ, <em>demilitarized zone</em>), en la qual s’ubiquen els servidors de l’organització que han de romandre accessibles des de la xarxa exterior.
</p>
<div class="iocfigure"><a name="Figura15"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Xarxa amb un tallafocs i una xarxa desmilitaritzada (DMZ)

</figcaption><img src="../media/smx_m07u3-41_1.png" alt="" /></figure>
</div>
<p>
Actualment, tots disposem de múltiples equips connectats a una xarxa domèstica (ordinadors de sobretaula, portàtils, agendes electròniques, consoles o discs durs externs) i, en conseqüència, un volum alt d’informació continguda en els nostres equips electrònics comporta una necessitat més gran de seguretat entre la nostra xarxa interna i Internet.
</p>

<p>

</p>

<p>
Ara bé, tenint en compte que una muralla amb un fossat no protegia les fortificacions envers tot tipus d’amenaça, un tallafocs tampoc ens protegirà de tot tipus d’atac informàtic. És més, les millores en la seguretat perimetral han posat ben alt el llistó de les habilitats i coneixements requerits en un ciberdelinqüent.
</p>

<p>
<div class="iocfigurec">
<ul>
<li>
<img src="../media/smx_m07u3-42_1.png" class="imgB" title="El servidor intermediari rastreja cadascun dels paquets de dades per avaluar-ne el contingut i esbrinar si contenen dades malicioses o no permeses en les polítiques de seguretat establertes./3" alt="El servidor intermediari rastreja cadascun dels paquets de dades per avaluar-ne el contingut i esbrinar si contenen dades malicioses o no permeses en les polítiques de seguretat establertes./3" /></li><li><small>El servidor intermediari rastreja cadascun dels paquets de dades per avaluar-ne el contingut i esbrinar si contenen dades malicioses o no permeses en les polítiques de seguretat establertes.</small></li>
</ul></div>

</p>

<p>
Per tant, ja que tard o d’hora poden arribar a accedir al nostre sistema protegit, haurem de tenir la capacitat d’analitzar els paquets de dades entrants i sortints. És en aquest punt on el servidor intermediari el seu paper essencial, ja que és l’encarregat d’avaluar les adreces d’Internet (IP) i rastrejar les dades contingudes en el paquet de dades.
</p>

<h2><a id="passarel_les_a_nivell_d_aplicacio_emmagatzematge_en_memoria_cau" >Passarel·les a nivell d’aplicació. Emmagatzematge en memòria cau</a></h2>
<div class="level2">

<p>
La seguretat és una de les àrees a tractar quan una organització es planteja connectar la seva xarxa privada a Internet.
</p>

<p>
En conseqüència, els administradors de les xarxes han d’incrementar les mesures de seguretat informàtica ja que exposen les organitzacions a les quals representen, les dades contingudes i la infraestructura de la xarxa a tot tipus de delinqüents informàtics. Per això les organitzacions han de posar en marxa polítiques de seguretat per evitar possibles atacs i/o robatoris d’informació o de dades confidencials. Per tant, han d’establir mesures de seguretat perimetral, per exemple mitjançant la utilització de tallafocs.
</p>

<p>
De fet, els tallafocs ofereixen la possibilitat de monitoritzar la seguretat i, en cas d’activitats sospitoses, generar una alarma davant de la possibilitat d’atacs o problemes en el trànsit de dades. Ara bé, els tallafocs no poden protegir la xarxa organitzativa de tots aquells problemes que sorgeixin fora del seu punt d’actuació com ara virus informàtics o troians que hagin accedit a la xarxa.
</p>

<p>
Arribats a aquest punt, les passarel·les a nivell d’aplicació prenen protagonisme, ja que no substitueixen els tallafocs sinó que en reforcen l’ actuació per augmentar els nivells de seguretat perimetral existents. Per aquest motiu, tal i com mostra la <span class="figref"><a href="#Figura16"><span>figura</span></a></span>, les passarel·les a nivell d’aplicació poden ser considerades tallafocs basats en servidors intermediaris.
</p>
<div class="ioctextl"><div class="ioccontent"><p class="ioctitle">Servidor intermediari</p>
<p>
Un servidor intermediari és un programa o dispositiu que duu a terme tasques d’accés a Internet en el lloc d’un altre ordinador. Un servidor intermediari és un punt intermedi entre un ordinador connectat a Internet i el servidor al qual està accedint.
</p>

<p>
En la navegació mitjançant un servidor intermediari no es facilita l’accés directe al servidor, sinó que es fa una sol·licitud al servidor intermediari i aquest és el que es connecta amb el servidor i torna el resultat de la sol·licitud. De fet, la traducció de la paraula anglesa proxy és per poders, és a dir, es
permet que sigui un servidor intermediari el que ens connecta a Internet en lloc del mateix usuari.
</p>
</div></div>
<p>
Són molts els que consideren que una passarel·la a nivell d’aplicació és un servidor de seguretat (<em>bastion host</em>), ja que es tracta d’un sistema dissenyat específicament, blindat i protegit contra qualsevol tipus d’atac.
</p>
<div class="iocfigure"><a name="Figura16"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Treball conjunt d’un servidor intermediari i un tallafocs

</figcaption><img src="../media/smx_m07u3-43_1.png" alt="" /></figure>
</div>
<p>
El funcionament d’una passarel·la a nivell d’aplicació és el propi d’un element intermediari, ja que rep les peticions dels usuaris de la xarxa organitzativa per sortir a Internet o connectar amb un servidor determinat a nivell d’aplicació.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Bastion Host</p>
<p>
Sistema especialment assegurat però que, en principi, és vulnerable a tot tipus d’atacs per estar obert a Internet. La seva funció és ser el punt de contacte
dels usuaris de la xarxa interna  d’una organització amb altres tipus de xarxes.
</p>
</div></div>
<p>
La passarel·la a nivell d’aplicació és l’encarregada de sol·licitar el nom de la màquina amb què es vol establir la comunicació. Un cop disposi de la informació, l’usuari haurà de proporcionar un nom d’usuari i una autenticació. Si tot és correcte, la passarel·la es posarà en contacte amb la màquina remota i començarà a transmetre les dades entre totes dues. Ara bé, en el cas que no es disposi d’un servidor intermediari per a una determinada aplicació, els paquets que s’hi adrecin serien rebutjats.
</p>

<p>
Una passarel·la a nivell d’aplicació o servidor intermediari no encamina paquets a nivell de xarxa sinó que, tal com mostra la <span class="figref"><a href="#Figura17"><span>figura</span></a></span>, des del punt de vista del model de referència d’interconnexió de sistemes oberts (OSI, <em>open system interconnection</em>), actua com a retransmissor a nivell d’aplicació. Els usuaris de la xarxa es posaran en contacte amb el servidor intermediari que, al seu torn, estarà oferint un servei intermediari associat a almenys una aplicació determinada.
</p>

<p>
El servidor intermediari facilitarà les connexions sol·licitades amb l’exterior i quan rebi una resposta s’encarregarà de retransmetre-la cap a l’equip que havia iniciat la connexió. En conseqüència, el servidor intermediari permetrà decidir si s’accepta o es rebutja una petició de connexió.
</p>
<div class="iocfigure"><a name="Figura17"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Passarel·la a nivell d’aplicació

</figcaption><img src="../media/smx_m07u3-44_1.png" alt="" /></figure>
</div><div class="iocimportant"><div class="ioccontent">
<p>
Una passarel·la separa completament l’interior de la xarxa de l’exterior i ofereix només un conjunt de serveis a nivell d’aplicació. Això permetrà l’autenticació dels usuaris que fan peticions de connexió i l’anàlisi de connexions a nivell d’aplicació.
</p>
</div></div>
<p>
Les característiques fonamentals de les passarel·les comporta que, sense cap mena de dubte, ofereixin més seguretat pel que fa als filtres de paquets i un ventall de possibilitats molt elevat. Per contra, la penalització introduïda per aquests dispositius és molt elevada. En el cas d’una gran càrrega de tràfic per la xarxa, el rendiment es pot arribar a reduir dràsticament.
</p>

<p>
En la pràctica, les passarel·les i els dispositius de xarxa amb filtratge de paquets són complementaris. Així, aquests dos sistemes es poden combinar i proporcionar molta més seguretat i flexibilitat.
</p>

<p>
Tal com mostra la <span class="figref"><a href="#Figura18"><span>figura</span></a></span>, quan la passarel·la autentifica al client, obre una connexió al servidor intermediari i aquest esdevé el responsable de transmetre les dades que el client rebi del servidor intermediari.
</p>

<p>
Aquest funcionament particular provoca que les passarel·les a nivell d’aplicació presentin un rendiment inferior que els filtres de paquets. Amb la finalitat d’evitar-ho, els servidors intermediaris fan una còpia de les dades transmeses d’un sistema per lliurar-los a un altre. Aquest funcionament particular permet que aquests es puguin emmagatzemar per lliurar-los quan un altre sistema els sol·liciti –és aquí on intervé l’emmagatzematge en memòria cau (<em>cache memory</em>).
</p>
<div class="iocfigure"><a name="Figura18"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Sensació del client en una passarel·la a nivell d’aplicació

</figcaption><img src="../media/smx_m07u3-45_1.png" alt="" /></figure>
</div>
<p>
La utilització de les passarel·les proporciona diferents beneficis:
</p>
<ol>
<li class="level1"><div class="li"> Les passarel·les permeten únicament aquells serveis per als quals hi ha un servidor intermediari habilitat. Per tant, si una passarel·la conté serveis intermediaris tan sols per als serveis HTTP i <acronym title="Domain Name System">DNS</acronym>, dins de la xarxa interna només es permetran aquests serveis. La resta de serveis seran completament rebutjats.</div>
</li>
<li class="level1"><div class="li"> El protocol també pot ser filtrat, i així es prohibeix la utilització de subserveis diferents dins d’un mateix servei permès. Per exemple, mitjançant una passarel·la que filtrés connexions de protocol de transferència d’arxiu (<acronym title="File Transfer Protocol">FTP</acronym>, file transfer protocol), seria possible prohibir únicament l’ús de l’ordre put del protocol de transferència d’arxiu (<acronym title="File Transfer Protocol">FTP</acronym>) i deixar habilitada la resta d’ordres.</div>
</li>
<li class="level1"><div class="li"> Addicionalment, els servidors intermediaris també poden implantar el filtre de connexions per adreça d’Internet (IP) de la mateixa manera que els filtres de paquets, ja que l’adreça IP es troba disponible en l’àmbit d’aplicació en el qual s’aplicarà el filtratge.</div>
</li>
</ol>

<p>
Finalment, un avantatge que no té res a veure amb la seguretat és que permet emmagatzemar a la memòria cau les dades sol·licitades a què s’ha accedit fa poc. Això comporta menys temps d’espera en les sol·licituds d’accés a les pàgines web més demandades pels usuaris. Es tracta, doncs, d’un servidor intermediari amb una missió específica: l’accés a les pàgines web.
</p>

<p>

</p>

</div>

<h3><a id="emmagatzematge_en_memoria_cau" >Emmagatzematge en memòria cau</a></h3>
<div class="level3">
<div class="iocimportant"><div class="ioccontent">
<p>
En l’entorn de la informàtica, la memòria cau és la memòria d’alta velocitat instal·lada en el mateix processador on s’emmagatzemen les dades que el microprocessador necessita utilitzar més freqüentment (podem incloure dins d’aquest grup els arxius temporals d’Internet).
</p>
</div></div>
<p>
Considerant que la memòria cau ajuda a augmentar notòriament la velocitat de funcionament de l’ordinador, la seva inclusió en un servidor intermediari facilita un cau on desar les pàgines web i els continguts descarregats. Aquesta informació és compartida per tots els equips de la xarxa i, en conseqüència, hi ha millores importants en els temps d’accés per a totes les consultes coincidents que puguin sorgir.
</p>

<p>
Tal com mostra la <span class="figref"><a href="#Figura19"><span>figura</span></a></span>, l’emmagatzematge en memòria cau per part del servidor intermediari optimitza en gran mesura la navegació per la xarxa
o per Internet.
</p>
<div class="iocfigure"><a name="Figura19"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Funcionament d’un servidor intermediari cau

</figcaption><img src="../media/smx_m07u3-46_1.png" alt="" /></figure>
</div>
<p>
De fet, quan es fa una petició des d’un ordinador cap a Internet, s’emmagatzema una còpia de la petició per si en properes ocasions es torna a demanar la mateixa informació. En aquest cas, el servidor intermediari cau comprova que la versió emmagatzemada encara sigui vàlida (sempre i quan no sigui en format <acronym title="HyperText Markup Language">HTML</acronym>, atès que el contingut de les pàgines web pot canviar en qualsevol moment).
</p>

<p>
Arribats a aquest punt, amb la intenció d’agilitzar la navegació per Internet i augmentar la seguretat, podem configurar el nostre navegador web perquè, a l’hora de navegar, ho faci mitjançant un servidor intermediari cau que hi hagi instal·lat a la xarxa. Per fer-ho, haurem d’adreçar-nos a l’opció Eines dins de la barra superior del navegador i accedir a la configuració de les opcions principals del navegador web (<span class="figref"><a href="#Figura20"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figura20"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Funcionament d’un servidor intermediari cau

</figcaption><img src="../media/smx_m07u3-47_1.png" alt="" /></figure>
</div>
<p>
D’altra banda, tal com mostra la <span class="figref"><a href="#Figura21"><span>figura</span></a></span>, un cop dins de les opcions de configuració del navegador web, ens haurem d’adreçar a l’opció Avançat i, un cop dins i tenint en compte que la decisió de navegar mitjançant el servidor intermediari cau és una cosa pròpia de la xarxa en què estem treballant, accedir a la pestanya Xarxa per ajustar els paràmetres corresponents.
</p>

<p>
Finalment, haurem d’ajustar els detalls principals de la nostra navegació per la xarxa: per exemple, definir el servidor intermediari per on volem navegar i el port. En aquest cas, optarem pel port 8080, ja que és el port per on escolta les peticions el servidor intermediari cau.
</p>

<p>
El port que acostumarem a prendre sempre que estiguem navegant des d’una xarxa corporativa serà el 8080, ja que s’utilitza quan un segon servidor web està en funcionament en la mateixa màquina (la major part de xarxes corporatives té un servidor web per penjar-hi la pàgina web de l’organització que escolta pel port 80) (<span class="figref"><a href="#Figura22"><span>figura</span></a></span>).
</p>
<div class="iocfigure"><a name="Figura21"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Configuració dels paràmetres de navegació

</figcaption><img src="../media/smx_m07u3-47_2.png" alt="" /></figure>
</div><div class="iocfigure"><a name="Figura22"></a><figure>
<figcaption><span class="figuretitle">Figura</span>

Configuració dels paràmetres de connexió

</figcaption><img src="../media/smx_m07u3-48_1.png" alt="" /></figure>
</div>
<p>
Si un programa client no especifica explícitament el servidor intermediari que vol fer servir, pot estar utilitzant un servidor intermediari sense cap mena de configuració addicional, és a dir, un servidor intermediari transparent.
</p>
<div class="ioctextl"><div class="ioccontent"><p class="ioctitle">Servidor intermediari transparent</p>
<p>
Són moltes les organitzacions que opten per la utilització dels servidors intermediaris per reforçar les polítiques d’utilització de la xarxa o per proporcionar seguretat i serveis de memòria cau.
</p>

<p>
En la configuració d’un navegador que utilitza un servidor intermediari (<em>proxy</em>) transparent amb memòria cau, no cal configurar els navegadors web i els usuaris són obligats a utilitzar-los sense serne conscients. Quan els usuaris fan una petició des del navegador web creuen que es troben connectats directament a la xarxa d’Internet tot i que en realitat estan connectats al servidor intermediari. Aquests tipus de servidors intermediaris són els que acostumen a utilitzar els proveïdors de serveis d’Internet (ISP, <em>Internet service provider</em>).
</p>
</div></div>
</div>

<h2><a id="instal_lacio_d_una_aplicacio_que_faci_de_passarel_la" >Instal·lació d&#039;una aplicació que faci de passarel·la</a></h2>
<div class="level2">
<div class="iocimportant"><div class="ioccontent">
<p>
El servidor intermediari és una màquina (ordinador) que recull pàgines web directament de l’exterior a petició dels seus ordinadors clients, i emmagatzema en el seu disc dur local una còpia i un índex de totes les pàgines visitades.
</p>
</div></div>
<p>
<div class="iocfigurec">
<ul>
<li>
<img src="../media/smx_m07u3-48_2.png" class="imgB" title="Logotip del programari Squid./11" alt="Logotip del programari Squid./11" /></li><li><small>Logotip del programari Squid.</small></li>
</ul></div>

</p>

<p>
Des del punt de vista del programari que facilita les tasques pròpies de passarel·la i servidor intermediari és inevitable citar el programari Squid. Es tracta d’un programari reconegut que, sota la categoria de programari lliure (es distribueix sota els termes de la llicència pública general GNU), s’ha estat desenvolupant durant uns quants anys fins que ha assolit una utilització freqüent en els sistemes operatius GNU/Linux. Proporciona un alt grau de confiança, és robust i, alhora, molt versàtil.
</p>

<p>
El programari Squid tant pot funcionar com a servidor intermediari i memòria cau de continguts de xarxa per als protocols HTTP o de transferència d’arxius (<acronym title="File Transfer Protocol">FTP</acronym>) com pot facilitar l’acceleració HTTP i permet establir caus de consultes al servidor de noms de domini (<acronym title="Domain Name System">DNS</acronym>). Paral·lelament, des del punt de vista de la seguretat, permet filtrar per continguts i establir controls d’accés per adreça d’Internet (IP) i per usuari.
</p>
<div class="iocimportant"><div class="ioccontent">
<p>
El programari Squid no pot actuar com a servidor intermediari per a protocols de correu electrònic (SMTP, POP3), segurs (SSH) o de comunicació instantània (<acronym title="Internet Relay Chat">IRC</acronym>). En aquests casos, una de les possibles solucions és implementar obligatòriament un emmascarament de l’adreça d’Internet (IP) (NAT, <em>network address translation</em>).
</p>
</div></div>
<p>

</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Traducció d’adreça de xarxa (NAT)</p>
<p>
Mecanisme utilitzat per encaminadors per permetre la connexió a Internet a un gran nombre d’equips mitjançant una única adreça d’Internet (IP). Per tant, permet utilitzar una sola adreça IP pública per a tota una xarxa privada.
</p>
</div></div>
<p>
Paral·lelament, com que el programari Squid també és un servidor intermedi, és a dir, es comporta com un client en lloc del client real, pot proporcionar un cert grau d’anonimat i seguretat. No obstant, el que es pot interpretar com un avantatge també pot esdevenir un desavantatge, ja que pot introduir problemes significatius de privadesa perquè pot registrar molta informació, que inclou les <acronym title="Uniform Resource Locator">URL</acronym> sol·licitades juntament amb altra informació addicional (la data de la petició, la versió del navegador i del sistema operatiu, etc.).
</p>

<p>
És important destacar que el programari Squid té algunes característiques que poden facilitar l’establiment de connexions anònimes com l’eliminació o modificació de camps determinats de la capçalera de peticions HTTP dels clients. Aquesta política d’eliminació i alteració de capçaleres s’estableix en la configuració de Squid.
</p>

<p>
Amb tot, l’usuari que sol·licita pàgines mitjançant una xarxa que utilitza el programari Squid de manera transparent no acostuma a ser conscient d’aquest procés o del registre d’informació relacionada amb el procés.
</p>

</div>

<h3><a id="instal_lacio_del_programari_squid_per_a_linux" >Instal·lació del programari Squid per a Linux</a></h3>
<div class="level3">

<p>
Tenint en compte que el programari Squid té una presència important a nivell dels diferents sistemes operatius GNU/Linux, exposarem el seu procés d’instal·lació i configuració en un sistema operatiu d’aquesta categoria.
</p>

<p>
Cal destacar que, que gràcies a Squid, podrem establir un servidor intermediari amb memòria cau i/o de filtrat. L’avantatge principal d’aquest tipus de servidor intermediari és que cada pàgina web estàtica visitada és emmagatzemada durant un període de temps determinat i, en conseqüència, estalviem amplada de banda. Des del punt de vista del vessant del servidor intermediari de filtratge, aquest no ens permet accedir a un lloc web determinat, una adreça d’Internet o bé una paraula clau.
</p>

<p>
Per tant, per portar a terme la instal·lació haurem de descarregar els paquets corresponents. En aquest cas, tot i que el programari queda instal·lat, ens podem trobar algunes incongruències de configuració per al nostre sistema.
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">ubuntu@ubuntu:~$ sudo apt get install squid</div></li><li class="li1"><div class="de1">ubuntu@ubuntu:~$ sudo update.rc squid 90 2 3 4 5 . stop 90 1 6 .</div></li></ol></pre>

<p>
És important destacar, a més, que dins de la instal·lació del programari Squid en el sistema operatiu Ubuntu hi ha la possibilitat que aparegui un missatge d’error.
</p>
<pre class="code">FATAL: Could not determine fully qualified hostname. Please set &#039;visible_hostname&#039;</pre>

<p>
En aquest cas, ens haurem d’adreçar a l’arxiu de configuració principal que es troba en la ruta <code>/etc/squid/squid.conf</code> i hi afegirem la línea <em>visible_hostname localhost</em>. Això farà que el programari Squid s’executi com a dimoni cada cop que engeguem l’ordinador.
</p>

<p>
L’arxiu de configuració del programari Squid s’anomena <em> /etc/squid/squid.conf</em> i està integrat per diferents línies de text corresponents a les directives de configuració del programari i els paràmetres corresponents. Val a dir que les línies de text que comencen amb el símbol <em>#</em> són ignorades perquè es consideren comentaris.
</p>

<p>
Cal destacar que dins del procés d’instal·lació de Squid podem trobar una eina tallafocs anomenada <code>Iptables</code> que permet tant filtrar paquets de dades com traduir les adreces de xarxa pel protocol IPv4.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Iptables</p>
<p>
GNU/Linux pot funcionar com a tallafocs, ja que el porta inclòs en el seu nucli. De fet, permet definir regles que determinen què es pot fer amb cada paquet. Per a les versions actuals el filtratge es fa mitjançant l’eina Iptables.
</p>
</div></div>
<p>
Paral·lelament, és rellevant destacar que dins de l’arxiu de configuració principal de Squid (<code>/etc/squid/squid.conf</code>) hi ha un gran nombre de paràmetres que és rellevant que coneguem, ja que ens ajudaran a definir el funcionament del programari perquè s’ajusti fins al mínim detall a les necessitats de la nostra xarxa.
</p>

</div>

<h4><a id="parametre_http_port" >Paràmetre http_port</a></h4>
<div class="level4">

<p>
El paràmetre <em>http_port</em> ens permet definir quin port ha de ser utilitzat per al programari Squid. Cal tenir en compte que l’autoritat per a l’assignació de números d’Internet (IANA, <em>Internet assigned numbers authority</em>) va establir que els ports registrats (interval entre 1024 i 49151) recomanats per als servidors intermediaris poden anar des del 3128 fins al 8080 mitjançant el protocol de control de transmissió (TCP, <em>transmission control protocol</em>).
</p>

<p>
De manera predefinida, el programari Squid utilitza el port 3128 per atendre peticions, tot i que hi ha la possibilitat d’especificar un altre port que estigui disponible o bé fer-ho per diversos ports disponibles alhora.
</p>

<p>
Normalment, són molts els programes a nivell d’usuari que porten predefinit que el port 8080 serà el que utilitzarà el servidor intermediari amb què hagin de treballar. Per tant, amb la intenció d’agilitzar la configuració del programari Squid, podem definir que també escolti les peticions per aquest port.
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">#</div></li><li class="li1"><div class="de1"># You may specify multiple socket addresses on multiple lines.</div></li><li class="li1"><div class="de1">#</div></li><li class="li1"><div class="de1"># Default: http_port 3128</div></li><li class="li1"><div class="de1">http_port 3128</div></li><li class="li1"><div class="de1">http_port 8080</div></li></ol></pre>

<p>
Hi ha la possibilitat d’incrementar el nivell de seguretat vinculant el servei a una adreça d’Internet (IP) a la qual només es pugui accedir des de la xarxa local. Per tant, si el servidor utilitzat fa servir una adreça IP 192.168.1.254, podem establir el següent:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">#</div></li><li class="li1"><div class="de1"># You may specify multiple socket addresses on multiple lines.</div></li><li class="li1"><div class="de1">#</div></li><li class="li1"><div class="de1"># Default: http_port 3128</div></li><li class="li1"><div class="de1">http_port 192.168.1.254:3128</div></li><li class="li1"><div class="de1">http_port 192.168.1.254:8080</div></li></ol></pre>

</div>

<h4><a id="parametre_cache_mem" >Paràmetre cache_mem</a></h4>
<div class="level4">

<p>

</p>

<p>
El paràmetre <code>cache_mem</code> estableix la quantitat ideal de memòria per dedicar als objectes en trànsit, als objectes que s’utilitzen més sovint o bé als objectes negativament emmagatzemats en la cau. En aquest cas, les dades d’aquests objectes s’emmagatzemen en blocs de 4 kB, on el paràmetre <code>cache_mem</code> especifica un límit màxim en la grandària total de blocs acomodats on els objectes en trànsit tenen més prioritat.
</p>

<p>
Amb tot, la resta d’objectes emmagatzemats en la cau podran utilitzar la memòria disponible fins que sigui requerida. De fet, en el cas que un objecte en trànsit fos més gran que la quantitat de memòria especificada, el programari Squid l’excediria tant com calgués per satisfer la petició.
</p>

<p>
Tot i que de manera predeterminada s’estableixen uns 8 <acronym title="Megabyte">MB</acronym>, hi ha la possibilitat d’especificar-ne una quantitat més gran si ho considerem necessari. Amb tot, si disposem d’un servidor amb uns 128 <acronym title="Megabyte">MB</acronym> de RAM, podríem establir uns 16 <acronym title="Megabyte">MB</acronym> com a valor per a aquest paràmetre.
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">cache_mem 16 MB</div></li></ol></pre>

</div>

<h4><a id="parametre_cache_dir" >Paràmetre cache_dir</a></h4>
<div class="level4">

<p>
Aquest paràmetre s’utilitza per establir quina grandària es desitja que tingui la memòria cau en el disc dur per al programari Squid. És com si ens demanéssim quant volem emmagatzemar d’Internet en el nostre disc dur.
</p>

<p>
De manera predefinida, el programari Squid utilitzarà una cau de 100 <acronym title="Megabyte">MB</acronym>; per tant, dins de l’arxiu de configuració trobarem la línia següent:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">cache_dir ufs /var/spool/squid 100 16 256</div></li></ol></pre>

<p>
Val a dir que podrem incrementar la grandària de la cau tant com vulguem per emmagatzemar un nombre més gran d’objectes i, per tant, utilitzar menys amplada de banda.
</p>

<p>
Per exemple, amb la línia següent establirem una cau de 700 <acronym title="Megabyte">MB</acronym>:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">cache_dir ufs /var/spool/squid 700 16 256</div></li></ol></pre>

<p>
En aquest exemple, els números 16 i 256 volen dir que el directori de la cau contindrà 16 directoris subordinats amb 256 nivells cadascun. És preferible que no modifiquem aquests valors.
</p>

<p>
Finalment, és important destacar que, en el cas que especifiquem una grandària de cau i aquesta excedeixi l’espai real en el disc dur, Squid es bloquejarà inevitablement.
</p>

</div>

<h4><a id="parametre_cache_mgr" >Paràmetre cache_mgr</a></h4>
<div class="level4">

<p>
<div class="iocfigurec">
<ul>
<li>
<img src="../media/smx_m07u3-52_1.png" class="imgB" title="Com si es tractés d’un garatge, les dades es van agrupant de manera ordenada. En el cas que sobrepassem la capacitat, provocarem un bloqueig en el programari i en el maquinari./5" alt="Com si es tractés d’un garatge, les dades es van agrupant de manera ordenada. En el cas que sobrepassem la capacitat, provocarem un bloqueig en el programari i en el maquinari./5" /></li><li><small>Com si es tractés d’un garatge, les dades es van agrupant de manera ordenada. En el cas que sobrepassem la capacitat, provocarem un bloqueig en el programari i en el maquinari.</small></li>
</ul></div>

</p>

<p>
De manera predeterminada, si succeeix alguna cosa a la cau (per exemple, que es morin els processos), s’enviarà un missatge d’avís al compte de correu electrònic de l’administrador del servidor o bé al compte de correu electrònic definit dins de l’arxiu de configuració.
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">cache_mgr admin@municipi.cat</div></li></ol></pre>

</div>

<h4><a id="parametre_cache_peercaus_pares_i_germans" >Paràmetre cache_peer: caus pares i germans</a></h4>
<div class="level4">

<p>
El paràmetre <em>cache_peer</em> s’utilitza per especificar altres servidors intermediaris amb cau dins d’una jerarquia com a pares o bé com a germans – és a dir, per definir si hi ha un servidor intermediari situat per davant o en paral·lel. En aquest cas, la sintaxi bàsica seria la següent:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">cache_peer servidor tipus http_port icp_port opcions</div></li></ol></pre>

<p>
Finalment, és important destacar que, des del punt de vista de les memòries cau, el programari Squid utilitza diversos algorismes per gestionar aquesta memòria mitjançant el paràmetre <code>cache_replacement_policy</code>.
</p>

</div>

<h4><a id="el_menys_utilitzat_recentment_lru_least_recently_used" >El menys utilitzat recentment (LRU, Least Recently Used)</a></h4>
<div class="level4">

<p>
En aquest algorisme és on els objectes als quals no s’ha accedit en molt temps són eliminats en primer lloc i sempre es mantenen en la memòria cau els objectes que s’hagin sol·licitat més recentment. Aquesta política és la utilitzada per Squid de manera predefinida.
</p>

</div>

<h4><a id="el_menys_utilitzat_frequeentment_amb_envelliment_dinamic_lfuda_least_frequently_used_with_dynamic_aging" >El menys utilitzat freqüentment amb envelliment dinàmic (LFUDA, Least Frequently Used with Dynamic Aging)</a></h4>
<div class="level4">

<p>
En aquest algorisme els objectes més sol·licitats es mantenen en la memòria cau sense que hi hagi problemes per la seva grandària mitjançant una optimització de l’eficiència. De fet, un objecte gran que es sol·liciti amb molta freqüència impedirà que es puguin emmagatzemar en la cau aquells objectes petits que se sol·liciten amb menys freqüència.
</p>

</div>

<h4><a id="frequeencia_de_grandaria_del_cobejos_dual_gdsf_greedydual_size_frequency" >Freqüència de grandària del cobejós dual (GDSF, GreedyDual size Frequency)</a></h4>
<div class="level4">

<p>
En aquest algorisme s’optimitza l’eficiència (<em>hit rate</em>) per objecte i es mantenen en la memòria cau els objectes petits que se sol·liciten amb més freqüència perquè, en conseqüència, hi hagi més possibilitats d’aconseguir respostes a una sol·licitud (<em>hit</em>). Té més eficiència que l’algorisme <em>LFUDA</em>, ja que descarta de la memòria cau aquells objectes més grans que se sol·liciten amb freqüència.
</p>

</div>

<h3><a id="configuracio_de_squid_per_a_linux" >Configuració de Squid per a Linux</a></h3>
<div class="level3">

<p>
Una de les configuracions de servidor intermediari més aplicada és la pròpia d’un servidor intermediari transparent: un servidor intermediari en el qual l’usuari final no s’adona que l’està utilitzant, és a dir, la configuració no s’ha aplicat en el navegador web sinó en el tràfic de dades que produeix la navegació per Internet d’aquest usuari.
</p>

<p>
Paral·lelament, elaborarem un arxiu de regles de paraules denegades i d’altres de permeses perquè, de manera predeterminada, accepta tot allò que no estigui denegat; no obstant, hi ha el perill que, a l’hora de denegar alguna paraula, en puguem prohibir alguna altra de vàlida: per exemple, si deneguem <em>cul</em> també prohibirem <em>culminar</em>; per tant, en aquest cas, amb la intenció d’evitar possibles inconvenients haurem d’afegir la paraula <em>culminar</em> a la llista de paraules permeses.
</p>

<p>
Finalment, podem optar per ser una mica més permissius amb una part dels usuaris. Per fer-ho, podem segmentar la xarxa en dos, és a dir, d’una banda, un equip d’usuaris podrà veure totes les pàgines web que desitgi i, de l’altra, no permetrem que la resta d’usuaris (per exemple, individus menors d’edat) tingui accés a les pàgines amb continguts admesos per a adults.
</p>

<p>
Per tant, per establir el servidor intermediari transparent ens haurem d’adreçar a l’arxiu de configuració principal de Squid (<code>/etc/squid/squid.conf</code>) i haurem de modificar el paràmetre corresponent al port del protocol http.
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">http_port 10.65.10.1:3128 transparent</div></li></ol></pre>

<p>
En aquesta primera instrucció indicarem que utilitzarem el port 3128 mitjançant el nostre servidor situat, per exemple, en l’adreça d’Internet 10.65.10.1; a més, establirem que el nostre servidor intermediari sigui transparent.
</p>

<p>
A continuació, haurem de configurar els paràmetres principals relacionats amb la memòria cau.
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">cache_mem 64 MB</div></li><li class="li1"><div class="de1">cache_swap_low 85</div></li><li class="li1"><div class="de1">cache_swap_high 95</div></li><li class="li1"><div class="de1">maximum_object_size 4096 KB</div></li><li class="li1"><div class="de1">cache_dir aufs /var/spool/squid 1024 16 256</div></li><li class="li1"><div class="de1">cache_access_log /var/log/squid/access.log</div></li><li class="li1"><div class="de1">cache_log /var/log/squid/cache.log</div></li><li class="li1"><div class="de1">cache_store_log /var/log/squid/store.log</div></li></ol></pre>

<p>
Pel que fa als paràmetres propis de la memòria cau, podem destacar que la <code>cache_swap_low</code> i la <code>cache_swap_high</code>, que són l’interval de percentatge de memòria cau que es dedica a l’intercanvi. En aquest cas, des del punt de vista dels paràmetres <code>cache_access_log</code>, <code>cache_log</code> i <code>cache_store_log</code>, aquests fan referència als registres que informen de l’accés, el registre del sistema de memòria cau i el de la utilització de l’emmagatzematge.
</p>

<p>
Un cop haguem definit les característiques principals de la memòria cau, ja podrem definir els temps d’emmagatzematge com, per exemple, quant temps romandrà desada la informació, el temps mínim abans de descarregar de nou (en minuts), el percentatge d’envelliment i el temps màxim perquè es consideri antic (també en minuts).
</p>

<p>
Per exemple, podríem establir una temporització respecte al temps que s’han de mantenir emmagatzemats els arxius de so i vídeo (en els formats més utilitzats) o els paquets d’actualització del sistema operatiu. Ara bé, s’emmagatzemaran els arxius que compleixin allò que s’hagi definit en el paràmetre <code>maximum_object_size</code>.
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># Paquets Debian 1 dia</div></li><li class="li1"><div class="de1">refresh_pattern -i \.deb$ 1440 100% 1440</div></li><li class="li1"><div class="de1">refresh_pattern -i \.rpm$ 1440 100% 1440</div></li><li class="li1"><div class="de1"># Actualitzacions de windows 10 a 20 dies</div></li><li class="li1"><div class="de1">refresh_pattern -i \.cab$ 14400 80% 28800</div></li><li class="li1"><div class="de1"># Executables 10 a 30 dies</div></li><li class="li1"><div class="de1">refresh_pattern -i \.exe$ 14400 80% 43200</div></li><li class="li1"><div class="de1"># Imatges mínim 1 dia i màxim 3 abans de tornar a descarregar-les</div></li><li class="li1"><div class="de1">refresh_pattern -i \.gif$ 1440 80% 4320</div></li><li class="li1"><div class="de1">refresh_pattern -i \.tiff?$ 1440 80% 4320</div></li><li class="li1"><div class="de1">refresh_pattern -i \.jpe?g$ 1440 80% 4320</div></li><li class="li1"><div class="de1">refresh_pattern -i \.png$ 1440 80% 4320</div></li><li class="li1"><div class="de1">refresh_pattern -i \.ico$ 1440 80% 4320</div></li><li class="li1"><div class="de1"># Video mínim 10 dies, màxim 30</div></li><li class="li1"><div class="de1">refresh_pattern -i \.mpe?g?$ 14400 80% 43200</div></li><li class="li1"><div class="de1">refresh_pattern -i \.avi$ 14400 80% 43200</div></li><li class="li1"><div class="de1">refresh_pattern -i \.swf$ 14400 80% 43200</div></li><li class="li1"><div class="de1">refresh_pattern -i \.flv$ 14400 80% 43200</div></li><li class="li1"><div class="de1"># So mínim 10 dies, màxim 30</div></li><li class="li1"><div class="de1">refresh_pattern -i \.wav$ 14400 80% 43200</div></li><li class="li1"><div class="de1">refresh_pattern -i \.mp2$ 14400 80% 43200</div></li><li class="li1"><div class="de1">refresh_pattern -i \.mp3$ 14400 80% 43200</div></li><li class="li1"><div class="de1">refresh_pattern -i \.ogg$ 14400 80% 43200</div></li><li class="li1"><div class="de1"># Default</div></li><li class="li1"><div class="de1">refresh_pattern ^ftp: 1440  20% 10080</div></li><li class="li1"><div class="de1">refresh_pattern .     0     20% 4320</div></li></ol></pre>

</div>

<h3><a id="configuracio_del_control_d_acces_de_squid_per_a_linux" >Configuració del control d’accés de Squid per a Linux</a></h3>
<div class="level3">

<p>
Denegar l’accés a certs llocs web d’Internet no només permet fer un ús més racional de l’amplada de banda disponible, sinó que ajuda a establir unes mesures de seguretat i protecció dels usuaris. Per aquest motiu no hem de deixar de banda la possibilitat d’establir llistes de control d’accés (<acronym title="Access Control List">ACL</acronym>, <em>access control list</em>) que ens ofereix el programari Squid.
</p>

<p>
Per tant, si partim d’un cas en què hem de permetre l’accés a tots els llocs web d’Internet sense cap mena de restricció a un sector dels usuaris i limitar la navegació a la resta (usuaris menors d’edat), ens hem d’adreçar al paràmetre <code>http_access</code>. El paràmetre <code>http_access</code> permet o proporciona l’accés a les regles d’accés http.
</p>
<div class="ioctext"><div class="ioccontent"><p class="ioctitle">Llista de control d’accés (ACL)</p>
<p>
Concepte de seguretat informàtica utilitzat per fer complir la separació de privilegis, és a dir, donar o no uns privilegis a un objecte determinat que està fent una consulta.
</p>
</div></div><div class="iocimportant"><div class="ioccontent">
<p>
Les regles s’apliquen de dalt a baix; per tant, les regles situades en les zones superiors tenen rellevància per sobre de les regles de les zones inferiors. És a dir, si a dalt de tot permeto un accés i a continuació denego tot, únicament estic permetent un accés.
</p>
</div></div>
<p>

</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">acl all src 0.0.0.0/0.0.0.0                 # tot</div></li><li class="li1"><div class="de1">acl manager proto cache_object</div></li><li class="li1"><div class="de1">acl localhost src 127.0.0.1/255.255.255.255 # maquina local</div></li><li class="li1"><div class="de1">acl SSL_ports port 443 873                  # https, rsync</div></li><li class="li1"><div class="de1">acl Safe_ports port 80                      # http</div></li><li class="li1"><div class="de1">acl Safe_ports port 21                      # ftp</div></li><li class="li1"><div class="de1">acl CONNECT method CONNECT                  # metode Connect</div></li><li class="li1"><div class="de1">acl adults src 10.65.10.0/255.255.255.0     # xarxa adults</div></li><li class="li1"><div class="de1">acl menors_edat src 10.85.10.0/255.255.255.0 # xarxa menors_edat</div></li><li class="li1"><div class="de1">acl paraulesNo url_regex &quot;/etc/squid/paraules_no&quot;</div></li><li class="li1"><div class="de1">acl paraulesSi url_regex &quot;/etc/squid/paraules_si&quot;</div></li><li class="li1"><div class="de1">acl horari time MTWHF 17:30-20:00</div></li><li class="li1"><div class="de1">acl cap_d_setmana time AS 15:00-23:00</div></li><li class="li1"><div class="de1">http_access allow manager localhost</div></li><li class="li1"><div class="de1">http_access deny !Safe_ports</div></li><li class="li1"><div class="de1">http_access deny CONNECT !SSL_ports</div></li><li class="li1"><div class="de1">http_access allow paraulesSi</div></li><li class="li1"><div class="de1">http_access allow adults</div></li><li class="li1"><div class="de1">http_access allow horari cap_d_setmana menors_edat !paraulesNo</div></li><li class="li1"><div class="de1">http_access deny all</div></li></ol></pre>

<p>
Per a l’establiment d’una llista de control d’accés haurem de respectar una sintaxi determinada –en el nostre cas, si utilitzem l’acrònim “src” farem referència a una adreça o un conjunt d’adreces d’Internet (IP); d’altra banda, el paràmetre time fa referència als 7 dies de la setmana (MTWHFAS, Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday) i un interval horari (00.00 – 23.59).
</p>

<p>
D’altra banda, els paràmetres <code>acl paraulesNo url_regex “/etc/squid/paraules_no”</code> i <code>acl paraulesSi url_regex “/etc/squid/paraules_si”</code> fan referència a url_regex, que fa una cerca d’una expressió (o un mot concret) en un nom de domini d’Internet i la llista d’expressions regulars es troba en els arxius <code>/etc/squid/paraules_no</code> i <code>/etc/squid/paraules_si</code>.
</p>

<p>
Per exemple, com a <code>paraules_no</code> podríem citar “sexe”, “sex”, “xat”, “joc”, “cul” o qualsevol altra paraula que l’usuari pugui cercar mitjançant un cercador, o bé que pugui estar continguda en un lloc web present a Internet. Ara bé, un exemple de <code>paraules_si</code> serien aquelles paraules que poden tenir integrada una part d’alguna paraula denegada com, per exemple, “sexenni” o “culminar” (totes dues contindrien les paraules prohibides “sex” o “cul”).
</p>

<p>
Val a dir que, tenint en compte que haurem d’establir restriccions en la navegació per Internet per a un sector dels usuaris, haurem d’establir missatges del servidor intermediari en castellà i, alhora, modificar el nom de l’ordinador per aquell que desitgem.
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">error_directory /usr/share/squid/errors/Spanish</div></li><li class="li1"><div class="de1">visible_hostname proxy.controlparental.local</div></li></ol></pre>

<p>
Arribats a aquest punt, ja podrem configurar Iptables; en aquest cas, com que estem treballant amb el sistema operatiu Ubuntu, haurem de crear l’arxiu <code>squid.sh</code> en la ruta <code>/etc/network/if-pre-up.d/</code>, que contindrà les línies de codi següents:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">#!/bin/sh</div></li><li class="li1"><div class="de1">iptables -t nat -A PREROUTING -s 10.69.0.0/255.255.255.0 -p tcp -m tcp --dport 80 -j REDIRECT --to-ports 3128</div></li><li class="li1"><div class="de1">iptables -t nat -A PREROUTING -s 10.69.1.0/255.255.255.0 -p tcp -m tcp --dport 80 -j REDIRECT --to-ports 3128</div></li><li class="li1"><div class="de1">iptables -t filter -A RH-Firewall-1-INPUT -i eth1 -p tcp -m state --state NEW -m tcp --dport 3128 -j ACCEPT</div></li></ol></pre>

<p>

</p>

<p>
Un cop haguem creat el document, haurem de canviar-ne els permisos, principalment el d’execució, i, a continuació, carregarem l’arxiu en qüestió.
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">chmod ugo+x /etc/network/if-pre-up.d/squid.sh</div></li><li class="li1"><div class="de1">source /etc/network/if-pre-up.d/squid.sh</div></li></ol></pre>

</div>

<h3><a id="inici_i_inclusio_del_servei_en_l_arrencada_del_sistema" >Inici i inclusió del servei en l’arrencada del sistema</a></h3>
<div class="level3">

<p>
Un cop haguem finalitzat la configuració del programari Squid, ja podrem executar l’ordre per iniciar, per primera vegada, el programari:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">/etc/init.d/squid start</div></li></ol></pre>

<p>
En el cas que necessitéssim tornar a arrencar per comprovar els canvis fets en la configuració, haurem d’executar l’ordre següent:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">/etc/init.d/squid restart</div></li></ol></pre>

<p>
Paral·lelament, si volem aturar el programari, haurem d’executar l’ordre següent:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">/etc/init.d/squid stop</div></li></ol></pre>

</div>

<h3><a id="permis_o_denegacio_de_l_acces_des_de_certs_conjunts_d_adreces_ip" >Permís o denegació de l’accés des de certs conjunts d’adreces IP</a></h3>
<div class="level3">

<p>
Amb Squid és molt senzill permetre o denegar l’accés a Internet per conjunts d’adreces d’Internet (IP). De fet, si una organització on cada secció/departament utilitza un conjunt d’adreces concret, podrem permetre o denegar l’accés a un departament de manera senzilla.
</p>

<p>
En aquest cas, amb la intenció d’evitar treballar amb l’arxiu de configuració principal de Squid (<code>/etc/squid/squid.conf</code>), és preferible que creem una llista de control d’accés (<acronym title="Access Control List">ACL</acronym>) que carregui els departaments des d’un arxiu extern. Per exemple, mitjançant un editor de textos podríem crear l’arxiu <code>/etc/squid/depts-prohibits.txt</code>, on indicarem els conjunts d’adreces d’Internet (IP) que no volem que naveguin. Per exemple, si no volem que el departament de comptabilitat i recursos humans naveguin, el contingut de l’arxiu <code>/etc/squid/depts-prohibits.txt</code> hauria de ser:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">//Arxiu /etc/squid/depts-prohibits.txt</div></li><li class="li1"><div class="de1">10.0.2.0/24 # Dept. Comptabilitat</div></li><li class="li1"><div class="de1">10.0.3.0/24 # Dept. RRHH</div></li></ol></pre>

<p>
A continuació, haurem d’editar l’arxiu de configuració principal de Squid (<code>/etc/squid/squid.conf</code>) per crear i introduir una llista d’accés (<acronym title="Access Control List">ACL</acronym>) que carregui els conjunts des de l’arxiu <code>/etc/squid/depts-prohibits.txt</code> i, així, denegarem l’accés a aquests conjunts.
</p>

<p>
Editarem <code>squid.conf</code> i introduirem aquestes dues línies:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">acl depts-prohibits src &quot;/etc/squid/depts-prohibits.txt&quot;</div></li><li class="li1"><div class="de1">http_access deny depts-prohibits</div></li></ol></pre>

<p>
Finalment, haurem de recarregar la configuració de Squid perquè arrenqui amb la configuració nova.
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">/etc/init.d/squid reload</div></li></ol></pre>

<p>
Val a dir que també podrem crear i introduir una llista d’accés (<acronym title="Access Control List">ACL</acronym>) per indicar els localitzadors uniformes de recursos (<acronym title="Uniform Resource Locator">URL</acronym>) prohibits, és a dir, les adreces prohibides des d’un arxiu extern. Per tant, editarem l’arxiu principal de configuració de Squid (<code>/etc/squid/squid.conf</code>) i introduirem les línies següents:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">acl urls-prohibides dst &quot;/etc/squid/urls-prohibides.txt&quot;</div></li><li class="li1"><div class="de1">http_access deny urls-prohibides</div></li></ol></pre>

<p>
Ara bé, si no volem que els treballadors de l’organització accedeixin a llocs web determinats (per exemple, <code>www.sexe.cat</code> o <code>www.gentenconill.cat</code>), el contingut de l’arxiu <code>/etc/squid/urls-prohibides.txt</code> que haurem de definir seria:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1">//Arxiu /etc/squid/urls-prohibides.txt</div></li><li class="li1"><div class="de1">  www.sexe.cat</div></li><li class="li1"><div class="de1">  www.gentenconill.cat</div></li></ol></pre>

<p>
A tall de conclusió, si bé la tendència natural és denegar els departaments prohibits, denegar les adreces prohibides i a continuació permetre la resta, en el nostre cas l’arxiu <code>squid.conf</code> serà com l’original, tot i que presentarà algunes modificacions (a partir de la línea de caràcters<code> # INSERT YOUR OWN RULE(S) HERE TO ALLOW ACCESS FROM YOUR CLIENTS)</code> tal com s’indica a continuació:
</p>
<pre class="code bash"><ol><li class="li1"><div class="de1"># INSERT YOUR OWN RULE(S) HERE TO ALLOW ACCESS FROM YOUR CLIENTS</div></li><li class="li1"><div class="de1">acl depts-prohibits src &quot;/etc/squid/depts-prohibits.txt&quot;</div></li><li class="li1"><div class="de1">http_access deny depts-prohibides</div></li><li class="li1"><div class="de1">acl urls-prohibides dst &quot;/etc/squid/urls-prohibides.txt&quot;</div></li><li class="li1"><div class="de1">http_access deny urls-prohibides</div></li><li class="li1"><div class="de1">http_access allow all</div></li></ol></pre>

<p>
Per tant, editant els arxius <code>/etc/squid/depts-prohibits.txt</code> i <code>/etc/squid/urls-prohibides.txt</code> i recarregant la configuració de Squid (executant <code>/etc/init.d/squid reload</code>), podrem tornar a configurar Squid sense haver de modificar l’arxiu de configuració <code>squid.conf</code>.
</p>

<p>
Una de les funcionalitats principals que ens ofereix Squid és que registra tots els accessos a la xarxa d’Internet. De fet, cada cop que un ordinador accedeix a Internet, Squid registrarà dins de l’arxiu <code>/var/log/squid/acces.log</code> la data i l’hora, l’ordinador i l’adreça d’Internet (IP) a la qual s’ha accedit.
</p>

<p>
Per tant, analitzar l’arxiu <code>/var/log/squid/acces.log</code> ens resultarà de gran ajuda, ja que podrem veure a quines pàgines web no permeses es connecten els membres dels diferents departaments de l’organització. Aquesta informació ens permetrà decidir si hem d’anotar les diferents pàgines web visitades i recopilar-les en el nostre arxiu <code>/etc/squid/urls-prohibides.txt</code>.
</p>

</div>

	 </article>
     <div class="pnpage">
      <div class="left-corner"></div>
      <div id="prevpage">Anar a la p&agrave;gina anterior:<br /><a href="../../../WebContent/u3/a1/exercicis.html">Exercicis d'autoavaluació</a></div>
      <div id="nextpage">Anar a la p&agrave;gina seg&uuml;ent:<br /><a href="../../../WebContent/u3/a2/activitats.html">Activitats</a></div>
      <div class="right-corner"></div>
     </div>
    </div>
    <footer class="footer">
      <div><small>Aquest document està subjecte a una llicència oberta de Creative Commons, es reserva el dret de reconeixement de l'autoria, d'exigir que no se'n faci cap mena d'ús comercial. Si altereu o transformeu aquesta obra, o en genereu obres derivades, només podeu distribuir l'obra generada amb una llicència idèntica a aquesta.</small></div>
    </footer>
 </div>
 <div id="back_preview" class="hidden"></div>
 <div id="preview" class="hidden">
  <div class="prevcontent"></div>
 </div>
 <div id="help-tooltips">
  <div id="help-toc" class="hidden tooltip"><span>Taula de continguts:</span> Ofereix una vista general de l&#39;estructura del m&ograve;dul, que us facilitar&agrave; la navegaci&oacute; a trav&eacute;s dels seus continguts.<span class="arrow-left"></span></div> 
  <div id="help-settings" class="hidden tooltip"><span>Opcions de format:</span> Permet configurar el format de lectura a partir de les vostres prefer&egrave;ncies, modificant la mida de la lletra, el color del fons, l&#39;amplada de la p&agrave;gina o l&#39;ocultaci&oacute; dels continguts complementaris, entre d&#39;altres.<span class="arrow-left"></span></div>
  <div id="help-printer" class="hidden tooltip"><span>Imprimir:</span>  Envia el contingut seleccionat a la impressora.<span class="arrow-left"></span></div>
  <div id="help-favorites" class="hidden tooltip"><span>Prefereits:</span> Permet desar aquelles parts del contingut a les que us interessi accedir en un moment posterior; us permetr&agrave; anar creant un repositori personalitzat de les seccions que considereu m&eacute;s rellevants. Un cop l&#39;hageu començat a fer servir se us mostrar&agrave; a sota un comptador que us informar&agrave; del nombre de preferits que s&#39;hagin emmagatzemat fins al moment.<span class="arrow-left"></span></div>
  <div id="help-favcounter" class="hidden tooltip"><span>Comptador i llistat de preferits:</span> Indica el nombre de preferits que s&#39;han desat fins el moment; clicant damunt seu accedireu al llistat de preferits, i a trav&eacute;s d&#39;aquest podreu accedir directament als continguts que hageu emmagatzemat.<span class="arrow-left"></span></div>
  <div id="help-help_icon" class="hidden tooltip"><span>Ajuda:</span> Aquesta opci&oacute; activa la informaci&oacute; de les funcionalitats del web tot situant el punter del ratol&iacute; al damunt dels diferents &iacute;tems.<span class="arrow-left"></span></div>
  <div id="help-sidebar-hide" class="hidden tooltip"><span>Mostrar/Ocultar barra lateral:</span>  Deshabilita la barra d&#39;opcions, permetent la seva recuperaci&oacute; quan es desitgi.<span class="arrow-left"></span></div>
  <div id="help-search" class="hidden tooltip"><span>Cerca:</span>  Introdu&iuml;u les paraules clau sobre aquells conceptes que desitgeu localitzar en els continguts del m&ograve;dul. Tamb&eacute; podeu excloure un terme de la cerca tot afegint-hi el signe &#8220;-&#8221; al davant.<span class="arrow-top"></span></div>
  <div id="help-header" class="hidden tooltip"><span>Cap&ccedil;alera:</span>  Indica l&#39;apartat o secci&oacute; que es mostra en pantalla. Tingueu present que les capçaleres de segon, tercer i quart nivell tamb&eacute; es poden desar com a marcadors.<span class="arrow-left"></span></div>
</div> 
</body>
</html>
